function $9(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function AP(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var bE={exports:{}},iy={},wE={exports:{}},Un={};var u3;function X9(){if(u3)return Un;u3=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function m(X){return X===null||typeof X!="object"?null:(X=d&&X[d]||X["@@iterator"],typeof X=="function"?X:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,T={};function S(X,Y,ce){this.props=X,this.context=Y,this.refs=T,this.updater=ce||y}S.prototype.isReactComponent={},S.prototype.setState=function(X,Y){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,Y,"setState")},S.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function w(){}w.prototype=S.prototype;function P(X,Y,ce){this.props=X,this.context=Y,this.refs=T,this.updater=ce||y}var M=P.prototype=new w;M.constructor=P,x(M,S.prototype),M.isPureReactComponent=!0;var I=Array.isArray,k=Object.prototype.hasOwnProperty,D={current:null},H={key:!0,ref:!0,__self:!0,__source:!0};function W(X,Y,ce){var Me,Re={},Fe=null,Be=null;if(Y!=null)for(Me in Y.ref!==void 0&&(Be=Y.ref),Y.key!==void 0&&(Fe=""+Y.key),Y)k.call(Y,Me)&&!H.hasOwnProperty(Me)&&(Re[Me]=Y[Me]);var at=arguments.length-2;if(at===1)Re.children=ce;else if(1<at){for(var pt=Array(at),Ft=0;Ft<at;Ft++)pt[Ft]=arguments[Ft+2];Re.children=pt}if(X&&X.defaultProps)for(Me in at=X.defaultProps,at)Re[Me]===void 0&&(Re[Me]=at[Me]);return{$$typeof:n,type:X,key:Fe,ref:Be,props:Re,_owner:D.current}}function z(X,Y){return{$$typeof:n,type:X.type,key:Y,ref:X.ref,props:X.props,_owner:X._owner}}function j(X){return typeof X=="object"&&X!==null&&X.$$typeof===n}function J(X){var Y={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(ce){return Y[ce]})}var le=/\/+/g;function ge(X,Y){return typeof X=="object"&&X!==null&&X.key!=null?J(""+X.key):Y.toString(36)}function te(X,Y,ce,Me,Re){var Fe=typeof X;(Fe==="undefined"||Fe==="boolean")&&(X=null);var Be=!1;if(X===null)Be=!0;else switch(Fe){case"string":case"number":Be=!0;break;case"object":switch(X.$$typeof){case n:case e:Be=!0}}if(Be)return Be=X,Re=Re(Be),X=Me===""?"."+ge(Be,0):Me,I(Re)?(ce="",X!=null&&(ce=X.replace(le,"$&/")+"/"),te(Re,Y,ce,"",function(Ft){return Ft})):Re!=null&&(j(Re)&&(Re=z(Re,ce+(!Re.key||Be&&Be.key===Re.key?"":(""+Re.key).replace(le,"$&/")+"/")+X)),Y.push(Re)),1;if(Be=0,Me=Me===""?".":Me+":",I(X))for(var at=0;at<X.length;at++){Fe=X[at];var pt=Me+ge(Fe,at);Be+=te(Fe,Y,ce,pt,Re)}else if(pt=m(X),typeof pt=="function")for(X=pt.call(X),at=0;!(Fe=X.next()).done;)Fe=Fe.value,pt=Me+ge(Fe,at++),Be+=te(Fe,Y,ce,pt,Re);else if(Fe==="object")throw Y=String(X),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return Be}function de(X,Y,ce){if(X==null)return X;var Me=[],Re=0;return te(X,Me,"","",function(Fe){return Y.call(ce,Fe,Re++)}),Me}function ve(X){if(X._status===-1){var Y=X._result;Y=Y(),Y.then(function(ce){(X._status===0||X._status===-1)&&(X._status=1,X._result=ce)},function(ce){(X._status===0||X._status===-1)&&(X._status=2,X._result=ce)}),X._status===-1&&(X._status=0,X._result=Y)}if(X._status===1)return X._result.default;throw X._result}var me={current:null},q={transition:null},ie={ReactCurrentDispatcher:me,ReactCurrentBatchConfig:q,ReactCurrentOwner:D};return Un.Children={map:de,forEach:function(X,Y,ce){de(X,function(){Y.apply(this,arguments)},ce)},count:function(X){var Y=0;return de(X,function(){Y++}),Y},toArray:function(X){return de(X,function(Y){return Y})||[]},only:function(X){if(!j(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},Un.Component=S,Un.Fragment=t,Un.Profiler=r,Un.PureComponent=P,Un.StrictMode=i,Un.Suspense=l,Un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,Un.cloneElement=function(X,Y,ce){if(X==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+X+".");var Me=x({},X.props),Re=X.key,Fe=X.ref,Be=X._owner;if(Y!=null){if(Y.ref!==void 0&&(Fe=Y.ref,Be=D.current),Y.key!==void 0&&(Re=""+Y.key),X.type&&X.type.defaultProps)var at=X.type.defaultProps;for(pt in Y)k.call(Y,pt)&&!H.hasOwnProperty(pt)&&(Me[pt]=Y[pt]===void 0&&at!==void 0?at[pt]:Y[pt])}var pt=arguments.length-2;if(pt===1)Me.children=ce;else if(1<pt){at=Array(pt);for(var Ft=0;Ft<pt;Ft++)at[Ft]=arguments[Ft+2];Me.children=at}return{$$typeof:n,type:X.type,key:Re,ref:Fe,props:Me,_owner:Be}},Un.createContext=function(X){return X={$$typeof:o,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},X.Provider={$$typeof:s,_context:X},X.Consumer=X},Un.createElement=W,Un.createFactory=function(X){var Y=W.bind(null,X);return Y.type=X,Y},Un.createRef=function(){return{current:null}},Un.forwardRef=function(X){return{$$typeof:a,render:X}},Un.isValidElement=j,Un.lazy=function(X){return{$$typeof:u,_payload:{_status:-1,_result:X},_init:ve}},Un.memo=function(X,Y){return{$$typeof:c,type:X,compare:Y===void 0?null:Y}},Un.startTransition=function(X){var Y=q.transition;q.transition={};try{X()}finally{q.transition=Y}},Un.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Un.useCallback=function(X,Y){return me.current.useCallback(X,Y)},Un.useContext=function(X){return me.current.useContext(X)},Un.useDebugValue=function(){},Un.useDeferredValue=function(X){return me.current.useDeferredValue(X)},Un.useEffect=function(X,Y){return me.current.useEffect(X,Y)},Un.useId=function(){return me.current.useId()},Un.useImperativeHandle=function(X,Y,ce){return me.current.useImperativeHandle(X,Y,ce)},Un.useInsertionEffect=function(X,Y){return me.current.useInsertionEffect(X,Y)},Un.useLayoutEffect=function(X,Y){return me.current.useLayoutEffect(X,Y)},Un.useMemo=function(X,Y){return me.current.useMemo(X,Y)},Un.useReducer=function(X,Y,ce){return me.current.useReducer(X,Y,ce)},Un.useRef=function(X){return me.current.useRef(X)},Un.useState=function(X){return me.current.useState(X)},Un.useSyncExternalStore=function(X,Y,ce){return me.current.useSyncExternalStore(X,Y,ce)},Un.useTransition=function(){return me.current.useTransition()},Un.version="18.2.0",Un}var h3;function l0(){return h3||(h3=1,wE.exports=X9()),wE.exports}var f3;function G9(){if(f3)return iy;f3=1;var n=l0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var u,d={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(u in l)i.call(l,u)&&!s.hasOwnProperty(u)&&(d[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)d[u]===void 0&&(d[u]=l[u]);return{$$typeof:e,type:a,key:m,ref:y,props:d,_owner:r.current}}return iy.Fragment=t,iy.jsx=o,iy.jsxs=o,iy}var d3;function Y9(){return d3||(d3=1,bE.exports=G9()),bE.exports}var U=Y9(),G=l0();const ic=AP(G),q9=$9({__proto__:null,default:ic},[G]);var Ex={},SE={exports:{}},sa={},TE={exports:{}},EE={};var p3;function Z9(){return p3||(p3=1,(function(n){function e(q,ie){var X=q.length;q.push(ie);e:for(;0<X;){var Y=X-1>>>1,ce=q[Y];if(0<r(ce,ie))q[Y]=ie,q[X]=ce,X=Y;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var ie=q[0],X=q.pop();if(X!==ie){q[0]=X;e:for(var Y=0,ce=q.length,Me=ce>>>1;Y<Me;){var Re=2*(Y+1)-1,Fe=q[Re],Be=Re+1,at=q[Be];if(0>r(Fe,X))Be<ce&&0>r(at,Fe)?(q[Y]=at,q[Be]=X,Y=Be):(q[Y]=Fe,q[Re]=X,Y=Re);else if(Be<ce&&0>r(at,X))q[Y]=at,q[Be]=X,Y=Be;else break e}}return ie}function r(q,ie){var X=q.sortIndex-ie.sortIndex;return X!==0?X:q.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,m=3,y=!1,x=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(q){for(var ie=t(c);ie!==null;){if(ie.callback===null)i(c);else if(ie.startTime<=q)i(c),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=t(c)}}function I(q){if(T=!1,M(q),!x)if(t(l)!==null)x=!0,ve(k);else{var ie=t(c);ie!==null&&me(I,ie.startTime-q)}}function k(q,ie){x=!1,T&&(T=!1,w(W),W=-1),y=!0;var X=m;try{for(M(ie),d=t(l);d!==null&&(!(d.expirationTime>ie)||q&&!J());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,m=d.priorityLevel;var ce=Y(d.expirationTime<=ie);ie=n.unstable_now(),typeof ce=="function"?d.callback=ce:d===t(l)&&i(l),M(ie)}else i(l);d=t(l)}if(d!==null)var Me=!0;else{var Re=t(c);Re!==null&&me(I,Re.startTime-ie),Me=!1}return Me}finally{d=null,m=X,y=!1}}var D=!1,H=null,W=-1,z=5,j=-1;function J(){return!(n.unstable_now()-j<z)}function le(){if(H!==null){var q=n.unstable_now();j=q;var ie=!0;try{ie=H(!0,q)}finally{ie?ge():(D=!1,H=null)}}else D=!1}var ge;if(typeof P=="function")ge=function(){P(le)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,de=te.port2;te.port1.onmessage=le,ge=function(){de.postMessage(null)}}else ge=function(){S(le,0)};function ve(q){H=q,D||(D=!0,ge())}function me(q,ie){W=S(function(){q(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){x||y||(x=!0,ve(k))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var ie=3;break;default:ie=m}var X=m;m=ie;try{return q()}finally{m=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,ie){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var X=m;m=q;try{return ie()}finally{m=X}},n.unstable_scheduleCallback=function(q,ie,X){var Y=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Y+X:Y):X=Y,q){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=X+ce,q={id:u++,callback:ie,priorityLevel:q,startTime:X,expirationTime:ce,sortIndex:-1},X>Y?(q.sortIndex=X,e(c,q),t(l)===null&&q===t(c)&&(T?(w(W),W=-1):T=!0,me(I,X-Y))):(q.sortIndex=ce,e(l,q),x||y||(x=!0,ve(k))),q},n.unstable_shouldYield=J,n.unstable_wrapCallback=function(q){var ie=m;return function(){var X=m;m=ie;try{return q.apply(this,arguments)}finally{m=X}}}})(EE)),EE}var m3;function K9(){return m3||(m3=1,TE.exports=Z9()),TE.exports}var g3;function J9(){if(g3)return sa;g3=1;var n=l0(),e=K9();function t(h){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+h,b=1;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(h,p){o(h,p),o(h+"Capture",p)}function o(h,p){for(r[h]=p,h=0;h<p.length;h++)i.add(p[h])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},d={};function m(h){return l.call(d,h)?!0:l.call(u,h)?!1:c.test(h)?d[h]=!0:(u[h]=!0,!1)}function y(h,p,b,C){if(b!==null&&b.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return C?!1:b!==null?!b.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function x(h,p,b,C){if(p===null||typeof p>"u"||y(h,p,b,C))return!0;if(C)return!1;if(b!==null)switch(b.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function T(h,p,b,C,N,B,Z){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=C,this.attributeNamespace=N,this.mustUseProperty=b,this.propertyName=h,this.type=p,this.sanitizeURL=B,this.removeEmptyString=Z}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){S[h]=new T(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var p=h[0];S[p]=new T(p,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){S[h]=new T(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){S[h]=new T(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){S[h]=new T(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){S[h]=new T(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){S[h]=new T(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){S[h]=new T(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){S[h]=new T(h,5,!1,h.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function P(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var p=h.replace(w,P);S[p]=new T(p,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var p=h.replace(w,P);S[p]=new T(p,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var p=h.replace(w,P);S[p]=new T(p,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){S[h]=new T(h,1,!1,h.toLowerCase(),null,!1,!1)}),S.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){S[h]=new T(h,1,!1,h.toLowerCase(),null,!0,!0)});function M(h,p,b,C){var N=S.hasOwnProperty(p)?S[p]:null;(N!==null?N.type!==0:C||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(x(p,b,N,C)&&(b=null),C||N===null?m(p)&&(b===null?h.removeAttribute(p):h.setAttribute(p,""+b)):N.mustUseProperty?h[N.propertyName]=b===null?N.type===3?!1:"":b:(p=N.attributeName,C=N.attributeNamespace,b===null?h.removeAttribute(p):(N=N.type,b=N===3||N===4&&b===!0?"":""+b,C?h.setAttributeNS(C,p,b):h.setAttribute(p,b))))}var I=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),D=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),J=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),q=Symbol.iterator;function ie(h){return h===null||typeof h!="object"?null:(h=q&&h[q]||h["@@iterator"],typeof h=="function"?h:null)}var X=Object.assign,Y;function ce(h){if(Y===void 0)try{throw Error()}catch(b){var p=b.stack.trim().match(/\n( *(at )?)/);Y=p&&p[1]||""}return`
`+Y+h}var Me=!1;function Re(h,p){if(!h||Me)return"";Me=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Ue){var C=Ue}Reflect.construct(h,[],p)}else{try{p.call()}catch(Ue){C=Ue}h.call(p.prototype)}else{try{throw Error()}catch(Ue){C=Ue}h()}}catch(Ue){if(Ue&&C&&typeof Ue.stack=="string"){for(var N=Ue.stack.split(`
`),B=C.stack.split(`
`),Z=N.length-1,ue=B.length-1;1<=Z&&0<=ue&&N[Z]!==B[ue];)ue--;for(;1<=Z&&0<=ue;Z--,ue--)if(N[Z]!==B[ue]){if(Z!==1||ue!==1)do if(Z--,ue--,0>ue||N[Z]!==B[ue]){var _e=`
`+N[Z].replace(" at new "," at ");return h.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",h.displayName)),_e}while(1<=Z&&0<=ue);break}}}finally{Me=!1,Error.prepareStackTrace=b}return(h=h?h.displayName||h.name:"")?ce(h):""}function Fe(h){switch(h.tag){case 5:return ce(h.type);case 16:return ce("Lazy");case 13:return ce("Suspense");case 19:return ce("SuspenseList");case 0:case 2:case 15:return h=Re(h.type,!1),h;case 11:return h=Re(h.type.render,!1),h;case 1:return h=Re(h.type,!0),h;default:return""}}function Be(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case H:return"Fragment";case D:return"Portal";case z:return"Profiler";case W:return"StrictMode";case ge:return"Suspense";case te:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case J:return(h.displayName||"Context")+".Consumer";case j:return(h._context.displayName||"Context")+".Provider";case le:var p=h.render;return h=h.displayName,h||(h=p.displayName||p.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case de:return p=h.displayName||null,p!==null?p:Be(h.type)||"Memo";case ve:p=h._payload,h=h._init;try{return Be(h(p))}catch{}}return null}function at(h){var p=h.type;switch(h.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=p.render,h=h.displayName||h.name||"",p.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Be(p);case 8:return p===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function pt(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function Ft(h){var p=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function yn(h){var p=Ft(h)?"checked":"value",b=Object.getOwnPropertyDescriptor(h.constructor.prototype,p),C=""+h[p];if(!h.hasOwnProperty(p)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var N=b.get,B=b.set;return Object.defineProperty(h,p,{configurable:!0,get:function(){return N.call(this)},set:function(Z){C=""+Z,B.call(this,Z)}}),Object.defineProperty(h,p,{enumerable:b.enumerable}),{getValue:function(){return C},setValue:function(Z){C=""+Z},stopTracking:function(){h._valueTracker=null,delete h[p]}}}}function Rt(h){h._valueTracker||(h._valueTracker=yn(h))}function he(h){if(!h)return!1;var p=h._valueTracker;if(!p)return!0;var b=p.getValue(),C="";return h&&(C=Ft(h)?h.checked?"true":"false":h.value),h=C,h!==b?(p.setValue(h),!0):!1}function nt(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function Ye(h,p){var b=p.checked;return X({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??h._wrapperState.initialChecked})}function lt(h,p){var b=p.defaultValue==null?"":p.defaultValue,C=p.checked!=null?p.checked:p.defaultChecked;b=pt(p.value!=null?p.value:b),h._wrapperState={initialChecked:C,initialValue:b,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function Ke(h,p){p=p.checked,p!=null&&M(h,"checked",p,!1)}function Ut(h,p){Ke(h,p);var b=pt(p.value),C=p.type;if(b!=null)C==="number"?(b===0&&h.value===""||h.value!=b)&&(h.value=""+b):h.value!==""+b&&(h.value=""+b);else if(C==="submit"||C==="reset"){h.removeAttribute("value");return}p.hasOwnProperty("value")?Ct(h,p.type,b):p.hasOwnProperty("defaultValue")&&Ct(h,p.type,pt(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(h.defaultChecked=!!p.defaultChecked)}function bt(h,p,b){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var C=p.type;if(!(C!=="submit"&&C!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+h._wrapperState.initialValue,b||p===h.value||(h.value=p),h.defaultValue=p}b=h.name,b!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,b!==""&&(h.name=b)}function Ct(h,p,b){(p!=="number"||nt(h.ownerDocument)!==h)&&(b==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+b&&(h.defaultValue=""+b))}var Zt=Array.isArray;function ln(h,p,b,C){if(h=h.options,p){p={};for(var N=0;N<b.length;N++)p["$"+b[N]]=!0;for(b=0;b<h.length;b++)N=p.hasOwnProperty("$"+h[b].value),h[b].selected!==N&&(h[b].selected=N),N&&C&&(h[b].defaultSelected=!0)}else{for(b=""+pt(b),p=null,N=0;N<h.length;N++){if(h[N].value===b){h[N].selected=!0,C&&(h[N].defaultSelected=!0);return}p!==null||h[N].disabled||(p=h[N])}p!==null&&(p.selected=!0)}}function Xn(h,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return X({},p,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function ae(h,p){var b=p.value;if(b==null){if(b=p.children,p=p.defaultValue,b!=null){if(p!=null)throw Error(t(92));if(Zt(b)){if(1<b.length)throw Error(t(93));b=b[0]}p=b}p==null&&(p=""),b=p}h._wrapperState={initialValue:pt(b)}}function Q(h,p){var b=pt(p.value),C=pt(p.defaultValue);b!=null&&(b=""+b,b!==h.value&&(h.value=b),p.defaultValue==null&&h.defaultValue!==b&&(h.defaultValue=b)),C!=null&&(h.defaultValue=""+C)}function Ne(h){var p=h.textContent;p===h._wrapperState.initialValue&&p!==""&&p!==null&&(h.value=p)}function ct(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function et(h,p){return h==null||h==="http://www.w3.org/1999/xhtml"?ct(p):h==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var ot,Bt=(function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,b,C,N){MSApp.execUnsafeLocalFunction(function(){return h(p,b,C,N)})}:h})(function(h,p){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=p;else{for(ot=ot||document.createElement("div"),ot.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=ot.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;p.firstChild;)h.appendChild(p.firstChild)}});function dt(h,p){if(p){var b=h.firstChild;if(b&&b===h.lastChild&&b.nodeType===3){b.nodeValue=p;return}}h.textContent=p}var vt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nn=["Webkit","ms","Moz","O"];Object.keys(vt).forEach(function(h){nn.forEach(function(p){p=p+h.charAt(0).toUpperCase()+h.substring(1),vt[p]=vt[h]})});function Mn(h,p,b){return p==null||typeof p=="boolean"||p===""?"":b||typeof p!="number"||p===0||vt.hasOwnProperty(h)&&vt[h]?(""+p).trim():p+"px"}function ht(h,p){h=h.style;for(var b in p)if(p.hasOwnProperty(b)){var C=b.indexOf("--")===0,N=Mn(b,p[b],C);b==="float"&&(b="cssFloat"),C?h.setProperty(b,N):h[b]=N}}var Ln=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pe(h,p){if(p){if(Ln[h]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,h));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function $e(h,p){if(h.indexOf("-")===-1)return typeof p.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var it=null;function tt(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var jt=null,ye=null,mt=null;function gt(h){if(h=Mo(h)){if(typeof jt!="function")throw Error(t(280));var p=h.stateNode;p&&(p=$h(p),jt(h.stateNode,h.type,p))}}function Ge(h){ye?mt?mt.push(h):mt=[h]:ye=h}function ut(){if(ye){var h=ye,p=mt;if(mt=ye=null,gt(h),p)for(h=0;h<p.length;h++)gt(p[h])}}function Vt(h,p){return h(p)}function vn(){}var jn=!1;function pi(h,p,b){if(jn)return h(p,b);jn=!0;try{return Vt(h,p,b)}finally{jn=!1,(ye!==null||mt!==null)&&(vn(),ut())}}function Cn(h,p){var b=h.stateNode;if(b===null)return null;var C=$h(b);if(C===null)return null;b=C[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(h=h.type,C=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!C;break e;default:h=!1}if(h)return null;if(b&&typeof b!="function")throw Error(t(231,p,typeof b));return b}var qi=!1;if(a)try{var Rr={};Object.defineProperty(Rr,"passive",{get:function(){qi=!0}}),window.addEventListener("test",Rr,Rr),window.removeEventListener("test",Rr,Rr)}catch{qi=!1}function du(h,p,b,C,N,B,Z,ue,_e){var Ue=Array.prototype.slice.call(arguments,3);try{p.apply(b,Ue)}catch(st){this.onError(st)}}var rr=!1,Lt=null,$s=!1,ga=null,pu={onError:function(h){rr=!0,Lt=h}};function mu(h,p,b,C,N,B,Z,ue,_e){rr=!1,Lt=null,du.apply(pu,arguments)}function gu(h,p,b,C,N,B,Z,ue,_e){if(mu.apply(this,arguments),rr){if(rr){var Ue=Lt;rr=!1,Lt=null}else throw Error(t(198));$s||($s=!0,ga=Ue)}}function Vo(h){var p=h,b=h;if(h.alternate)for(;p.return;)p=p.return;else{h=p;do p=h,(p.flags&4098)!==0&&(b=p.return),h=p.return;while(h)}return p.tag===3?b:null}function _a(h){if(h.tag===13){var p=h.memoizedState;if(p===null&&(h=h.alternate,h!==null&&(p=h.memoizedState)),p!==null)return p.dehydrated}return null}function ne(h){if(Vo(h)!==h)throw Error(t(188))}function Pe(h){var p=h.alternate;if(!p){if(p=Vo(h),p===null)throw Error(t(188));return p!==h?null:h}for(var b=h,C=p;;){var N=b.return;if(N===null)break;var B=N.alternate;if(B===null){if(C=N.return,C!==null){b=C;continue}break}if(N.child===B.child){for(B=N.child;B;){if(B===b)return ne(N),h;if(B===C)return ne(N),p;B=B.sibling}throw Error(t(188))}if(b.return!==C.return)b=N,C=B;else{for(var Z=!1,ue=N.child;ue;){if(ue===b){Z=!0,b=N,C=B;break}if(ue===C){Z=!0,C=N,b=B;break}ue=ue.sibling}if(!Z){for(ue=B.child;ue;){if(ue===b){Z=!0,b=B,C=N;break}if(ue===C){Z=!0,C=B,b=N;break}ue=ue.sibling}if(!Z)throw Error(t(189))}}if(b.alternate!==C)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?h:p}function ze(h){return h=Pe(h),h!==null?He(h):null}function He(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var p=He(h);if(p!==null)return p;h=h.sibling}return null}var je=e.unstable_scheduleCallback,Et=e.unstable_cancelCallback,Yt=e.unstable_shouldYield,Jt=e.unstable_requestPaint,Mt=e.unstable_now,fn=e.unstable_getCurrentPriorityLevel,rn=e.unstable_ImmediatePriority,un=e.unstable_UserBlockingPriority,ri=e.unstable_NormalPriority,Zi=e.unstable_LowPriority,Gn=e.unstable_IdlePriority,Mi=null,$t=null;function It(h){if($t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Mi,h,void 0,(h.current.flags&128)===128)}catch{}}var Qt=Math.clz32?Math.clz32:Xr,Wt=Math.log,ai=Math.LN2;function Xr(h){return h>>>=0,h===0?32:31-(Wt(h)/ai|0)|0}var Fi=64,bi=4194304;function Dt(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Fn(h,p){var b=h.pendingLanes;if(b===0)return 0;var C=0,N=h.suspendedLanes,B=h.pingedLanes,Z=b&268435455;if(Z!==0){var ue=Z&~N;ue!==0?C=Dt(ue):(B&=Z,B!==0&&(C=Dt(B)))}else Z=b&~N,Z!==0?C=Dt(Z):B!==0&&(C=Dt(B));if(C===0)return 0;if(p!==0&&p!==C&&(p&N)===0&&(N=C&-C,B=p&-p,N>=B||N===16&&(B&4194240)!==0))return p;if((C&4)!==0&&(C|=b&16),p=h.entangledLanes,p!==0)for(h=h.entanglements,p&=C;0<p;)b=31-Qt(p),N=1<<b,C|=h[b],p&=~N;return C}function Ga(h,p){switch(h){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ki(h,p){for(var b=h.suspendedLanes,C=h.pingedLanes,N=h.expirationTimes,B=h.pendingLanes;0<B;){var Z=31-Qt(B),ue=1<<Z,_e=N[Z];_e===-1?((ue&b)===0||(ue&C)!==0)&&(N[Z]=Ga(ue,p)):_e<=p&&(h.expiredLanes|=ue),B&=~ue}}function Ki(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function os(){var h=Fi;return Fi<<=1,(Fi&4194240)===0&&(Fi=64),h}function ya(h){for(var p=[],b=0;31>b;b++)p.push(h);return p}function vo(h,p,b){h.pendingLanes|=p,p!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,p=31-Qt(p),h[p]=b}function Ui(h,p){var b=h.pendingLanes&~p;h.pendingLanes=p,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=p,h.mutableReadLanes&=p,h.entangledLanes&=p,p=h.entanglements;var C=h.eventTimes;for(h=h.expirationTimes;0<b;){var N=31-Qt(b),B=1<<N;p[N]=0,C[N]=-1,h[N]=-1,b&=~B}}function Xs(h,p){var b=h.entangledLanes|=p;for(h=h.entanglements;b;){var C=31-Qt(b),N=1<<C;N&p|h[C]&p&&(h[C]|=p),b&=~N}}var In=0;function Ho(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var wl,Sl,Mh,_c,Tl,va=!1,yc=[],ws=null,xn=null,xo=null,El=new Map,cn=new Map,_r=[],si="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bi(h,p){switch(h){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":xn=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":El.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":cn.delete(p.pointerId)}}function xa(h,p,b,C,N,B){return h===null||h.nativeEvent!==B?(h={blockedOn:p,domEventName:b,eventSystemFlags:C,nativeEvent:B,targetContainers:[N]},p!==null&&(p=Mo(p),p!==null&&Sl(p)),h):(h.eventSystemFlags|=C,p=h.targetContainers,N!==null&&p.indexOf(N)===-1&&p.push(N),h)}function gd(h,p,b,C,N){switch(p){case"focusin":return ws=xa(ws,h,p,b,C,N),!0;case"dragenter":return xn=xa(xn,h,p,b,C,N),!0;case"mouseover":return xo=xa(xo,h,p,b,C,N),!0;case"pointerover":var B=N.pointerId;return El.set(B,xa(El.get(B)||null,h,p,b,C,N)),!0;case"gotpointercapture":return B=N.pointerId,cn.set(B,xa(cn.get(B)||null,h,p,b,C,N)),!0}return!1}function vc(h){var p=el(h.target);if(p!==null){var b=Vo(p);if(b!==null){if(p=b.tag,p===13){if(p=_a(b),p!==null){h.blockedOn=p,Tl(h.priority,function(){Mh(b)});return}}else if(p===3&&b.stateNode.current.memoizedState.isDehydrated){h.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}h.blockedOn=null}function Wo(h){if(h.blockedOn!==null)return!1;for(var p=h.targetContainers;0<p.length;){var b=Ts(h.domEventName,h.eventSystemFlags,p[0],h.nativeEvent);if(b===null){b=h.nativeEvent;var C=new b.constructor(b.type,b);it=C,b.target.dispatchEvent(C),it=null}else return p=Mo(b),p!==null&&Sl(p),h.blockedOn=b,!1;p.shift()}return!0}function Al(h,p,b){Wo(h)&&b.delete(p)}function as(){va=!1,ws!==null&&Wo(ws)&&(ws=null),xn!==null&&Wo(xn)&&(xn=null),xo!==null&&Wo(xo)&&(xo=null),El.forEach(Al),cn.forEach(Al)}function Oi(h,p){h.blockedOn===p&&(h.blockedOn=null,va||(va=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,as)))}function bo(h){function p(N){return Oi(N,h)}if(0<yc.length){Oi(yc[0],h);for(var b=1;b<yc.length;b++){var C=yc[b];C.blockedOn===h&&(C.blockedOn=null)}}for(ws!==null&&Oi(ws,h),xn!==null&&Oi(xn,h),xo!==null&&Oi(xo,h),El.forEach(p),cn.forEach(p),b=0;b<_r.length;b++)C=_r[b],C.blockedOn===h&&(C.blockedOn=null);for(;0<_r.length&&(b=_r[0],b.blockedOn===null);)vc(b),b.blockedOn===null&&_r.shift()}var Ir=I.ReactCurrentBatchConfig,Ss=!0;function Ch(h,p,b,C){var N=In,B=Ir.transition;Ir.transition=null;try{In=1,xc(h,p,b,C)}finally{In=N,Ir.transition=B}}function Ph(h,p,b,C){var N=In,B=Ir.transition;Ir.transition=null;try{In=4,xc(h,p,b,C)}finally{In=N,Ir.transition=B}}function xc(h,p,b,C){if(Ss){var N=Ts(h,p,b,C);if(N===null)f(h,p,C,Rh,b),Bi(h,C);else if(gd(N,h,p,b,C))C.stopPropagation();else if(Bi(h,C),p&4&&-1<si.indexOf(h)){for(;N!==null;){var B=Mo(N);if(B!==null&&wl(B),B=Ts(h,p,b,C),B===null&&f(h,p,C,Rh,b),B===N)break;N=B}N!==null&&C.stopPropagation()}else f(h,p,C,null,b)}}var Rh=null;function Ts(h,p,b,C){if(Rh=null,h=tt(C),h=el(h),h!==null)if(p=Vo(h),p===null)h=null;else if(b=p.tag,b===13){if(h=_a(p),h!==null)return h;h=null}else if(b===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;h=null}else p!==h&&(h=null);return Rh=h,null}function Nn(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fn()){case rn:return 1;case un:return 4;case ri:case Zi:return 16;case Gn:return 536870912;default:return 16}default:return 16}}var wo=null,Es=null,sr=null;function bc(){if(sr)return sr;var h,p=Es,b=p.length,C,N="value"in wo?wo.value:wo.textContent,B=N.length;for(h=0;h<b&&p[h]===N[h];h++);var Z=b-h;for(C=1;C<=Z&&p[b-C]===N[B-C];C++);return sr=N.slice(h,1<C?1-C:void 0)}function Ml(h){var p=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&p===13&&(h=13)):h=p,h===10&&(h=13),32<=h||h===13?h:0}function So(){return!0}function Ih(){return!1}function kr(h){function p(b,C,N,B,Z){this._reactName=b,this._targetInst=N,this.type=C,this.nativeEvent=B,this.target=Z,this.currentTarget=null;for(var ue in h)h.hasOwnProperty(ue)&&(b=h[ue],this[ue]=b?b(B):B[ue]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?So:Ih,this.isPropagationStopped=Ih,this}return X(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=So)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=So)},persist:function(){},isPersistent:So}),p}var Cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_u=kr(Cl),ba=X({},Cl,{view:0,detail:0}),wc=kr(ba),wi,Gs,As,Ms=X({},ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ys,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==As&&(As&&h.type==="mousemove"?(wi=h.screenX-As.screenX,Gs=h.screenY-As.screenY):Gs=wi=0,As=h),wi)},movementY:function(h){return"movementY"in h?h.movementY:Gs}}),kh=kr(Ms),jo=X({},Ms,{dataTransfer:0}),$o=kr(jo),Oh=X({},ba,{relatedTarget:0}),yu=kr(Oh),vu=X({},Cl,{animationName:0,elapsedTime:0,pseudoElement:0}),pm=kr(vu),mm=X({},Cl,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),xu=kr(mm),Lh=X({},Cl,{data:0}),Nh=kr(Lh),_d={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sc(h){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(h):(h=wa[h])?!!p[h]:!1}function Ys(){return Sc}var Gr=X({},ba,{key:function(h){if(h.key){var p=_d[h.key]||h.key;if(p!=="Unidentified")return p}return h.type==="keypress"?(h=Ml(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?bu[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ys,charCode:function(h){return h.type==="keypress"?Ml(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?Ml(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),wu=kr(Gr),Cs=X({},Ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ps=kr(Cs),Sa=X({},ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ys}),To=kr(Sa),Ta=X({},Cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pl=kr(Ta),yd=X({},Ms,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),vd=kr(yd),Rs=[9,13,27,32],zi=a&&"CompositionEvent"in window,yr=null;a&&"documentMode"in document&&(yr=document.documentMode);var zn=a&&"TextEvent"in window&&!yr,Tc=a&&(!zi||yr&&8<yr&&11>=yr),vr=" ",xd=!1;function Rl(h,p){switch(h){case"keyup":return Rs.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Su(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var Eo=!1;function gm(h,p){switch(h){case"compositionend":return Su(p);case"keypress":return p.which!==32?null:(xd=!0,vr);case"textInput":return h=p.data,h===vr&&xd?null:h;default:return null}}function qs(h,p){if(Eo)return h==="compositionend"||!zi&&Rl(h,p)?(h=bc(),sr=Es=wo=null,Eo=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return Tc&&p.locale!=="ko"?null:p.data;default:return null}}var Ea={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dh(h){var p=h&&h.nodeName&&h.nodeName.toLowerCase();return p==="input"?!!Ea[h.type]:p==="textarea"}function Ya(h,p,b,C){Ge(C),p=E(p,"onChange"),0<p.length&&(b=new _u("onChange","change",null,b,C),h.push({event:b,listeners:p}))}var qa=null,ls=null;function _m(h){Nl(h,0)}function cs(h){var p=Ci(h);if(he(p))return h}function ym(h,p){if(h==="change")return p}var us=!1;if(a){var xr;if(a){var Za="oninput"in document;if(!Za){var Aa=document.createElement("div");Aa.setAttribute("oninput","return;"),Za=typeof Aa.oninput=="function"}xr=Za}else xr=!1;us=xr&&(!document.documentMode||9<document.documentMode)}function hs(){qa&&(qa.detachEvent("onpropertychange",Ec),ls=qa=null)}function Ec(h){if(h.propertyName==="value"&&cs(ls)){var p=[];Ya(p,ls,h,tt(h)),pi(_m,p)}}function Ma(h,p,b){h==="focusin"?(hs(),qa=p,ls=b,qa.attachEvent("onpropertychange",Ec)):h==="focusout"&&hs()}function Il(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return cs(ls)}function Ac(h,p){if(h==="click")return cs(p)}function li(h,p){if(h==="input"||h==="change")return cs(p)}function Tu(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var Is=typeof Object.is=="function"?Object.is:Tu;function Xo(h,p){if(Is(h,p))return!0;if(typeof h!="object"||h===null||typeof p!="object"||p===null)return!1;var b=Object.keys(h),C=Object.keys(p);if(b.length!==C.length)return!1;for(C=0;C<b.length;C++){var N=b[C];if(!l.call(p,N)||!Is(h[N],p[N]))return!1}return!0}function Eu(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function fs(h,p){var b=Eu(h);h=0;for(var C;b;){if(b.nodeType===3){if(C=h+b.textContent.length,h<=p&&C>=p)return{node:b,offset:p-h};h=C}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Eu(b)}}function kl(h,p){return h&&p?h===p?!0:h&&h.nodeType===3?!1:p&&p.nodeType===3?kl(h,p.parentNode):"contains"in h?h.contains(p):h.compareDocumentPosition?!!(h.compareDocumentPosition(p)&16):!1:!1}function mi(){for(var h=window,p=nt();p instanceof h.HTMLIFrameElement;){try{var b=typeof p.contentWindow.location.href=="string"}catch{b=!1}if(b)h=p.contentWindow;else break;p=nt(h.document)}return p}function or(h){var p=h&&h.nodeName&&h.nodeName.toLowerCase();return p&&(p==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||p==="textarea"||h.contentEditable==="true")}function ei(h){var p=mi(),b=h.focusedElem,C=h.selectionRange;if(p!==b&&b&&b.ownerDocument&&kl(b.ownerDocument.documentElement,b)){if(C!==null&&or(b)){if(p=C.start,h=C.end,h===void 0&&(h=p),"selectionStart"in b)b.selectionStart=p,b.selectionEnd=Math.min(h,b.value.length);else if(h=(p=b.ownerDocument||document)&&p.defaultView||window,h.getSelection){h=h.getSelection();var N=b.textContent.length,B=Math.min(C.start,N);C=C.end===void 0?B:Math.min(C.end,N),!h.extend&&B>C&&(N=C,C=B,B=N),N=fs(b,B);var Z=fs(b,C);N&&Z&&(h.rangeCount!==1||h.anchorNode!==N.node||h.anchorOffset!==N.offset||h.focusNode!==Z.node||h.focusOffset!==Z.offset)&&(p=p.createRange(),p.setStart(N.node,N.offset),h.removeAllRanges(),B>C?(h.addRange(p),h.extend(Z.node,Z.offset)):(p.setEnd(Z.node,Z.offset),h.addRange(p)))}}for(p=[],h=b;h=h.parentNode;)h.nodeType===1&&p.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<p.length;b++)h=p[b],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var Ol=a&&"documentMode"in document&&11>=document.documentMode,Go=null,Yo=null,Au=null,Ji=!1;function Fh(h,p,b){var C=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Ji||Go==null||Go!==nt(C)||(C=Go,"selectionStart"in C&&or(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),Au&&Xo(Au,C)||(Au=C,C=E(Yo,"onSelect"),0<C.length&&(p=new _u("onSelect","select",null,p,b),h.push({event:p,listeners:C}),p.target=Go)))}function qo(h,p){var b={};return b[h.toLowerCase()]=p.toLowerCase(),b["Webkit"+h]="webkit"+p,b["Moz"+h]="moz"+p,b}var Ka={animationend:qo("Animation","AnimationEnd"),animationiteration:qo("Animation","AnimationIteration"),animationstart:qo("Animation","AnimationStart"),transitionend:qo("Transition","TransitionEnd")},Or={},Zs={};a&&(Zs=document.createElement("div").style,"AnimationEvent"in window||(delete Ka.animationend.animation,delete Ka.animationiteration.animation,delete Ka.animationstart.animation),"TransitionEvent"in window||delete Ka.transitionend.transition);function Ao(h){if(Or[h])return Or[h];if(!Ka[h])return h;var p=Ka[h],b;for(b in p)if(p.hasOwnProperty(b)&&b in Zs)return Or[h]=p[b];return h}var Mu=Ao("animationend"),ks=Ao("animationiteration"),Uh=Ao("animationstart"),Bh=Ao("transitionend"),Ll=new Map,bd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ks(h,p){Ll.set(h,p),s(p,[h])}for(var Ja=0;Ja<bd.length;Ja++){var Mc=bd[Ja],Cc=Mc.toLowerCase(),vm=Mc[0].toUpperCase()+Mc.slice(1);Ks(Cc,"on"+vm)}Ks(Mu,"onAnimationEnd"),Ks(ks,"onAnimationIteration"),Ks(Uh,"onAnimationStart"),Ks("dblclick","onDoubleClick"),Ks("focusin","onFocus"),Ks("focusout","onBlur"),Ks(Bh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ca="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cu=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ca));function Pu(h,p,b){var C=h.type||"unknown-event";h.currentTarget=b,gu(C,p,void 0,h),h.currentTarget=null}function Nl(h,p){p=(p&4)!==0;for(var b=0;b<h.length;b++){var C=h[b],N=C.event;C=C.listeners;e:{var B=void 0;if(p)for(var Z=C.length-1;0<=Z;Z--){var ue=C[Z],_e=ue.instance,Ue=ue.currentTarget;if(ue=ue.listener,_e!==B&&N.isPropagationStopped())break e;Pu(N,ue,Ue),B=_e}else for(Z=0;Z<C.length;Z++){if(ue=C[Z],_e=ue.instance,Ue=ue.currentTarget,ue=ue.listener,_e!==B&&N.isPropagationStopped())break e;Pu(N,ue,Ue),B=_e}}}if($s)throw h=ga,$s=!1,ga=null,h}function ti(h,p){var b=p[Zo];b===void 0&&(b=p[Zo]=new Set);var C=h+"__bubble";b.has(C)||(Vh(p,h,2,!1),b.add(C))}function zh(h,p,b){var C=0;p&&(C|=4),Vh(b,h,C,p)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function Dl(h){if(!h[Pc]){h[Pc]=!0,i.forEach(function(b){b!=="selectionchange"&&(Cu.has(b)||zh(b,!1,h),zh(b,!0,h))});var p=h.nodeType===9?h:h.ownerDocument;p===null||p[Pc]||(p[Pc]=!0,zh("selectionchange",!1,p))}}function Vh(h,p,b,C){switch(Nn(p)){case 1:var N=Ch;break;case 4:N=Ph;break;default:N=xc}b=N.bind(null,p,b,h),N=void 0,!qi||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(N=!0),C?N!==void 0?h.addEventListener(p,b,{capture:!0,passive:N}):h.addEventListener(p,b,!0):N!==void 0?h.addEventListener(p,b,{passive:N}):h.addEventListener(p,b,!1)}function f(h,p,b,C,N){var B=C;if((p&1)===0&&(p&2)===0&&C!==null)e:for(;;){if(C===null)return;var Z=C.tag;if(Z===3||Z===4){var ue=C.stateNode.containerInfo;if(ue===N||ue.nodeType===8&&ue.parentNode===N)break;if(Z===4)for(Z=C.return;Z!==null;){var _e=Z.tag;if((_e===3||_e===4)&&(_e=Z.stateNode.containerInfo,_e===N||_e.nodeType===8&&_e.parentNode===N))return;Z=Z.return}for(;ue!==null;){if(Z=el(ue),Z===null)return;if(_e=Z.tag,_e===5||_e===6){C=B=Z;continue e}ue=ue.parentNode}}C=C.return}pi(function(){var Ue=B,st=tt(b),ft=[];e:{var rt=Ll.get(h);if(rt!==void 0){var kt=_u,Ht=h;switch(h){case"keypress":if(Ml(b)===0)break e;case"keydown":case"keyup":kt=wu;break;case"focusin":Ht="focus",kt=yu;break;case"focusout":Ht="blur",kt=yu;break;case"beforeblur":case"afterblur":kt=yu;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":kt=kh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":kt=$o;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":kt=To;break;case Mu:case ks:case Uh:kt=pm;break;case Bh:kt=Pl;break;case"scroll":kt=wc;break;case"wheel":kt=vd;break;case"copy":case"cut":case"paste":kt=xu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":kt=Ps}var Gt=(p&4)!==0,Sr=!Gt&&h==="scroll",ke=Gt?rt!==null?rt+"Capture":null:rt;Gt=[];for(var xe=Ue,Oe;xe!==null;){Oe=xe;var yt=Oe.stateNode;if(Oe.tag===5&&yt!==null&&(Oe=yt,ke!==null&&(yt=Cn(xe,ke),yt!=null&&Gt.push(v(xe,yt,Oe)))),Sr)break;xe=xe.return}0<Gt.length&&(rt=new kt(rt,Ht,null,b,st),ft.push({event:rt,listeners:Gt}))}}if((p&7)===0){e:{if(rt=h==="mouseover"||h==="pointerover",kt=h==="mouseout"||h==="pointerout",rt&&b!==it&&(Ht=b.relatedTarget||b.fromElement)&&(el(Ht)||Ht[Vn]))break e;if((kt||rt)&&(rt=st.window===st?st:(rt=st.ownerDocument)?rt.defaultView||rt.parentWindow:window,kt?(Ht=b.relatedTarget||b.toElement,kt=Ue,Ht=Ht?el(Ht):null,Ht!==null&&(Sr=Vo(Ht),Ht!==Sr||Ht.tag!==5&&Ht.tag!==6)&&(Ht=null)):(kt=null,Ht=Ue),kt!==Ht)){if(Gt=kh,yt="onMouseLeave",ke="onMouseEnter",xe="mouse",(h==="pointerout"||h==="pointerover")&&(Gt=Ps,yt="onPointerLeave",ke="onPointerEnter",xe="pointer"),Sr=kt==null?rt:Ci(kt),Oe=Ht==null?rt:Ci(Ht),rt=new Gt(yt,xe+"leave",kt,b,st),rt.target=Sr,rt.relatedTarget=Oe,yt=null,el(st)===Ue&&(Gt=new Gt(ke,xe+"enter",Ht,b,st),Gt.target=Oe,Gt.relatedTarget=Sr,yt=Gt),Sr=yt,kt&&Ht)t:{for(Gt=kt,ke=Ht,xe=0,Oe=Gt;Oe;Oe=O(Oe))xe++;for(Oe=0,yt=ke;yt;yt=O(yt))Oe++;for(;0<xe-Oe;)Gt=O(Gt),xe--;for(;0<Oe-xe;)ke=O(ke),Oe--;for(;xe--;){if(Gt===ke||ke!==null&&Gt===ke.alternate)break t;Gt=O(Gt),ke=O(ke)}Gt=null}else Gt=null;kt!==null&&V(ft,rt,kt,Gt,!1),Ht!==null&&Sr!==null&&V(ft,Sr,Ht,Gt,!0)}}e:{if(rt=Ue?Ci(Ue):window,kt=rt.nodeName&&rt.nodeName.toLowerCase(),kt==="select"||kt==="input"&&rt.type==="file")var Kt=ym;else if(Dh(rt))if(us)Kt=li;else{Kt=Il;var sn=Ma}else(kt=rt.nodeName)&&kt.toLowerCase()==="input"&&(rt.type==="checkbox"||rt.type==="radio")&&(Kt=Ac);if(Kt&&(Kt=Kt(h,Ue))){Ya(ft,Kt,b,st);break e}sn&&sn(h,rt,Ue),h==="focusout"&&(sn=rt._wrapperState)&&sn.controlled&&rt.type==="number"&&Ct(rt,"number",rt.value)}switch(sn=Ue?Ci(Ue):window,h){case"focusin":(Dh(sn)||sn.contentEditable==="true")&&(Go=sn,Yo=Ue,Au=null);break;case"focusout":Au=Yo=Go=null;break;case"mousedown":Ji=!0;break;case"contextmenu":case"mouseup":case"dragend":Ji=!1,Fh(ft,b,st);break;case"selectionchange":if(Ol)break;case"keydown":case"keyup":Fh(ft,b,st)}var on;if(zi)e:{switch(h){case"compositionstart":var gn="onCompositionStart";break e;case"compositionend":gn="onCompositionEnd";break e;case"compositionupdate":gn="onCompositionUpdate";break e}gn=void 0}else Eo?Rl(h,b)&&(gn="onCompositionEnd"):h==="keydown"&&b.keyCode===229&&(gn="onCompositionStart");gn&&(Tc&&b.locale!=="ko"&&(Eo||gn!=="onCompositionStart"?gn==="onCompositionEnd"&&Eo&&(on=bc()):(wo=st,Es="value"in wo?wo.value:wo.textContent,Eo=!0)),sn=E(Ue,gn),0<sn.length&&(gn=new Nh(gn,h,null,b,st),ft.push({event:gn,listeners:sn}),on?gn.data=on:(on=Su(b),on!==null&&(gn.data=on)))),(on=zn?gm(h,b):qs(h,b))&&(Ue=E(Ue,"onBeforeInput"),0<Ue.length&&(st=new Nh("onBeforeInput","beforeinput",null,b,st),ft.push({event:st,listeners:Ue}),st.data=on))}Nl(ft,p)})}function v(h,p,b){return{instance:h,listener:p,currentTarget:b}}function E(h,p){for(var b=p+"Capture",C=[];h!==null;){var N=h,B=N.stateNode;N.tag===5&&B!==null&&(N=B,B=Cn(h,b),B!=null&&C.unshift(v(h,B,N)),B=Cn(h,p),B!=null&&C.push(v(h,B,N))),h=h.return}return C}function O(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function V(h,p,b,C,N){for(var B=p._reactName,Z=[];b!==null&&b!==C;){var ue=b,_e=ue.alternate,Ue=ue.stateNode;if(_e!==null&&_e===C)break;ue.tag===5&&Ue!==null&&(ue=Ue,N?(_e=Cn(b,B),_e!=null&&Z.unshift(v(b,_e,ue))):N||(_e=Cn(b,B),_e!=null&&Z.push(v(b,_e,ue)))),b=b.return}Z.length!==0&&h.push({event:p,listeners:Z})}var K=/\r\n?/g,fe=/\u0000|\uFFFD/g;function Ce(h){return(typeof h=="string"?h:""+h).replace(K,`
`).replace(fe,"")}function De(h,p,b){if(p=Ce(p),Ce(h)!==p&&b)throw Error(t(425))}function Je(){}var wt=null,en=null;function bn(h,p){return h==="textarea"||h==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var br=typeof setTimeout=="function"?setTimeout:void 0,Vi=typeof clearTimeout=="function"?clearTimeout:void 0,Yr=typeof Promise=="function"?Promise:void 0,ds=typeof queueMicrotask=="function"?queueMicrotask:typeof Yr<"u"?function(h){return Yr.resolve(null).then(h).catch(Fl)}:br;function Fl(h){setTimeout(function(){throw h})}function Hh(h,p){var b=p,C=0;do{var N=b.nextSibling;if(h.removeChild(b),N&&N.nodeType===8)if(b=N.data,b==="/$"){if(C===0){h.removeChild(N),bo(p);return}C--}else b!=="$"&&b!=="$?"&&b!=="$!"||C++;b=N}while(b);bo(p)}function Pa(h){for(;h!=null;h=h.nextSibling){var p=h.nodeType;if(p===1||p===3)break;if(p===8){if(p=h.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return h}function wd(h){h=h.previousSibling;for(var p=0;h;){if(h.nodeType===8){var b=h.data;if(b==="$"||b==="$!"||b==="$?"){if(p===0)return h;p--}else b==="/$"&&p++}h=h.previousSibling}return null}var Qa=Math.random().toString(36).slice(2),Qi="__reactFiber$"+Qa,Ul="__reactProps$"+Qa,Vn="__reactContainer$"+Qa,Zo="__reactEvents$"+Qa,Wh="__reactListeners$"+Qa,jh="__reactHandles$"+Qa;function el(h){var p=h[Qi];if(p)return p;for(var b=h.parentNode;b;){if(p=b[Vn]||b[Qi]){if(b=p.alternate,p.child!==null||b!==null&&b.child!==null)for(h=wd(h);h!==null;){if(b=h[Qi])return b;h=wd(h)}return p}h=b,b=h.parentNode}return null}function Mo(h){return h=h[Qi]||h[Vn],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function Ci(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(t(33))}function $h(h){return h[Ul]||null}var U_=[],Lr=-1;function Hi(h){return{current:h}}function gi(h){0>Lr||(h.current=U_[Lr],U_[Lr]=null,Lr--)}function ci(h,p){Lr++,U_[Lr]=h.current,h.current=p}var Bl={},qr=Hi(Bl),Os=Hi(!1),zl=Bl;function Ru(h,p){var b=h.type.contextTypes;if(!b)return Bl;var C=h.stateNode;if(C&&C.__reactInternalMemoizedUnmaskedChildContext===p)return C.__reactInternalMemoizedMaskedChildContext;var N={},B;for(B in b)N[B]=p[B];return C&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=p,h.__reactInternalMemoizedMaskedChildContext=N),N}function ps(h){return h=h.childContextTypes,h!=null}function Sd(){gi(Os),gi(qr)}function B_(h,p,b){if(qr.current!==Bl)throw Error(t(168));ci(qr,p),ci(Os,b)}function Td(h,p,b){var C=h.stateNode;if(p=p.childContextTypes,typeof C.getChildContext!="function")return b;C=C.getChildContext();for(var N in C)if(!(N in p))throw Error(t(108,at(h)||"Unknown",N));return X({},b,C)}function Iu(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||Bl,zl=qr.current,ci(qr,h),ci(Os,Os.current),!0}function z_(h,p,b){var C=h.stateNode;if(!C)throw Error(t(169));b?(h=Td(h,p,zl),C.__reactInternalMemoizedMergedChildContext=h,gi(Os),gi(qr),ci(qr,h)):gi(Os),ci(Os,b)}var Ra=null,Ed=!1,xm=!1;function Ad(h){Ra===null?Ra=[h]:Ra.push(h)}function X0(h){Ed=!0,Ad(h)}function tl(){if(!xm&&Ra!==null){xm=!0;var h=0,p=In;try{var b=Ra;for(In=1;h<b.length;h++){var C=b[h];do C=C(!0);while(C!==null)}Ra=null,Ed=!1}catch(N){throw Ra!==null&&(Ra=Ra.slice(h+1)),je(rn,tl),N}finally{In=p,xm=!1}}return null}var ku=[],Js=0,bm=null,wm=0,Ls=[],Nr=0,Ou=null,xt=1,Ko="";function Vl(h,p){ku[Js++]=wm,ku[Js++]=bm,bm=h,wm=p}function V_(h,p,b){Ls[Nr++]=xt,Ls[Nr++]=Ko,Ls[Nr++]=Ou,Ou=h;var C=xt;h=Ko;var N=32-Qt(C)-1;C&=~(1<<N),b+=1;var B=32-Qt(p)+N;if(30<B){var Z=N-N%5;B=(C&(1<<Z)-1).toString(32),C>>=Z,N-=Z,xt=1<<32-Qt(p)+N|b<<N|C,Ko=B+h}else xt=1<<B|b<<N|C,Ko=h}function H_(h){h.return!==null&&(Vl(h,1),V_(h,1,0))}function Hl(h){for(;h===bm;)bm=ku[--Js],ku[Js]=null,wm=ku[--Js],ku[Js]=null;for(;h===Ou;)Ou=Ls[--Nr],Ls[Nr]=null,Ko=Ls[--Nr],Ls[Nr]=null,xt=Ls[--Nr],Ls[Nr]=null}var Zr=null,Ns=null,Si=!1,Jo=null;function W_(h,p){var b=al(5,null,null,0);b.elementType="DELETED",b.stateNode=p,b.return=h,p=h.deletions,p===null?(h.deletions=[b],h.flags|=16):p.push(b)}function j_(h,p){switch(h.tag){case 5:var b=h.type;return p=p.nodeType!==1||b.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(h.stateNode=p,Zr=h,Ns=Pa(p.firstChild),!0):!1;case 6:return p=h.pendingProps===""||p.nodeType!==3?null:p,p!==null?(h.stateNode=p,Zr=h,Ns=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(b=Ou!==null?{id:xt,overflow:Ko}:null,h.memoizedState={dehydrated:p,treeContext:b,retryLane:1073741824},b=al(18,null,null,0),b.stateNode=p,b.return=h,h.child=b,Zr=h,Ns=null,!0):!1;default:return!1}}function Sm(h){return(h.mode&1)!==0&&(h.flags&128)===0}function Tm(h){if(Si){var p=Ns;if(p){var b=p;if(!j_(h,p)){if(Sm(h))throw Error(t(418));p=Pa(b.nextSibling);var C=Zr;p&&j_(h,p)?W_(C,b):(h.flags=h.flags&-4097|2,Si=!1,Zr=h)}}else{if(Sm(h))throw Error(t(418));h.flags=h.flags&-4097|2,Si=!1,Zr=h}}}function Em(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Zr=h}function Xh(h){if(h!==Zr)return!1;if(!Si)return Em(h),Si=!0,!1;var p;if((p=h.tag!==3)&&!(p=h.tag!==5)&&(p=h.type,p=p!=="head"&&p!=="body"&&!bn(h.type,h.memoizedProps)),p&&(p=Ns)){if(Sm(h))throw $_(),Error(t(418));for(;p;)W_(h,p),p=Pa(p.nextSibling)}if(Em(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(t(317));e:{for(h=h.nextSibling,p=0;h;){if(h.nodeType===8){var b=h.data;if(b==="/$"){if(p===0){Ns=Pa(h.nextSibling);break e}p--}else b!=="$"&&b!=="$!"&&b!=="$?"||p++}h=h.nextSibling}Ns=null}}else Ns=Zr?Pa(h.stateNode.nextSibling):null;return!0}function $_(){for(var h=Ns;h;)h=Pa(h.nextSibling)}function Rc(){Ns=Zr=null,Si=!1}function Gh(h){Jo===null?Jo=[h]:Jo.push(h)}var ZT=I.ReactCurrentBatchConfig;function Ia(h,p){if(h&&h.defaultProps){p=X({},p),h=h.defaultProps;for(var b in h)p[b]===void 0&&(p[b]=h[b]);return p}return p}var Md=Hi(null),Cd=null,Lu=null,Am=null;function Yh(){Am=Lu=Cd=null}function qh(h){var p=Md.current;gi(Md),h._currentValue=p}function Zh(h,p,b){for(;h!==null;){var C=h.alternate;if((h.childLanes&p)!==p?(h.childLanes|=p,C!==null&&(C.childLanes|=p)):C!==null&&(C.childLanes&p)!==p&&(C.childLanes|=p),h===b)break;h=h.return}}function Wl(h,p){Cd=h,Am=Lu=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&p)!==0&&(Pt=!0),h.firstContext=null)}function Ds(h){var p=h._currentValue;if(Am!==h)if(h={context:h,memoizedValue:p,next:null},Lu===null){if(Cd===null)throw Error(t(308));Lu=h,Cd.dependencies={lanes:0,firstContext:h}}else Lu=Lu.next=h;return p}var ka=null;function Pd(h){ka===null?ka=[h]:ka.push(h)}function Mm(h,p,b,C){var N=p.interleaved;return N===null?(b.next=b,Pd(p)):(b.next=N.next,N.next=b),p.interleaved=b,Oa(h,C)}function Oa(h,p){h.lanes|=p;var b=h.alternate;for(b!==null&&(b.lanes|=p),b=h,h=h.return;h!==null;)h.childLanes|=p,b=h.alternate,b!==null&&(b.childLanes|=p),b=h,h=h.return;return b.tag===3?b.stateNode:null}var jl=!1;function Rd(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G0(h,p){h=h.updateQueue,p.updateQueue===h&&(p.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Qo(h,p){return{eventTime:h,lane:p,tag:0,payload:null,callback:null,next:null}}function nl(h,p,b){var C=h.updateQueue;if(C===null)return null;if(C=C.shared,(Yn&2)!==0){var N=C.pending;return N===null?p.next=p:(p.next=N.next,N.next=p),C.pending=p,Oa(h,b)}return N=C.interleaved,N===null?(p.next=p,Pd(C)):(p.next=N.next,N.next=p),C.interleaved=p,Oa(h,b)}function Pi(h,p,b){if(p=p.updateQueue,p!==null&&(p=p.shared,(b&4194240)!==0)){var C=p.lanes;C&=h.pendingLanes,b|=C,p.lanes=b,Xs(h,b)}}function En(h,p){var b=h.updateQueue,C=h.alternate;if(C!==null&&(C=C.updateQueue,b===C)){var N=null,B=null;if(b=b.firstBaseUpdate,b!==null){do{var Z={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};B===null?N=B=Z:B=B.next=Z,b=b.next}while(b!==null);B===null?N=B=p:B=B.next=p}else N=B=p;b={baseState:C.baseState,firstBaseUpdate:N,lastBaseUpdate:B,shared:C.shared,effects:C.effects},h.updateQueue=b;return}h=b.lastBaseUpdate,h===null?b.firstBaseUpdate=p:h.next=p,b.lastBaseUpdate=p}function Li(h,p,b,C){var N=h.updateQueue;jl=!1;var B=N.firstBaseUpdate,Z=N.lastBaseUpdate,ue=N.shared.pending;if(ue!==null){N.shared.pending=null;var _e=ue,Ue=_e.next;_e.next=null,Z===null?B=Ue:Z.next=Ue,Z=_e;var st=h.alternate;st!==null&&(st=st.updateQueue,ue=st.lastBaseUpdate,ue!==Z&&(ue===null?st.firstBaseUpdate=Ue:ue.next=Ue,st.lastBaseUpdate=_e))}if(B!==null){var ft=N.baseState;Z=0,st=Ue=_e=null,ue=B;do{var rt=ue.lane,kt=ue.eventTime;if((C&rt)===rt){st!==null&&(st=st.next={eventTime:kt,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Ht=h,Gt=ue;switch(rt=p,kt=b,Gt.tag){case 1:if(Ht=Gt.payload,typeof Ht=="function"){ft=Ht.call(kt,ft,rt);break e}ft=Ht;break e;case 3:Ht.flags=Ht.flags&-65537|128;case 0:if(Ht=Gt.payload,rt=typeof Ht=="function"?Ht.call(kt,ft,rt):Ht,rt==null)break e;ft=X({},ft,rt);break e;case 2:jl=!0}}ue.callback!==null&&ue.lane!==0&&(h.flags|=64,rt=N.effects,rt===null?N.effects=[ue]:rt.push(ue))}else kt={eventTime:kt,lane:rt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},st===null?(Ue=st=kt,_e=ft):st=st.next=kt,Z|=rt;if(ue=ue.next,ue===null){if(ue=N.shared.pending,ue===null)break;rt=ue,ue=rt.next,rt.next=null,N.lastBaseUpdate=rt,N.shared.pending=null}}while(!0);if(st===null&&(_e=ft),N.baseState=_e,N.firstBaseUpdate=Ue,N.lastBaseUpdate=st,p=N.shared.interleaved,p!==null){N=p;do Z|=N.lane,N=N.next;while(N!==p)}else B===null&&(N.shared.lanes=0);Fd|=Z,h.lanes=Z,h.memoizedState=ft}}function er(h,p,b){if(h=p.effects,p.effects=null,h!==null)for(p=0;p<h.length;p++){var C=h[p],N=C.callback;if(N!==null){if(C.callback=null,C=b,typeof N!="function")throw Error(t(191,N));N.call(C)}}}var Dr=new n.Component().refs;function Fs(h,p,b,C){p=h.memoizedState,b=b(C,p),b=b==null?p:X({},p,b),h.memoizedState=b,h.lanes===0&&(h.updateQueue.baseState=b)}var $l={isMounted:function(h){return(h=h._reactInternals)?Vo(h)===h:!1},enqueueSetState:function(h,p,b){h=h._reactInternals;var C=Io(),N=lf(h),B=Qo(C,N);B.payload=p,b!=null&&(B.callback=b),p=nl(h,B,N),p!==null&&(ql(p,h,N,C),Pi(p,h,N))},enqueueReplaceState:function(h,p,b){h=h._reactInternals;var C=Io(),N=lf(h),B=Qo(C,N);B.tag=1,B.payload=p,b!=null&&(B.callback=b),p=nl(h,B,N),p!==null&&(ql(p,h,N,C),Pi(p,h,N))},enqueueForceUpdate:function(h,p){h=h._reactInternals;var b=Io(),C=lf(h),N=Qo(b,C);N.tag=2,p!=null&&(N.callback=p),p=nl(h,N,C),p!==null&&(ql(p,h,C,b),Pi(p,h,C))}};function ar(h,p,b,C,N,B,Z){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(C,B,Z):p.prototype&&p.prototype.isPureReactComponent?!Xo(b,C)||!Xo(N,B):!0}function Kh(h,p,b){var C=!1,N=Bl,B=p.contextType;return typeof B=="object"&&B!==null?B=Ds(B):(N=ps(p)?zl:qr.current,C=p.contextTypes,B=(C=C!=null)?Ru(h,N):Bl),p=new p(b,B),h.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=$l,h.stateNode=p,p._reactInternals=h,C&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=N,h.__reactInternalMemoizedMaskedChildContext=B),p}function Nu(h,p,b,C){h=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(b,C),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(b,C),p.state!==h&&$l.enqueueReplaceState(p,p.state,null)}function Jh(h,p,b,C){var N=h.stateNode;N.props=b,N.state=h.memoizedState,N.refs=Dr,Rd(h);var B=p.contextType;typeof B=="object"&&B!==null?N.context=Ds(B):(B=ps(p)?zl:qr.current,N.context=Ru(h,B)),N.state=h.memoizedState,B=p.getDerivedStateFromProps,typeof B=="function"&&(Fs(h,p,B,b),N.state=h.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(p=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),p!==N.state&&$l.enqueueReplaceState(N,N.state,null),Li(h,b,N,C),N.state=h.memoizedState),typeof N.componentDidMount=="function"&&(h.flags|=4194308)}function Du(h,p,b){if(h=b.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var C=b.stateNode}if(!C)throw Error(t(147,h));var N=C,B=""+h;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===B?p.ref:(p=function(Z){var ue=N.refs;ue===Dr&&(ue=N.refs={}),Z===null?delete ue[B]:ue[B]=Z},p._stringRef=B,p)}if(typeof h!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,h))}return h}function Ic(h,p){throw h=Object.prototype.toString.call(p),Error(t(31,h==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":h))}function Us(h){var p=h._init;return p(h._payload)}function Cm(h){function p(ke,xe){if(h){var Oe=ke.deletions;Oe===null?(ke.deletions=[xe],ke.flags|=16):Oe.push(xe)}}function b(ke,xe){if(!h)return null;for(;xe!==null;)p(ke,xe),xe=xe.sibling;return null}function C(ke,xe){for(ke=new Map;xe!==null;)xe.key!==null?ke.set(xe.key,xe):ke.set(xe.index,xe),xe=xe.sibling;return ke}function N(ke,xe){return ke=uf(ke,xe),ke.index=0,ke.sibling=null,ke}function B(ke,xe,Oe){return ke.index=Oe,h?(Oe=ke.alternate,Oe!==null?(Oe=Oe.index,Oe<xe?(ke.flags|=2,xe):Oe):(ke.flags|=2,xe)):(ke.flags|=1048576,xe)}function Z(ke){return h&&ke.alternate===null&&(ke.flags|=2),ke}function ue(ke,xe,Oe,yt){return xe===null||xe.tag!==6?(xe=mE(Oe,ke.mode,yt),xe.return=ke,xe):(xe=N(xe,Oe),xe.return=ke,xe)}function _e(ke,xe,Oe,yt){var Kt=Oe.type;return Kt===H?st(ke,xe,Oe.props.children,yt,Oe.key):xe!==null&&(xe.elementType===Kt||typeof Kt=="object"&&Kt!==null&&Kt.$$typeof===ve&&Us(Kt)===xe.type)?(yt=N(xe,Oe.props),yt.ref=Du(ke,xe,Oe),yt.return=ke,yt):(yt=_x(Oe.type,Oe.key,Oe.props,null,ke.mode,yt),yt.ref=Du(ke,xe,Oe),yt.return=ke,yt)}function Ue(ke,xe,Oe,yt){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Oe.containerInfo||xe.stateNode.implementation!==Oe.implementation?(xe=gE(Oe,ke.mode,yt),xe.return=ke,xe):(xe=N(xe,Oe.children||[]),xe.return=ke,xe)}function st(ke,xe,Oe,yt,Kt){return xe===null||xe.tag!==7?(xe=Vd(Oe,ke.mode,yt,Kt),xe.return=ke,xe):(xe=N(xe,Oe),xe.return=ke,xe)}function ft(ke,xe,Oe){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return xe=mE(""+xe,ke.mode,Oe),xe.return=ke,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case k:return Oe=_x(xe.type,xe.key,xe.props,null,ke.mode,Oe),Oe.ref=Du(ke,null,xe),Oe.return=ke,Oe;case D:return xe=gE(xe,ke.mode,Oe),xe.return=ke,xe;case ve:var yt=xe._init;return ft(ke,yt(xe._payload),Oe)}if(Zt(xe)||ie(xe))return xe=Vd(xe,ke.mode,Oe,null),xe.return=ke,xe;Ic(ke,xe)}return null}function rt(ke,xe,Oe,yt){var Kt=xe!==null?xe.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return Kt!==null?null:ue(ke,xe,""+Oe,yt);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case k:return Oe.key===Kt?_e(ke,xe,Oe,yt):null;case D:return Oe.key===Kt?Ue(ke,xe,Oe,yt):null;case ve:return Kt=Oe._init,rt(ke,xe,Kt(Oe._payload),yt)}if(Zt(Oe)||ie(Oe))return Kt!==null?null:st(ke,xe,Oe,yt,null);Ic(ke,Oe)}return null}function kt(ke,xe,Oe,yt,Kt){if(typeof yt=="string"&&yt!==""||typeof yt=="number")return ke=ke.get(Oe)||null,ue(xe,ke,""+yt,Kt);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case k:return ke=ke.get(yt.key===null?Oe:yt.key)||null,_e(xe,ke,yt,Kt);case D:return ke=ke.get(yt.key===null?Oe:yt.key)||null,Ue(xe,ke,yt,Kt);case ve:var sn=yt._init;return kt(ke,xe,Oe,sn(yt._payload),Kt)}if(Zt(yt)||ie(yt))return ke=ke.get(Oe)||null,st(xe,ke,yt,Kt,null);Ic(xe,yt)}return null}function Ht(ke,xe,Oe,yt){for(var Kt=null,sn=null,on=xe,gn=xe=0,_s=null;on!==null&&gn<Oe.length;gn++){on.index>gn?(_s=on,on=null):_s=on.sibling;var Kn=rt(ke,on,Oe[gn],yt);if(Kn===null){on===null&&(on=_s);break}h&&on&&Kn.alternate===null&&p(ke,on),xe=B(Kn,xe,gn),sn===null?Kt=Kn:sn.sibling=Kn,sn=Kn,on=_s}if(gn===Oe.length)return b(ke,on),Si&&Vl(ke,gn),Kt;if(on===null){for(;gn<Oe.length;gn++)on=ft(ke,Oe[gn],yt),on!==null&&(xe=B(on,xe,gn),sn===null?Kt=on:sn.sibling=on,sn=on);return Si&&Vl(ke,gn),Kt}for(on=C(ke,on);gn<Oe.length;gn++)_s=kt(on,ke,gn,Oe[gn],yt),_s!==null&&(h&&_s.alternate!==null&&on.delete(_s.key===null?gn:_s.key),xe=B(_s,xe,gn),sn===null?Kt=_s:sn.sibling=_s,sn=_s);return h&&on.forEach(function(hf){return p(ke,hf)}),Si&&Vl(ke,gn),Kt}function Gt(ke,xe,Oe,yt){var Kt=ie(Oe);if(typeof Kt!="function")throw Error(t(150));if(Oe=Kt.call(Oe),Oe==null)throw Error(t(151));for(var sn=Kt=null,on=xe,gn=xe=0,_s=null,Kn=Oe.next();on!==null&&!Kn.done;gn++,Kn=Oe.next()){on.index>gn?(_s=on,on=null):_s=on.sibling;var hf=rt(ke,on,Kn.value,yt);if(hf===null){on===null&&(on=_s);break}h&&on&&hf.alternate===null&&p(ke,on),xe=B(hf,xe,gn),sn===null?Kt=hf:sn.sibling=hf,sn=hf,on=_s}if(Kn.done)return b(ke,on),Si&&Vl(ke,gn),Kt;if(on===null){for(;!Kn.done;gn++,Kn=Oe.next())Kn=ft(ke,Kn.value,yt),Kn!==null&&(xe=B(Kn,xe,gn),sn===null?Kt=Kn:sn.sibling=Kn,sn=Kn);return Si&&Vl(ke,gn),Kt}for(on=C(ke,on);!Kn.done;gn++,Kn=Oe.next())Kn=kt(on,ke,gn,Kn.value,yt),Kn!==null&&(h&&Kn.alternate!==null&&on.delete(Kn.key===null?gn:Kn.key),xe=B(Kn,xe,gn),sn===null?Kt=Kn:sn.sibling=Kn,sn=Kn);return h&&on.forEach(function(j9){return p(ke,j9)}),Si&&Vl(ke,gn),Kt}function Sr(ke,xe,Oe,yt){if(typeof Oe=="object"&&Oe!==null&&Oe.type===H&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case k:e:{for(var Kt=Oe.key,sn=xe;sn!==null;){if(sn.key===Kt){if(Kt=Oe.type,Kt===H){if(sn.tag===7){b(ke,sn.sibling),xe=N(sn,Oe.props.children),xe.return=ke,ke=xe;break e}}else if(sn.elementType===Kt||typeof Kt=="object"&&Kt!==null&&Kt.$$typeof===ve&&Us(Kt)===sn.type){b(ke,sn.sibling),xe=N(sn,Oe.props),xe.ref=Du(ke,sn,Oe),xe.return=ke,ke=xe;break e}b(ke,sn);break}else p(ke,sn);sn=sn.sibling}Oe.type===H?(xe=Vd(Oe.props.children,ke.mode,yt,Oe.key),xe.return=ke,ke=xe):(yt=_x(Oe.type,Oe.key,Oe.props,null,ke.mode,yt),yt.ref=Du(ke,xe,Oe),yt.return=ke,ke=yt)}return Z(ke);case D:e:{for(sn=Oe.key;xe!==null;){if(xe.key===sn)if(xe.tag===4&&xe.stateNode.containerInfo===Oe.containerInfo&&xe.stateNode.implementation===Oe.implementation){b(ke,xe.sibling),xe=N(xe,Oe.children||[]),xe.return=ke,ke=xe;break e}else{b(ke,xe);break}else p(ke,xe);xe=xe.sibling}xe=gE(Oe,ke.mode,yt),xe.return=ke,ke=xe}return Z(ke);case ve:return sn=Oe._init,Sr(ke,xe,sn(Oe._payload),yt)}if(Zt(Oe))return Ht(ke,xe,Oe,yt);if(ie(Oe))return Gt(ke,xe,Oe,yt);Ic(ke,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"?(Oe=""+Oe,xe!==null&&xe.tag===6?(b(ke,xe.sibling),xe=N(xe,Oe),xe.return=ke,ke=xe):(b(ke,xe),xe=mE(Oe,ke.mode,yt),xe.return=ke,ke=xe),Z(ke)):b(ke,xe)}return Sr}var kc=Cm(!0),Fu=Cm(!1),Oc={},ea=Hi(Oc),ta=Hi(Oc),Lc=Hi(Oc);function Qs(h){if(h===Oc)throw Error(t(174));return h}function Qh(h,p){switch(ci(Lc,p),ci(ta,h),ci(ea,Oc),h=p.nodeType,h){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:et(null,"");break;default:h=h===8?p.parentNode:p,p=h.namespaceURI||null,h=h.tagName,p=et(p,h)}gi(ea),ci(ea,p)}function il(){gi(ea),gi(ta),gi(Lc)}function Pm(h){Qs(Lc.current);var p=Qs(ea.current),b=et(p,h.type);p!==b&&(ci(ta,h),ci(ea,b))}function ef(h){ta.current===h&&(gi(ea),gi(ta))}var _i=Hi(0);function Fr(h){for(var p=h;p!==null;){if(p.tag===13){var b=p.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var rl=[];function eo(){for(var h=0;h<rl.length;h++)rl[h]._workInProgressVersionPrimary=null;rl.length=0}var Uu=I.ReactCurrentDispatcher,ms=I.ReactCurrentBatchConfig,Nc=0,Ti=null,tr=null,Ur=null,La=!1,tf=!1,nf=0,X_=0;function Wi(){throw Error(t(321))}function Rm(h,p){if(p===null)return!1;for(var b=0;b<p.length&&b<h.length;b++)if(!Is(h[b],p[b]))return!1;return!0}function Im(h,p,b,C,N,B){if(Nc=B,Ti=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,Uu.current=h===null||h.memoizedState===null?_:A,h=b(C,N),tf){B=0;do{if(tf=!1,nf=0,25<=B)throw Error(t(301));B+=1,Ur=tr=null,p.updateQueue=null,Uu.current=R,h=b(C,N)}while(tf)}if(Uu.current=g,p=tr!==null&&tr.next!==null,Nc=0,Ur=tr=Ti=null,La=!1,p)throw Error(t(300));return h}function Id(){var h=nf!==0;return nf=0,h}function Co(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ur===null?Ti.memoizedState=Ur=h:Ur=Ur.next=h,Ur}function na(){if(tr===null){var h=Ti.alternate;h=h!==null?h.memoizedState:null}else h=tr.next;var p=Ur===null?Ti.memoizedState:Ur.next;if(p!==null)Ur=p,tr=h;else{if(h===null)throw Error(t(310));tr=h,h={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},Ur===null?Ti.memoizedState=Ur=h:Ur=Ur.next=h}return Ur}function kd(h,p){return typeof p=="function"?p(h):p}function km(h){var p=na(),b=p.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=h;var C=tr,N=C.baseQueue,B=b.pending;if(B!==null){if(N!==null){var Z=N.next;N.next=B.next,B.next=Z}C.baseQueue=N=B,b.pending=null}if(N!==null){B=N.next,C=C.baseState;var ue=Z=null,_e=null,Ue=B;do{var st=Ue.lane;if((Nc&st)===st)_e!==null&&(_e=_e.next={lane:0,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null}),C=Ue.hasEagerState?Ue.eagerState:h(C,Ue.action);else{var ft={lane:st,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null};_e===null?(ue=_e=ft,Z=C):_e=_e.next=ft,Ti.lanes|=st,Fd|=st}Ue=Ue.next}while(Ue!==null&&Ue!==B);_e===null?Z=C:_e.next=ue,Is(C,p.memoizedState)||(Pt=!0),p.memoizedState=C,p.baseState=Z,p.baseQueue=_e,b.lastRenderedState=C}if(h=b.interleaved,h!==null){N=h;do B=N.lane,Ti.lanes|=B,Fd|=B,N=N.next;while(N!==h)}else N===null&&(b.lanes=0);return[p.memoizedState,b.dispatch]}function Om(h){var p=na(),b=p.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=h;var C=b.dispatch,N=b.pending,B=p.memoizedState;if(N!==null){b.pending=null;var Z=N=N.next;do B=h(B,Z.action),Z=Z.next;while(Z!==N);Is(B,p.memoizedState)||(Pt=!0),p.memoizedState=B,p.baseQueue===null&&(p.baseState=B),b.lastRenderedState=B}return[B,C]}function Dc(){}function Y0(h,p){var b=Ti,C=na(),N=p(),B=!Is(C.memoizedState,N);if(B&&(C.memoizedState=N,Pt=!0),C=C.queue,Nd(Bs.bind(null,b,C,h),[h]),C.getSnapshot!==p||B||Ur!==null&&Ur.memoizedState.tag&1){if(b.flags|=2048,Od(9,G_.bind(null,b,C,N,p),void 0,null),gs===null)throw Error(t(349));(Nc&30)!==0||Fc(b,p,N)}return N}function Fc(h,p,b){h.flags|=16384,h={getSnapshot:p,value:b},p=Ti.updateQueue,p===null?(p={lastEffect:null,stores:null},Ti.updateQueue=p,p.stores=[h]):(b=p.stores,b===null?p.stores=[h]:b.push(h))}function G_(h,p,b,C){p.value=b,p.getSnapshot=C,q0(p)&&Y_(h)}function Bs(h,p,b){return b(function(){q0(p)&&Y_(h)})}function q0(h){var p=h.getSnapshot;h=h.value;try{var b=p();return!Is(h,b)}catch{return!0}}function Y_(h){var p=Oa(h,1);p!==null&&ql(p,h,1,-1)}function Z0(h){var p=Co();return typeof h=="function"&&(h=h()),p.memoizedState=p.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kd,lastRenderedState:h},p.queue=h,h=h.dispatch=tx.bind(null,Ti,h),[p.memoizedState,h]}function Od(h,p,b,C){return h={tag:h,create:p,destroy:b,deps:C,next:null},p=Ti.updateQueue,p===null?(p={lastEffect:null,stores:null},Ti.updateQueue=p,p.lastEffect=h.next=h):(b=p.lastEffect,b===null?p.lastEffect=h.next=h:(C=b.next,b.next=h,h.next=C,p.lastEffect=h)),h}function q_(){return na().memoizedState}function Ld(h,p,b,C){var N=Co();Ti.flags|=h,N.memoizedState=Od(1|p,b,void 0,C===void 0?null:C)}function Lm(h,p,b,C){var N=na();C=C===void 0?null:C;var B=void 0;if(tr!==null){var Z=tr.memoizedState;if(B=Z.destroy,C!==null&&Rm(C,Z.deps)){N.memoizedState=Od(p,b,B,C);return}}Ti.flags|=h,N.memoizedState=Od(1|p,b,B,C)}function Po(h,p){return Ld(8390656,8,h,p)}function Nd(h,p){return Lm(2048,8,h,p)}function K0(h,p){return Lm(4,2,h,p)}function Xl(h,p){return Lm(4,4,h,p)}function Dd(h,p){if(typeof p=="function")return h=h(),p(h),function(){p(null)};if(p!=null)return h=h(),p.current=h,function(){p.current=null}}function Uc(h,p,b){return b=b!=null?b.concat([h]):null,Lm(4,4,Dd.bind(null,p,h),b)}function rf(){}function Nm(h,p){var b=na();p=p===void 0?null:p;var C=b.memoizedState;return C!==null&&p!==null&&Rm(p,C[1])?C[0]:(b.memoizedState=[h,p],h)}function Dm(h,p){var b=na();p=p===void 0?null:p;var C=b.memoizedState;return C!==null&&p!==null&&Rm(p,C[1])?C[0]:(h=h(),b.memoizedState=[h,p],h)}function J0(h,p,b){return(Nc&21)===0?(h.baseState&&(h.baseState=!1,Pt=!0),h.memoizedState=b):(Is(b,p)||(b=os(),Ti.lanes|=b,Fd|=b,h.baseState=!0),p)}function Q0(h,p){var b=In;In=b!==0&&4>b?b:4,h(!0);var C=ms.transition;ms.transition={};try{h(!1),p()}finally{In=b,ms.transition=C}}function Z_(){return na().memoizedState}function ex(h,p,b){var C=lf(h);if(b={lane:C,action:b,hasEagerState:!1,eagerState:null,next:null},Fm(h))nx(p,b);else if(b=Mm(h,p,b,C),b!==null){var N=Io();ql(b,h,C,N),ix(b,p,C)}}function tx(h,p,b){var C=lf(h),N={lane:C,action:b,hasEagerState:!1,eagerState:null,next:null};if(Fm(h))nx(p,N);else{var B=h.alternate;if(h.lanes===0&&(B===null||B.lanes===0)&&(B=p.lastRenderedReducer,B!==null))try{var Z=p.lastRenderedState,ue=B(Z,b);if(N.hasEagerState=!0,N.eagerState=ue,Is(ue,Z)){var _e=p.interleaved;_e===null?(N.next=N,Pd(p)):(N.next=_e.next,_e.next=N),p.interleaved=N;return}}catch{}finally{}b=Mm(h,p,N,C),b!==null&&(N=Io(),ql(b,h,C,N),ix(b,p,C))}}function Fm(h){var p=h.alternate;return h===Ti||p!==null&&p===Ti}function nx(h,p){tf=La=!0;var b=h.pending;b===null?p.next=p:(p.next=b.next,b.next=p),h.pending=p}function ix(h,p,b){if((b&4194240)!==0){var C=p.lanes;C&=h.pendingLanes,b|=C,p.lanes=b,Xs(h,b)}}var g={readContext:Ds,useCallback:Wi,useContext:Wi,useEffect:Wi,useImperativeHandle:Wi,useInsertionEffect:Wi,useLayoutEffect:Wi,useMemo:Wi,useReducer:Wi,useRef:Wi,useState:Wi,useDebugValue:Wi,useDeferredValue:Wi,useTransition:Wi,useMutableSource:Wi,useSyncExternalStore:Wi,useId:Wi,unstable_isNewReconciler:!1},_={readContext:Ds,useCallback:function(h,p){return Co().memoizedState=[h,p===void 0?null:p],h},useContext:Ds,useEffect:Po,useImperativeHandle:function(h,p,b){return b=b!=null?b.concat([h]):null,Ld(4194308,4,Dd.bind(null,p,h),b)},useLayoutEffect:function(h,p){return Ld(4194308,4,h,p)},useInsertionEffect:function(h,p){return Ld(4,2,h,p)},useMemo:function(h,p){var b=Co();return p=p===void 0?null:p,h=h(),b.memoizedState=[h,p],h},useReducer:function(h,p,b){var C=Co();return p=b!==void 0?b(p):p,C.memoizedState=C.baseState=p,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:p},C.queue=h,h=h.dispatch=ex.bind(null,Ti,h),[C.memoizedState,h]},useRef:function(h){var p=Co();return h={current:h},p.memoizedState=h},useState:Z0,useDebugValue:rf,useDeferredValue:function(h){return Co().memoizedState=h},useTransition:function(){var h=Z0(!1),p=h[0];return h=Q0.bind(null,h[1]),Co().memoizedState=h,[p,h]},useMutableSource:function(){},useSyncExternalStore:function(h,p,b){var C=Ti,N=Co();if(Si){if(b===void 0)throw Error(t(407));b=b()}else{if(b=p(),gs===null)throw Error(t(349));(Nc&30)!==0||Fc(C,p,b)}N.memoizedState=b;var B={value:b,getSnapshot:p};return N.queue=B,Po(Bs.bind(null,C,B,h),[h]),C.flags|=2048,Od(9,G_.bind(null,C,B,b,p),void 0,null),b},useId:function(){var h=Co(),p=gs.identifierPrefix;if(Si){var b=Ko,C=xt;b=(C&~(1<<32-Qt(C)-1)).toString(32)+b,p=":"+p+"R"+b,b=nf++,0<b&&(p+="H"+b.toString(32)),p+=":"}else b=X_++,p=":"+p+"r"+b.toString(32)+":";return h.memoizedState=p},unstable_isNewReconciler:!1},A={readContext:Ds,useCallback:Nm,useContext:Ds,useEffect:Nd,useImperativeHandle:Uc,useInsertionEffect:K0,useLayoutEffect:Xl,useMemo:Dm,useReducer:km,useRef:q_,useState:function(){return km(kd)},useDebugValue:rf,useDeferredValue:function(h){var p=na();return J0(p,tr.memoizedState,h)},useTransition:function(){var h=km(kd)[0],p=na().memoizedState;return[h,p]},useMutableSource:Dc,useSyncExternalStore:Y0,useId:Z_,unstable_isNewReconciler:!1},R={readContext:Ds,useCallback:Nm,useContext:Ds,useEffect:Nd,useImperativeHandle:Uc,useInsertionEffect:K0,useLayoutEffect:Xl,useMemo:Dm,useReducer:Om,useRef:q_,useState:function(){return Om(kd)},useDebugValue:rf,useDeferredValue:function(h){var p=na();return tr===null?p.memoizedState=h:J0(p,tr.memoizedState,h)},useTransition:function(){var h=Om(kd)[0],p=na().memoizedState;return[h,p]},useMutableSource:Dc,useSyncExternalStore:Y0,useId:Z_,unstable_isNewReconciler:!1};function F(h,p){try{var b="",C=p;do b+=Fe(C),C=C.return;while(C);var N=b}catch(B){N=`
Error generating stack: `+B.message+`
`+B.stack}return{value:h,source:p,stack:N,digest:null}}function $(h,p,b){return{value:h,source:null,stack:b??null,digest:p??null}}function oe(h,p){try{console.error(p.value)}catch(b){setTimeout(function(){throw b})}}var we=typeof WeakMap=="function"?WeakMap:Map;function Xe(h,p,b){b=Qo(-1,b),b.tag=3,b.payload={element:null};var C=p.value;return b.callback=function(){hx||(hx=!0,aE=C),oe(h,p)},b}function _t(h,p,b){b=Qo(-1,b),b.tag=3;var C=h.type.getDerivedStateFromError;if(typeof C=="function"){var N=p.value;b.payload=function(){return C(N)},b.callback=function(){oe(h,p)}}var B=h.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(b.callback=function(){oe(h,p),typeof C!="function"&&(of===null?of=new Set([this]):of.add(this));var Z=p.stack;this.componentDidCatch(p.value,{componentStack:Z!==null?Z:""})}),b}function Nt(h,p,b){var C=h.pingCache;if(C===null){C=h.pingCache=new we;var N=new Set;C.set(p,N)}else N=C.get(p),N===void 0&&(N=new Set,C.set(p,N));N.has(b)||(N.add(b),h=O9.bind(null,h,p,b),p.then(h,h))}function _n(h){do{var p;if((p=h.tag===13)&&(p=h.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return h;h=h.return}while(h!==null);return null}function tn(h,p,b,C,N){return(h.mode&1)===0?(h===p?h.flags|=65536:(h.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(p=Qo(-1,1),p.tag=2,nl(b,p,1))),b.lanes|=1),h):(h.flags|=65536,h.lanes=N,h)}var ui=I.ReactCurrentOwner,Pt=!1;function Zn(h,p,b,C){p.child=h===null?Fu(p,null,b,C):kc(p,h.child,b,C)}function Ro(h,p,b,C,N){b=b.render;var B=p.ref;return Wl(p,N),C=Im(h,p,b,C,B,N),b=Id(),h!==null&&!Pt?(p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~N,Bu(h,p,N)):(Si&&b&&H_(p),p.flags|=1,Zn(h,p,C,N),p.child)}function Le(h,p,b,C,N){if(h===null){var B=b.type;return typeof B=="function"&&!pE(B)&&B.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(p.tag=15,p.type=B,Ee(h,p,B,C,N)):(h=_x(b.type,null,C,p,p.mode,N),h.ref=p.ref,h.return=p,p.child=h)}if(B=h.child,(h.lanes&N)===0){var Z=B.memoizedProps;if(b=b.compare,b=b!==null?b:Xo,b(Z,C)&&h.ref===p.ref)return Bu(h,p,N)}return p.flags|=1,h=uf(B,C),h.ref=p.ref,h.return=p,p.child=h}function Ee(h,p,b,C,N){if(h!==null){var B=h.memoizedProps;if(Xo(B,C)&&h.ref===p.ref)if(Pt=!1,p.pendingProps=C=B,(h.lanes&N)!==0)(h.flags&131072)!==0&&(Pt=!0);else return p.lanes=h.lanes,Bu(h,p,N)}return Xt(h,p,b,C,N)}function We(h,p,b){var C=p.pendingProps,N=C.children,B=h!==null?h.memoizedState:null;if(C.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},ci(Bm,Na),Na|=b;else{if((b&1073741824)===0)return h=B!==null?B.baseLanes|b:b,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:h,cachePool:null,transitions:null},p.updateQueue=null,ci(Bm,Na),Na|=h,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},C=B!==null?B.baseLanes:b,ci(Bm,Na),Na|=C}else B!==null?(C=B.baseLanes|b,p.memoizedState=null):C=b,ci(Bm,Na),Na|=C;return Zn(h,p,N,b),p.child}function At(h,p){var b=p.ref;(h===null&&b!==null||h!==null&&h.ref!==b)&&(p.flags|=512,p.flags|=2097152)}function Xt(h,p,b,C,N){var B=ps(b)?zl:qr.current;return B=Ru(p,B),Wl(p,N),b=Im(h,p,b,C,B,N),C=Id(),h!==null&&!Pt?(p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~N,Bu(h,p,N)):(Si&&C&&H_(p),p.flags|=1,Zn(h,p,b,N),p.child)}function Sn(h,p,b,C,N){if(ps(b)){var B=!0;Iu(p)}else B=!1;if(Wl(p,N),p.stateNode===null)ox(h,p),Kh(p,b,C),Jh(p,b,C,N),C=!0;else if(h===null){var Z=p.stateNode,ue=p.memoizedProps;Z.props=ue;var _e=Z.context,Ue=b.contextType;typeof Ue=="object"&&Ue!==null?Ue=Ds(Ue):(Ue=ps(b)?zl:qr.current,Ue=Ru(p,Ue));var st=b.getDerivedStateFromProps,ft=typeof st=="function"||typeof Z.getSnapshotBeforeUpdate=="function";ft||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(ue!==C||_e!==Ue)&&Nu(p,Z,C,Ue),jl=!1;var rt=p.memoizedState;Z.state=rt,Li(p,C,Z,N),_e=p.memoizedState,ue!==C||rt!==_e||Os.current||jl?(typeof st=="function"&&(Fs(p,b,st,C),_e=p.memoizedState),(ue=jl||ar(p,b,ue,C,rt,_e,Ue))?(ft||typeof Z.UNSAFE_componentWillMount!="function"&&typeof Z.componentWillMount!="function"||(typeof Z.componentWillMount=="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount=="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount=="function"&&(p.flags|=4194308)):(typeof Z.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=C,p.memoizedState=_e),Z.props=C,Z.state=_e,Z.context=Ue,C=ue):(typeof Z.componentDidMount=="function"&&(p.flags|=4194308),C=!1)}else{Z=p.stateNode,G0(h,p),ue=p.memoizedProps,Ue=p.type===p.elementType?ue:Ia(p.type,ue),Z.props=Ue,ft=p.pendingProps,rt=Z.context,_e=b.contextType,typeof _e=="object"&&_e!==null?_e=Ds(_e):(_e=ps(b)?zl:qr.current,_e=Ru(p,_e));var kt=b.getDerivedStateFromProps;(st=typeof kt=="function"||typeof Z.getSnapshotBeforeUpdate=="function")||typeof Z.UNSAFE_componentWillReceiveProps!="function"&&typeof Z.componentWillReceiveProps!="function"||(ue!==ft||rt!==_e)&&Nu(p,Z,C,_e),jl=!1,rt=p.memoizedState,Z.state=rt,Li(p,C,Z,N);var Ht=p.memoizedState;ue!==ft||rt!==Ht||Os.current||jl?(typeof kt=="function"&&(Fs(p,b,kt,C),Ht=p.memoizedState),(Ue=jl||ar(p,b,Ue,C,rt,Ht,_e)||!1)?(st||typeof Z.UNSAFE_componentWillUpdate!="function"&&typeof Z.componentWillUpdate!="function"||(typeof Z.componentWillUpdate=="function"&&Z.componentWillUpdate(C,Ht,_e),typeof Z.UNSAFE_componentWillUpdate=="function"&&Z.UNSAFE_componentWillUpdate(C,Ht,_e)),typeof Z.componentDidUpdate=="function"&&(p.flags|=4),typeof Z.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof Z.componentDidUpdate!="function"||ue===h.memoizedProps&&rt===h.memoizedState||(p.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||ue===h.memoizedProps&&rt===h.memoizedState||(p.flags|=1024),p.memoizedProps=C,p.memoizedState=Ht),Z.props=C,Z.state=Ht,Z.context=_e,C=Ue):(typeof Z.componentDidUpdate!="function"||ue===h.memoizedProps&&rt===h.memoizedState||(p.flags|=4),typeof Z.getSnapshotBeforeUpdate!="function"||ue===h.memoizedProps&&rt===h.memoizedState||(p.flags|=1024),C=!1)}return mn(h,p,b,C,B,N)}function mn(h,p,b,C,N,B){At(h,p);var Z=(p.flags&128)!==0;if(!C&&!Z)return N&&z_(p,b,!1),Bu(h,p,B);C=p.stateNode,ui.current=p;var ue=Z&&typeof b.getDerivedStateFromError!="function"?null:C.render();return p.flags|=1,h!==null&&Z?(p.child=kc(p,h.child,null,B),p.child=kc(p,null,ue,B)):Zn(h,p,ue,B),p.memoizedState=C.state,N&&z_(p,b,!0),p.child}function $n(h){var p=h.stateNode;p.pendingContext?B_(h,p.pendingContext,p.pendingContext!==p.context):p.context&&B_(h,p.context,!1),Qh(h,p.containerInfo)}function wr(h,p,b,C,N){return Rc(),Gh(N),p.flags|=256,Zn(h,p,b,C),p.child}var Hn={dehydrated:null,treeContext:null,retryLane:0};function sl(h){return{baseLanes:h,cachePool:null,transitions:null}}function rx(h,p,b){var C=p.pendingProps,N=_i.current,B=!1,Z=(p.flags&128)!==0,ue;if((ue=Z)||(ue=h!==null&&h.memoizedState===null?!1:(N&2)!==0),ue?(B=!0,p.flags&=-129):(h===null||h.memoizedState!==null)&&(N|=1),ci(_i,N&1),h===null)return Tm(p),h=p.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((p.mode&1)===0?p.lanes=1:h.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(Z=C.children,h=C.fallback,B?(C=p.mode,B=p.child,Z={mode:"hidden",children:Z},(C&1)===0&&B!==null?(B.childLanes=0,B.pendingProps=Z):B=yx(Z,C,0,null),h=Vd(h,C,b,null),B.return=p,h.return=p,B.sibling=h,p.child=B,p.child.memoizedState=sl(b),p.memoizedState=Hn,h):KT(p,Z));if(N=h.memoizedState,N!==null&&(ue=N.dehydrated,ue!==null))return b9(h,p,Z,C,ue,N,b);if(B){B=C.fallback,Z=p.mode,N=h.child,ue=N.sibling;var _e={mode:"hidden",children:C.children};return(Z&1)===0&&p.child!==N?(C=p.child,C.childLanes=0,C.pendingProps=_e,p.deletions=null):(C=uf(N,_e),C.subtreeFlags=N.subtreeFlags&14680064),ue!==null?B=uf(ue,B):(B=Vd(B,Z,b,null),B.flags|=2),B.return=p,C.return=p,C.sibling=B,p.child=C,C=B,B=p.child,Z=h.child.memoizedState,Z=Z===null?sl(b):{baseLanes:Z.baseLanes|b,cachePool:null,transitions:Z.transitions},B.memoizedState=Z,B.childLanes=h.childLanes&~b,p.memoizedState=Hn,C}return B=h.child,h=B.sibling,C=uf(B,{mode:"visible",children:C.children}),(p.mode&1)===0&&(C.lanes=b),C.return=p,C.sibling=null,h!==null&&(b=p.deletions,b===null?(p.deletions=[h],p.flags|=16):b.push(h)),p.child=C,p.memoizedState=null,C}function KT(h,p){return p=yx({mode:"visible",children:p},h.mode,0,null),p.return=h,h.child=p}function sx(h,p,b,C){return C!==null&&Gh(C),kc(p,h.child,null,b),h=KT(p,p.pendingProps.children),h.flags|=2,p.memoizedState=null,h}function b9(h,p,b,C,N,B,Z){if(b)return p.flags&256?(p.flags&=-257,C=$(Error(t(422))),sx(h,p,Z,C)):p.memoizedState!==null?(p.child=h.child,p.flags|=128,null):(B=C.fallback,N=p.mode,C=yx({mode:"visible",children:C.children},N,0,null),B=Vd(B,N,Z,null),B.flags|=2,C.return=p,B.return=p,C.sibling=B,p.child=C,(p.mode&1)!==0&&kc(p,h.child,null,Z),p.child.memoizedState=sl(Z),p.memoizedState=Hn,B);if((p.mode&1)===0)return sx(h,p,Z,null);if(N.data==="$!"){if(C=N.nextSibling&&N.nextSibling.dataset,C)var ue=C.dgst;return C=ue,B=Error(t(419)),C=$(B,C,void 0),sx(h,p,Z,C)}if(ue=(Z&h.childLanes)!==0,Pt||ue){if(C=gs,C!==null){switch(Z&-Z){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(C.suspendedLanes|Z))!==0?0:N,N!==0&&N!==B.retryLane&&(B.retryLane=N,Oa(h,N),ql(C,h,N,-1))}return dE(),C=$(Error(t(421))),sx(h,p,Z,C)}return N.data==="$?"?(p.flags|=128,p.child=h.child,p=L9.bind(null,h),N._reactRetry=p,null):(h=B.treeContext,Ns=Pa(N.nextSibling),Zr=p,Si=!0,Jo=null,h!==null&&(Ls[Nr++]=xt,Ls[Nr++]=Ko,Ls[Nr++]=Ou,xt=h.id,Ko=h.overflow,Ou=p),p=KT(p,C.children),p.flags|=4096,p)}function OI(h,p,b){h.lanes|=p;var C=h.alternate;C!==null&&(C.lanes|=p),Zh(h.return,p,b)}function JT(h,p,b,C,N){var B=h.memoizedState;B===null?h.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:C,tail:b,tailMode:N}:(B.isBackwards=p,B.rendering=null,B.renderingStartTime=0,B.last=C,B.tail=b,B.tailMode=N)}function LI(h,p,b){var C=p.pendingProps,N=C.revealOrder,B=C.tail;if(Zn(h,p,C.children,b),C=_i.current,(C&2)!==0)C=C&1|2,p.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=p.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&OI(h,b,p);else if(h.tag===19)OI(h,b,p);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===p)break e;for(;h.sibling===null;){if(h.return===null||h.return===p)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}C&=1}if(ci(_i,C),(p.mode&1)===0)p.memoizedState=null;else switch(N){case"forwards":for(b=p.child,N=null;b!==null;)h=b.alternate,h!==null&&Fr(h)===null&&(N=b),b=b.sibling;b=N,b===null?(N=p.child,p.child=null):(N=b.sibling,b.sibling=null),JT(p,!1,N,b,B);break;case"backwards":for(b=null,N=p.child,p.child=null;N!==null;){if(h=N.alternate,h!==null&&Fr(h)===null){p.child=N;break}h=N.sibling,N.sibling=b,b=N,N=h}JT(p,!0,b,null,B);break;case"together":JT(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function ox(h,p){(p.mode&1)===0&&h!==null&&(h.alternate=null,p.alternate=null,p.flags|=2)}function Bu(h,p,b){if(h!==null&&(p.dependencies=h.dependencies),Fd|=p.lanes,(b&p.childLanes)===0)return null;if(h!==null&&p.child!==h.child)throw Error(t(153));if(p.child!==null){for(h=p.child,b=uf(h,h.pendingProps),p.child=b,b.return=p;h.sibling!==null;)h=h.sibling,b=b.sibling=uf(h,h.pendingProps),b.return=p;b.sibling=null}return p.child}function w9(h,p,b){switch(p.tag){case 3:$n(p),Rc();break;case 5:Pm(p);break;case 1:ps(p.type)&&Iu(p);break;case 4:Qh(p,p.stateNode.containerInfo);break;case 10:var C=p.type._context,N=p.memoizedProps.value;ci(Md,C._currentValue),C._currentValue=N;break;case 13:if(C=p.memoizedState,C!==null)return C.dehydrated!==null?(ci(_i,_i.current&1),p.flags|=128,null):(b&p.child.childLanes)!==0?rx(h,p,b):(ci(_i,_i.current&1),h=Bu(h,p,b),h!==null?h.sibling:null);ci(_i,_i.current&1);break;case 19:if(C=(b&p.childLanes)!==0,(h.flags&128)!==0){if(C)return LI(h,p,b);p.flags|=128}if(N=p.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),ci(_i,_i.current),C)break;return null;case 22:case 23:return p.lanes=0,We(h,p,b)}return Bu(h,p,b)}var NI,QT,DI,FI;NI=function(h,p){for(var b=p.child;b!==null;){if(b.tag===5||b.tag===6)h.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===p)break;for(;b.sibling===null;){if(b.return===null||b.return===p)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},QT=function(){},DI=function(h,p,b,C){var N=h.memoizedProps;if(N!==C){h=p.stateNode,Qs(ea.current);var B=null;switch(b){case"input":N=Ye(h,N),C=Ye(h,C),B=[];break;case"select":N=X({},N,{value:void 0}),C=X({},C,{value:void 0}),B=[];break;case"textarea":N=Xn(h,N),C=Xn(h,C),B=[];break;default:typeof N.onClick!="function"&&typeof C.onClick=="function"&&(h.onclick=Je)}pe(b,C);var Z;b=null;for(Ue in N)if(!C.hasOwnProperty(Ue)&&N.hasOwnProperty(Ue)&&N[Ue]!=null)if(Ue==="style"){var ue=N[Ue];for(Z in ue)ue.hasOwnProperty(Z)&&(b||(b={}),b[Z]="")}else Ue!=="dangerouslySetInnerHTML"&&Ue!=="children"&&Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&Ue!=="autoFocus"&&(r.hasOwnProperty(Ue)?B||(B=[]):(B=B||[]).push(Ue,null));for(Ue in C){var _e=C[Ue];if(ue=N?.[Ue],C.hasOwnProperty(Ue)&&_e!==ue&&(_e!=null||ue!=null))if(Ue==="style")if(ue){for(Z in ue)!ue.hasOwnProperty(Z)||_e&&_e.hasOwnProperty(Z)||(b||(b={}),b[Z]="");for(Z in _e)_e.hasOwnProperty(Z)&&ue[Z]!==_e[Z]&&(b||(b={}),b[Z]=_e[Z])}else b||(B||(B=[]),B.push(Ue,b)),b=_e;else Ue==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,ue=ue?ue.__html:void 0,_e!=null&&ue!==_e&&(B=B||[]).push(Ue,_e)):Ue==="children"?typeof _e!="string"&&typeof _e!="number"||(B=B||[]).push(Ue,""+_e):Ue!=="suppressContentEditableWarning"&&Ue!=="suppressHydrationWarning"&&(r.hasOwnProperty(Ue)?(_e!=null&&Ue==="onScroll"&&ti("scroll",h),B||ue===_e||(B=[])):(B=B||[]).push(Ue,_e))}b&&(B=B||[]).push("style",b);var Ue=B;(p.updateQueue=Ue)&&(p.flags|=4)}},FI=function(h,p,b,C){b!==C&&(p.flags|=4)};function K_(h,p){if(!Si)switch(h.tailMode){case"hidden":p=h.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?h.tail=null:b.sibling=null;break;case"collapsed":b=h.tail;for(var C=null;b!==null;)b.alternate!==null&&(C=b),b=b.sibling;C===null?p||h.tail===null?h.tail=null:h.tail.sibling=null:C.sibling=null}}function to(h){var p=h.alternate!==null&&h.alternate.child===h.child,b=0,C=0;if(p)for(var N=h.child;N!==null;)b|=N.lanes|N.childLanes,C|=N.subtreeFlags&14680064,C|=N.flags&14680064,N.return=h,N=N.sibling;else for(N=h.child;N!==null;)b|=N.lanes|N.childLanes,C|=N.subtreeFlags,C|=N.flags,N.return=h,N=N.sibling;return h.subtreeFlags|=C,h.childLanes=b,p}function S9(h,p,b){var C=p.pendingProps;switch(Hl(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return to(p),null;case 1:return ps(p.type)&&Sd(),to(p),null;case 3:return C=p.stateNode,il(),gi(Os),gi(qr),eo(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(h===null||h.child===null)&&(Xh(p)?p.flags|=4:h===null||h.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Jo!==null&&(uE(Jo),Jo=null))),QT(h,p),to(p),null;case 5:ef(p);var N=Qs(Lc.current);if(b=p.type,h!==null&&p.stateNode!=null)DI(h,p,b,C,N),h.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!C){if(p.stateNode===null)throw Error(t(166));return to(p),null}if(h=Qs(ea.current),Xh(p)){C=p.stateNode,b=p.type;var B=p.memoizedProps;switch(C[Qi]=p,C[Ul]=B,h=(p.mode&1)!==0,b){case"dialog":ti("cancel",C),ti("close",C);break;case"iframe":case"object":case"embed":ti("load",C);break;case"video":case"audio":for(N=0;N<Ca.length;N++)ti(Ca[N],C);break;case"source":ti("error",C);break;case"img":case"image":case"link":ti("error",C),ti("load",C);break;case"details":ti("toggle",C);break;case"input":lt(C,B),ti("invalid",C);break;case"select":C._wrapperState={wasMultiple:!!B.multiple},ti("invalid",C);break;case"textarea":ae(C,B),ti("invalid",C)}pe(b,B),N=null;for(var Z in B)if(B.hasOwnProperty(Z)){var ue=B[Z];Z==="children"?typeof ue=="string"?C.textContent!==ue&&(B.suppressHydrationWarning!==!0&&De(C.textContent,ue,h),N=["children",ue]):typeof ue=="number"&&C.textContent!==""+ue&&(B.suppressHydrationWarning!==!0&&De(C.textContent,ue,h),N=["children",""+ue]):r.hasOwnProperty(Z)&&ue!=null&&Z==="onScroll"&&ti("scroll",C)}switch(b){case"input":Rt(C),bt(C,B,!0);break;case"textarea":Rt(C),Ne(C);break;case"select":case"option":break;default:typeof B.onClick=="function"&&(C.onclick=Je)}C=N,p.updateQueue=C,C!==null&&(p.flags|=4)}else{Z=N.nodeType===9?N:N.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=ct(b)),h==="http://www.w3.org/1999/xhtml"?b==="script"?(h=Z.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof C.is=="string"?h=Z.createElement(b,{is:C.is}):(h=Z.createElement(b),b==="select"&&(Z=h,C.multiple?Z.multiple=!0:C.size&&(Z.size=C.size))):h=Z.createElementNS(h,b),h[Qi]=p,h[Ul]=C,NI(h,p,!1,!1),p.stateNode=h;e:{switch(Z=$e(b,C),b){case"dialog":ti("cancel",h),ti("close",h),N=C;break;case"iframe":case"object":case"embed":ti("load",h),N=C;break;case"video":case"audio":for(N=0;N<Ca.length;N++)ti(Ca[N],h);N=C;break;case"source":ti("error",h),N=C;break;case"img":case"image":case"link":ti("error",h),ti("load",h),N=C;break;case"details":ti("toggle",h),N=C;break;case"input":lt(h,C),N=Ye(h,C),ti("invalid",h);break;case"option":N=C;break;case"select":h._wrapperState={wasMultiple:!!C.multiple},N=X({},C,{value:void 0}),ti("invalid",h);break;case"textarea":ae(h,C),N=Xn(h,C),ti("invalid",h);break;default:N=C}pe(b,N),ue=N;for(B in ue)if(ue.hasOwnProperty(B)){var _e=ue[B];B==="style"?ht(h,_e):B==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,_e!=null&&Bt(h,_e)):B==="children"?typeof _e=="string"?(b!=="textarea"||_e!=="")&&dt(h,_e):typeof _e=="number"&&dt(h,""+_e):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(r.hasOwnProperty(B)?_e!=null&&B==="onScroll"&&ti("scroll",h):_e!=null&&M(h,B,_e,Z))}switch(b){case"input":Rt(h),bt(h,C,!1);break;case"textarea":Rt(h),Ne(h);break;case"option":C.value!=null&&h.setAttribute("value",""+pt(C.value));break;case"select":h.multiple=!!C.multiple,B=C.value,B!=null?ln(h,!!C.multiple,B,!1):C.defaultValue!=null&&ln(h,!!C.multiple,C.defaultValue,!0);break;default:typeof N.onClick=="function"&&(h.onclick=Je)}switch(b){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}}C&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return to(p),null;case 6:if(h&&p.stateNode!=null)FI(h,p,h.memoizedProps,C);else{if(typeof C!="string"&&p.stateNode===null)throw Error(t(166));if(b=Qs(Lc.current),Qs(ea.current),Xh(p)){if(C=p.stateNode,b=p.memoizedProps,C[Qi]=p,(B=C.nodeValue!==b)&&(h=Zr,h!==null))switch(h.tag){case 3:De(C.nodeValue,b,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&De(C.nodeValue,b,(h.mode&1)!==0)}B&&(p.flags|=4)}else C=(b.nodeType===9?b:b.ownerDocument).createTextNode(C),C[Qi]=p,p.stateNode=C}return to(p),null;case 13:if(gi(_i),C=p.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(Si&&Ns!==null&&(p.mode&1)!==0&&(p.flags&128)===0)$_(),Rc(),p.flags|=98560,B=!1;else if(B=Xh(p),C!==null&&C.dehydrated!==null){if(h===null){if(!B)throw Error(t(318));if(B=p.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(t(317));B[Qi]=p}else Rc(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;to(p),B=!1}else Jo!==null&&(uE(Jo),Jo=null),B=!0;if(!B)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=b,p):(C=C!==null,C!==(h!==null&&h.memoizedState!==null)&&C&&(p.child.flags|=8192,(p.mode&1)!==0&&(h===null||(_i.current&1)!==0?Kr===0&&(Kr=3):dE())),p.updateQueue!==null&&(p.flags|=4),to(p),null);case 4:return il(),QT(h,p),h===null&&Dl(p.stateNode.containerInfo),to(p),null;case 10:return qh(p.type._context),to(p),null;case 17:return ps(p.type)&&Sd(),to(p),null;case 19:if(gi(_i),B=p.memoizedState,B===null)return to(p),null;if(C=(p.flags&128)!==0,Z=B.rendering,Z===null)if(C)K_(B,!1);else{if(Kr!==0||h!==null&&(h.flags&128)!==0)for(h=p.child;h!==null;){if(Z=Fr(h),Z!==null){for(p.flags|=128,K_(B,!1),C=Z.updateQueue,C!==null&&(p.updateQueue=C,p.flags|=4),p.subtreeFlags=0,C=b,b=p.child;b!==null;)B=b,h=C,B.flags&=14680066,Z=B.alternate,Z===null?(B.childLanes=0,B.lanes=h,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=Z.childLanes,B.lanes=Z.lanes,B.child=Z.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=Z.memoizedProps,B.memoizedState=Z.memoizedState,B.updateQueue=Z.updateQueue,B.type=Z.type,h=Z.dependencies,B.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),b=b.sibling;return ci(_i,_i.current&1|2),p.child}h=h.sibling}B.tail!==null&&Mt()>zm&&(p.flags|=128,C=!0,K_(B,!1),p.lanes=4194304)}else{if(!C)if(h=Fr(Z),h!==null){if(p.flags|=128,C=!0,b=h.updateQueue,b!==null&&(p.updateQueue=b,p.flags|=4),K_(B,!0),B.tail===null&&B.tailMode==="hidden"&&!Z.alternate&&!Si)return to(p),null}else 2*Mt()-B.renderingStartTime>zm&&b!==1073741824&&(p.flags|=128,C=!0,K_(B,!1),p.lanes=4194304);B.isBackwards?(Z.sibling=p.child,p.child=Z):(b=B.last,b!==null?b.sibling=Z:p.child=Z,B.last=Z)}return B.tail!==null?(p=B.tail,B.rendering=p,B.tail=p.sibling,B.renderingStartTime=Mt(),p.sibling=null,b=_i.current,ci(_i,C?b&1|2:b&1),p):(to(p),null);case 22:case 23:return fE(),C=p.memoizedState!==null,h!==null&&h.memoizedState!==null!==C&&(p.flags|=8192),C&&(p.mode&1)!==0?(Na&1073741824)!==0&&(to(p),p.subtreeFlags&6&&(p.flags|=8192)):to(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function T9(h,p){switch(Hl(p),p.tag){case 1:return ps(p.type)&&Sd(),h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 3:return il(),gi(Os),gi(qr),eo(),h=p.flags,(h&65536)!==0&&(h&128)===0?(p.flags=h&-65537|128,p):null;case 5:return ef(p),null;case 13:if(gi(_i),h=p.memoizedState,h!==null&&h.dehydrated!==null){if(p.alternate===null)throw Error(t(340));Rc()}return h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 19:return gi(_i),null;case 4:return il(),null;case 10:return qh(p.type._context),null;case 22:case 23:return fE(),null;case 24:return null;default:return null}}var ax=!1,no=!1,E9=typeof WeakSet=="function"?WeakSet:Set,zt=null;function Um(h,p){var b=h.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(C){lr(h,p,C)}else b.current=null}function eE(h,p,b){try{b()}catch(C){lr(h,p,C)}}var UI=!1;function A9(h,p){if(wt=Ss,h=mi(),or(h)){if("selectionStart"in h)var b={start:h.selectionStart,end:h.selectionEnd};else e:{b=(b=h.ownerDocument)&&b.defaultView||window;var C=b.getSelection&&b.getSelection();if(C&&C.rangeCount!==0){b=C.anchorNode;var N=C.anchorOffset,B=C.focusNode;C=C.focusOffset;try{b.nodeType,B.nodeType}catch{b=null;break e}var Z=0,ue=-1,_e=-1,Ue=0,st=0,ft=h,rt=null;t:for(;;){for(var kt;ft!==b||N!==0&&ft.nodeType!==3||(ue=Z+N),ft!==B||C!==0&&ft.nodeType!==3||(_e=Z+C),ft.nodeType===3&&(Z+=ft.nodeValue.length),(kt=ft.firstChild)!==null;)rt=ft,ft=kt;for(;;){if(ft===h)break t;if(rt===b&&++Ue===N&&(ue=Z),rt===B&&++st===C&&(_e=Z),(kt=ft.nextSibling)!==null)break;ft=rt,rt=ft.parentNode}ft=kt}b=ue===-1||_e===-1?null:{start:ue,end:_e}}else b=null}b=b||{start:0,end:0}}else b=null;for(en={focusedElem:h,selectionRange:b},Ss=!1,zt=p;zt!==null;)if(p=zt,h=p.child,(p.subtreeFlags&1028)!==0&&h!==null)h.return=p,zt=h;else for(;zt!==null;){p=zt;try{var Ht=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Ht!==null){var Gt=Ht.memoizedProps,Sr=Ht.memoizedState,ke=p.stateNode,xe=ke.getSnapshotBeforeUpdate(p.elementType===p.type?Gt:Ia(p.type,Gt),Sr);ke.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:var Oe=p.stateNode.containerInfo;Oe.nodeType===1?Oe.textContent="":Oe.nodeType===9&&Oe.documentElement&&Oe.removeChild(Oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(yt){lr(p,p.return,yt)}if(h=p.sibling,h!==null){h.return=p.return,zt=h;break}zt=p.return}return Ht=UI,UI=!1,Ht}function J_(h,p,b){var C=p.updateQueue;if(C=C!==null?C.lastEffect:null,C!==null){var N=C=C.next;do{if((N.tag&h)===h){var B=N.destroy;N.destroy=void 0,B!==void 0&&eE(p,b,B)}N=N.next}while(N!==C)}}function lx(h,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var b=p=p.next;do{if((b.tag&h)===h){var C=b.create;b.destroy=C()}b=b.next}while(b!==p)}}function tE(h){var p=h.ref;if(p!==null){var b=h.stateNode;switch(h.tag){case 5:h=b;break;default:h=b}typeof p=="function"?p(h):p.current=h}}function BI(h){var p=h.alternate;p!==null&&(h.alternate=null,BI(p)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(p=h.stateNode,p!==null&&(delete p[Qi],delete p[Ul],delete p[Zo],delete p[Wh],delete p[jh])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function zI(h){return h.tag===5||h.tag===3||h.tag===4}function VI(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||zI(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function nE(h,p,b){var C=h.tag;if(C===5||C===6)h=h.stateNode,p?b.nodeType===8?b.parentNode.insertBefore(h,p):b.insertBefore(h,p):(b.nodeType===8?(p=b.parentNode,p.insertBefore(h,b)):(p=b,p.appendChild(h)),b=b._reactRootContainer,b!=null||p.onclick!==null||(p.onclick=Je));else if(C!==4&&(h=h.child,h!==null))for(nE(h,p,b),h=h.sibling;h!==null;)nE(h,p,b),h=h.sibling}function iE(h,p,b){var C=h.tag;if(C===5||C===6)h=h.stateNode,p?b.insertBefore(h,p):b.appendChild(h);else if(C!==4&&(h=h.child,h!==null))for(iE(h,p,b),h=h.sibling;h!==null;)iE(h,p,b),h=h.sibling}var zs=null,Gl=!1;function sf(h,p,b){for(b=b.child;b!==null;)HI(h,p,b),b=b.sibling}function HI(h,p,b){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Mi,b)}catch{}switch(b.tag){case 5:no||Um(b,p);case 6:var C=zs,N=Gl;zs=null,sf(h,p,b),zs=C,Gl=N,zs!==null&&(Gl?(h=zs,b=b.stateNode,h.nodeType===8?h.parentNode.removeChild(b):h.removeChild(b)):zs.removeChild(b.stateNode));break;case 18:zs!==null&&(Gl?(h=zs,b=b.stateNode,h.nodeType===8?Hh(h.parentNode,b):h.nodeType===1&&Hh(h,b),bo(h)):Hh(zs,b.stateNode));break;case 4:C=zs,N=Gl,zs=b.stateNode.containerInfo,Gl=!0,sf(h,p,b),zs=C,Gl=N;break;case 0:case 11:case 14:case 15:if(!no&&(C=b.updateQueue,C!==null&&(C=C.lastEffect,C!==null))){N=C=C.next;do{var B=N,Z=B.destroy;B=B.tag,Z!==void 0&&((B&2)!==0||(B&4)!==0)&&eE(b,p,Z),N=N.next}while(N!==C)}sf(h,p,b);break;case 1:if(!no&&(Um(b,p),C=b.stateNode,typeof C.componentWillUnmount=="function"))try{C.props=b.memoizedProps,C.state=b.memoizedState,C.componentWillUnmount()}catch(ue){lr(b,p,ue)}sf(h,p,b);break;case 21:sf(h,p,b);break;case 22:b.mode&1?(no=(C=no)||b.memoizedState!==null,sf(h,p,b),no=C):sf(h,p,b);break;default:sf(h,p,b)}}function WI(h){var p=h.updateQueue;if(p!==null){h.updateQueue=null;var b=h.stateNode;b===null&&(b=h.stateNode=new E9),p.forEach(function(C){var N=N9.bind(null,h,C);b.has(C)||(b.add(C),C.then(N,N))})}}function Yl(h,p){var b=p.deletions;if(b!==null)for(var C=0;C<b.length;C++){var N=b[C];try{var B=h,Z=p,ue=Z;e:for(;ue!==null;){switch(ue.tag){case 5:zs=ue.stateNode,Gl=!1;break e;case 3:zs=ue.stateNode.containerInfo,Gl=!0;break e;case 4:zs=ue.stateNode.containerInfo,Gl=!0;break e}ue=ue.return}if(zs===null)throw Error(t(160));HI(B,Z,N),zs=null,Gl=!1;var _e=N.alternate;_e!==null&&(_e.return=null),N.return=null}catch(Ue){lr(N,p,Ue)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)jI(p,h),p=p.sibling}function jI(h,p){var b=h.alternate,C=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(Yl(p,h),Bc(h),C&4){try{J_(3,h,h.return),lx(3,h)}catch(Gt){lr(h,h.return,Gt)}try{J_(5,h,h.return)}catch(Gt){lr(h,h.return,Gt)}}break;case 1:Yl(p,h),Bc(h),C&512&&b!==null&&Um(b,b.return);break;case 5:if(Yl(p,h),Bc(h),C&512&&b!==null&&Um(b,b.return),h.flags&32){var N=h.stateNode;try{dt(N,"")}catch(Gt){lr(h,h.return,Gt)}}if(C&4&&(N=h.stateNode,N!=null)){var B=h.memoizedProps,Z=b!==null?b.memoizedProps:B,ue=h.type,_e=h.updateQueue;if(h.updateQueue=null,_e!==null)try{ue==="input"&&B.type==="radio"&&B.name!=null&&Ke(N,B),$e(ue,Z);var Ue=$e(ue,B);for(Z=0;Z<_e.length;Z+=2){var st=_e[Z],ft=_e[Z+1];st==="style"?ht(N,ft):st==="dangerouslySetInnerHTML"?Bt(N,ft):st==="children"?dt(N,ft):M(N,st,ft,Ue)}switch(ue){case"input":Ut(N,B);break;case"textarea":Q(N,B);break;case"select":var rt=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!B.multiple;var kt=B.value;kt!=null?ln(N,!!B.multiple,kt,!1):rt!==!!B.multiple&&(B.defaultValue!=null?ln(N,!!B.multiple,B.defaultValue,!0):ln(N,!!B.multiple,B.multiple?[]:"",!1))}N[Ul]=B}catch(Gt){lr(h,h.return,Gt)}}break;case 6:if(Yl(p,h),Bc(h),C&4){if(h.stateNode===null)throw Error(t(162));N=h.stateNode,B=h.memoizedProps;try{N.nodeValue=B}catch(Gt){lr(h,h.return,Gt)}}break;case 3:if(Yl(p,h),Bc(h),C&4&&b!==null&&b.memoizedState.isDehydrated)try{bo(p.containerInfo)}catch(Gt){lr(h,h.return,Gt)}break;case 4:Yl(p,h),Bc(h);break;case 13:Yl(p,h),Bc(h),N=h.child,N.flags&8192&&(B=N.memoizedState!==null,N.stateNode.isHidden=B,!B||N.alternate!==null&&N.alternate.memoizedState!==null||(oE=Mt())),C&4&&WI(h);break;case 22:if(st=b!==null&&b.memoizedState!==null,h.mode&1?(no=(Ue=no)||st,Yl(p,h),no=Ue):Yl(p,h),Bc(h),C&8192){if(Ue=h.memoizedState!==null,(h.stateNode.isHidden=Ue)&&!st&&(h.mode&1)!==0)for(zt=h,st=h.child;st!==null;){for(ft=zt=st;zt!==null;){switch(rt=zt,kt=rt.child,rt.tag){case 0:case 11:case 14:case 15:J_(4,rt,rt.return);break;case 1:Um(rt,rt.return);var Ht=rt.stateNode;if(typeof Ht.componentWillUnmount=="function"){C=rt,b=rt.return;try{p=C,Ht.props=p.memoizedProps,Ht.state=p.memoizedState,Ht.componentWillUnmount()}catch(Gt){lr(C,b,Gt)}}break;case 5:Um(rt,rt.return);break;case 22:if(rt.memoizedState!==null){GI(ft);continue}}kt!==null?(kt.return=rt,zt=kt):GI(ft)}st=st.sibling}e:for(st=null,ft=h;;){if(ft.tag===5){if(st===null){st=ft;try{N=ft.stateNode,Ue?(B=N.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none"):(ue=ft.stateNode,_e=ft.memoizedProps.style,Z=_e!=null&&_e.hasOwnProperty("display")?_e.display:null,ue.style.display=Mn("display",Z))}catch(Gt){lr(h,h.return,Gt)}}}else if(ft.tag===6){if(st===null)try{ft.stateNode.nodeValue=Ue?"":ft.memoizedProps}catch(Gt){lr(h,h.return,Gt)}}else if((ft.tag!==22&&ft.tag!==23||ft.memoizedState===null||ft===h)&&ft.child!==null){ft.child.return=ft,ft=ft.child;continue}if(ft===h)break e;for(;ft.sibling===null;){if(ft.return===null||ft.return===h)break e;st===ft&&(st=null),ft=ft.return}st===ft&&(st=null),ft.sibling.return=ft.return,ft=ft.sibling}}break;case 19:Yl(p,h),Bc(h),C&4&&WI(h);break;case 21:break;default:Yl(p,h),Bc(h)}}function Bc(h){var p=h.flags;if(p&2){try{e:{for(var b=h.return;b!==null;){if(zI(b)){var C=b;break e}b=b.return}throw Error(t(160))}switch(C.tag){case 5:var N=C.stateNode;C.flags&32&&(dt(N,""),C.flags&=-33);var B=VI(h);iE(h,B,N);break;case 3:case 4:var Z=C.stateNode.containerInfo,ue=VI(h);nE(h,ue,Z);break;default:throw Error(t(161))}}catch(_e){lr(h,h.return,_e)}h.flags&=-3}p&4096&&(h.flags&=-4097)}function M9(h,p,b){zt=h,$I(h)}function $I(h,p,b){for(var C=(h.mode&1)!==0;zt!==null;){var N=zt,B=N.child;if(N.tag===22&&C){var Z=N.memoizedState!==null||ax;if(!Z){var ue=N.alternate,_e=ue!==null&&ue.memoizedState!==null||no;ue=ax;var Ue=no;if(ax=Z,(no=_e)&&!Ue)for(zt=N;zt!==null;)Z=zt,_e=Z.child,Z.tag===22&&Z.memoizedState!==null?YI(N):_e!==null?(_e.return=Z,zt=_e):YI(N);for(;B!==null;)zt=B,$I(B),B=B.sibling;zt=N,ax=ue,no=Ue}XI(h)}else(N.subtreeFlags&8772)!==0&&B!==null?(B.return=N,zt=B):XI(h)}}function XI(h){for(;zt!==null;){var p=zt;if((p.flags&8772)!==0){var b=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:no||lx(5,p);break;case 1:var C=p.stateNode;if(p.flags&4&&!no)if(b===null)C.componentDidMount();else{var N=p.elementType===p.type?b.memoizedProps:Ia(p.type,b.memoizedProps);C.componentDidUpdate(N,b.memoizedState,C.__reactInternalSnapshotBeforeUpdate)}var B=p.updateQueue;B!==null&&er(p,B,C);break;case 3:var Z=p.updateQueue;if(Z!==null){if(b=null,p.child!==null)switch(p.child.tag){case 5:b=p.child.stateNode;break;case 1:b=p.child.stateNode}er(p,Z,b)}break;case 5:var ue=p.stateNode;if(b===null&&p.flags&4){b=ue;var _e=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":_e.autoFocus&&b.focus();break;case"img":_e.src&&(b.src=_e.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Ue=p.alternate;if(Ue!==null){var st=Ue.memoizedState;if(st!==null){var ft=st.dehydrated;ft!==null&&bo(ft)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}no||p.flags&512&&tE(p)}catch(rt){lr(p,p.return,rt)}}if(p===h){zt=null;break}if(b=p.sibling,b!==null){b.return=p.return,zt=b;break}zt=p.return}}function GI(h){for(;zt!==null;){var p=zt;if(p===h){zt=null;break}var b=p.sibling;if(b!==null){b.return=p.return,zt=b;break}zt=p.return}}function YI(h){for(;zt!==null;){var p=zt;try{switch(p.tag){case 0:case 11:case 15:var b=p.return;try{lx(4,p)}catch(_e){lr(p,b,_e)}break;case 1:var C=p.stateNode;if(typeof C.componentDidMount=="function"){var N=p.return;try{C.componentDidMount()}catch(_e){lr(p,N,_e)}}var B=p.return;try{tE(p)}catch(_e){lr(p,B,_e)}break;case 5:var Z=p.return;try{tE(p)}catch(_e){lr(p,Z,_e)}}}catch(_e){lr(p,p.return,_e)}if(p===h){zt=null;break}var ue=p.sibling;if(ue!==null){ue.return=p.return,zt=ue;break}zt=p.return}}var C9=Math.ceil,cx=I.ReactCurrentDispatcher,rE=I.ReactCurrentOwner,ol=I.ReactCurrentBatchConfig,Yn=0,gs=null,Br=null,Vs=0,Na=0,Bm=Hi(0),Kr=0,Q_=null,Fd=0,ux=0,sE=0,ey=null,ia=null,oE=0,zm=1/0,zu=null,hx=!1,aE=null,of=null,fx=!1,af=null,dx=0,ty=0,lE=null,px=-1,mx=0;function Io(){return(Yn&6)!==0?Mt():px!==-1?px:px=Mt()}function lf(h){return(h.mode&1)===0?1:(Yn&2)!==0&&Vs!==0?Vs&-Vs:ZT.transition!==null?(mx===0&&(mx=os()),mx):(h=In,h!==0||(h=window.event,h=h===void 0?16:Nn(h.type)),h)}function ql(h,p,b,C){if(50<ty)throw ty=0,lE=null,Error(t(185));vo(h,b,C),((Yn&2)===0||h!==gs)&&(h===gs&&((Yn&2)===0&&(ux|=b),Kr===4&&cf(h,Vs)),ra(h,C),b===1&&Yn===0&&(p.mode&1)===0&&(zm=Mt()+500,Ed&&tl()))}function ra(h,p){var b=h.callbackNode;ki(h,p);var C=Fn(h,h===gs?Vs:0);if(C===0)b!==null&&Et(b),h.callbackNode=null,h.callbackPriority=0;else if(p=C&-C,h.callbackPriority!==p){if(b!=null&&Et(b),p===1)h.tag===0?X0(ZI.bind(null,h)):Ad(ZI.bind(null,h)),ds(function(){(Yn&6)===0&&tl()}),b=null;else{switch(Ho(C)){case 1:b=rn;break;case 4:b=un;break;case 16:b=ri;break;case 536870912:b=Gn;break;default:b=ri}b=r3(b,qI.bind(null,h))}h.callbackPriority=p,h.callbackNode=b}}function qI(h,p){if(px=-1,mx=0,(Yn&6)!==0)throw Error(t(327));var b=h.callbackNode;if(Vm()&&h.callbackNode!==b)return null;var C=Fn(h,h===gs?Vs:0);if(C===0)return null;if((C&30)!==0||(C&h.expiredLanes)!==0||p)p=gx(h,C);else{p=C;var N=Yn;Yn|=2;var B=JI();(gs!==h||Vs!==p)&&(zu=null,zm=Mt()+500,Bd(h,p));do try{I9();break}catch(ue){KI(h,ue)}while(!0);Yh(),cx.current=B,Yn=N,Br!==null?p=0:(gs=null,Vs=0,p=Kr)}if(p!==0){if(p===2&&(N=Ki(h),N!==0&&(C=N,p=cE(h,N))),p===1)throw b=Q_,Bd(h,0),cf(h,C),ra(h,Mt()),b;if(p===6)cf(h,C);else{if(N=h.current.alternate,(C&30)===0&&!P9(N)&&(p=gx(h,C),p===2&&(B=Ki(h),B!==0&&(C=B,p=cE(h,B))),p===1))throw b=Q_,Bd(h,0),cf(h,C),ra(h,Mt()),b;switch(h.finishedWork=N,h.finishedLanes=C,p){case 0:case 1:throw Error(t(345));case 2:zd(h,ia,zu);break;case 3:if(cf(h,C),(C&130023424)===C&&(p=oE+500-Mt(),10<p)){if(Fn(h,0)!==0)break;if(N=h.suspendedLanes,(N&C)!==C){Io(),h.pingedLanes|=h.suspendedLanes&N;break}h.timeoutHandle=br(zd.bind(null,h,ia,zu),p);break}zd(h,ia,zu);break;case 4:if(cf(h,C),(C&4194240)===C)break;for(p=h.eventTimes,N=-1;0<C;){var Z=31-Qt(C);B=1<<Z,Z=p[Z],Z>N&&(N=Z),C&=~B}if(C=N,C=Mt()-C,C=(120>C?120:480>C?480:1080>C?1080:1920>C?1920:3e3>C?3e3:4320>C?4320:1960*C9(C/1960))-C,10<C){h.timeoutHandle=br(zd.bind(null,h,ia,zu),C);break}zd(h,ia,zu);break;case 5:zd(h,ia,zu);break;default:throw Error(t(329))}}}return ra(h,Mt()),h.callbackNode===b?qI.bind(null,h):null}function cE(h,p){var b=ey;return h.current.memoizedState.isDehydrated&&(Bd(h,p).flags|=256),h=gx(h,p),h!==2&&(p=ia,ia=b,p!==null&&uE(p)),h}function uE(h){ia===null?ia=h:ia.push.apply(ia,h)}function P9(h){for(var p=h;;){if(p.flags&16384){var b=p.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var C=0;C<b.length;C++){var N=b[C],B=N.getSnapshot;N=N.value;try{if(!Is(B(),N))return!1}catch{return!1}}}if(b=p.child,p.subtreeFlags&16384&&b!==null)b.return=p,p=b;else{if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function cf(h,p){for(p&=~sE,p&=~ux,h.suspendedLanes|=p,h.pingedLanes&=~p,h=h.expirationTimes;0<p;){var b=31-Qt(p),C=1<<b;h[b]=-1,p&=~C}}function ZI(h){if((Yn&6)!==0)throw Error(t(327));Vm();var p=Fn(h,0);if((p&1)===0)return ra(h,Mt()),null;var b=gx(h,p);if(h.tag!==0&&b===2){var C=Ki(h);C!==0&&(p=C,b=cE(h,C))}if(b===1)throw b=Q_,Bd(h,0),cf(h,p),ra(h,Mt()),b;if(b===6)throw Error(t(345));return h.finishedWork=h.current.alternate,h.finishedLanes=p,zd(h,ia,zu),ra(h,Mt()),null}function hE(h,p){var b=Yn;Yn|=1;try{return h(p)}finally{Yn=b,Yn===0&&(zm=Mt()+500,Ed&&tl())}}function Ud(h){af!==null&&af.tag===0&&(Yn&6)===0&&Vm();var p=Yn;Yn|=1;var b=ol.transition,C=In;try{if(ol.transition=null,In=1,h)return h()}finally{In=C,ol.transition=b,Yn=p,(Yn&6)===0&&tl()}}function fE(){Na=Bm.current,gi(Bm)}function Bd(h,p){h.finishedWork=null,h.finishedLanes=0;var b=h.timeoutHandle;if(b!==-1&&(h.timeoutHandle=-1,Vi(b)),Br!==null)for(b=Br.return;b!==null;){var C=b;switch(Hl(C),C.tag){case 1:C=C.type.childContextTypes,C!=null&&Sd();break;case 3:il(),gi(Os),gi(qr),eo();break;case 5:ef(C);break;case 4:il();break;case 13:gi(_i);break;case 19:gi(_i);break;case 10:qh(C.type._context);break;case 22:case 23:fE()}b=b.return}if(gs=h,Br=h=uf(h.current,null),Vs=Na=p,Kr=0,Q_=null,sE=ux=Fd=0,ia=ey=null,ka!==null){for(p=0;p<ka.length;p++)if(b=ka[p],C=b.interleaved,C!==null){b.interleaved=null;var N=C.next,B=b.pending;if(B!==null){var Z=B.next;B.next=N,C.next=Z}b.pending=C}ka=null}return h}function KI(h,p){do{var b=Br;try{if(Yh(),Uu.current=g,La){for(var C=Ti.memoizedState;C!==null;){var N=C.queue;N!==null&&(N.pending=null),C=C.next}La=!1}if(Nc=0,Ur=tr=Ti=null,tf=!1,nf=0,rE.current=null,b===null||b.return===null){Kr=1,Q_=p,Br=null;break}e:{var B=h,Z=b.return,ue=b,_e=p;if(p=Vs,ue.flags|=32768,_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var Ue=_e,st=ue,ft=st.tag;if((st.mode&1)===0&&(ft===0||ft===11||ft===15)){var rt=st.alternate;rt?(st.updateQueue=rt.updateQueue,st.memoizedState=rt.memoizedState,st.lanes=rt.lanes):(st.updateQueue=null,st.memoizedState=null)}var kt=_n(Z);if(kt!==null){kt.flags&=-257,tn(kt,Z,ue,B,p),kt.mode&1&&Nt(B,Ue,p),p=kt,_e=Ue;var Ht=p.updateQueue;if(Ht===null){var Gt=new Set;Gt.add(_e),p.updateQueue=Gt}else Ht.add(_e);break e}else{if((p&1)===0){Nt(B,Ue,p),dE();break e}_e=Error(t(426))}}else if(Si&&ue.mode&1){var Sr=_n(Z);if(Sr!==null){(Sr.flags&65536)===0&&(Sr.flags|=256),tn(Sr,Z,ue,B,p),Gh(F(_e,ue));break e}}B=_e=F(_e,ue),Kr!==4&&(Kr=2),ey===null?ey=[B]:ey.push(B),B=Z;do{switch(B.tag){case 3:B.flags|=65536,p&=-p,B.lanes|=p;var ke=Xe(B,_e,p);En(B,ke);break e;case 1:ue=_e;var xe=B.type,Oe=B.stateNode;if((B.flags&128)===0&&(typeof xe.getDerivedStateFromError=="function"||Oe!==null&&typeof Oe.componentDidCatch=="function"&&(of===null||!of.has(Oe)))){B.flags|=65536,p&=-p,B.lanes|=p;var yt=_t(B,ue,p);En(B,yt);break e}}B=B.return}while(B!==null)}e3(b)}catch(Kt){p=Kt,Br===b&&b!==null&&(Br=b=b.return);continue}break}while(!0)}function JI(){var h=cx.current;return cx.current=g,h===null?g:h}function dE(){(Kr===0||Kr===3||Kr===2)&&(Kr=4),gs===null||(Fd&268435455)===0&&(ux&268435455)===0||cf(gs,Vs)}function gx(h,p){var b=Yn;Yn|=2;var C=JI();(gs!==h||Vs!==p)&&(zu=null,Bd(h,p));do try{R9();break}catch(N){KI(h,N)}while(!0);if(Yh(),Yn=b,cx.current=C,Br!==null)throw Error(t(261));return gs=null,Vs=0,Kr}function R9(){for(;Br!==null;)QI(Br)}function I9(){for(;Br!==null&&!Yt();)QI(Br)}function QI(h){var p=i3(h.alternate,h,Na);h.memoizedProps=h.pendingProps,p===null?e3(h):Br=p,rE.current=null}function e3(h){var p=h;do{var b=p.alternate;if(h=p.return,(p.flags&32768)===0){if(b=S9(b,p,Na),b!==null){Br=b;return}}else{if(b=T9(b,p),b!==null){b.flags&=32767,Br=b;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{Kr=6,Br=null;return}}if(p=p.sibling,p!==null){Br=p;return}Br=p=h}while(p!==null);Kr===0&&(Kr=5)}function zd(h,p,b){var C=In,N=ol.transition;try{ol.transition=null,In=1,k9(h,p,b,C)}finally{ol.transition=N,In=C}return null}function k9(h,p,b,C){do Vm();while(af!==null);if((Yn&6)!==0)throw Error(t(327));b=h.finishedWork;var N=h.finishedLanes;if(b===null)return null;if(h.finishedWork=null,h.finishedLanes=0,b===h.current)throw Error(t(177));h.callbackNode=null,h.callbackPriority=0;var B=b.lanes|b.childLanes;if(Ui(h,B),h===gs&&(Br=gs=null,Vs=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||fx||(fx=!0,r3(ri,function(){return Vm(),null})),B=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||B){B=ol.transition,ol.transition=null;var Z=In;In=1;var ue=Yn;Yn|=4,rE.current=null,A9(h,b),jI(b,h),ei(en),Ss=!!wt,en=wt=null,h.current=b,M9(b),Jt(),Yn=ue,In=Z,ol.transition=B}else h.current=b;if(fx&&(fx=!1,af=h,dx=N),B=h.pendingLanes,B===0&&(of=null),It(b.stateNode),ra(h,Mt()),p!==null)for(C=h.onRecoverableError,b=0;b<p.length;b++)N=p[b],C(N.value,{componentStack:N.stack,digest:N.digest});if(hx)throw hx=!1,h=aE,aE=null,h;return(dx&1)!==0&&h.tag!==0&&Vm(),B=h.pendingLanes,(B&1)!==0?h===lE?ty++:(ty=0,lE=h):ty=0,tl(),null}function Vm(){if(af!==null){var h=Ho(dx),p=ol.transition,b=In;try{if(ol.transition=null,In=16>h?16:h,af===null)var C=!1;else{if(h=af,af=null,dx=0,(Yn&6)!==0)throw Error(t(331));var N=Yn;for(Yn|=4,zt=h.current;zt!==null;){var B=zt,Z=B.child;if((zt.flags&16)!==0){var ue=B.deletions;if(ue!==null){for(var _e=0;_e<ue.length;_e++){var Ue=ue[_e];for(zt=Ue;zt!==null;){var st=zt;switch(st.tag){case 0:case 11:case 15:J_(8,st,B)}var ft=st.child;if(ft!==null)ft.return=st,zt=ft;else for(;zt!==null;){st=zt;var rt=st.sibling,kt=st.return;if(BI(st),st===Ue){zt=null;break}if(rt!==null){rt.return=kt,zt=rt;break}zt=kt}}}var Ht=B.alternate;if(Ht!==null){var Gt=Ht.child;if(Gt!==null){Ht.child=null;do{var Sr=Gt.sibling;Gt.sibling=null,Gt=Sr}while(Gt!==null)}}zt=B}}if((B.subtreeFlags&2064)!==0&&Z!==null)Z.return=B,zt=Z;else e:for(;zt!==null;){if(B=zt,(B.flags&2048)!==0)switch(B.tag){case 0:case 11:case 15:J_(9,B,B.return)}var ke=B.sibling;if(ke!==null){ke.return=B.return,zt=ke;break e}zt=B.return}}var xe=h.current;for(zt=xe;zt!==null;){Z=zt;var Oe=Z.child;if((Z.subtreeFlags&2064)!==0&&Oe!==null)Oe.return=Z,zt=Oe;else e:for(Z=xe;zt!==null;){if(ue=zt,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:lx(9,ue)}}catch(Kt){lr(ue,ue.return,Kt)}if(ue===Z){zt=null;break e}var yt=ue.sibling;if(yt!==null){yt.return=ue.return,zt=yt;break e}zt=ue.return}}if(Yn=N,tl(),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Mi,h)}catch{}C=!0}return C}finally{In=b,ol.transition=p}}return!1}function t3(h,p,b){p=F(b,p),p=Xe(h,p,1),h=nl(h,p,1),p=Io(),h!==null&&(vo(h,1,p),ra(h,p))}function lr(h,p,b){if(h.tag===3)t3(h,h,b);else for(;p!==null;){if(p.tag===3){t3(p,h,b);break}else if(p.tag===1){var C=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(of===null||!of.has(C))){h=F(b,h),h=_t(p,h,1),p=nl(p,h,1),h=Io(),p!==null&&(vo(p,1,h),ra(p,h));break}}p=p.return}}function O9(h,p,b){var C=h.pingCache;C!==null&&C.delete(p),p=Io(),h.pingedLanes|=h.suspendedLanes&b,gs===h&&(Vs&b)===b&&(Kr===4||Kr===3&&(Vs&130023424)===Vs&&500>Mt()-oE?Bd(h,0):sE|=b),ra(h,p)}function n3(h,p){p===0&&((h.mode&1)===0?p=1:(p=bi,bi<<=1,(bi&130023424)===0&&(bi=4194304)));var b=Io();h=Oa(h,p),h!==null&&(vo(h,p,b),ra(h,b))}function L9(h){var p=h.memoizedState,b=0;p!==null&&(b=p.retryLane),n3(h,b)}function N9(h,p){var b=0;switch(h.tag){case 13:var C=h.stateNode,N=h.memoizedState;N!==null&&(b=N.retryLane);break;case 19:C=h.stateNode;break;default:throw Error(t(314))}C!==null&&C.delete(p),n3(h,b)}var i3;i3=function(h,p,b){if(h!==null)if(h.memoizedProps!==p.pendingProps||Os.current)Pt=!0;else{if((h.lanes&b)===0&&(p.flags&128)===0)return Pt=!1,w9(h,p,b);Pt=(h.flags&131072)!==0}else Pt=!1,Si&&(p.flags&1048576)!==0&&V_(p,wm,p.index);switch(p.lanes=0,p.tag){case 2:var C=p.type;ox(h,p),h=p.pendingProps;var N=Ru(p,qr.current);Wl(p,b),N=Im(null,p,C,h,N,b);var B=Id();return p.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,ps(C)?(B=!0,Iu(p)):B=!1,p.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,Rd(p),N.updater=$l,p.stateNode=N,N._reactInternals=p,Jh(p,C,h,b),p=mn(null,p,C,!0,B,b)):(p.tag=0,Si&&B&&H_(p),Zn(null,p,N,b),p=p.child),p;case 16:C=p.elementType;e:{switch(ox(h,p),h=p.pendingProps,N=C._init,C=N(C._payload),p.type=C,N=p.tag=F9(C),h=Ia(C,h),N){case 0:p=Xt(null,p,C,h,b);break e;case 1:p=Sn(null,p,C,h,b);break e;case 11:p=Ro(null,p,C,h,b);break e;case 14:p=Le(null,p,C,Ia(C.type,h),b);break e}throw Error(t(306,C,""))}return p;case 0:return C=p.type,N=p.pendingProps,N=p.elementType===C?N:Ia(C,N),Xt(h,p,C,N,b);case 1:return C=p.type,N=p.pendingProps,N=p.elementType===C?N:Ia(C,N),Sn(h,p,C,N,b);case 3:e:{if($n(p),h===null)throw Error(t(387));C=p.pendingProps,B=p.memoizedState,N=B.element,G0(h,p),Li(p,C,null,b);var Z=p.memoizedState;if(C=Z.element,B.isDehydrated)if(B={element:C,isDehydrated:!1,cache:Z.cache,pendingSuspenseBoundaries:Z.pendingSuspenseBoundaries,transitions:Z.transitions},p.updateQueue.baseState=B,p.memoizedState=B,p.flags&256){N=F(Error(t(423)),p),p=wr(h,p,C,b,N);break e}else if(C!==N){N=F(Error(t(424)),p),p=wr(h,p,C,b,N);break e}else for(Ns=Pa(p.stateNode.containerInfo.firstChild),Zr=p,Si=!0,Jo=null,b=Fu(p,null,C,b),p.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Rc(),C===N){p=Bu(h,p,b);break e}Zn(h,p,C,b)}p=p.child}return p;case 5:return Pm(p),h===null&&Tm(p),C=p.type,N=p.pendingProps,B=h!==null?h.memoizedProps:null,Z=N.children,bn(C,N)?Z=null:B!==null&&bn(C,B)&&(p.flags|=32),At(h,p),Zn(h,p,Z,b),p.child;case 6:return h===null&&Tm(p),null;case 13:return rx(h,p,b);case 4:return Qh(p,p.stateNode.containerInfo),C=p.pendingProps,h===null?p.child=kc(p,null,C,b):Zn(h,p,C,b),p.child;case 11:return C=p.type,N=p.pendingProps,N=p.elementType===C?N:Ia(C,N),Ro(h,p,C,N,b);case 7:return Zn(h,p,p.pendingProps,b),p.child;case 8:return Zn(h,p,p.pendingProps.children,b),p.child;case 12:return Zn(h,p,p.pendingProps.children,b),p.child;case 10:e:{if(C=p.type._context,N=p.pendingProps,B=p.memoizedProps,Z=N.value,ci(Md,C._currentValue),C._currentValue=Z,B!==null)if(Is(B.value,Z)){if(B.children===N.children&&!Os.current){p=Bu(h,p,b);break e}}else for(B=p.child,B!==null&&(B.return=p);B!==null;){var ue=B.dependencies;if(ue!==null){Z=B.child;for(var _e=ue.firstContext;_e!==null;){if(_e.context===C){if(B.tag===1){_e=Qo(-1,b&-b),_e.tag=2;var Ue=B.updateQueue;if(Ue!==null){Ue=Ue.shared;var st=Ue.pending;st===null?_e.next=_e:(_e.next=st.next,st.next=_e),Ue.pending=_e}}B.lanes|=b,_e=B.alternate,_e!==null&&(_e.lanes|=b),Zh(B.return,b,p),ue.lanes|=b;break}_e=_e.next}}else if(B.tag===10)Z=B.type===p.type?null:B.child;else if(B.tag===18){if(Z=B.return,Z===null)throw Error(t(341));Z.lanes|=b,ue=Z.alternate,ue!==null&&(ue.lanes|=b),Zh(Z,b,p),Z=B.sibling}else Z=B.child;if(Z!==null)Z.return=B;else for(Z=B;Z!==null;){if(Z===p){Z=null;break}if(B=Z.sibling,B!==null){B.return=Z.return,Z=B;break}Z=Z.return}B=Z}Zn(h,p,N.children,b),p=p.child}return p;case 9:return N=p.type,C=p.pendingProps.children,Wl(p,b),N=Ds(N),C=C(N),p.flags|=1,Zn(h,p,C,b),p.child;case 14:return C=p.type,N=Ia(C,p.pendingProps),N=Ia(C.type,N),Le(h,p,C,N,b);case 15:return Ee(h,p,p.type,p.pendingProps,b);case 17:return C=p.type,N=p.pendingProps,N=p.elementType===C?N:Ia(C,N),ox(h,p),p.tag=1,ps(C)?(h=!0,Iu(p)):h=!1,Wl(p,b),Kh(p,C,N),Jh(p,C,N,b),mn(null,p,C,!0,h,b);case 19:return LI(h,p,b);case 22:return We(h,p,b)}throw Error(t(156,p.tag))};function r3(h,p){return je(h,p)}function D9(h,p,b,C){this.tag=h,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function al(h,p,b,C){return new D9(h,p,b,C)}function pE(h){return h=h.prototype,!(!h||!h.isReactComponent)}function F9(h){if(typeof h=="function")return pE(h)?1:0;if(h!=null){if(h=h.$$typeof,h===le)return 11;if(h===de)return 14}return 2}function uf(h,p){var b=h.alternate;return b===null?(b=al(h.tag,p,h.key,h.mode),b.elementType=h.elementType,b.type=h.type,b.stateNode=h.stateNode,b.alternate=h,h.alternate=b):(b.pendingProps=p,b.type=h.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=h.flags&14680064,b.childLanes=h.childLanes,b.lanes=h.lanes,b.child=h.child,b.memoizedProps=h.memoizedProps,b.memoizedState=h.memoizedState,b.updateQueue=h.updateQueue,p=h.dependencies,b.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},b.sibling=h.sibling,b.index=h.index,b.ref=h.ref,b}function _x(h,p,b,C,N,B){var Z=2;if(C=h,typeof h=="function")pE(h)&&(Z=1);else if(typeof h=="string")Z=5;else e:switch(h){case H:return Vd(b.children,N,B,p);case W:Z=8,N|=8;break;case z:return h=al(12,b,p,N|2),h.elementType=z,h.lanes=B,h;case ge:return h=al(13,b,p,N),h.elementType=ge,h.lanes=B,h;case te:return h=al(19,b,p,N),h.elementType=te,h.lanes=B,h;case me:return yx(b,N,B,p);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case j:Z=10;break e;case J:Z=9;break e;case le:Z=11;break e;case de:Z=14;break e;case ve:Z=16,C=null;break e}throw Error(t(130,h==null?h:typeof h,""))}return p=al(Z,b,p,N),p.elementType=h,p.type=C,p.lanes=B,p}function Vd(h,p,b,C){return h=al(7,h,C,p),h.lanes=b,h}function yx(h,p,b,C){return h=al(22,h,C,p),h.elementType=me,h.lanes=b,h.stateNode={isHidden:!1},h}function mE(h,p,b){return h=al(6,h,null,p),h.lanes=b,h}function gE(h,p,b){return p=al(4,h.children!==null?h.children:[],h.key,p),p.lanes=b,p.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},p}function U9(h,p,b,C,N){this.tag=p,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ya(0),this.expirationTimes=ya(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ya(0),this.identifierPrefix=C,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function _E(h,p,b,C,N,B,Z,ue,_e){return h=new U9(h,p,b,ue,_e),p===1?(p=1,B===!0&&(p|=8)):p=0,B=al(3,null,null,p),h.current=B,B.stateNode=h,B.memoizedState={element:C,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rd(B),h}function B9(h,p,b){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:C==null?null:""+C,children:h,containerInfo:p,implementation:b}}function s3(h){if(!h)return Bl;h=h._reactInternals;e:{if(Vo(h)!==h||h.tag!==1)throw Error(t(170));var p=h;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(ps(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(h.tag===1){var b=h.type;if(ps(b))return Td(h,b,p)}return p}function o3(h,p,b,C,N,B,Z,ue,_e){return h=_E(b,C,!0,h,N,B,Z,ue,_e),h.context=s3(null),b=h.current,C=Io(),N=lf(b),B=Qo(C,N),B.callback=p??null,nl(b,B,N),h.current.lanes=N,vo(h,N,C),ra(h,C),h}function vx(h,p,b,C){var N=p.current,B=Io(),Z=lf(N);return b=s3(b),p.context===null?p.context=b:p.pendingContext=b,p=Qo(B,Z),p.payload={element:h},C=C===void 0?null:C,C!==null&&(p.callback=C),h=nl(N,p,Z),h!==null&&(ql(h,N,Z,B),Pi(h,N,Z)),Z}function xx(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return h.child.stateNode;default:return h.child.stateNode}}function a3(h,p){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var b=h.retryLane;h.retryLane=b!==0&&b<p?b:p}}function yE(h,p){a3(h,p),(h=h.alternate)&&a3(h,p)}function z9(){return null}var l3=typeof reportError=="function"?reportError:function(h){console.error(h)};function vE(h){this._internalRoot=h}bx.prototype.render=vE.prototype.render=function(h){var p=this._internalRoot;if(p===null)throw Error(t(409));vx(h,p,null,null)},bx.prototype.unmount=vE.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var p=h.containerInfo;Ud(function(){vx(null,h,null,null)}),p[Vn]=null}};function bx(h){this._internalRoot=h}bx.prototype.unstable_scheduleHydration=function(h){if(h){var p=_c();h={blockedOn:null,target:h,priority:p};for(var b=0;b<_r.length&&p!==0&&p<_r[b].priority;b++);_r.splice(b,0,h),b===0&&vc(h)}};function xE(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function wx(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function c3(){}function V9(h,p,b,C,N){if(N){if(typeof C=="function"){var B=C;C=function(){var Ue=xx(Z);B.call(Ue)}}var Z=o3(p,C,h,0,null,!1,!1,"",c3);return h._reactRootContainer=Z,h[Vn]=Z.current,Dl(h.nodeType===8?h.parentNode:h),Ud(),Z}for(;N=h.lastChild;)h.removeChild(N);if(typeof C=="function"){var ue=C;C=function(){var Ue=xx(_e);ue.call(Ue)}}var _e=_E(h,0,!1,null,null,!1,!1,"",c3);return h._reactRootContainer=_e,h[Vn]=_e.current,Dl(h.nodeType===8?h.parentNode:h),Ud(function(){vx(p,_e,b,C)}),_e}function Sx(h,p,b,C,N){var B=b._reactRootContainer;if(B){var Z=B;if(typeof N=="function"){var ue=N;N=function(){var _e=xx(Z);ue.call(_e)}}vx(p,Z,h,N)}else Z=V9(b,p,h,N,C);return xx(Z)}wl=function(h){switch(h.tag){case 3:var p=h.stateNode;if(p.current.memoizedState.isDehydrated){var b=Dt(p.pendingLanes);b!==0&&(Xs(p,b|1),ra(p,Mt()),(Yn&6)===0&&(zm=Mt()+500,tl()))}break;case 13:Ud(function(){var C=Oa(h,1);if(C!==null){var N=Io();ql(C,h,1,N)}}),yE(h,1)}},Sl=function(h){if(h.tag===13){var p=Oa(h,134217728);if(p!==null){var b=Io();ql(p,h,134217728,b)}yE(h,134217728)}},Mh=function(h){if(h.tag===13){var p=lf(h),b=Oa(h,p);if(b!==null){var C=Io();ql(b,h,p,C)}yE(h,p)}},_c=function(){return In},Tl=function(h,p){var b=In;try{return In=h,p()}finally{In=b}},jt=function(h,p,b){switch(p){case"input":if(Ut(h,b),p=b.name,b.type==="radio"&&p!=null){for(b=h;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<b.length;p++){var C=b[p];if(C!==h&&C.form===h.form){var N=$h(C);if(!N)throw Error(t(90));he(C),Ut(C,N)}}}break;case"textarea":Q(h,b);break;case"select":p=b.value,p!=null&&ln(h,!!b.multiple,p,!1)}},Vt=hE,vn=Ud;var H9={usingClientEntryPoint:!1,Events:[Mo,Ci,$h,Ge,ut,hE]},ny={findFiberByHostInstance:el,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},W9={bundleType:ny.bundleType,version:ny.version,rendererPackageName:ny.rendererPackageName,rendererConfig:ny.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=ze(h),h===null?null:h.stateNode},findFiberByHostInstance:ny.findFiberByHostInstance||z9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tx.isDisabled&&Tx.supportsFiber)try{Mi=Tx.inject(W9),$t=Tx}catch{}}return sa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H9,sa.createPortal=function(h,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xE(p))throw Error(t(200));return B9(h,p,null,b)},sa.createRoot=function(h,p){if(!xE(h))throw Error(t(299));var b=!1,C="",N=l3;return p!=null&&(p.unstable_strictMode===!0&&(b=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onRecoverableError!==void 0&&(N=p.onRecoverableError)),p=_E(h,1,!1,null,null,b,!1,C,N),h[Vn]=p.current,Dl(h.nodeType===8?h.parentNode:h),new vE(p)},sa.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var p=h._reactInternals;if(p===void 0)throw typeof h.render=="function"?Error(t(188)):(h=Object.keys(h).join(","),Error(t(268,h)));return h=ze(p),h=h===null?null:h.stateNode,h},sa.flushSync=function(h){return Ud(h)},sa.hydrate=function(h,p,b){if(!wx(p))throw Error(t(200));return Sx(null,h,p,!0,b)},sa.hydrateRoot=function(h,p,b){if(!xE(h))throw Error(t(405));var C=b!=null&&b.hydratedSources||null,N=!1,B="",Z=l3;if(b!=null&&(b.unstable_strictMode===!0&&(N=!0),b.identifierPrefix!==void 0&&(B=b.identifierPrefix),b.onRecoverableError!==void 0&&(Z=b.onRecoverableError)),p=o3(p,null,h,1,b??null,N,!1,B,Z),h[Vn]=p.current,Dl(h),C)for(h=0;h<C.length;h++)b=C[h],N=b._getVersion,N=N(b._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[b,N]:p.mutableSourceEagerHydrationData.push(b,N);return new bx(p)},sa.render=function(h,p,b){if(!wx(p))throw Error(t(200));return Sx(null,h,p,!1,b)},sa.unmountComponentAtNode=function(h){if(!wx(h))throw Error(t(40));return h._reactRootContainer?(Ud(function(){Sx(null,null,h,!1,function(){h._reactRootContainer=null,h[Vn]=null})}),!0):!1},sa.unstable_batchedUpdates=hE,sa.unstable_renderSubtreeIntoContainer=function(h,p,b,C){if(!wx(b))throw Error(t(200));if(h==null||h._reactInternals===void 0)throw Error(t(38));return Sx(h,p,b,!1,C)},sa.version="18.2.0-next-9e3b772b8-20220608",sa}var _3;function UB(){if(_3)return SE.exports;_3=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),SE.exports=J9(),SE.exports}var y3;function Q9(){if(y3)return Ex;y3=1;var n=UB();return Ex.createRoot=n.createRoot,Ex.hydrateRoot=n.hydrateRoot,Ex}var e7=Q9(),MP=UB();function dv(){return dv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},dv.apply(this,arguments)}var Lf;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Lf||(Lf={}));const v3="popstate";function t7(n){n===void 0&&(n={});function e(i,r){let{pathname:s,search:o,hash:a}=i.location;return ZA("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Rw(r)}return i7(e,t,null,n)}function Pr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function BB(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function n7(){return Math.random().toString(36).substr(2,8)}function x3(n,e){return{usr:n.state,key:n.key,idx:e}}function ZA(n,e,t,i){return t===void 0&&(t=null),dv({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?w_(e):e,{state:t,key:e&&e.key||i||n7()})}function Rw(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function w_(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function i7(n,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=Lf.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(dv({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Lf.Pop;let S=u(),w=S==null?null:S-c;c=S,l&&l({action:a,location:T.location,delta:w})}function m(S,w){a=Lf.Push;let P=ZA(T.location,S,w);c=u()+1;let M=x3(P,c),I=T.createHref(P);try{o.pushState(M,"",I)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(I)}s&&l&&l({action:a,location:T.location,delta:1})}function y(S,w){a=Lf.Replace;let P=ZA(T.location,S,w);c=u();let M=x3(P,c),I=T.createHref(P);o.replaceState(M,"",I),s&&l&&l({action:a,location:T.location,delta:0})}function x(S){let w=r.location.origin!=="null"?r.location.origin:r.location.href,P=typeof S=="string"?S:Rw(S);return P=P.replace(/ $/,"%20"),Pr(w,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,w)}let T={get action(){return a},get location(){return n(r,o)},listen(S){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(v3,d),l=S,()=>{r.removeEventListener(v3,d),l=null}},createHref(S){return e(r,S)},createURL:x,encodeLocation(S){let w=x(S);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:y,go(S){return o.go(S)}};return T}var b3;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(b3||(b3={}));function r7(n,e,t){return t===void 0&&(t="/"),s7(n,e,t)}function s7(n,e,t,i){let r=typeof e=="string"?w_(e):e,s=CP(r.pathname||"/",t);if(s==null)return null;let o=zB(n);o7(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=y7(s);a=m7(o[l],c)}return a}function zB(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Pr(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=Hf([i,l.relativePath]),u=t.concat(l);s.children&&s.children.length>0&&(Pr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),zB(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:d7(c,s.index),routesMeta:u})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of VB(s.path))r(s,o,l)}),e}function VB(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=VB(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function o7(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:p7(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const a7=/^:[\w-]+$/,l7=3,c7=2,u7=1,h7=10,f7=-2,w3=n=>n==="*";function d7(n,e){let t=n.split("/"),i=t.length;return t.some(w3)&&(i+=f7),e&&(i+=c7),t.filter(r=>!w3(r)).reduce((r,s)=>r+(a7.test(s)?l7:s===""?u7:h7),i)}function p7(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function m7(n,e,t){let{routesMeta:i}=n,r={},s="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],c=a===i.length-1,u=s==="/"?e:e.slice(s.length)||"/",d=g7({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:Hf([s,d.pathname]),pathnameBase:w7(Hf([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Hf([s,d.pathnameBase]))}return o}function g7(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=_7(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((c,u,d)=>{let{paramName:m,isOptional:y}=u;if(m==="*"){let T=a[d]||"";o=s.slice(0,s.length-T.length).replace(/(.)\/+$/,"$1")}const x=a[d];return y&&!x?c[m]=void 0:c[m]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:n}}function _7(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),BB(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function y7(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return BB(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function CP(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function v7(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?w_(n):n;return{pathname:t?t.startsWith("/")?t:x7(t,e):e,search:S7(i),hash:T7(r)}}function x7(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function AE(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function b7(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function PP(n,e){let t=b7(n);return e?t.map((i,r)=>r===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function RP(n,e,t,i){i===void 0&&(i=!1);let r;typeof n=="string"?r=w_(n):(r=dv({},n),Pr(!r.pathname||!r.pathname.includes("?"),AE("?","pathname","search",r)),Pr(!r.pathname||!r.pathname.includes("#"),AE("#","pathname","hash",r)),Pr(!r.search||!r.search.includes("#"),AE("#","search","hash",r)));let s=n===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=t;else{let d=e.length-1;if(!i&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),d-=1;r.pathname=m.join("/")}a=d>=0?e[d]:"/"}let l=v7(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Hf=n=>n.join("/").replace(/\/\/+/g,"/"),w7=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),S7=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,T7=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function E7(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const HB=["post","put","patch","delete"];new Set(HB);const A7=["get",...HB];new Set(A7);function pv(){return pv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},pv.apply(this,arguments)}const IP=G.createContext(null),M7=G.createContext(null),sd=G.createContext(null),OS=G.createContext(null),uu=G.createContext({outlet:null,matches:[],isDataRoute:!1}),WB=G.createContext(null);function C7(n,e){let{relative:t}=e===void 0?{}:e;S_()||Pr(!1);let{basename:i,navigator:r}=G.useContext(sd),{hash:s,pathname:o,search:a}=$B(n,{relative:t}),l=o;return i!=="/"&&(l=o==="/"?i:Hf([i,o])),r.createHref({pathname:l,search:a,hash:s})}function S_(){return G.useContext(OS)!=null}function im(){return S_()||Pr(!1),G.useContext(OS).location}function jB(n){G.useContext(sd).static||G.useLayoutEffect(n)}function bh(){let{isDataRoute:n}=G.useContext(uu);return n?W7():P7()}function P7(){S_()||Pr(!1);let n=G.useContext(IP),{basename:e,future:t,navigator:i}=G.useContext(sd),{matches:r}=G.useContext(uu),{pathname:s}=im(),o=JSON.stringify(PP(r,t.v7_relativeSplatPath)),a=G.useRef(!1);return jB(()=>{a.current=!0}),G.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){i.go(c);return}let d=RP(c,JSON.parse(o),s,u.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Hf([e,d.pathname])),(u.replace?i.replace:i.push)(d,u.state,u)},[e,i,o,s,n])}const R7=G.createContext(null);function I7(n){let e=G.useContext(uu).outlet;return e&&G.createElement(R7.Provider,{value:n},e)}function kP(){let{matches:n}=G.useContext(uu),e=n[n.length-1];return e?e.params:{}}function $B(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=G.useContext(sd),{matches:r}=G.useContext(uu),{pathname:s}=im(),o=JSON.stringify(PP(r,i.v7_relativeSplatPath));return G.useMemo(()=>RP(n,JSON.parse(o),s,t==="path"),[n,o,s,t])}function k7(n,e){return O7(n,e)}function O7(n,e,t,i){S_()||Pr(!1);let{navigator:r}=G.useContext(sd),{matches:s}=G.useContext(uu),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=im(),u;if(e){var d;let S=typeof e=="string"?w_(e):e;l==="/"||(d=S.pathname)!=null&&d.startsWith(l)||Pr(!1),u=S}else u=c;let m=u.pathname||"/",y=m;if(l!=="/"){let S=l.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(S.length).join("/")}let x=r7(n,{pathname:y}),T=U7(x&&x.map(S=>Object.assign({},S,{params:Object.assign({},a,S.params),pathname:Hf([l,r.encodeLocation?r.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?l:Hf([l,r.encodeLocation?r.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),s,t,i);return e&&T?G.createElement(OS.Provider,{value:{location:pv({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Lf.Pop}},T):T}function L7(){let n=H7(),e=E7(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),t?G.createElement("pre",{style:r},t):null,null)}const N7=G.createElement(L7,null);class D7 extends G.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?G.createElement(uu.Provider,{value:this.props.routeContext},G.createElement(WB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function F7(n){let{routeContext:e,match:t,children:i}=n,r=G.useContext(IP);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),G.createElement(uu.Provider,{value:e},i)}function U7(n,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=i)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(r=t)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&a?.[d.route.id]!==void 0);u>=0||Pr(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&i&&i.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:m,errors:y}=t,x=d.route.loader&&m[d.route.id]===void 0&&(!y||y[d.route.id]===void 0);if(d.route.lazy||x){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,m)=>{let y,x=!1,T=null,S=null;t&&(y=a&&d.route.id?a[d.route.id]:void 0,T=d.route.errorElement||N7,l&&(c<0&&m===0?(j7("route-fallback"),x=!0,S=null):c===m&&(x=!0,S=d.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,m+1)),P=()=>{let M;return y?M=T:x?M=S:d.route.Component?M=G.createElement(d.route.Component,null):d.route.element?M=d.route.element:M=u,G.createElement(F7,{match:d,routeContext:{outlet:u,matches:w,isDataRoute:t!=null},children:M})};return t&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?G.createElement(D7,{location:t.location,revalidation:t.revalidation,component:T,error:y,children:P(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):P()},null)}var XB=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(XB||{}),GB=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(GB||{});function B7(n){let e=G.useContext(IP);return e||Pr(!1),e}function z7(n){let e=G.useContext(M7);return e||Pr(!1),e}function V7(n){let e=G.useContext(uu);return e||Pr(!1),e}function YB(n){let e=V7(),t=e.matches[e.matches.length-1];return t.route.id||Pr(!1),t.route.id}function H7(){var n;let e=G.useContext(WB),t=z7(),i=YB();return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function W7(){let{router:n}=B7(XB.UseNavigateStable),e=YB(GB.UseNavigateStable),t=G.useRef(!1);return jB(()=>{t.current=!0}),G.useCallback(function(r,s){s===void 0&&(s={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,pv({fromRouteId:e},s)))},[n,e])}const S3={};function j7(n,e,t){S3[n]||(S3[n]=!0)}function $7(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function KA(n){let{to:e,replace:t,state:i,relative:r}=n;S_()||Pr(!1);let{future:s,static:o}=G.useContext(sd),{matches:a}=G.useContext(uu),{pathname:l}=im(),c=bh(),u=RP(e,PP(a,s.v7_relativeSplatPath),l,r==="path"),d=JSON.stringify(u);return G.useEffect(()=>c(JSON.parse(d),{replace:t,state:i,relative:r}),[c,d,r,t,i]),null}function qB(n){return I7(n.context)}function Hr(n){Pr(!1)}function X7(n){let{basename:e="/",children:t=null,location:i,navigationType:r=Lf.Pop,navigator:s,static:o=!1,future:a}=n;S_()&&Pr(!1);let l=e.replace(/^\/*/,"/"),c=G.useMemo(()=>({basename:l,navigator:s,static:o,future:pv({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof i=="string"&&(i=w_(i));let{pathname:u="/",search:d="",hash:m="",state:y=null,key:x="default"}=i,T=G.useMemo(()=>{let S=CP(u,l);return S==null?null:{location:{pathname:S,search:d,hash:m,state:y,key:x},navigationType:r}},[l,u,d,m,y,x,r]);return T==null?null:G.createElement(sd.Provider,{value:c},G.createElement(OS.Provider,{children:t,value:T}))}function G7(n){let{children:e,location:t}=n;return k7(JA(e),t)}new Promise(()=>{});function JA(n,e){e===void 0&&(e=[]);let t=[];return G.Children.forEach(n,(i,r)=>{if(!G.isValidElement(i))return;let s=[...e,r];if(i.type===G.Fragment){t.push.apply(t,JA(i.props.children,s));return}i.type!==Hr&&Pr(!1),!i.props.index||!i.props.children||Pr(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=JA(i.props.children,s)),t.push(o)}),t}function QA(){return QA=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},QA.apply(this,arguments)}function Y7(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function q7(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Z7(n,e){return n.button===0&&(!e||e==="_self")&&!q7(n)}const K7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],J7="6";try{window.__reactRouterVersion=J7}catch{}const Q7="startTransition",T3=q9[Q7];function e$(n){let{basename:e,children:t,future:i,window:r}=n,s=G.useRef();s.current==null&&(s.current=t7({window:r,v5Compat:!0}));let o=s.current,[a,l]=G.useState({action:o.action,location:o.location}),{v7_startTransition:c}=i||{},u=G.useCallback(d=>{c&&T3?T3(()=>l(d)):l(d)},[l,c]);return G.useLayoutEffect(()=>o.listen(u),[o,u]),G.useEffect(()=>$7(i),[i]),G.createElement(X7,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:i})}const t$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",n$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LS=G.forwardRef(function(e,t){let{onClick:i,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,m=Y7(e,K7),{basename:y}=G.useContext(sd),x,T=!1;if(typeof c=="string"&&n$.test(c)&&(x=c,t$))try{let M=new URL(window.location.href),I=c.startsWith("//")?new URL(M.protocol+c):new URL(c),k=CP(I.pathname,y);I.origin===M.origin&&k!=null?c=k+I.search+I.hash:T=!0}catch{}let S=C7(c,{relative:r}),w=i$(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,viewTransition:d});function P(M){i&&i(M),M.defaultPrevented||w(M)}return G.createElement("a",QA({},m,{href:x||S,onClick:T||s?i:P,ref:t,target:l}))});var E3;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(E3||(E3={}));var A3;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(A3||(A3={}));function i$(n,e){let{target:t,replace:i,state:r,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=bh(),c=im(),u=$B(n,{relative:o});return G.useCallback(d=>{if(Z7(d,t)){d.preventDefault();let m=i!==void 0?i:Rw(c)===Rw(u);l(n,{replace:m,state:r,preventScrollReset:s,relative:o,viewTransition:a})}},[c,l,u,i,r,t,n,s,o,a])}function ZB(n,e){const t=G.useRef(e);G.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}function r$(n,e,t){e.center!==t.center&&n.setLatLng(e.center),e.radius!=null&&e.radius!==t.radius&&n.setRadius(e.radius)}const s$=1;function o$(n){return Object.freeze({__version:s$,map:n})}function OP(n,e){return Object.freeze({...n,...e})}const KB=G.createContext(null),JB=KB.Provider;function NS(){const n=G.useContext(KB);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function QB(n){function e(t,i){const{instance:r,context:s}=n(t).current;return G.useImperativeHandle(i,()=>r),t.children==null?null:ic.createElement(JB,{value:s},t.children)}return G.forwardRef(e)}function a$(n){function e(t,i){const[r,s]=G.useState(!1),{instance:o}=n(t,s).current;G.useImperativeHandle(i,()=>o),G.useEffect(function(){r&&o.update()},[o,r,t.children]);const a=o._contentNode;return a?MP.createPortal(t.children,a):null}return G.forwardRef(e)}function l$(n){function e(t,i){const{instance:r}=n(t).current;return G.useImperativeHandle(i,()=>r),null}return G.forwardRef(e)}function LP(n,e){const t=G.useRef();G.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function DS(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function c$(n,e){return function(i,r){const s=NS(),o=n(DS(i,s),s);return ZB(s.map,i.attribution),LP(o.current,i.eventHandlers),e(o.current,s,i,r),o}}var My={exports:{}};var u$=My.exports,M3;function h$(){return M3||(M3=1,(function(n,e){(function(t,i){i(e)})(u$,(function(t){var i="1.9.4";function r(f){var v,E,O,V;for(E=1,O=arguments.length;E<O;E++){V=arguments[E];for(v in V)f[v]=V[v]}return f}var s=Object.create||(function(){function f(){}return function(v){return f.prototype=v,new f}})();function o(f,v){var E=Array.prototype.slice;if(f.bind)return f.bind.apply(f,E.call(arguments,1));var O=E.call(arguments,2);return function(){return f.apply(v,O.length?O.concat(E.call(arguments)):arguments)}}var a=0;function l(f){return"_leaflet_id"in f||(f._leaflet_id=++a),f._leaflet_id}function c(f,v,E){var O,V,K,fe;return fe=function(){O=!1,V&&(K.apply(E,V),V=!1)},K=function(){O?V=arguments:(f.apply(E,arguments),setTimeout(fe,v),O=!0)},K}function u(f,v,E){var O=v[1],V=v[0],K=O-V;return f===O&&E?f:((f-V)%K+K)%K+V}function d(){return!1}function m(f,v){if(v===!1)return f;var E=Math.pow(10,v===void 0?6:v);return Math.round(f*E)/E}function y(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function x(f){return y(f).split(/\s+/)}function T(f,v){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?s(f.options):{});for(var E in v)f.options[E]=v[E];return f.options}function S(f,v,E){var O=[];for(var V in f)O.push(encodeURIComponent(E?V.toUpperCase():V)+"="+encodeURIComponent(f[V]));return(!v||v.indexOf("?")===-1?"?":"&")+O.join("&")}var w=/\{ *([\w_ -]+) *\}/g;function P(f,v){return f.replace(w,function(E,O){var V=v[O];if(V===void 0)throw new Error("No value provided for variable "+E);return typeof V=="function"&&(V=V(v)),V})}var M=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function I(f,v){for(var E=0;E<f.length;E++)if(f[E]===v)return E;return-1}var k="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function D(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var H=0;function W(f){var v=+new Date,E=Math.max(0,16-(v-H));return H=v+E,window.setTimeout(f,E)}var z=window.requestAnimationFrame||D("RequestAnimationFrame")||W,j=window.cancelAnimationFrame||D("CancelAnimationFrame")||D("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function J(f,v,E){if(E&&z===W)f.call(v);else return z.call(window,o(f,v))}function le(f){f&&j.call(window,f)}var ge={__proto__:null,extend:r,create:s,bind:o,get lastId(){return a},stamp:l,throttle:c,wrapNum:u,falseFn:d,formatNum:m,trim:y,splitWords:x,setOptions:T,getParamString:S,template:P,isArray:M,indexOf:I,emptyImageUrl:k,requestFn:z,cancelFn:j,requestAnimFrame:J,cancelAnimFrame:le};function te(){}te.extend=function(f){var v=function(){T(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},E=v.__super__=this.prototype,O=s(E);O.constructor=v,v.prototype=O;for(var V in this)Object.prototype.hasOwnProperty.call(this,V)&&V!=="prototype"&&V!=="__super__"&&(v[V]=this[V]);return f.statics&&r(v,f.statics),f.includes&&(de(f.includes),r.apply(null,[O].concat(f.includes))),r(O,f),delete O.statics,delete O.includes,O.options&&(O.options=E.options?s(E.options):{},r(O.options,f.options)),O._initHooks=[],O.callInitHooks=function(){if(!this._initHooksCalled){E.callInitHooks&&E.callInitHooks.call(this),this._initHooksCalled=!0;for(var K=0,fe=O._initHooks.length;K<fe;K++)O._initHooks[K].call(this)}},v},te.include=function(f){var v=this.prototype.options;return r(this.prototype,f),f.options&&(this.prototype.options=v,this.mergeOptions(f.options)),this},te.mergeOptions=function(f){return r(this.prototype.options,f),this},te.addInitHook=function(f){var v=Array.prototype.slice.call(arguments,1),E=typeof f=="function"?f:function(){this[f].apply(this,v)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(E),this};function de(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=M(f)?f:[f];for(var v=0;v<f.length;v++)f[v]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ve={on:function(f,v,E){if(typeof f=="object")for(var O in f)this._on(O,f[O],v);else{f=x(f);for(var V=0,K=f.length;V<K;V++)this._on(f[V],v,E)}return this},off:function(f,v,E){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var O in f)this._off(O,f[O],v);else{f=x(f);for(var V=arguments.length===1,K=0,fe=f.length;K<fe;K++)V?this._off(f[K]):this._off(f[K],v,E)}return this},_on:function(f,v,E,O){if(typeof v!="function"){console.warn("wrong listener type: "+typeof v);return}if(this._listens(f,v,E)===!1){E===this&&(E=void 0);var V={fn:v,ctx:E};O&&(V.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(V)}},_off:function(f,v,E){var O,V,K;if(this._events&&(O=this._events[f],!!O)){if(arguments.length===1){if(this._firingCount)for(V=0,K=O.length;V<K;V++)O[V].fn=d;delete this._events[f];return}if(typeof v!="function"){console.warn("wrong listener type: "+typeof v);return}var fe=this._listens(f,v,E);if(fe!==!1){var Ce=O[fe];this._firingCount&&(Ce.fn=d,this._events[f]=O=O.slice()),O.splice(fe,1)}}},fire:function(f,v,E){if(!this.listens(f,E))return this;var O=r({},v,{type:f,target:this,sourceTarget:v&&v.sourceTarget||this});if(this._events){var V=this._events[f];if(V){this._firingCount=this._firingCount+1||1;for(var K=0,fe=V.length;K<fe;K++){var Ce=V[K],De=Ce.fn;Ce.once&&this.off(f,De,Ce.ctx),De.call(Ce.ctx||this,O)}this._firingCount--}}return E&&this._propagateEvent(O),this},listens:function(f,v,E,O){typeof f!="string"&&console.warn('"string" type argument expected');var V=v;typeof v!="function"&&(O=!!v,V=void 0,E=void 0);var K=this._events&&this._events[f];if(K&&K.length&&this._listens(f,V,E)!==!1)return!0;if(O){for(var fe in this._eventParents)if(this._eventParents[fe].listens(f,v,E,O))return!0}return!1},_listens:function(f,v,E){if(!this._events)return!1;var O=this._events[f]||[];if(!v)return!!O.length;E===this&&(E=void 0);for(var V=0,K=O.length;V<K;V++)if(O[V].fn===v&&O[V].ctx===E)return V;return!1},once:function(f,v,E){if(typeof f=="object")for(var O in f)this._on(O,f[O],v,!0);else{f=x(f);for(var V=0,K=f.length;V<K;V++)this._on(f[V],v,E,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[l(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[l(f)],this},_propagateEvent:function(f){for(var v in this._eventParents)this._eventParents[v].fire(f.type,r({layer:f.target,propagatedFrom:f.target},f),!0)}};ve.addEventListener=ve.on,ve.removeEventListener=ve.clearAllEventListeners=ve.off,ve.addOneTimeEventListener=ve.once,ve.fireEvent=ve.fire,ve.hasEventListeners=ve.listens;var me=te.extend(ve);function q(f,v,E){this.x=E?Math.round(f):f,this.y=E?Math.round(v):v}var ie=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(f){return this.clone()._add(X(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(X(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new q(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new q(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ie(this.x),this.y=ie(this.y),this},distanceTo:function(f){f=X(f);var v=f.x-this.x,E=f.y-this.y;return Math.sqrt(v*v+E*E)},equals:function(f){return f=X(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=X(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}};function X(f,v,E){return f instanceof q?f:M(f)?new q(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new q(f.x,f.y):new q(f,v,E)}function Y(f,v){if(f)for(var E=v?[f,v]:f,O=0,V=E.length;O<V;O++)this.extend(E[O])}Y.prototype={extend:function(f){var v,E;if(!f)return this;if(f instanceof q||typeof f[0]=="number"||"x"in f)v=E=X(f);else if(f=ce(f),v=f.min,E=f.max,!v||!E)return this;return!this.min&&!this.max?(this.min=v.clone(),this.max=E.clone()):(this.min.x=Math.min(v.x,this.min.x),this.max.x=Math.max(E.x,this.max.x),this.min.y=Math.min(v.y,this.min.y),this.max.y=Math.max(E.y,this.max.y)),this},getCenter:function(f){return X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return X(this.min.x,this.max.y)},getTopRight:function(){return X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var v,E;return typeof f[0]=="number"||f instanceof q?f=X(f):f=ce(f),f instanceof Y?(v=f.min,E=f.max):v=E=f,v.x>=this.min.x&&E.x<=this.max.x&&v.y>=this.min.y&&E.y<=this.max.y},intersects:function(f){f=ce(f);var v=this.min,E=this.max,O=f.min,V=f.max,K=V.x>=v.x&&O.x<=E.x,fe=V.y>=v.y&&O.y<=E.y;return K&&fe},overlaps:function(f){f=ce(f);var v=this.min,E=this.max,O=f.min,V=f.max,K=V.x>v.x&&O.x<E.x,fe=V.y>v.y&&O.y<E.y;return K&&fe},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var v=this.min,E=this.max,O=Math.abs(v.x-E.x)*f,V=Math.abs(v.y-E.y)*f;return ce(X(v.x-O,v.y-V),X(E.x+O,E.y+V))},equals:function(f){return f?(f=ce(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function ce(f,v){return!f||f instanceof Y?f:new Y(f,v)}function Me(f,v){if(f)for(var E=v?[f,v]:f,O=0,V=E.length;O<V;O++)this.extend(E[O])}Me.prototype={extend:function(f){var v=this._southWest,E=this._northEast,O,V;if(f instanceof Fe)O=f,V=f;else if(f instanceof Me){if(O=f._southWest,V=f._northEast,!O||!V)return this}else return f?this.extend(Be(f)||Re(f)):this;return!v&&!E?(this._southWest=new Fe(O.lat,O.lng),this._northEast=new Fe(V.lat,V.lng)):(v.lat=Math.min(O.lat,v.lat),v.lng=Math.min(O.lng,v.lng),E.lat=Math.max(V.lat,E.lat),E.lng=Math.max(V.lng,E.lng)),this},pad:function(f){var v=this._southWest,E=this._northEast,O=Math.abs(v.lat-E.lat)*f,V=Math.abs(v.lng-E.lng)*f;return new Me(new Fe(v.lat-O,v.lng-V),new Fe(E.lat+O,E.lng+V))},getCenter:function(){return new Fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new Fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof Fe||"lat"in f?f=Be(f):f=Re(f);var v=this._southWest,E=this._northEast,O,V;return f instanceof Me?(O=f.getSouthWest(),V=f.getNorthEast()):O=V=f,O.lat>=v.lat&&V.lat<=E.lat&&O.lng>=v.lng&&V.lng<=E.lng},intersects:function(f){f=Re(f);var v=this._southWest,E=this._northEast,O=f.getSouthWest(),V=f.getNorthEast(),K=V.lat>=v.lat&&O.lat<=E.lat,fe=V.lng>=v.lng&&O.lng<=E.lng;return K&&fe},overlaps:function(f){f=Re(f);var v=this._southWest,E=this._northEast,O=f.getSouthWest(),V=f.getNorthEast(),K=V.lat>v.lat&&O.lat<E.lat,fe=V.lng>v.lng&&O.lng<E.lng;return K&&fe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,v){return f?(f=Re(f),this._southWest.equals(f.getSouthWest(),v)&&this._northEast.equals(f.getNorthEast(),v)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Re(f,v){return f instanceof Me?f:new Me(f,v)}function Fe(f,v,E){if(isNaN(f)||isNaN(v))throw new Error("Invalid LatLng object: ("+f+", "+v+")");this.lat=+f,this.lng=+v,E!==void 0&&(this.alt=+E)}Fe.prototype={equals:function(f,v){if(!f)return!1;f=Be(f);var E=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return E<=(v===void 0?1e-9:v)},toString:function(f){return"LatLng("+m(this.lat,f)+", "+m(this.lng,f)+")"},distanceTo:function(f){return pt.distance(this,Be(f))},wrap:function(){return pt.wrapLatLng(this)},toBounds:function(f){var v=180*f/40075017,E=v/Math.cos(Math.PI/180*this.lat);return Re([this.lat-v,this.lng-E],[this.lat+v,this.lng+E])},clone:function(){return new Fe(this.lat,this.lng,this.alt)}};function Be(f,v,E){return f instanceof Fe?f:M(f)&&typeof f[0]!="object"?f.length===3?new Fe(f[0],f[1],f[2]):f.length===2?new Fe(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new Fe(f.lat,"lng"in f?f.lng:f.lon,f.alt):v===void 0?null:new Fe(f,v,E)}var at={latLngToPoint:function(f,v){var E=this.projection.project(f),O=this.scale(v);return this.transformation._transform(E,O)},pointToLatLng:function(f,v){var E=this.scale(v),O=this.transformation.untransform(f,E);return this.projection.unproject(O)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var v=this.projection.bounds,E=this.scale(f),O=this.transformation.transform(v.min,E),V=this.transformation.transform(v.max,E);return new Y(O,V)},infinite:!1,wrapLatLng:function(f){var v=this.wrapLng?u(f.lng,this.wrapLng,!0):f.lng,E=this.wrapLat?u(f.lat,this.wrapLat,!0):f.lat,O=f.alt;return new Fe(E,v,O)},wrapLatLngBounds:function(f){var v=f.getCenter(),E=this.wrapLatLng(v),O=v.lat-E.lat,V=v.lng-E.lng;if(O===0&&V===0)return f;var K=f.getSouthWest(),fe=f.getNorthEast(),Ce=new Fe(K.lat-O,K.lng-V),De=new Fe(fe.lat-O,fe.lng-V);return new Me(Ce,De)}},pt=r({},at,{wrapLng:[-180,180],R:6371e3,distance:function(f,v){var E=Math.PI/180,O=f.lat*E,V=v.lat*E,K=Math.sin((v.lat-f.lat)*E/2),fe=Math.sin((v.lng-f.lng)*E/2),Ce=K*K+Math.cos(O)*Math.cos(V)*fe*fe,De=2*Math.atan2(Math.sqrt(Ce),Math.sqrt(1-Ce));return this.R*De}}),Ft=6378137,yn={R:Ft,MAX_LATITUDE:85.0511287798,project:function(f){var v=Math.PI/180,E=this.MAX_LATITUDE,O=Math.max(Math.min(E,f.lat),-E),V=Math.sin(O*v);return new q(this.R*f.lng*v,this.R*Math.log((1+V)/(1-V))/2)},unproject:function(f){var v=180/Math.PI;return new Fe((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*v,f.x*v/this.R)},bounds:(function(){var f=Ft*Math.PI;return new Y([-f,-f],[f,f])})()};function Rt(f,v,E,O){if(M(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=v,this._c=E,this._d=O}Rt.prototype={transform:function(f,v){return this._transform(f.clone(),v)},_transform:function(f,v){return v=v||1,f.x=v*(this._a*f.x+this._b),f.y=v*(this._c*f.y+this._d),f},untransform:function(f,v){return v=v||1,new q((f.x/v-this._b)/this._a,(f.y/v-this._d)/this._c)}};function he(f,v,E,O){return new Rt(f,v,E,O)}var nt=r({},pt,{code:"EPSG:3857",projection:yn,transformation:(function(){var f=.5/(Math.PI*yn.R);return he(f,.5,-f,.5)})()}),Ye=r({},nt,{code:"EPSG:900913"});function lt(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function Ke(f,v){var E="",O,V,K,fe,Ce,De;for(O=0,K=f.length;O<K;O++){for(Ce=f[O],V=0,fe=Ce.length;V<fe;V++)De=Ce[V],E+=(V?"L":"M")+De.x+" "+De.y;E+=v?Lt.svg?"z":"x":""}return E||"M0 0"}var Ut=document.documentElement.style,bt="ActiveXObject"in window,Ct=bt&&!document.addEventListener,Zt="msLaunchUri"in navigator&&!("documentMode"in document),ln=rr("webkit"),Xn=rr("android"),ae=rr("android 2")||rr("android 3"),Q=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ne=Xn&&rr("Google")&&Q<537&&!("AudioNode"in window),ct=!!window.opera,et=!Zt&&rr("chrome"),ot=rr("gecko")&&!ln&&!ct&&!bt,Bt=!et&&rr("safari"),dt=rr("phantom"),vt="OTransition"in Ut,nn=navigator.platform.indexOf("Win")===0,Mn=bt&&"transition"in Ut,ht="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ae,Ln="MozPerspective"in Ut,pe=!window.L_DISABLE_3D&&(Mn||ht||Ln)&&!vt&&!dt,$e=typeof orientation<"u"||rr("mobile"),it=$e&&ln,tt=$e&&ht,jt=!window.PointerEvent&&window.MSPointerEvent,ye=!!(window.PointerEvent||jt),mt="ontouchstart"in window||!!window.TouchEvent,gt=!window.L_NO_TOUCH&&(mt||ye),Ge=$e&&ct,ut=$e&&ot,Vt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,vn=(function(){var f=!1;try{var v=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",d,v),window.removeEventListener("testPassiveEventSupport",d,v)}catch{}return f})(),jn=(function(){return!!document.createElement("canvas").getContext})(),pi=!!(document.createElementNS&&lt("svg").createSVGRect),Cn=!!pi&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),qi=!pi&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var v=f.firstChild;return v.style.behavior="url(#default#VML)",v&&typeof v.adj=="object"}catch{return!1}})(),Rr=navigator.platform.indexOf("Mac")===0,du=navigator.platform.indexOf("Linux")===0;function rr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var Lt={ie:bt,ielt9:Ct,edge:Zt,webkit:ln,android:Xn,android23:ae,androidStock:Ne,opera:ct,chrome:et,gecko:ot,safari:Bt,phantom:dt,opera12:vt,win:nn,ie3d:Mn,webkit3d:ht,gecko3d:Ln,any3d:pe,mobile:$e,mobileWebkit:it,mobileWebkit3d:tt,msPointer:jt,pointer:ye,touch:gt,touchNative:mt,mobileOpera:Ge,mobileGecko:ut,retina:Vt,passiveEvents:vn,canvas:jn,svg:pi,vml:qi,inlineSvg:Cn,mac:Rr,linux:du},$s=Lt.msPointer?"MSPointerDown":"pointerdown",ga=Lt.msPointer?"MSPointerMove":"pointermove",pu=Lt.msPointer?"MSPointerUp":"pointerup",mu=Lt.msPointer?"MSPointerCancel":"pointercancel",gu={touchstart:$s,touchmove:ga,touchend:pu,touchcancel:mu},Vo={touchstart:Mt,touchmove:Jt,touchend:Jt,touchcancel:Jt},_a={},ne=!1;function Pe(f,v,E){return v==="touchstart"&&Yt(),Vo[v]?(E=Vo[v].bind(this,E),f.addEventListener(gu[v],E,!1),E):(console.warn("wrong event specified:",v),d)}function ze(f,v,E){if(!gu[v]){console.warn("wrong event specified:",v);return}f.removeEventListener(gu[v],E,!1)}function He(f){_a[f.pointerId]=f}function je(f){_a[f.pointerId]&&(_a[f.pointerId]=f)}function Et(f){delete _a[f.pointerId]}function Yt(){ne||(document.addEventListener($s,He,!0),document.addEventListener(ga,je,!0),document.addEventListener(pu,Et,!0),document.addEventListener(mu,Et,!0),ne=!0)}function Jt(f,v){if(v.pointerType!==(v.MSPOINTER_TYPE_MOUSE||"mouse")){v.touches=[];for(var E in _a)v.touches.push(_a[E]);v.changedTouches=[v],f(v)}}function Mt(f,v){v.MSPOINTER_TYPE_TOUCH&&v.pointerType===v.MSPOINTER_TYPE_TOUCH&&Oi(v),Jt(f,v)}function fn(f){var v={},E,O;for(O in f)E=f[O],v[O]=E&&E.bind?E.bind(f):E;return f=v,v.type="dblclick",v.detail=2,v.isTrusted=!1,v._simulated=!0,v}var rn=200;function un(f,v){f.addEventListener("dblclick",v);var E=0,O;function V(K){if(K.detail!==1){O=K.detail;return}if(!(K.pointerType==="mouse"||K.sourceCapabilities&&!K.sourceCapabilities.firesTouchEvents)){var fe=Ir(K);if(!(fe.some(function(De){return De instanceof HTMLLabelElement&&De.attributes.for})&&!fe.some(function(De){return De instanceof HTMLInputElement||De instanceof HTMLSelectElement}))){var Ce=Date.now();Ce-E<=rn?(O++,O===2&&v(fn(K))):O=1,E=Ce}}}return f.addEventListener("click",V),{dblclick:v,simDblclick:V}}function ri(f,v){f.removeEventListener("dblclick",v.dblclick),f.removeEventListener("click",v.simDblclick)}var Zi=ya(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Gn=ya(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Mi=Gn==="webkitTransition"||Gn==="OTransition"?Gn+"End":"transitionend";function $t(f){return typeof f=="string"?document.getElementById(f):f}function It(f,v){var E=f.style[v]||f.currentStyle&&f.currentStyle[v];if((!E||E==="auto")&&document.defaultView){var O=document.defaultView.getComputedStyle(f,null);E=O?O[v]:null}return E==="auto"?null:E}function Qt(f,v,E){var O=document.createElement(f);return O.className=v||"",E&&E.appendChild(O),O}function Wt(f){var v=f.parentNode;v&&v.removeChild(f)}function ai(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Xr(f){var v=f.parentNode;v&&v.lastChild!==f&&v.appendChild(f)}function Fi(f){var v=f.parentNode;v&&v.firstChild!==f&&v.insertBefore(f,v.firstChild)}function bi(f,v){if(f.classList!==void 0)return f.classList.contains(v);var E=ki(f);return E.length>0&&new RegExp("(^|\\s)"+v+"(\\s|$)").test(E)}function Dt(f,v){if(f.classList!==void 0)for(var E=x(v),O=0,V=E.length;O<V;O++)f.classList.add(E[O]);else if(!bi(f,v)){var K=ki(f);Ga(f,(K?K+" ":"")+v)}}function Fn(f,v){f.classList!==void 0?f.classList.remove(v):Ga(f,y((" "+ki(f)+" ").replace(" "+v+" "," ")))}function Ga(f,v){f.className.baseVal===void 0?f.className=v:f.className.baseVal=v}function ki(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function Ki(f,v){"opacity"in f.style?f.style.opacity=v:"filter"in f.style&&os(f,v)}function os(f,v){var E=!1,O="DXImageTransform.Microsoft.Alpha";try{E=f.filters.item(O)}catch{if(v===1)return}v=Math.round(v*100),E?(E.Enabled=v!==100,E.Opacity=v):f.style.filter+=" progid:"+O+"(opacity="+v+")"}function ya(f){for(var v=document.documentElement.style,E=0;E<f.length;E++)if(f[E]in v)return f[E];return!1}function vo(f,v,E){var O=v||new q(0,0);f.style[Zi]=(Lt.ie3d?"translate("+O.x+"px,"+O.y+"px)":"translate3d("+O.x+"px,"+O.y+"px,0)")+(E?" scale("+E+")":"")}function Ui(f,v){f._leaflet_pos=v,Lt.any3d?vo(f,v):(f.style.left=v.x+"px",f.style.top=v.y+"px")}function Xs(f){return f._leaflet_pos||new q(0,0)}var In,Ho,wl;if("onselectstart"in document)In=function(){cn(window,"selectstart",Oi)},Ho=function(){si(window,"selectstart",Oi)};else{var Sl=ya(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);In=function(){if(Sl){var f=document.documentElement.style;wl=f[Sl],f[Sl]="none"}},Ho=function(){Sl&&(document.documentElement.style[Sl]=wl,wl=void 0)}}function Mh(){cn(window,"dragstart",Oi)}function _c(){si(window,"dragstart",Oi)}var Tl,va;function yc(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(ws(),Tl=f,va=f.style.outlineStyle,f.style.outlineStyle="none",cn(window,"keydown",ws))}function ws(){Tl&&(Tl.style.outlineStyle=va,Tl=void 0,va=void 0,si(window,"keydown",ws))}function xn(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function xo(f){var v=f.getBoundingClientRect();return{x:v.width/f.offsetWidth||1,y:v.height/f.offsetHeight||1,boundingClientRect:v}}var El={__proto__:null,TRANSFORM:Zi,TRANSITION:Gn,TRANSITION_END:Mi,get:$t,getStyle:It,create:Qt,remove:Wt,empty:ai,toFront:Xr,toBack:Fi,hasClass:bi,addClass:Dt,removeClass:Fn,setClass:Ga,getClass:ki,setOpacity:Ki,testProp:ya,setTransform:vo,setPosition:Ui,getPosition:Xs,get disableTextSelection(){return In},get enableTextSelection(){return Ho},disableImageDrag:Mh,enableImageDrag:_c,preventOutline:yc,restoreOutline:ws,getSizedParentNode:xn,getScale:xo};function cn(f,v,E,O){if(v&&typeof v=="object")for(var V in v)gd(f,V,v[V],E);else{v=x(v);for(var K=0,fe=v.length;K<fe;K++)gd(f,v[K],E,O)}return this}var _r="_leaflet_events";function si(f,v,E,O){if(arguments.length===1)Bi(f),delete f[_r];else if(v&&typeof v=="object")for(var V in v)vc(f,V,v[V],E);else if(v=x(v),arguments.length===2)Bi(f,function(Ce){return I(v,Ce)!==-1});else for(var K=0,fe=v.length;K<fe;K++)vc(f,v[K],E,O);return this}function Bi(f,v){for(var E in f[_r]){var O=E.split(/\d/)[0];(!v||v(O))&&vc(f,O,null,null,E)}}var xa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function gd(f,v,E,O){var V=v+l(E)+(O?"_"+l(O):"");if(f[_r]&&f[_r][V])return this;var K=function(Ce){return E.call(O||f,Ce||window.event)},fe=K;!Lt.touchNative&&Lt.pointer&&v.indexOf("touch")===0?K=Pe(f,v,K):Lt.touch&&v==="dblclick"?K=un(f,K):"addEventListener"in f?v==="touchstart"||v==="touchmove"||v==="wheel"||v==="mousewheel"?f.addEventListener(xa[v]||v,K,Lt.passiveEvents?{passive:!1}:!1):v==="mouseenter"||v==="mouseleave"?(K=function(Ce){Ce=Ce||window.event,xc(f,Ce)&&fe(Ce)},f.addEventListener(xa[v],K,!1)):f.addEventListener(v,fe,!1):f.attachEvent("on"+v,K),f[_r]=f[_r]||{},f[_r][V]=K}function vc(f,v,E,O,V){V=V||v+l(E)+(O?"_"+l(O):"");var K=f[_r]&&f[_r][V];if(!K)return this;!Lt.touchNative&&Lt.pointer&&v.indexOf("touch")===0?ze(f,v,K):Lt.touch&&v==="dblclick"?ri(f,K):"removeEventListener"in f?f.removeEventListener(xa[v]||v,K,!1):f.detachEvent("on"+v,K),f[_r][V]=null}function Wo(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Al(f){return gd(f,"wheel",Wo),this}function as(f){return cn(f,"mousedown touchstart dblclick contextmenu",Wo),f._leaflet_disable_click=!0,this}function Oi(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function bo(f){return Oi(f),Wo(f),this}function Ir(f){if(f.composedPath)return f.composedPath();for(var v=[],E=f.target;E;)v.push(E),E=E.parentNode;return v}function Ss(f,v){if(!v)return new q(f.clientX,f.clientY);var E=xo(v),O=E.boundingClientRect;return new q((f.clientX-O.left)/E.x-v.clientLeft,(f.clientY-O.top)/E.y-v.clientTop)}var Ch=Lt.linux&&Lt.chrome?window.devicePixelRatio:Lt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ph(f){return Lt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/Ch:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function xc(f,v){var E=v.relatedTarget;if(!E)return!0;try{for(;E&&E!==f;)E=E.parentNode}catch{return!1}return E!==f}var Rh={__proto__:null,on:cn,off:si,stopPropagation:Wo,disableScrollPropagation:Al,disableClickPropagation:as,preventDefault:Oi,stop:bo,getPropagationPath:Ir,getMousePosition:Ss,getWheelDelta:Ph,isExternalTarget:xc,addListener:cn,removeListener:si},Ts=me.extend({run:function(f,v,E,O){this.stop(),this._el=f,this._inProgress=!0,this._duration=E||.25,this._easeOutPower=1/Math.max(O||.5,.2),this._startPos=Xs(f),this._offset=v.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=J(this._animate,this),this._step()},_step:function(f){var v=+new Date-this._startTime,E=this._duration*1e3;v<E?this._runFrame(this._easeOut(v/E),f):(this._runFrame(1),this._complete())},_runFrame:function(f,v){var E=this._startPos.add(this._offset.multiplyBy(f));v&&E._round(),Ui(this._el,E),this.fire("step")},_complete:function(){le(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Nn=me.extend({options:{crs:nt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,v){v=T(this,v),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),v.maxBounds&&this.setMaxBounds(v.maxBounds),v.zoom!==void 0&&(this._zoom=this._limitZoom(v.zoom)),v.center&&v.zoom!==void 0&&this.setView(Be(v.center),v.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Gn&&Lt.any3d&&!Lt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),cn(this._proxy,Mi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,v,E){if(v=v===void 0?this._zoom:this._limitZoom(v),f=this._limitCenter(Be(f),v,this.options.maxBounds),E=E||{},this._stop(),this._loaded&&!E.reset&&E!==!0){E.animate!==void 0&&(E.zoom=r({animate:E.animate},E.zoom),E.pan=r({animate:E.animate,duration:E.duration},E.pan));var O=this._zoom!==v?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,v,E.zoom):this._tryAnimatedPan(f,E.pan);if(O)return clearTimeout(this._sizeTimer),this}return this._resetView(f,v,E.pan&&E.pan.noMoveStart),this},setZoom:function(f,v){return this._loaded?this.setView(this.getCenter(),f,{zoom:v}):(this._zoom=f,this)},zoomIn:function(f,v){return f=f||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,v)},zoomOut:function(f,v){return f=f||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,v)},setZoomAround:function(f,v,E){var O=this.getZoomScale(v),V=this.getSize().divideBy(2),K=f instanceof q?f:this.latLngToContainerPoint(f),fe=K.subtract(V).multiplyBy(1-1/O),Ce=this.containerPointToLatLng(V.add(fe));return this.setView(Ce,v,{zoom:E})},_getBoundsCenterZoom:function(f,v){v=v||{},f=f.getBounds?f.getBounds():Re(f);var E=X(v.paddingTopLeft||v.padding||[0,0]),O=X(v.paddingBottomRight||v.padding||[0,0]),V=this.getBoundsZoom(f,!1,E.add(O));if(V=typeof v.maxZoom=="number"?Math.min(v.maxZoom,V):V,V===1/0)return{center:f.getCenter(),zoom:V};var K=O.subtract(E).divideBy(2),fe=this.project(f.getSouthWest(),V),Ce=this.project(f.getNorthEast(),V),De=this.unproject(fe.add(Ce).divideBy(2).add(K),V);return{center:De,zoom:V}},fitBounds:function(f,v){if(f=Re(f),!f.isValid())throw new Error("Bounds are not valid.");var E=this._getBoundsCenterZoom(f,v);return this.setView(E.center,E.zoom,v)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,v){return this.setView(f,this._zoom,{pan:v})},panBy:function(f,v){if(f=X(f).round(),v=v||{},!f.x&&!f.y)return this.fire("moveend");if(v.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ts,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),v.noMoveStart||this.fire("movestart"),v.animate!==!1){Dt(this._mapPane,"leaflet-pan-anim");var E=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,E,v.duration||.25,v.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,v,E){if(E=E||{},E.animate===!1||!Lt.any3d)return this.setView(f,v,E);this._stop();var O=this.project(this.getCenter()),V=this.project(f),K=this.getSize(),fe=this._zoom;f=Be(f),v=v===void 0?fe:v;var Ce=Math.max(K.x,K.y),De=Ce*this.getZoomScale(fe,v),Je=V.distanceTo(O)||1,wt=1.42,en=wt*wt;function bn(Vn){var Zo=Vn?-1:1,Wh=Vn?De:Ce,jh=De*De-Ce*Ce+Zo*en*en*Je*Je,el=2*Wh*en*Je,Mo=jh/el,Ci=Math.sqrt(Mo*Mo+1)-Mo,$h=Ci<1e-9?-18:Math.log(Ci);return $h}function br(Vn){return(Math.exp(Vn)-Math.exp(-Vn))/2}function Vi(Vn){return(Math.exp(Vn)+Math.exp(-Vn))/2}function Yr(Vn){return br(Vn)/Vi(Vn)}var ds=bn(0);function Fl(Vn){return Ce*(Vi(ds)/Vi(ds+wt*Vn))}function Hh(Vn){return Ce*(Vi(ds)*Yr(ds+wt*Vn)-br(ds))/en}function Pa(Vn){return 1-Math.pow(1-Vn,1.5)}var wd=Date.now(),Qa=(bn(1)-ds)/wt,Qi=E.duration?1e3*E.duration:1e3*Qa*.8;function Ul(){var Vn=(Date.now()-wd)/Qi,Zo=Pa(Vn)*Qa;Vn<=1?(this._flyToFrame=J(Ul,this),this._move(this.unproject(O.add(V.subtract(O).multiplyBy(Hh(Zo)/Je)),fe),this.getScaleZoom(Ce/Fl(Zo),fe),{flyTo:!0})):this._move(f,v)._moveEnd(!0)}return this._moveStart(!0,E.noMoveStart),Ul.call(this),this},flyToBounds:function(f,v){var E=this._getBoundsCenterZoom(f,v);return this.flyTo(E.center,E.zoom,v)},setMaxBounds:function(f){return f=Re(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var v=this.options.minZoom;return this.options.minZoom=f,this._loaded&&v!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var v=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&v!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,v){this._enforcingBounds=!0;var E=this.getCenter(),O=this._limitCenter(E,this._zoom,Re(f));return E.equals(O)||this.panTo(O,v),this._enforcingBounds=!1,this},panInside:function(f,v){v=v||{};var E=X(v.paddingTopLeft||v.padding||[0,0]),O=X(v.paddingBottomRight||v.padding||[0,0]),V=this.project(this.getCenter()),K=this.project(f),fe=this.getPixelBounds(),Ce=ce([fe.min.add(E),fe.max.subtract(O)]),De=Ce.getSize();if(!Ce.contains(K)){this._enforcingBounds=!0;var Je=K.subtract(Ce.getCenter()),wt=Ce.extend(K).getSize().subtract(De);V.x+=Je.x<0?-wt.x:wt.x,V.y+=Je.y<0?-wt.y:wt.y,this.panTo(this.unproject(V),v),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=r({animate:!1,pan:!0},f===!0?{animate:!0}:f);var v=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var E=this.getSize(),O=v.divideBy(2).round(),V=E.divideBy(2).round(),K=O.subtract(V);return!K.x&&!K.y?this:(f.animate&&f.pan?this.panBy(K):(f.pan&&this._rawPanBy(K),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:v,newSize:E}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=r({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var v=o(this._handleGeolocationResponse,this),E=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(v,E,f):navigator.geolocation.getCurrentPosition(v,E,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var v=f.code,E=f.message||(v===1?"permission denied":v===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:v,message:"Geolocation error: "+E+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var v=f.coords.latitude,E=f.coords.longitude,O=new Fe(v,E),V=O.toBounds(f.coords.accuracy*2),K=this._locateOptions;if(K.setView){var fe=this.getBoundsZoom(V);this.setView(O,K.maxZoom?Math.min(fe,K.maxZoom):fe)}var Ce={latlng:O,bounds:V,timestamp:f.timestamp};for(var De in f.coords)typeof f.coords[De]=="number"&&(Ce[De]=f.coords[De]);this.fire("locationfound",Ce)}},addHandler:function(f,v){if(!v)return this;var E=this[f]=new v(this);return this._handlers.push(E),this.options[f]&&E.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Wt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(le(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)Wt(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,v){var E="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),O=Qt("div",E,v||this._mapPane);return f&&(this._panes[f]=O),O},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),v=this.unproject(f.getBottomLeft()),E=this.unproject(f.getTopRight());return new Me(v,E)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,v,E){f=Re(f),E=X(E||[0,0]);var O=this.getZoom()||0,V=this.getMinZoom(),K=this.getMaxZoom(),fe=f.getNorthWest(),Ce=f.getSouthEast(),De=this.getSize().subtract(E),Je=ce(this.project(Ce,O),this.project(fe,O)).getSize(),wt=Lt.any3d?this.options.zoomSnap:1,en=De.x/Je.x,bn=De.y/Je.y,br=v?Math.max(en,bn):Math.min(en,bn);return O=this.getScaleZoom(br,O),wt&&(O=Math.round(O/(wt/100))*(wt/100),O=v?Math.ceil(O/wt)*wt:Math.floor(O/wt)*wt),Math.max(V,Math.min(K,O))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,v){var E=this._getTopLeftPoint(f,v);return new Y(E,E.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,v){var E=this.options.crs;return v=v===void 0?this._zoom:v,E.scale(f)/E.scale(v)},getScaleZoom:function(f,v){var E=this.options.crs;v=v===void 0?this._zoom:v;var O=E.zoom(f*E.scale(v));return isNaN(O)?1/0:O},project:function(f,v){return v=v===void 0?this._zoom:v,this.options.crs.latLngToPoint(Be(f),v)},unproject:function(f,v){return v=v===void 0?this._zoom:v,this.options.crs.pointToLatLng(X(f),v)},layerPointToLatLng:function(f){var v=X(f).add(this.getPixelOrigin());return this.unproject(v)},latLngToLayerPoint:function(f){var v=this.project(Be(f))._round();return v._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(Be(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(Re(f))},distance:function(f,v){return this.options.crs.distance(Be(f),Be(v))},containerPointToLayerPoint:function(f){return X(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return X(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var v=this.containerPointToLayerPoint(X(f));return this.layerPointToLatLng(v)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Be(f)))},mouseEventToContainerPoint:function(f){return Ss(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var v=this._container=$t(f);if(v){if(v._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");cn(v,"scroll",this._onScroll,this),this._containerId=l(v)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&Lt.any3d,Dt(f,"leaflet-container"+(Lt.touch?" leaflet-touch":"")+(Lt.retina?" leaflet-retina":"")+(Lt.ielt9?" leaflet-oldie":"")+(Lt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var v=It(f,"position");v!=="absolute"&&v!=="relative"&&v!=="fixed"&&v!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ui(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Dt(f.markerPane,"leaflet-zoom-hide"),Dt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,v,E){Ui(this._mapPane,new q(0,0));var O=!this._loaded;this._loaded=!0,v=this._limitZoom(v),this.fire("viewprereset");var V=this._zoom!==v;this._moveStart(V,E)._move(f,v)._moveEnd(V),this.fire("viewreset"),O&&this.fire("load")},_moveStart:function(f,v){return f&&this.fire("zoomstart"),v||this.fire("movestart"),this},_move:function(f,v,E,O){v===void 0&&(v=this._zoom);var V=this._zoom!==v;return this._zoom=v,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),O?E&&E.pinch&&this.fire("zoom",E):((V||E&&E.pinch)&&this.fire("zoom",E),this.fire("move",E)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return le(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){Ui(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[l(this._container)]=this;var v=f?si:cn;v(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&v(window,"resize",this._onResize,this),Lt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){le(this._resizeRequest),this._resizeRequest=J(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,v){for(var E=[],O,V=v==="mouseout"||v==="mouseover",K=f.target||f.srcElement,fe=!1;K;){if(O=this._targets[l(K)],O&&(v==="click"||v==="preclick")&&this._draggableMoved(O)){fe=!0;break}if(O&&O.listens(v,!0)&&(V&&!xc(K,f)||(E.push(O),V))||K===this._container)break;K=K.parentNode}return!E.length&&!fe&&!V&&this.listens(v,!0)&&(E=[this]),E},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var v=f.target||f.srcElement;if(!(!this._loaded||v._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(v))){var E=f.type;E==="mousedown"&&yc(v),this._fireDOMEvent(f,E)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,v,E){if(f.type==="click"){var O=r({},f);O.type="preclick",this._fireDOMEvent(O,O.type,E)}var V=this._findEventTargets(f,v);if(E){for(var K=[],fe=0;fe<E.length;fe++)E[fe].listens(v,!0)&&K.push(E[fe]);V=K.concat(V)}if(V.length){v==="contextmenu"&&Oi(f);var Ce=V[0],De={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Je=Ce.getLatLng&&(!Ce._radius||Ce._radius<=10);De.containerPoint=Je?this.latLngToContainerPoint(Ce.getLatLng()):this.mouseEventToContainerPoint(f),De.layerPoint=this.containerPointToLayerPoint(De.containerPoint),De.latlng=Je?Ce.getLatLng():this.layerPointToLatLng(De.layerPoint)}for(fe=0;fe<V.length;fe++)if(V[fe].fire(v,De,!0),De.originalEvent._stopped||V[fe].options.bubblingMouseEvents===!1&&I(this._mouseEvents,v)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,v=this._handlers.length;f<v;f++)this._handlers[f].disable()},whenReady:function(f,v){return this._loaded?f.call(v||this,{target:this}):this.on("load",f,v),this},_getMapPanePos:function(){return Xs(this._mapPane)||new q(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,v){var E=f&&v!==void 0?this._getNewPixelOrigin(f,v):this.getPixelOrigin();return E.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,v){var E=this.getSize()._divideBy(2);return this.project(f,v)._subtract(E)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,v,E){var O=this._getNewPixelOrigin(E,v);return this.project(f,v)._subtract(O)},_latLngBoundsToNewLayerBounds:function(f,v,E){var O=this._getNewPixelOrigin(E,v);return ce([this.project(f.getSouthWest(),v)._subtract(O),this.project(f.getNorthWest(),v)._subtract(O),this.project(f.getSouthEast(),v)._subtract(O),this.project(f.getNorthEast(),v)._subtract(O)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,v,E){if(!E)return f;var O=this.project(f,v),V=this.getSize().divideBy(2),K=new Y(O.subtract(V),O.add(V)),fe=this._getBoundsOffset(K,E,v);return Math.abs(fe.x)<=1&&Math.abs(fe.y)<=1?f:this.unproject(O.add(fe),v)},_limitOffset:function(f,v){if(!v)return f;var E=this.getPixelBounds(),O=new Y(E.min.add(f),E.max.add(f));return f.add(this._getBoundsOffset(O,v))},_getBoundsOffset:function(f,v,E){var O=ce(this.project(v.getNorthEast(),E),this.project(v.getSouthWest(),E)),V=O.min.subtract(f.min),K=O.max.subtract(f.max),fe=this._rebound(V.x,-K.x),Ce=this._rebound(V.y,-K.y);return new q(fe,Ce)},_rebound:function(f,v){return f+v>0?Math.round(f-v)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(v))},_limitZoom:function(f){var v=this.getMinZoom(),E=this.getMaxZoom(),O=Lt.any3d?this.options.zoomSnap:1;return O&&(f=Math.round(f/O)*O),Math.max(v,Math.min(E,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Fn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,v){var E=this._getCenterOffset(f)._trunc();return(v&&v.animate)!==!0&&!this.getSize().contains(E)?!1:(this.panBy(E,v),!0)},_createAnimProxy:function(){var f=this._proxy=Qt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(v){var E=Zi,O=this._proxy.style[E];vo(this._proxy,this.project(v.center,v.zoom),this.getZoomScale(v.zoom,1)),O===this._proxy.style[E]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Wt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),v=this.getZoom();vo(this._proxy,this.project(f,v),this.getZoomScale(v,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,v,E){if(this._animatingZoom)return!0;if(E=E||{},!this._zoomAnimated||E.animate===!1||this._nothingToAnimate()||Math.abs(v-this._zoom)>this.options.zoomAnimationThreshold)return!1;var O=this.getZoomScale(v),V=this._getCenterOffset(f)._divideBy(1-1/O);return E.animate!==!0&&!this.getSize().contains(V)?!1:(J(function(){this._moveStart(!0,E.noMoveStart||!1)._animateZoom(f,v,!0)},this),!0)},_animateZoom:function(f,v,E,O){this._mapPane&&(E&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=v,Dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:v,noUpdate:O}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Fn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function wo(f,v){return new Nn(f,v)}var Es=te.extend({options:{position:"topright"},initialize:function(f){T(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var v=this._map;return v&&v.removeControl(this),this.options.position=f,v&&v.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var v=this._container=this.onAdd(f),E=this.getPosition(),O=f._controlCorners[E];return Dt(v,"leaflet-control"),E.indexOf("bottom")!==-1?O.insertBefore(v,O.firstChild):O.appendChild(v),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Wt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),sr=function(f){return new Es(f)};Nn.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},v="leaflet-",E=this._controlContainer=Qt("div",v+"control-container",this._container);function O(V,K){var fe=v+V+" "+v+K;f[V+K]=Qt("div",fe,E)}O("top","left"),O("top","right"),O("bottom","left"),O("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)Wt(this._controlCorners[f]);Wt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var bc=Es.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,v,E,O){return E<O?-1:O<E?1:0}},initialize:function(f,v,E){T(this,E),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var O in f)this._addLayer(f[O],O);for(O in v)this._addLayer(v[O],O,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var v=0;v<this._layers.length;v++)this._layers[v].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return Es.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,v){return this._addLayer(f,v),this._map?this._update():this},addOverlay:function(f,v){return this._addLayer(f,v,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var v=this._getLayer(l(f));return v&&this._layers.splice(this._layers.indexOf(v),1),this._map?this._update():this},expand:function(){Dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):Fn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Fn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",v=this._container=Qt("div",f),E=this.options.collapsed;v.setAttribute("aria-haspopup",!0),as(v),Al(v);var O=this._section=Qt("section",f+"-list");E&&(this._map.on("click",this.collapse,this),cn(v,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var V=this._layersLink=Qt("a",f+"-toggle",v);V.href="#",V.title="Layers",V.setAttribute("role","button"),cn(V,{keydown:function(K){K.keyCode===13&&this._expandSafely()},click:function(K){Oi(K),this._expandSafely()}},this),E||this.expand(),this._baseLayersList=Qt("div",f+"-base",O),this._separator=Qt("div",f+"-separator",O),this._overlaysList=Qt("div",f+"-overlays",O),v.appendChild(O)},_getLayer:function(f){for(var v=0;v<this._layers.length;v++)if(this._layers[v]&&l(this._layers[v].layer)===f)return this._layers[v]},_addLayer:function(f,v,E){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:v,overlay:E}),this.options.sortLayers&&this._layers.sort(o(function(O,V){return this.options.sortFunction(O.layer,V.layer,O.name,V.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ai(this._baseLayersList),ai(this._overlaysList),this._layerControlInputs=[];var f,v,E,O,V=0;for(E=0;E<this._layers.length;E++)O=this._layers[E],this._addItem(O),v=v||O.overlay,f=f||!O.overlay,V+=O.overlay?0:1;return this.options.hideSingleBase&&(f=f&&V>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=v&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var v=this._getLayer(l(f.target)),E=v.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;E&&this._map.fire(E,v)},_createRadioElement:function(f,v){var E='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(v?' checked="checked"':"")+"/>",O=document.createElement("div");return O.innerHTML=E,O.firstChild},_addItem:function(f){var v=document.createElement("label"),E=this._map.hasLayer(f.layer),O;f.overlay?(O=document.createElement("input"),O.type="checkbox",O.className="leaflet-control-layers-selector",O.defaultChecked=E):O=this._createRadioElement("leaflet-base-layers_"+l(this),E),this._layerControlInputs.push(O),O.layerId=l(f.layer),cn(O,"click",this._onInputClick,this);var V=document.createElement("span");V.innerHTML=" "+f.name;var K=document.createElement("span");v.appendChild(K),K.appendChild(O),K.appendChild(V);var fe=f.overlay?this._overlaysList:this._baseLayersList;return fe.appendChild(v),this._checkDisabledLayers(),v},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,v,E,O=[],V=[];this._handlingClick=!0;for(var K=f.length-1;K>=0;K--)v=f[K],E=this._getLayer(v.layerId).layer,v.checked?O.push(E):v.checked||V.push(E);for(K=0;K<V.length;K++)this._map.hasLayer(V[K])&&this._map.removeLayer(V[K]);for(K=0;K<O.length;K++)this._map.hasLayer(O[K])||this._map.addLayer(O[K]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,v,E,O=this._map.getZoom(),V=f.length-1;V>=0;V--)v=f[V],E=this._getLayer(v.layerId).layer,v.disabled=E.options.minZoom!==void 0&&O<E.options.minZoom||E.options.maxZoom!==void 0&&O>E.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,cn(f,"click",Oi),this.expand();var v=this;setTimeout(function(){si(f,"click",Oi),v._preventClick=!1})}}),Ml=function(f,v,E){return new bc(f,v,E)},So=Es.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var v="leaflet-control-zoom",E=Qt("div",v+" leaflet-bar"),O=this.options;return this._zoomInButton=this._createButton(O.zoomInText,O.zoomInTitle,v+"-in",E,this._zoomIn),this._zoomOutButton=this._createButton(O.zoomOutText,O.zoomOutTitle,v+"-out",E,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),E},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,v,E,O,V){var K=Qt("a",E,O);return K.innerHTML=f,K.href="#",K.title=v,K.setAttribute("role","button"),K.setAttribute("aria-label",v),as(K),cn(K,"click",bo),cn(K,"click",V,this),cn(K,"click",this._refocusOnMap,this),K},_updateDisabled:function(){var f=this._map,v="leaflet-disabled";Fn(this._zoomInButton,v),Fn(this._zoomOutButton,v),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Dt(this._zoomOutButton,v),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Dt(this._zoomInButton,v),this._zoomInButton.setAttribute("aria-disabled","true"))}});Nn.mergeOptions({zoomControl:!0}),Nn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new So,this.addControl(this.zoomControl))});var Ih=function(f){return new So(f)},kr=Es.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var v="leaflet-control-scale",E=Qt("div",v),O=this.options;return this._addScales(O,v+"-line",E),f.on(O.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),E},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,v,E){f.metric&&(this._mScale=Qt("div",v,E)),f.imperial&&(this._iScale=Qt("div",v,E))},_update:function(){var f=this._map,v=f.getSize().y/2,E=f.distance(f.containerPointToLatLng([0,v]),f.containerPointToLatLng([this.options.maxWidth,v]));this._updateScales(E)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var v=this._getRoundNum(f),E=v<1e3?v+" m":v/1e3+" km";this._updateScale(this._mScale,E,v/f)},_updateImperial:function(f){var v=f*3.2808399,E,O,V;v>5280?(E=v/5280,O=this._getRoundNum(E),this._updateScale(this._iScale,O+" mi",O/E)):(V=this._getRoundNum(v),this._updateScale(this._iScale,V+" ft",V/v))},_updateScale:function(f,v,E){f.style.width=Math.round(this.options.maxWidth*E)+"px",f.innerHTML=v},_getRoundNum:function(f){var v=Math.pow(10,(Math.floor(f)+"").length-1),E=f/v;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:1,v*E}}),Cl=function(f){return new kr(f)},_u='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ba=Es.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Lt.inlineSvg?_u+" ":"")+"Leaflet</a>"},initialize:function(f){T(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Qt("div","leaflet-control-attribution"),as(this._container);for(var v in f._layers)f._layers[v].getAttribution&&this.addAttribution(f._layers[v].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var v in this._attributions)this._attributions[v]&&f.push(v);var E=[];this.options.prefix&&E.push(this.options.prefix),f.length&&E.push(f.join(", ")),this._container.innerHTML=E.join(' <span aria-hidden="true">|</span> ')}}});Nn.mergeOptions({attributionControl:!0}),Nn.addInitHook(function(){this.options.attributionControl&&new ba().addTo(this)});var wc=function(f){return new ba(f)};Es.Layers=bc,Es.Zoom=So,Es.Scale=kr,Es.Attribution=ba,sr.layers=Ml,sr.zoom=Ih,sr.scale=Cl,sr.attribution=wc;var wi=te.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});wi.addTo=function(f,v){return f.addHandler(v,this),this};var Gs={Events:ve},As=Lt.touch?"touchstart mousedown":"mousedown",Ms=me.extend({options:{clickTolerance:3},initialize:function(f,v,E,O){T(this,O),this._element=f,this._dragStartTarget=v||f,this._preventOutline=E},enable:function(){this._enabled||(cn(this._dragStartTarget,As,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ms._dragging===this&&this.finishDrag(!0),si(this._dragStartTarget,As,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!bi(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){Ms._dragging===this&&this.finishDrag();return}if(!(Ms._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(Ms._dragging=this,this._preventOutline&&yc(this._element),Mh(),In(),!this._moving)){this.fire("down");var v=f.touches?f.touches[0]:f,E=xn(this._element);this._startPoint=new q(v.clientX,v.clientY),this._startPos=Xs(this._element),this._parentScale=xo(E);var O=f.type==="mousedown";cn(document,O?"mousemove":"touchmove",this._onMove,this),cn(document,O?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var v=f.touches&&f.touches.length===1?f.touches[0]:f,E=new q(v.clientX,v.clientY)._subtract(this._startPoint);!E.x&&!E.y||Math.abs(E.x)+Math.abs(E.y)<this.options.clickTolerance||(E.x/=this._parentScale.x,E.y/=this._parentScale.y,Oi(f),this._moved||(this.fire("dragstart"),this._moved=!0,Dt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(E),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),Ui(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){Fn(document.body,"leaflet-dragging"),this._lastTarget&&(Fn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),si(document,"mousemove touchmove",this._onMove,this),si(document,"mouseup touchend touchcancel",this._onUp,this),_c(),Ho();var v=this._moved&&this._moving;this._moving=!1,Ms._dragging=!1,v&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function kh(f,v,E){var O,V=[1,4,2,8],K,fe,Ce,De,Je,wt,en,bn;for(K=0,wt=f.length;K<wt;K++)f[K]._code=wa(f[K],v);for(Ce=0;Ce<4;Ce++){for(en=V[Ce],O=[],K=0,wt=f.length,fe=wt-1;K<wt;fe=K++)De=f[K],Je=f[fe],De._code&en?Je._code&en||(bn=bu(Je,De,en,v,E),bn._code=wa(bn,v),O.push(bn)):(Je._code&en&&(bn=bu(Je,De,en,v,E),bn._code=wa(bn,v),O.push(bn)),O.push(De));f=O}return f}function jo(f,v){var E,O,V,K,fe,Ce,De,Je,wt;if(!f||f.length===0)throw new Error("latlngs not passed");Gr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var en=Be([0,0]),bn=Re(f),br=bn.getNorthWest().distanceTo(bn.getSouthWest())*bn.getNorthEast().distanceTo(bn.getNorthWest());br<1700&&(en=$o(f));var Vi=f.length,Yr=[];for(E=0;E<Vi;E++){var ds=Be(f[E]);Yr.push(v.project(Be([ds.lat-en.lat,ds.lng-en.lng])))}for(Ce=De=Je=0,E=0,O=Vi-1;E<Vi;O=E++)V=Yr[E],K=Yr[O],fe=V.y*K.x-K.y*V.x,De+=(V.x+K.x)*fe,Je+=(V.y+K.y)*fe,Ce+=fe*3;Ce===0?wt=Yr[0]:wt=[De/Ce,Je/Ce];var Fl=v.unproject(X(wt));return Be([Fl.lat+en.lat,Fl.lng+en.lng])}function $o(f){for(var v=0,E=0,O=0,V=0;V<f.length;V++){var K=Be(f[V]);v+=K.lat,E+=K.lng,O++}return Be([v/O,E/O])}var Oh={__proto__:null,clipPolygon:kh,polygonCenter:jo,centroid:$o};function yu(f,v){if(!v||!f.length)return f.slice();var E=v*v;return f=Lh(f,E),f=mm(f,E),f}function vu(f,v,E){return Math.sqrt(Ys(f,v,E,!0))}function pm(f,v,E){return Ys(f,v,E)}function mm(f,v){var E=f.length,O=typeof Uint8Array<"u"?Uint8Array:Array,V=new O(E);V[0]=V[E-1]=1,xu(f,V,v,0,E-1);var K,fe=[];for(K=0;K<E;K++)V[K]&&fe.push(f[K]);return fe}function xu(f,v,E,O,V){var K=0,fe,Ce,De;for(Ce=O+1;Ce<=V-1;Ce++)De=Ys(f[Ce],f[O],f[V],!0),De>K&&(fe=Ce,K=De);K>E&&(v[fe]=1,xu(f,v,E,O,fe),xu(f,v,E,fe,V))}function Lh(f,v){for(var E=[f[0]],O=1,V=0,K=f.length;O<K;O++)Sc(f[O],f[V])>v&&(E.push(f[O]),V=O);return V<K-1&&E.push(f[K-1]),E}var Nh;function _d(f,v,E,O,V){var K=O?Nh:wa(f,E),fe=wa(v,E),Ce,De,Je;for(Nh=fe;;){if(!(K|fe))return[f,v];if(K&fe)return!1;Ce=K||fe,De=bu(f,v,Ce,E,V),Je=wa(De,E),Ce===K?(f=De,K=Je):(v=De,fe=Je)}}function bu(f,v,E,O,V){var K=v.x-f.x,fe=v.y-f.y,Ce=O.min,De=O.max,Je,wt;return E&8?(Je=f.x+K*(De.y-f.y)/fe,wt=De.y):E&4?(Je=f.x+K*(Ce.y-f.y)/fe,wt=Ce.y):E&2?(Je=De.x,wt=f.y+fe*(De.x-f.x)/K):E&1&&(Je=Ce.x,wt=f.y+fe*(Ce.x-f.x)/K),new q(Je,wt,V)}function wa(f,v){var E=0;return f.x<v.min.x?E|=1:f.x>v.max.x&&(E|=2),f.y<v.min.y?E|=4:f.y>v.max.y&&(E|=8),E}function Sc(f,v){var E=v.x-f.x,O=v.y-f.y;return E*E+O*O}function Ys(f,v,E,O){var V=v.x,K=v.y,fe=E.x-V,Ce=E.y-K,De=fe*fe+Ce*Ce,Je;return De>0&&(Je=((f.x-V)*fe+(f.y-K)*Ce)/De,Je>1?(V=E.x,K=E.y):Je>0&&(V+=fe*Je,K+=Ce*Je)),fe=f.x-V,Ce=f.y-K,O?fe*fe+Ce*Ce:new q(V,K)}function Gr(f){return!M(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function wu(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Gr(f)}function Cs(f,v){var E,O,V,K,fe,Ce,De,Je;if(!f||f.length===0)throw new Error("latlngs not passed");Gr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var wt=Be([0,0]),en=Re(f),bn=en.getNorthWest().distanceTo(en.getSouthWest())*en.getNorthEast().distanceTo(en.getNorthWest());bn<1700&&(wt=$o(f));var br=f.length,Vi=[];for(E=0;E<br;E++){var Yr=Be(f[E]);Vi.push(v.project(Be([Yr.lat-wt.lat,Yr.lng-wt.lng])))}for(E=0,O=0;E<br-1;E++)O+=Vi[E].distanceTo(Vi[E+1])/2;if(O===0)Je=Vi[0];else for(E=0,K=0;E<br-1;E++)if(fe=Vi[E],Ce=Vi[E+1],V=fe.distanceTo(Ce),K+=V,K>O){De=(K-O)/V,Je=[Ce.x-De*(Ce.x-fe.x),Ce.y-De*(Ce.y-fe.y)];break}var ds=v.unproject(X(Je));return Be([ds.lat+wt.lat,ds.lng+wt.lng])}var Ps={__proto__:null,simplify:yu,pointToSegmentDistance:vu,closestPointOnSegment:pm,clipSegment:_d,_getEdgeIntersection:bu,_getBitCode:wa,_sqClosestPointOnSegment:Ys,isFlat:Gr,_flat:wu,polylineCenter:Cs},Sa={project:function(f){return new q(f.lng,f.lat)},unproject:function(f){return new Fe(f.y,f.x)},bounds:new Y([-180,-90],[180,90])},To={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Y([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var v=Math.PI/180,E=this.R,O=f.lat*v,V=this.R_MINOR/E,K=Math.sqrt(1-V*V),fe=K*Math.sin(O),Ce=Math.tan(Math.PI/4-O/2)/Math.pow((1-fe)/(1+fe),K/2);return O=-E*Math.log(Math.max(Ce,1e-10)),new q(f.lng*v*E,O)},unproject:function(f){for(var v=180/Math.PI,E=this.R,O=this.R_MINOR/E,V=Math.sqrt(1-O*O),K=Math.exp(-f.y/E),fe=Math.PI/2-2*Math.atan(K),Ce=0,De=.1,Je;Ce<15&&Math.abs(De)>1e-7;Ce++)Je=V*Math.sin(fe),Je=Math.pow((1-Je)/(1+Je),V/2),De=Math.PI/2-2*Math.atan(K*Je)-fe,fe+=De;return new Fe(fe*v,f.x*v/E)}},Ta={__proto__:null,LonLat:Sa,Mercator:To,SphericalMercator:yn},Pl=r({},pt,{code:"EPSG:3395",projection:To,transformation:(function(){var f=.5/(Math.PI*To.R);return he(f,.5,-f,.5)})()}),yd=r({},pt,{code:"EPSG:4326",projection:Sa,transformation:he(1/180,1,-1/180,.5)}),vd=r({},at,{projection:Sa,transformation:he(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,v){var E=v.lng-f.lng,O=v.lat-f.lat;return Math.sqrt(E*E+O*O)},infinite:!0});at.Earth=pt,at.EPSG3395=Pl,at.EPSG3857=nt,at.EPSG900913=Ye,at.EPSG4326=yd,at.Simple=vd;var Rs=me.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[l(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[l(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var v=f.target;if(v.hasLayer(this)){if(this._map=v,this._zoomAnimated=v._zoomAnimated,this.getEvents){var E=this.getEvents();v.on(E,this),this.once("remove",function(){v.off(E,this)},this)}this.onAdd(v),this.fire("add"),v.fire("layeradd",{layer:this})}}});Nn.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var v=l(f);return this._layers[v]?this:(this._layers[v]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var v=l(f);return this._layers[v]?(this._loaded&&f.onRemove(this),delete this._layers[v],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return l(f)in this._layers},eachLayer:function(f,v){for(var E in this._layers)f.call(v,this._layers[E]);return this},_addLayers:function(f){f=f?M(f)?f:[f]:[];for(var v=0,E=f.length;v<E;v++)this.addLayer(f[v])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[l(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var v=l(f);this._zoomBoundLayers[v]&&(delete this._zoomBoundLayers[v],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,v=-1/0,E=this._getZoomSpan();for(var O in this._zoomBoundLayers){var V=this._zoomBoundLayers[O].options;f=V.minZoom===void 0?f:Math.min(f,V.minZoom),v=V.maxZoom===void 0?v:Math.max(v,V.maxZoom)}this._layersMaxZoom=v===-1/0?void 0:v,this._layersMinZoom=f===1/0?void 0:f,E!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var zi=Rs.extend({initialize:function(f,v){T(this,v),this._layers={};var E,O;if(f)for(E=0,O=f.length;E<O;E++)this.addLayer(f[E])},addLayer:function(f){var v=this.getLayerId(f);return this._layers[v]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var v=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[v]&&this._map.removeLayer(this._layers[v]),delete this._layers[v],this},hasLayer:function(f){var v=typeof f=="number"?f:this.getLayerId(f);return v in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var v=Array.prototype.slice.call(arguments,1),E,O;for(E in this._layers)O=this._layers[E],O[f]&&O[f].apply(O,v);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,v){for(var E in this._layers)f.call(v,this._layers[E]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return l(f)}}),yr=function(f,v){return new zi(f,v)},zn=zi.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),zi.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),zi.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new Me;for(var v in this._layers){var E=this._layers[v];f.extend(E.getBounds?E.getBounds():E.getLatLng())}return f}}),Tc=function(f,v){return new zn(f,v)},vr=te.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){T(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,v){var E=this._getIconUrl(f);if(!E){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var O=this._createImg(E,v&&v.tagName==="IMG"?v:null);return this._setIconStyles(O,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(O.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),O},_setIconStyles:function(f,v){var E=this.options,O=E[v+"Size"];typeof O=="number"&&(O=[O,O]);var V=X(O),K=X(v==="shadow"&&E.shadowAnchor||E.iconAnchor||V&&V.divideBy(2,!0));f.className="leaflet-marker-"+v+" "+(E.className||""),K&&(f.style.marginLeft=-K.x+"px",f.style.marginTop=-K.y+"px"),V&&(f.style.width=V.x+"px",f.style.height=V.y+"px")},_createImg:function(f,v){return v=v||document.createElement("img"),v.src=f,v},_getIconUrl:function(f){return Lt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function xd(f){return new vr(f)}var Rl=vr.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Rl.imagePath!="string"&&(Rl.imagePath=this._detectIconPath()),(this.options.imagePath||Rl.imagePath)+vr.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var v=function(E,O,V){var K=O.exec(E);return K&&K[V]};return f=v(f,/^url\((['"])?(.+)\1\)$/,2),f&&v(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Qt("div","leaflet-default-icon-path",document.body),v=It(f,"background-image")||It(f,"backgroundImage");if(document.body.removeChild(f),v=this._stripUrl(v),v)return v;var E=document.querySelector('link[href$="leaflet.css"]');return E?E.href.substring(0,E.href.length-11-1):""}}),Su=wi.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new Ms(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Dt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Fn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var v=this._marker,E=v._map,O=this._marker.options.autoPanSpeed,V=this._marker.options.autoPanPadding,K=Xs(v._icon),fe=E.getPixelBounds(),Ce=E.getPixelOrigin(),De=ce(fe.min._subtract(Ce).add(V),fe.max._subtract(Ce).subtract(V));if(!De.contains(K)){var Je=X((Math.max(De.max.x,K.x)-De.max.x)/(fe.max.x-De.max.x)-(Math.min(De.min.x,K.x)-De.min.x)/(fe.min.x-De.min.x),(Math.max(De.max.y,K.y)-De.max.y)/(fe.max.y-De.max.y)-(Math.min(De.min.y,K.y)-De.min.y)/(fe.min.y-De.min.y)).multiplyBy(O);E.panBy(Je,{animate:!1}),this._draggable._newPos._add(Je),this._draggable._startPos._add(Je),Ui(v._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=J(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(le(this._panRequest),this._panRequest=J(this._adjustPan.bind(this,f)))},_onDrag:function(f){var v=this._marker,E=v._shadow,O=Xs(v._icon),V=v._map.layerPointToLatLng(O);E&&Ui(E,O),v._latlng=V,f.latlng=V,f.oldLatLng=this._oldLatLng,v.fire("move",f).fire("drag",f)},_onDragEnd:function(f){le(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),Eo=Rs.extend({options:{icon:new Rl,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,v){T(this,v),this._latlng=Be(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var v=this._latlng;return this._latlng=Be(f),this.update(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,v="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),E=f.icon.createIcon(this._icon),O=!1;E!==this._icon&&(this._icon&&this._removeIcon(),O=!0,f.title&&(E.title=f.title),E.tagName==="IMG"&&(E.alt=f.alt||"")),Dt(E,v),f.keyboard&&(E.tabIndex="0",E.setAttribute("role","button")),this._icon=E,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&cn(E,"focus",this._panOnFocus,this);var V=f.icon.createShadow(this._shadow),K=!1;V!==this._shadow&&(this._removeShadow(),K=!0),V&&(Dt(V,v),V.alt=""),this._shadow=V,f.opacity<1&&this._updateOpacity(),O&&this.getPane().appendChild(this._icon),this._initInteraction(),V&&K&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&si(this._icon,"focus",this._panOnFocus,this),Wt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Wt(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&Ui(this._icon,f),this._shadow&&Ui(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var v=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(v)},_initInteraction:function(){if(this.options.interactive&&(Dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Su)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Su(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&Ki(this._icon,f),this._shadow&&Ki(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var v=this.options.icon.options,E=v.iconSize?X(v.iconSize):X(0,0),O=v.iconAnchor?X(v.iconAnchor):X(0,0);f.panInside(this._latlng,{paddingTopLeft:O,paddingBottomRight:E.subtract(O)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function gm(f,v){return new Eo(f,v)}var qs=Rs.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return T(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ea=qs.extend({options:{fill:!0,radius:10},initialize:function(f,v){T(this,v),this._latlng=Be(f),this._radius=this.options.radius},setLatLng:function(f){var v=this._latlng;return this._latlng=Be(f),this.redraw(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var v=f&&f.radius||this._radius;return qs.prototype.setStyle.call(this,f),this.setRadius(v),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,v=this._radiusY||f,E=this._clickTolerance(),O=[f+E,v+E];this._pxBounds=new Y(this._point.subtract(O),this._point.add(O))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Dh(f,v){return new Ea(f,v)}var Ya=Ea.extend({initialize:function(f,v,E){if(typeof v=="number"&&(v=r({},E,{radius:v})),T(this,v),this._latlng=Be(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new Me(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:qs.prototype.setStyle,_project:function(){var f=this._latlng.lng,v=this._latlng.lat,E=this._map,O=E.options.crs;if(O.distance===pt.distance){var V=Math.PI/180,K=this._mRadius/pt.R/V,fe=E.project([v+K,f]),Ce=E.project([v-K,f]),De=fe.add(Ce).divideBy(2),Je=E.unproject(De).lat,wt=Math.acos((Math.cos(K*V)-Math.sin(v*V)*Math.sin(Je*V))/(Math.cos(v*V)*Math.cos(Je*V)))/V;(isNaN(wt)||wt===0)&&(wt=K/Math.cos(Math.PI/180*v)),this._point=De.subtract(E.getPixelOrigin()),this._radius=isNaN(wt)?0:De.x-E.project([Je,f-wt]).x,this._radiusY=De.y-fe.y}else{var en=O.unproject(O.project(this._latlng).subtract([this._mRadius,0]));this._point=E.latLngToLayerPoint(this._latlng),this._radius=this._point.x-E.latLngToLayerPoint(en).x}this._updateBounds()}});function qa(f,v,E){return new Ya(f,v,E)}var ls=qs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,v){T(this,v),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var v=1/0,E=null,O=Ys,V,K,fe=0,Ce=this._parts.length;fe<Ce;fe++)for(var De=this._parts[fe],Je=1,wt=De.length;Je<wt;Je++){V=De[Je-1],K=De[Je];var en=O(f,V,K,!0);en<v&&(v=en,E=O(f,V,K))}return E&&(E.distance=Math.sqrt(v)),E},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Cs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,v){return v=v||this._defaultShape(),f=Be(f),v.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new Me,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Gr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var v=[],E=Gr(f),O=0,V=f.length;O<V;O++)E?(v[O]=Be(f[O]),this._bounds.extend(v[O])):v[O]=this._convertLatLngs(f[O]);return v},_project:function(){var f=new Y;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),v=new q(f,f);this._rawPxBounds&&(this._pxBounds=new Y([this._rawPxBounds.min.subtract(v),this._rawPxBounds.max.add(v)]))},_projectLatlngs:function(f,v,E){var O=f[0]instanceof Fe,V=f.length,K,fe;if(O){for(fe=[],K=0;K<V;K++)fe[K]=this._map.latLngToLayerPoint(f[K]),E.extend(fe[K]);v.push(fe)}else for(K=0;K<V;K++)this._projectLatlngs(f[K],v,E)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var v=this._parts,E,O,V,K,fe,Ce,De;for(E=0,V=0,K=this._rings.length;E<K;E++)for(De=this._rings[E],O=0,fe=De.length;O<fe-1;O++)Ce=_d(De[O],De[O+1],f,O,!0),Ce&&(v[V]=v[V]||[],v[V].push(Ce[0]),(Ce[1]!==De[O+1]||O===fe-2)&&(v[V].push(Ce[1]),V++))}},_simplifyPoints:function(){for(var f=this._parts,v=this.options.smoothFactor,E=0,O=f.length;E<O;E++)f[E]=yu(f[E],v)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,v){var E,O,V,K,fe,Ce,De=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(E=0,K=this._parts.length;E<K;E++)for(Ce=this._parts[E],O=0,fe=Ce.length,V=fe-1;O<fe;V=O++)if(!(!v&&O===0)&&vu(f,Ce[V],Ce[O])<=De)return!0;return!1}});function _m(f,v){return new ls(f,v)}ls._flat=wu;var cs=ls.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return jo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var v=ls.prototype._convertLatLngs.call(this,f),E=v.length;return E>=2&&v[0]instanceof Fe&&v[0].equals(v[E-1])&&v.pop(),v},_setLatLngs:function(f){ls.prototype._setLatLngs.call(this,f),Gr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Gr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,v=this.options.weight,E=new q(v,v);if(f=new Y(f.min.subtract(E),f.max.add(E)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var O=0,V=this._rings.length,K;O<V;O++)K=kh(this._rings[O],f,!0),K.length&&this._parts.push(K)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var v=!1,E,O,V,K,fe,Ce,De,Je;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(K=0,De=this._parts.length;K<De;K++)for(E=this._parts[K],fe=0,Je=E.length,Ce=Je-1;fe<Je;Ce=fe++)O=E[fe],V=E[Ce],O.y>f.y!=V.y>f.y&&f.x<(V.x-O.x)*(f.y-O.y)/(V.y-O.y)+O.x&&(v=!v);return v||ls.prototype._containsPoint.call(this,f,!0)}});function ym(f,v){return new cs(f,v)}var us=zn.extend({initialize:function(f,v){T(this,v),this._layers={},f&&this.addData(f)},addData:function(f){var v=M(f)?f:f.features,E,O,V;if(v){for(E=0,O=v.length;E<O;E++)V=v[E],(V.geometries||V.geometry||V.features||V.coordinates)&&this.addData(V);return this}var K=this.options;if(K.filter&&!K.filter(f))return this;var fe=xr(f,K);return fe?(fe.feature=Ac(f),fe.defaultOptions=fe.options,this.resetStyle(fe),K.onEachFeature&&K.onEachFeature(f,fe),this.addLayer(fe)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=r({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(v){this._setLayerStyle(v,f)},this)},_setLayerStyle:function(f,v){f.setStyle&&(typeof v=="function"&&(v=v(f.feature)),f.setStyle(v))}});function xr(f,v){var E=f.type==="Feature"?f.geometry:f,O=E?E.coordinates:null,V=[],K=v&&v.pointToLayer,fe=v&&v.coordsToLatLng||Aa,Ce,De,Je,wt;if(!O&&!E)return null;switch(E.type){case"Point":return Ce=fe(O),Za(K,f,Ce,v);case"MultiPoint":for(Je=0,wt=O.length;Je<wt;Je++)Ce=fe(O[Je]),V.push(Za(K,f,Ce,v));return new zn(V);case"LineString":case"MultiLineString":return De=hs(O,E.type==="LineString"?0:1,fe),new ls(De,v);case"Polygon":case"MultiPolygon":return De=hs(O,E.type==="Polygon"?1:2,fe),new cs(De,v);case"GeometryCollection":for(Je=0,wt=E.geometries.length;Je<wt;Je++){var en=xr({geometry:E.geometries[Je],type:"Feature",properties:f.properties},v);en&&V.push(en)}return new zn(V);case"FeatureCollection":for(Je=0,wt=E.features.length;Je<wt;Je++){var bn=xr(E.features[Je],v);bn&&V.push(bn)}return new zn(V);default:throw new Error("Invalid GeoJSON object.")}}function Za(f,v,E,O){return f?f(v,E):new Eo(E,O&&O.markersInheritOptions&&O)}function Aa(f){return new Fe(f[1],f[0],f[2])}function hs(f,v,E){for(var O=[],V=0,K=f.length,fe;V<K;V++)fe=v?hs(f[V],v-1,E):(E||Aa)(f[V]),O.push(fe);return O}function Ec(f,v){return f=Be(f),f.alt!==void 0?[m(f.lng,v),m(f.lat,v),m(f.alt,v)]:[m(f.lng,v),m(f.lat,v)]}function Ma(f,v,E,O){for(var V=[],K=0,fe=f.length;K<fe;K++)V.push(v?Ma(f[K],Gr(f[K])?0:v-1,E,O):Ec(f[K],O));return!v&&E&&V.length>0&&V.push(V[0].slice()),V}function Il(f,v){return f.feature?r({},f.feature,{geometry:v}):Ac(v)}function Ac(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var li={toGeoJSON:function(f){return Il(this,{type:"Point",coordinates:Ec(this.getLatLng(),f)})}};Eo.include(li),Ya.include(li),Ea.include(li),ls.include({toGeoJSON:function(f){var v=!Gr(this._latlngs),E=Ma(this._latlngs,v?1:0,!1,f);return Il(this,{type:(v?"Multi":"")+"LineString",coordinates:E})}}),cs.include({toGeoJSON:function(f){var v=!Gr(this._latlngs),E=v&&!Gr(this._latlngs[0]),O=Ma(this._latlngs,E?2:v?1:0,!0,f);return v||(O=[O]),Il(this,{type:(E?"Multi":"")+"Polygon",coordinates:O})}}),zi.include({toMultiPoint:function(f){var v=[];return this.eachLayer(function(E){v.push(E.toGeoJSON(f).geometry.coordinates)}),Il(this,{type:"MultiPoint",coordinates:v})},toGeoJSON:function(f){var v=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(v==="MultiPoint")return this.toMultiPoint(f);var E=v==="GeometryCollection",O=[];return this.eachLayer(function(V){if(V.toGeoJSON){var K=V.toGeoJSON(f);if(E)O.push(K.geometry);else{var fe=Ac(K);fe.type==="FeatureCollection"?O.push.apply(O,fe.features):O.push(fe)}}}),E?Il(this,{geometries:O,type:"GeometryCollection"}):{type:"FeatureCollection",features:O}}});function Tu(f,v){return new us(f,v)}var Is=Tu,Xo=Rs.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,v,E){this._url=f,this._bounds=Re(v),T(this,E)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Wt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Xr(this._image),this},bringToBack:function(){return this._map&&Fi(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=Re(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",v=this._image=f?this._url:Qt("img");if(Dt(v,"leaflet-image-layer"),this._zoomAnimated&&Dt(v,"leaflet-zoom-animated"),this.options.className&&Dt(v,this.options.className),v.onselectstart=d,v.onmousemove=d,v.onload=o(this.fire,this,"load"),v.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=v.src;return}v.src=this._url,v.alt=this.options.alt},_animateZoom:function(f){var v=this._map.getZoomScale(f.zoom),E=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;vo(this._image,E,v)},_reset:function(){var f=this._image,v=new Y(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),E=v.getSize();Ui(f,v.min),f.style.width=E.x+"px",f.style.height=E.y+"px"},_updateOpacity:function(){Ki(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Eu=function(f,v,E){return new Xo(f,v,E)},fs=Xo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",v=this._image=f?this._url:Qt("video");if(Dt(v,"leaflet-image-layer"),this._zoomAnimated&&Dt(v,"leaflet-zoom-animated"),this.options.className&&Dt(v,this.options.className),v.onselectstart=d,v.onmousemove=d,v.onloadeddata=o(this.fire,this,"load"),f){for(var E=v.getElementsByTagName("source"),O=[],V=0;V<E.length;V++)O.push(E[V].src);this._url=E.length>0?O:[v.src];return}M(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(v.style,"objectFit")&&(v.style.objectFit="fill"),v.autoplay=!!this.options.autoplay,v.loop=!!this.options.loop,v.muted=!!this.options.muted,v.playsInline=!!this.options.playsInline;for(var K=0;K<this._url.length;K++){var fe=Qt("source");fe.src=this._url[K],v.appendChild(fe)}}});function kl(f,v,E){return new fs(f,v,E)}var mi=Xo.extend({_initImage:function(){var f=this._image=this._url;Dt(f,"leaflet-image-layer"),this._zoomAnimated&&Dt(f,"leaflet-zoom-animated"),this.options.className&&Dt(f,this.options.className),f.onselectstart=d,f.onmousemove=d}});function or(f,v,E){return new mi(f,v,E)}var ei=Rs.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,v){f&&(f instanceof Fe||M(f))?(this._latlng=Be(f),T(this,v)):(T(this,f),this._source=v),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&Ki(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&Ki(this._container,1),this.bringToFront(),this.options.interactive&&(Dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(Ki(this._container,0),this._removeTimeout=setTimeout(o(Wt,void 0,this._container),200)):Wt(this._container),this.options.interactive&&(Fn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=Be(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Xr(this._container),this},bringToBack:function(){return this._map&&Fi(this._container),this},_prepareOpen:function(f){var v=this._source;if(!v._map)return!1;if(v instanceof zn){v=null;var E=this._source._layers;for(var O in E)if(E[O]._map){v=E[O];break}if(!v)return!1;this._source=v}if(!f)if(v.getCenter)f=v.getCenter();else if(v.getLatLng)f=v.getLatLng();else if(v.getBounds)f=v.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,v=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof v=="string")f.innerHTML=v;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(v)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),v=X(this.options.offset),E=this._getAnchor();this._zoomAnimated?Ui(this._container,f.add(E)):v=v.add(f).add(E);var O=this._containerBottom=-v.y,V=this._containerLeft=-Math.round(this._containerWidth/2)+v.x;this._container.style.bottom=O+"px",this._container.style.left=V+"px"}},_getAnchor:function(){return[0,0]}});Nn.include({_initOverlay:function(f,v,E,O){var V=v;return V instanceof f||(V=new f(O).setContent(v)),E&&V.setLatLng(E),V}}),Rs.include({_initOverlay:function(f,v,E,O){var V=E;return V instanceof f?(T(V,O),V._source=this):(V=v&&!O?v:new f(O,this),V.setContent(E)),V}});var Ol=ei.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,ei.prototype.openOn.call(this,f)},onAdd:function(f){ei.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof qs||this._source.on("preclick",Wo))},onRemove:function(f){ei.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof qs||this._source.off("preclick",Wo))},getEvents:function(){var f=ei.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",v=this._container=Qt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),E=this._wrapper=Qt("div",f+"-content-wrapper",v);if(this._contentNode=Qt("div",f+"-content",E),as(v),Al(this._contentNode),cn(v,"contextmenu",Wo),this._tipContainer=Qt("div",f+"-tip-container",v),this._tip=Qt("div",f+"-tip",this._tipContainer),this.options.closeButton){var O=this._closeButton=Qt("a",f+"-close-button",v);O.setAttribute("role","button"),O.setAttribute("aria-label","Close popup"),O.href="#close",O.innerHTML='<span aria-hidden="true">&#215;</span>',cn(O,"click",function(V){Oi(V),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,v=f.style;v.width="",v.whiteSpace="nowrap";var E=f.offsetWidth;E=Math.min(E,this.options.maxWidth),E=Math.max(E,this.options.minWidth),v.width=E+1+"px",v.whiteSpace="",v.height="";var O=f.offsetHeight,V=this.options.maxHeight,K="leaflet-popup-scrolled";V&&O>V?(v.height=V+"px",Dt(f,K)):Fn(f,K),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var v=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),E=this._getAnchor();Ui(this._container,v.add(E))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,v=parseInt(It(this._container,"marginBottom"),10)||0,E=this._container.offsetHeight+v,O=this._containerWidth,V=new q(this._containerLeft,-E-this._containerBottom);V._add(Xs(this._container));var K=f.layerPointToContainerPoint(V),fe=X(this.options.autoPanPadding),Ce=X(this.options.autoPanPaddingTopLeft||fe),De=X(this.options.autoPanPaddingBottomRight||fe),Je=f.getSize(),wt=0,en=0;K.x+O+De.x>Je.x&&(wt=K.x+O-Je.x+De.x),K.x-wt-Ce.x<0&&(wt=K.x-Ce.x),K.y+E+De.y>Je.y&&(en=K.y+E-Je.y+De.y),K.y-en-Ce.y<0&&(en=K.y-Ce.y),(wt||en)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([wt,en]))}},_getAnchor:function(){return X(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Go=function(f,v){return new Ol(f,v)};Nn.mergeOptions({closePopupOnClick:!0}),Nn.include({openPopup:function(f,v,E){return this._initOverlay(Ol,f,v,E).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Rs.include({bindPopup:function(f,v){return this._popup=this._initOverlay(Ol,this._popup,f,v),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof zn||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){bo(f);var v=f.layer||f.target;if(this._popup._source===v&&!(v instanceof qs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=v,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var Yo=ei.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){ei.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){ei.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=ei.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",v=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Qt("div",v),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var v,E,O=this._map,V=this._container,K=O.latLngToContainerPoint(O.getCenter()),fe=O.layerPointToContainerPoint(f),Ce=this.options.direction,De=V.offsetWidth,Je=V.offsetHeight,wt=X(this.options.offset),en=this._getAnchor();Ce==="top"?(v=De/2,E=Je):Ce==="bottom"?(v=De/2,E=0):Ce==="center"?(v=De/2,E=Je/2):Ce==="right"?(v=0,E=Je/2):Ce==="left"?(v=De,E=Je/2):fe.x<K.x?(Ce="right",v=0,E=Je/2):(Ce="left",v=De+(wt.x+en.x)*2,E=Je/2),f=f.subtract(X(v,E,!0)).add(wt).add(en),Fn(V,"leaflet-tooltip-right"),Fn(V,"leaflet-tooltip-left"),Fn(V,"leaflet-tooltip-top"),Fn(V,"leaflet-tooltip-bottom"),Dt(V,"leaflet-tooltip-"+Ce),Ui(V,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&Ki(this._container,f)},_animateZoom:function(f){var v=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(v)},_getAnchor:function(){return X(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Au=function(f,v){return new Yo(f,v)};Nn.include({openTooltip:function(f,v,E){return this._initOverlay(Yo,f,v,E).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Rs.include({bindTooltip:function(f,v){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Yo,this._tooltip,f,v),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var v=f?"off":"on",E={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?E.add=this._openTooltip:(E.mouseover=this._openTooltip,E.mouseout=this.closeTooltip,E.click=this._openTooltip,this._map?this._addFocusListeners():E.add=this._addFocusListeners),this._tooltip.options.sticky&&(E.mousemove=this._moveTooltip),this[v](E),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof zn||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var v=typeof f.getElement=="function"&&f.getElement();v&&(cn(v,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),cn(v,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var v=typeof f.getElement=="function"&&f.getElement();v&&v.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var v=this;this._map.once("moveend",function(){v._openOnceFlag=!1,v._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var v=f.latlng,E,O;this._tooltip.options.sticky&&f.originalEvent&&(E=this._map.mouseEventToContainerPoint(f.originalEvent),O=this._map.containerPointToLayerPoint(E),v=this._map.layerPointToLatLng(O)),this._tooltip.setLatLng(v)}});var Ji=vr.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var v=f&&f.tagName==="DIV"?f:document.createElement("div"),E=this.options;if(E.html instanceof Element?(ai(v),v.appendChild(E.html)):v.innerHTML=E.html!==!1?E.html:"",E.bgPos){var O=X(E.bgPos);v.style.backgroundPosition=-O.x+"px "+-O.y+"px"}return this._setIconStyles(v,"icon"),v},createShadow:function(){return null}});function Fh(f){return new Ji(f)}vr.Default=Rl;var qo=Rs.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Lt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){T(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),Wt(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Xr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Fi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof q?f:new q(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var v=this.getPane().children,E=-f(-1/0,1/0),O=0,V=v.length,K;O<V;O++)K=v[O].style.zIndex,v[O]!==this._container&&K&&(E=f(E,+K));isFinite(E)&&(this.options.zIndex=E+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Lt.ielt9){Ki(this._container,this.options.opacity);var f=+new Date,v=!1,E=!1;for(var O in this._tiles){var V=this._tiles[O];if(!(!V.current||!V.loaded)){var K=Math.min(1,(f-V.loaded)/200);Ki(V.el,K),K<1?v=!0:(V.active?E=!0:this._onOpaqueTile(V),V.active=!0)}}E&&!this._noPrune&&this._pruneTiles(),v&&(le(this._fadeFrame),this._fadeFrame=J(this._updateOpacity,this))}},_onOpaqueTile:d,_initContainer:function(){this._container||(this._container=Qt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,v=this.options.maxZoom;if(f!==void 0){for(var E in this._levels)E=Number(E),this._levels[E].el.children.length||E===f?(this._levels[E].el.style.zIndex=v-Math.abs(f-E),this._onUpdateLevel(E)):(Wt(this._levels[E].el),this._removeTilesAtZoom(E),this._onRemoveLevel(E),delete this._levels[E]);var O=this._levels[f],V=this._map;return O||(O=this._levels[f]={},O.el=Qt("div","leaflet-tile-container leaflet-zoom-animated",this._container),O.el.style.zIndex=v,O.origin=V.project(V.unproject(V.getPixelOrigin()),f).round(),O.zoom=f,this._setZoomTransform(O,V.getCenter(),V.getZoom()),d(O.el.offsetWidth),this._onCreateLevel(O)),this._level=O,O}},_onUpdateLevel:d,_onRemoveLevel:d,_onCreateLevel:d,_pruneTiles:function(){if(this._map){var f,v,E=this._map.getZoom();if(E>this.options.maxZoom||E<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)v=this._tiles[f],v.retain=v.current;for(f in this._tiles)if(v=this._tiles[f],v.current&&!v.active){var O=v.coords;this._retainParent(O.x,O.y,O.z,O.z-5)||this._retainChildren(O.x,O.y,O.z,O.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var v in this._tiles)this._tiles[v].coords.z===f&&this._removeTile(v)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)Wt(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,v,E,O){var V=Math.floor(f/2),K=Math.floor(v/2),fe=E-1,Ce=new q(+V,+K);Ce.z=+fe;var De=this._tileCoordsToKey(Ce),Je=this._tiles[De];return Je&&Je.active?(Je.retain=!0,!0):(Je&&Je.loaded&&(Je.retain=!0),fe>O?this._retainParent(V,K,fe,O):!1)},_retainChildren:function(f,v,E,O){for(var V=2*f;V<2*f+2;V++)for(var K=2*v;K<2*v+2;K++){var fe=new q(V,K);fe.z=E+1;var Ce=this._tileCoordsToKey(fe),De=this._tiles[Ce];if(De&&De.active){De.retain=!0;continue}else De&&De.loaded&&(De.retain=!0);E+1<O&&this._retainChildren(V,K,E+1,O)}},_resetView:function(f){var v=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),v,v)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var v=this.options;return v.minNativeZoom!==void 0&&f<v.minNativeZoom?v.minNativeZoom:v.maxNativeZoom!==void 0&&v.maxNativeZoom<f?v.maxNativeZoom:f},_setView:function(f,v,E,O){var V=Math.round(v);this.options.maxZoom!==void 0&&V>this.options.maxZoom||this.options.minZoom!==void 0&&V<this.options.minZoom?V=void 0:V=this._clampZoom(V);var K=this.options.updateWhenZooming&&V!==this._tileZoom;(!O||K)&&(this._tileZoom=V,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),V!==void 0&&this._update(f),E||this._pruneTiles(),this._noPrune=!!E),this._setZoomTransforms(f,v)},_setZoomTransforms:function(f,v){for(var E in this._levels)this._setZoomTransform(this._levels[E],f,v)},_setZoomTransform:function(f,v,E){var O=this._map.getZoomScale(E,f.zoom),V=f.origin.multiplyBy(O).subtract(this._map._getNewPixelOrigin(v,E)).round();Lt.any3d?vo(f.el,V,O):Ui(f.el,V)},_resetGrid:function(){var f=this._map,v=f.options.crs,E=this._tileSize=this.getTileSize(),O=this._tileZoom,V=this._map.getPixelWorldBounds(this._tileZoom);V&&(this._globalTileRange=this._pxBoundsToTileRange(V)),this._wrapX=v.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,v.wrapLng[0]],O).x/E.x),Math.ceil(f.project([0,v.wrapLng[1]],O).x/E.y)],this._wrapY=v.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([v.wrapLat[0],0],O).y/E.x),Math.ceil(f.project([v.wrapLat[1],0],O).y/E.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var v=this._map,E=v._animatingZoom?Math.max(v._animateToZoom,v.getZoom()):v.getZoom(),O=v.getZoomScale(E,this._tileZoom),V=v.project(f,this._tileZoom).floor(),K=v.getSize().divideBy(O*2);return new Y(V.subtract(K),V.add(K))},_update:function(f){var v=this._map;if(v){var E=this._clampZoom(v.getZoom());if(f===void 0&&(f=v.getCenter()),this._tileZoom!==void 0){var O=this._getTiledPixelBounds(f),V=this._pxBoundsToTileRange(O),K=V.getCenter(),fe=[],Ce=this.options.keepBuffer,De=new Y(V.getBottomLeft().subtract([Ce,-Ce]),V.getTopRight().add([Ce,-Ce]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Je in this._tiles){var wt=this._tiles[Je].coords;(wt.z!==this._tileZoom||!De.contains(new q(wt.x,wt.y)))&&(this._tiles[Je].current=!1)}if(Math.abs(E-this._tileZoom)>1){this._setView(f,E);return}for(var en=V.min.y;en<=V.max.y;en++)for(var bn=V.min.x;bn<=V.max.x;bn++){var br=new q(bn,en);if(br.z=this._tileZoom,!!this._isValidTile(br)){var Vi=this._tiles[this._tileCoordsToKey(br)];Vi?Vi.current=!0:fe.push(br)}}if(fe.sort(function(ds,Fl){return ds.distanceTo(K)-Fl.distanceTo(K)}),fe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Yr=document.createDocumentFragment();for(bn=0;bn<fe.length;bn++)this._addTile(fe[bn],Yr);this._level.el.appendChild(Yr)}}}},_isValidTile:function(f){var v=this._map.options.crs;if(!v.infinite){var E=this._globalTileRange;if(!v.wrapLng&&(f.x<E.min.x||f.x>E.max.x)||!v.wrapLat&&(f.y<E.min.y||f.y>E.max.y))return!1}if(!this.options.bounds)return!0;var O=this._tileCoordsToBounds(f);return Re(this.options.bounds).overlaps(O)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var v=this._map,E=this.getTileSize(),O=f.scaleBy(E),V=O.add(E),K=v.unproject(O,f.z),fe=v.unproject(V,f.z);return[K,fe]},_tileCoordsToBounds:function(f){var v=this._tileCoordsToNwSe(f),E=new Me(v[0],v[1]);return this.options.noWrap||(E=this._map.wrapLatLngBounds(E)),E},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var v=f.split(":"),E=new q(+v[0],+v[1]);return E.z=+v[2],E},_removeTile:function(f){var v=this._tiles[f];v&&(Wt(v.el),delete this._tiles[f],this.fire("tileunload",{tile:v.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Dt(f,"leaflet-tile");var v=this.getTileSize();f.style.width=v.x+"px",f.style.height=v.y+"px",f.onselectstart=d,f.onmousemove=d,Lt.ielt9&&this.options.opacity<1&&Ki(f,this.options.opacity)},_addTile:function(f,v){var E=this._getTilePos(f),O=this._tileCoordsToKey(f),V=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(V),this.createTile.length<2&&J(o(this._tileReady,this,f,null,V)),Ui(V,E),this._tiles[O]={el:V,coords:f,current:!0},v.appendChild(V),this.fire("tileloadstart",{tile:V,coords:f})},_tileReady:function(f,v,E){v&&this.fire("tileerror",{error:v,tile:E,coords:f});var O=this._tileCoordsToKey(f);E=this._tiles[O],E&&(E.loaded=+new Date,this._map._fadeAnimated?(Ki(E.el,0),le(this._fadeFrame),this._fadeFrame=J(this._updateOpacity,this)):(E.active=!0,this._pruneTiles()),v||(Dt(E.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:E.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Lt.ielt9||!this._map._fadeAnimated?J(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var v=new q(this._wrapX?u(f.x,this._wrapX):f.x,this._wrapY?u(f.y,this._wrapY):f.y);return v.z=f.z,v},_pxBoundsToTileRange:function(f){var v=this.getTileSize();return new Y(f.min.unscaleBy(v).floor(),f.max.unscaleBy(v).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function Ka(f){return new qo(f)}var Or=qo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,v){this._url=f,v=T(this,v),v.detectRetina&&Lt.retina&&v.maxZoom>0?(v.tileSize=Math.floor(v.tileSize/2),v.zoomReverse?(v.zoomOffset--,v.minZoom=Math.min(v.maxZoom,v.minZoom+1)):(v.zoomOffset++,v.maxZoom=Math.max(v.minZoom,v.maxZoom-1)),v.minZoom=Math.max(0,v.minZoom)):v.zoomReverse?v.minZoom=Math.min(v.maxZoom,v.minZoom):v.maxZoom=Math.max(v.minZoom,v.maxZoom),typeof v.subdomains=="string"&&(v.subdomains=v.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,v){return this._url===f&&v===void 0&&(v=!0),this._url=f,v||this.redraw(),this},createTile:function(f,v){var E=document.createElement("img");return cn(E,"load",o(this._tileOnLoad,this,v,E)),cn(E,"error",o(this._tileOnError,this,v,E)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(E.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(E.referrerPolicy=this.options.referrerPolicy),E.alt="",E.src=this.getTileUrl(f),E},getTileUrl:function(f){var v={r:Lt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var E=this._globalTileRange.max.y-f.y;this.options.tms&&(v.y=E),v["-y"]=E}return P(this._url,r(v,this.options))},_tileOnLoad:function(f,v){Lt.ielt9?setTimeout(o(f,this,null,v),0):f(null,v)},_tileOnError:function(f,v,E){var O=this.options.errorTileUrl;O&&v.getAttribute("src")!==O&&(v.src=O),f(E,v)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,v=this.options.maxZoom,E=this.options.zoomReverse,O=this.options.zoomOffset;return E&&(f=v-f),f+O},_getSubdomain:function(f){var v=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[v]},_abortLoading:function(){var f,v;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(v=this._tiles[f].el,v.onload=d,v.onerror=d,!v.complete)){v.src=k;var E=this._tiles[f].coords;Wt(v),delete this._tiles[f],this.fire("tileabort",{tile:v,coords:E})}},_removeTile:function(f){var v=this._tiles[f];if(v)return v.el.setAttribute("src",k),qo.prototype._removeTile.call(this,f)},_tileReady:function(f,v,E){if(!(!this._map||E&&E.getAttribute("src")===k))return qo.prototype._tileReady.call(this,f,v,E)}});function Zs(f,v){return new Or(f,v)}var Ao=Or.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,v){this._url=f;var E=r({},this.defaultWmsParams);for(var O in v)O in this.options||(E[O]=v[O]);v=T(this,v);var V=v.detectRetina&&Lt.retina?2:1,K=this.getTileSize();E.width=K.x*V,E.height=K.y*V,this.wmsParams=E},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var v=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[v]=this._crs.code,Or.prototype.onAdd.call(this,f)},getTileUrl:function(f){var v=this._tileCoordsToNwSe(f),E=this._crs,O=ce(E.project(v[0]),E.project(v[1])),V=O.min,K=O.max,fe=(this._wmsVersion>=1.3&&this._crs===yd?[V.y,V.x,K.y,K.x]:[V.x,V.y,K.x,K.y]).join(","),Ce=Or.prototype.getTileUrl.call(this,f);return Ce+S(this.wmsParams,Ce,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+fe},setParams:function(f,v){return r(this.wmsParams,f),v||this.redraw(),this}});function Mu(f,v){return new Ao(f,v)}Or.WMS=Ao,Zs.wms=Mu;var ks=Rs.extend({options:{padding:.1},initialize:function(f){T(this,f),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,v){var E=this._map.getZoomScale(v,this._zoom),O=this._map.getSize().multiplyBy(.5+this.options.padding),V=this._map.project(this._center,v),K=O.multiplyBy(-E).add(V).subtract(this._map._getNewPixelOrigin(f,v));Lt.any3d?vo(this._container,K,E):Ui(this._container,K)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,v=this._map.getSize(),E=this._map.containerPointToLayerPoint(v.multiplyBy(-f)).round();this._bounds=new Y(E,E.add(v.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Uh=ks.extend({options:{tolerance:0},getEvents:function(){var f=ks.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ks.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");cn(f,"mousemove",this._onMouseMove,this),cn(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),cn(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){le(this._redrawRequest),delete this._ctx,Wt(this._container),si(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var v in this._layers)f=this._layers[v],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ks.prototype._update.call(this);var f=this._bounds,v=this._container,E=f.getSize(),O=Lt.retina?2:1;Ui(v,f.min),v.width=O*E.x,v.height=O*E.y,v.style.width=E.x+"px",v.style.height=E.y+"px",Lt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){ks.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[l(f)]=f;var v=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=v),this._drawLast=v,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var v=f._order,E=v.next,O=v.prev;E?E.prev=O:this._drawLast=O,O?O.next=E:this._drawFirst=E,delete f._order,delete this._layers[l(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var v=f.options.dashArray.split(/[, ]+/),E=[],O,V;for(V=0;V<v.length;V++){if(O=Number(v[V]),isNaN(O))return;E.push(O)}f.options._dashArray=E}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||J(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var v=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Y,this._redrawBounds.extend(f._pxBounds.min.subtract([v,v])),this._redrawBounds.extend(f._pxBounds.max.add([v,v]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var v=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,v.x,v.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,v=this._redrawBounds;if(this._ctx.save(),v){var E=v.getSize();this._ctx.beginPath(),this._ctx.rect(v.min.x,v.min.y,E.x,E.y),this._ctx.clip()}this._drawing=!0;for(var O=this._drawFirst;O;O=O.next)f=O.layer,(!v||f._pxBounds&&f._pxBounds.intersects(v))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,v){if(this._drawing){var E,O,V,K,fe=f._parts,Ce=fe.length,De=this._ctx;if(Ce){for(De.beginPath(),E=0;E<Ce;E++){for(O=0,V=fe[E].length;O<V;O++)K=fe[E][O],De[O?"lineTo":"moveTo"](K.x,K.y);v&&De.closePath()}this._fillStroke(De,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var v=f._point,E=this._ctx,O=Math.max(Math.round(f._radius),1),V=(Math.max(Math.round(f._radiusY),1)||O)/O;V!==1&&(E.save(),E.scale(1,V)),E.beginPath(),E.arc(v.x,v.y/V,O,0,Math.PI*2,!1),V!==1&&E.restore(),this._fillStroke(E,f)}},_fillStroke:function(f,v){var E=v.options;E.fill&&(f.globalAlpha=E.fillOpacity,f.fillStyle=E.fillColor||E.color,f.fill(E.fillRule||"evenodd")),E.stroke&&E.weight!==0&&(f.setLineDash&&f.setLineDash(v.options&&v.options._dashArray||[]),f.globalAlpha=E.opacity,f.lineWidth=E.weight,f.strokeStyle=E.color,f.lineCap=E.lineCap,f.lineJoin=E.lineJoin,f.stroke())},_onClick:function(f){for(var v=this._map.mouseEventToLayerPoint(f),E,O,V=this._drawFirst;V;V=V.next)E=V.layer,E.options.interactive&&E._containsPoint(v)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(E))&&(O=E);this._fireEvent(O?[O]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var v=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,v)}},_handleMouseOut:function(f){var v=this._hoveredLayer;v&&(Fn(this._container,"leaflet-interactive"),this._fireEvent([v],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,v){if(!this._mouseHoverThrottled){for(var E,O,V=this._drawFirst;V;V=V.next)E=V.layer,E.options.interactive&&E._containsPoint(v)&&(O=E);O!==this._hoveredLayer&&(this._handleMouseOut(f),O&&(Dt(this._container,"leaflet-interactive"),this._fireEvent([O],f,"mouseover"),this._hoveredLayer=O)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,v,E){this._map._fireDOMEvent(v,E||v.type,f)},_bringToFront:function(f){var v=f._order;if(v){var E=v.next,O=v.prev;if(E)E.prev=O;else return;O?O.next=E:E&&(this._drawFirst=E),v.prev=this._drawLast,this._drawLast.next=v,v.next=null,this._drawLast=v,this._requestRedraw(f)}},_bringToBack:function(f){var v=f._order;if(v){var E=v.next,O=v.prev;if(O)O.next=E;else return;E?E.prev=O:O&&(this._drawLast=O),v.prev=null,v.next=this._drawFirst,this._drawFirst.prev=v,this._drawFirst=v,this._requestRedraw(f)}}});function Bh(f){return Lt.canvas?new Uh(f):null}var Ll=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),bd={_initContainer:function(){this._container=Qt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ks.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var v=f._container=Ll("shape");Dt(v,"leaflet-vml-shape "+(this.options.className||"")),v.coordsize="1 1",f._path=Ll("path"),v.appendChild(f._path),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){var v=f._container;this._container.appendChild(v),f.options.interactive&&f.addInteractiveTarget(v)},_removePath:function(f){var v=f._container;Wt(v),f.removeInteractiveTarget(v),delete this._layers[l(f)]},_updateStyle:function(f){var v=f._stroke,E=f._fill,O=f.options,V=f._container;V.stroked=!!O.stroke,V.filled=!!O.fill,O.stroke?(v||(v=f._stroke=Ll("stroke")),V.appendChild(v),v.weight=O.weight+"px",v.color=O.color,v.opacity=O.opacity,O.dashArray?v.dashStyle=M(O.dashArray)?O.dashArray.join(" "):O.dashArray.replace(/( *, *)/g," "):v.dashStyle="",v.endcap=O.lineCap.replace("butt","flat"),v.joinstyle=O.lineJoin):v&&(V.removeChild(v),f._stroke=null),O.fill?(E||(E=f._fill=Ll("fill")),V.appendChild(E),E.color=O.fillColor||O.color,E.opacity=O.fillOpacity):E&&(V.removeChild(E),f._fill=null)},_updateCircle:function(f){var v=f._point.round(),E=Math.round(f._radius),O=Math.round(f._radiusY||E);this._setPath(f,f._empty()?"M0 0":"AL "+v.x+","+v.y+" "+E+","+O+" 0,"+65535*360)},_setPath:function(f,v){f._path.v=v},_bringToFront:function(f){Xr(f._container)},_bringToBack:function(f){Fi(f._container)}},Ks=Lt.vml?Ll:lt,Ja=ks.extend({_initContainer:function(){this._container=Ks("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ks("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Wt(this._container),si(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ks.prototype._update.call(this);var f=this._bounds,v=f.getSize(),E=this._container;(!this._svgSize||!this._svgSize.equals(v))&&(this._svgSize=v,E.setAttribute("width",v.x),E.setAttribute("height",v.y)),Ui(E,f.min),E.setAttribute("viewBox",[f.min.x,f.min.y,v.x,v.y].join(" ")),this.fire("update")}},_initPath:function(f){var v=f._path=Ks("path");f.options.className&&Dt(v,f.options.className),f.options.interactive&&Dt(v,"leaflet-interactive"),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){Wt(f._path),f.removeInteractiveTarget(f._path),delete this._layers[l(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var v=f._path,E=f.options;v&&(E.stroke?(v.setAttribute("stroke",E.color),v.setAttribute("stroke-opacity",E.opacity),v.setAttribute("stroke-width",E.weight),v.setAttribute("stroke-linecap",E.lineCap),v.setAttribute("stroke-linejoin",E.lineJoin),E.dashArray?v.setAttribute("stroke-dasharray",E.dashArray):v.removeAttribute("stroke-dasharray"),E.dashOffset?v.setAttribute("stroke-dashoffset",E.dashOffset):v.removeAttribute("stroke-dashoffset")):v.setAttribute("stroke","none"),E.fill?(v.setAttribute("fill",E.fillColor||E.color),v.setAttribute("fill-opacity",E.fillOpacity),v.setAttribute("fill-rule",E.fillRule||"evenodd")):v.setAttribute("fill","none"))},_updatePoly:function(f,v){this._setPath(f,Ke(f._parts,v))},_updateCircle:function(f){var v=f._point,E=Math.max(Math.round(f._radius),1),O=Math.max(Math.round(f._radiusY),1)||E,V="a"+E+","+O+" 0 1,0 ",K=f._empty()?"M0 0":"M"+(v.x-E)+","+v.y+V+E*2+",0 "+V+-E*2+",0 ";this._setPath(f,K)},_setPath:function(f,v){f._path.setAttribute("d",v)},_bringToFront:function(f){Xr(f._path)},_bringToBack:function(f){Fi(f._path)}});Lt.vml&&Ja.include(bd);function Mc(f){return Lt.svg||Lt.vml?new Ja(f):null}Nn.include({getRenderer:function(f){var v=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return v||(v=this._renderer=this._createRenderer()),this.hasLayer(v)||this.addLayer(v),v},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var v=this._paneRenderers[f];return v===void 0&&(v=this._createRenderer({pane:f}),this._paneRenderers[f]=v),v},_createRenderer:function(f){return this.options.preferCanvas&&Bh(f)||Mc(f)}});var Cc=cs.extend({initialize:function(f,v){cs.prototype.initialize.call(this,this._boundsToLatLngs(f),v)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=Re(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function vm(f,v){return new Cc(f,v)}Ja.create=Ks,Ja.pointsToPath=Ke,us.geometryToLayer=xr,us.coordsToLatLng=Aa,us.coordsToLatLngs=hs,us.latLngToCoords=Ec,us.latLngsToCoords=Ma,us.getFeature=Il,us.asFeature=Ac,Nn.mergeOptions({boxZoom:!0});var Ca=wi.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){cn(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){si(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Wt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),In(),Mh(),this._startPoint=this._map.mouseEventToContainerPoint(f),cn(document,{contextmenu:bo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Qt("div","leaflet-zoom-box",this._container),Dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var v=new Y(this._point,this._startPoint),E=v.getSize();Ui(this._box,v.min),this._box.style.width=E.x+"px",this._box.style.height=E.y+"px"},_finish:function(){this._moved&&(Wt(this._box),Fn(this._container,"leaflet-crosshair")),Ho(),_c(),si(document,{contextmenu:bo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var v=new Me(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(v).fire("boxzoomend",{boxZoomBounds:v})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Nn.addInitHook("addHandler","boxZoom",Ca),Nn.mergeOptions({doubleClickZoom:!0});var Cu=wi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var v=this._map,E=v.getZoom(),O=v.options.zoomDelta,V=f.originalEvent.shiftKey?E-O:E+O;v.options.doubleClickZoom==="center"?v.setZoom(V):v.setZoomAround(f.containerPoint,V)}});Nn.addInitHook("addHandler","doubleClickZoom",Cu),Nn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Pu=wi.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new Ms(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Fn(this._map._container,"leaflet-grab"),Fn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var v=Re(this._map.options.maxBounds);this._offsetLimit=ce(this._map.latLngToContainerPoint(v.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(v.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var v=this._lastTime=+new Date,E=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(E),this._times.push(v),this._prunePositions(v)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),v=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=v.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,v){return f-(f-v)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),v=this._offsetLimit;f.x<v.min.x&&(f.x=this._viscousLimit(f.x,v.min.x)),f.y<v.min.y&&(f.y=this._viscousLimit(f.y,v.min.y)),f.x>v.max.x&&(f.x=this._viscousLimit(f.x,v.max.x)),f.y>v.max.y&&(f.y=this._viscousLimit(f.y,v.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,v=Math.round(f/2),E=this._initialWorldOffset,O=this._draggable._newPos.x,V=(O-v+E)%f+v-E,K=(O+v+E)%f-v-E,fe=Math.abs(V+E)<Math.abs(K+E)?V:K;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=fe},_onDragEnd:function(f){var v=this._map,E=v.options,O=!E.inertia||f.noInertia||this._times.length<2;if(v.fire("dragend",f),O)v.fire("moveend");else{this._prunePositions(+new Date);var V=this._lastPos.subtract(this._positions[0]),K=(this._lastTime-this._times[0])/1e3,fe=E.easeLinearity,Ce=V.multiplyBy(fe/K),De=Ce.distanceTo([0,0]),Je=Math.min(E.inertiaMaxSpeed,De),wt=Ce.multiplyBy(Je/De),en=Je/(E.inertiaDeceleration*fe),bn=wt.multiplyBy(-en/2).round();!bn.x&&!bn.y?v.fire("moveend"):(bn=v._limitOffset(bn,v.options.maxBounds),J(function(){v.panBy(bn,{duration:en,easeLinearity:fe,noMoveStart:!0,animate:!0})}))}}});Nn.addInitHook("addHandler","dragging",Pu),Nn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Nl=wi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),cn(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),si(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,v=document.documentElement,E=f.scrollTop||v.scrollTop,O=f.scrollLeft||v.scrollLeft;this._map._container.focus(),window.scrollTo(O,E)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var v=this._panKeys={},E=this.keyCodes,O,V;for(O=0,V=E.left.length;O<V;O++)v[E.left[O]]=[-1*f,0];for(O=0,V=E.right.length;O<V;O++)v[E.right[O]]=[f,0];for(O=0,V=E.down.length;O<V;O++)v[E.down[O]]=[0,f];for(O=0,V=E.up.length;O<V;O++)v[E.up[O]]=[0,-1*f]},_setZoomDelta:function(f){var v=this._zoomKeys={},E=this.keyCodes,O,V;for(O=0,V=E.zoomIn.length;O<V;O++)v[E.zoomIn[O]]=f;for(O=0,V=E.zoomOut.length;O<V;O++)v[E.zoomOut[O]]=-f},_addHooks:function(){cn(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){si(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var v=f.keyCode,E=this._map,O;if(v in this._panKeys){if(!E._panAnim||!E._panAnim._inProgress)if(O=this._panKeys[v],f.shiftKey&&(O=X(O).multiplyBy(3)),E.options.maxBounds&&(O=E._limitOffset(X(O),E.options.maxBounds)),E.options.worldCopyJump){var V=E.wrapLatLng(E.unproject(E.project(E.getCenter()).add(O)));E.panTo(V)}else E.panBy(O)}else if(v in this._zoomKeys)E.setZoom(E.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[v]);else if(v===27&&E._popup&&E._popup.options.closeOnEscapeKey)E.closePopup();else return;bo(f)}}});Nn.addInitHook("addHandler","keyboard",Nl),Nn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ti=wi.extend({addHooks:function(){cn(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){si(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var v=Ph(f),E=this._map.options.wheelDebounceTime;this._delta+=v,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var O=Math.max(E-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),O),bo(f)},_performZoom:function(){var f=this._map,v=f.getZoom(),E=this._map.options.zoomSnap||0;f._stop();var O=this._delta/(this._map.options.wheelPxPerZoomLevel*4),V=4*Math.log(2/(1+Math.exp(-Math.abs(O))))/Math.LN2,K=E?Math.ceil(V/E)*E:V,fe=f._limitZoom(v+(this._delta>0?K:-K))-v;this._delta=0,this._startTime=null,fe&&(f.options.scrollWheelZoom==="center"?f.setZoom(v+fe):f.setZoomAround(this._lastMousePos,v+fe))}});Nn.addInitHook("addHandler","scrollWheelZoom",ti);var zh=600;Nn.mergeOptions({tapHold:Lt.touchNative&&Lt.safari&&Lt.mobile,tapTolerance:15});var Pc=wi.extend({addHooks:function(){cn(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){si(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var v=f.touches[0];this._startPos=this._newPos=new q(v.clientX,v.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(cn(document,"touchend",Oi),cn(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",v))},this),zh),cn(document,"touchend touchcancel contextmenu",this._cancel,this),cn(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){si(document,"touchend",Oi),si(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),si(document,"touchend touchcancel contextmenu",this._cancel,this),si(document,"touchmove",this._onMove,this)},_onMove:function(f){var v=f.touches[0];this._newPos=new q(v.clientX,v.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,v){var E=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:v.screenX,screenY:v.screenY,clientX:v.clientX,clientY:v.clientY});E._simulated=!0,v.target.dispatchEvent(E)}});Nn.addInitHook("addHandler","tapHold",Pc),Nn.mergeOptions({touchZoom:Lt.touch,bounceAtZoomLimits:!0});var Dl=wi.extend({addHooks:function(){Dt(this._map._container,"leaflet-touch-zoom"),cn(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Fn(this._map._container,"leaflet-touch-zoom"),si(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var v=this._map;if(!(!f.touches||f.touches.length!==2||v._animatingZoom||this._zooming)){var E=v.mouseEventToContainerPoint(f.touches[0]),O=v.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=v.getSize()._divideBy(2),this._startLatLng=v.containerPointToLatLng(this._centerPoint),v.options.touchZoom!=="center"&&(this._pinchStartLatLng=v.containerPointToLatLng(E.add(O)._divideBy(2))),this._startDist=E.distanceTo(O),this._startZoom=v.getZoom(),this._moved=!1,this._zooming=!0,v._stop(),cn(document,"touchmove",this._onTouchMove,this),cn(document,"touchend touchcancel",this._onTouchEnd,this),Oi(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var v=this._map,E=v.mouseEventToContainerPoint(f.touches[0]),O=v.mouseEventToContainerPoint(f.touches[1]),V=E.distanceTo(O)/this._startDist;if(this._zoom=v.getScaleZoom(V,this._startZoom),!v.options.bounceAtZoomLimits&&(this._zoom<v.getMinZoom()&&V<1||this._zoom>v.getMaxZoom()&&V>1)&&(this._zoom=v._limitZoom(this._zoom)),v.options.touchZoom==="center"){if(this._center=this._startLatLng,V===1)return}else{var K=E._add(O)._divideBy(2)._subtract(this._centerPoint);if(V===1&&K.x===0&&K.y===0)return;this._center=v.unproject(v.project(this._pinchStartLatLng,this._zoom).subtract(K),this._zoom)}this._moved||(v._moveStart(!0,!1),this._moved=!0),le(this._animRequest);var fe=o(v._move,v,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=J(fe,this,!0),Oi(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,le(this._animRequest),si(document,"touchmove",this._onTouchMove,this),si(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Nn.addInitHook("addHandler","touchZoom",Dl),Nn.BoxZoom=Ca,Nn.DoubleClickZoom=Cu,Nn.Drag=Pu,Nn.Keyboard=Nl,Nn.ScrollWheelZoom=ti,Nn.TapHold=Pc,Nn.TouchZoom=Dl,t.Bounds=Y,t.Browser=Lt,t.CRS=at,t.Canvas=Uh,t.Circle=Ya,t.CircleMarker=Ea,t.Class=te,t.Control=Es,t.DivIcon=Ji,t.DivOverlay=ei,t.DomEvent=Rh,t.DomUtil=El,t.Draggable=Ms,t.Evented=me,t.FeatureGroup=zn,t.GeoJSON=us,t.GridLayer=qo,t.Handler=wi,t.Icon=vr,t.ImageOverlay=Xo,t.LatLng=Fe,t.LatLngBounds=Me,t.Layer=Rs,t.LayerGroup=zi,t.LineUtil=Ps,t.Map=Nn,t.Marker=Eo,t.Mixin=Gs,t.Path=qs,t.Point=q,t.PolyUtil=Oh,t.Polygon=cs,t.Polyline=ls,t.Popup=Ol,t.PosAnimation=Ts,t.Projection=Ta,t.Rectangle=Cc,t.Renderer=ks,t.SVG=Ja,t.SVGOverlay=mi,t.TileLayer=Or,t.Tooltip=Yo,t.Transformation=Rt,t.Util=ge,t.VideoOverlay=fs,t.bind=o,t.bounds=ce,t.canvas=Bh,t.circle=qa,t.circleMarker=Dh,t.control=sr,t.divIcon=Fh,t.extend=r,t.featureGroup=Tc,t.geoJSON=Tu,t.geoJson=Is,t.gridLayer=Ka,t.icon=xd,t.imageOverlay=Eu,t.latLng=Be,t.latLngBounds=Re,t.layerGroup=yr,t.map=wo,t.marker=gm,t.point=X,t.polygon=ym,t.polyline=_m,t.popup=Go,t.rectangle=vm,t.setOptions=T,t.stamp=l,t.svg=Mc,t.svgOverlay=or,t.tileLayer=Zs,t.tooltip=Au,t.transformation=he,t.version=i,t.videoOverlay=kl;var Vh=window.L;t.noConflict=function(){return window.L=Vh,this},window.L=t}))})(My,My.exports)),My.exports}var od=h$();const c0=AP(od);function u0(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function FS(n,e){return e==null?function(i,r){const s=G.useRef();return s.current||(s.current=n(i,r)),s}:function(i,r){const s=G.useRef();s.current||(s.current=n(i,r));const o=G.useRef(i),{instance:a}=s.current;return G.useEffect(function(){o.current!==i&&(e(a,i,o.current),o.current=i)},[a,i,r]),s}}function e4(n,e){G.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){e.layerContainer?.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function t4(n){return function(t){const i=NS(),r=n(DS(t,i),i);return ZB(i.map,t.attribution),LP(r.current,t.eventHandlers),e4(r.current,i),r}}function f$(n,e){const t=G.useRef();G.useEffect(function(){if(e.pathOptions!==t.current){const r=e.pathOptions??{};n.instance.setStyle(r),t.current=r}},[n,e])}function d$(n){return function(t){const i=NS(),r=n(DS(t,i),i);return LP(r.current,t.eventHandlers),e4(r.current,i),f$(r.current,t),r}}function p$(n,e){const t=FS(n,e),i=t4(t);return QB(i)}function m$(n,e){const t=FS(n),i=c$(t,e);return a$(i)}function n4(n,e){const t=FS(n,e),i=d$(t);return QB(i)}function g$(n,e){const t=FS(n,e),i=t4(t);return l$(i)}function _$(n,e,t){const{opacity:i,zIndex:r}=e;i!=null&&i!==t.opacity&&n.setOpacity(i),r!=null&&r!==t.zIndex&&n.setZIndex(r)}function y$(){return NS().map}function v$(n){const e=y$();return G.useEffect(function(){return e.on(n),function(){e.off(n)}},[e,n]),e}const x$=n4(function({center:e,children:t,...i},r){const s=new od.Circle(e,i);return u0(s,OP(r,{overlayContainer:s}))},r$);function eM(){return eM=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},eM.apply(this,arguments)}function b$({bounds:n,boundsOptions:e,center:t,children:i,className:r,id:s,placeholder:o,style:a,whenReady:l,zoom:c,...u},d){const[m]=G.useState({className:r,id:s,style:a}),[y,x]=G.useState(null);G.useImperativeHandle(d,()=>y?.map??null,[y]);const T=G.useCallback(w=>{if(w!==null&&y===null){const P=new od.Map(w,u);t!=null&&c!=null?P.setView(t,c):n!=null&&P.fitBounds(n,e),l!=null&&P.whenReady(l),x(o$(P))}},[]);G.useEffect(()=>()=>{y?.map.remove()},[y]);const S=y?ic.createElement(JB,{value:y},i):o??null;return ic.createElement("div",eM({},m,{ref:T}),S)}const NP=G.forwardRef(b$),Ug=p$(function({position:e,...t},i){const r=new od.Marker(e,t);return u0(r,OP(i,{overlayContainer:r}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==i.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==i.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),w$=n4(function({positions:e,...t},i){const r=new od.Polyline(e,t);return u0(r,OP(i,{overlayContainer:r}))},function(e,t,i){t.positions!==i.positions&&e.setLatLngs(t.positions)}),mv=m$(function(e,t){const i=new od.Popup(e,t.overlayContainer);return u0(i,t)},function(e,t,{position:i},r){G.useEffect(function(){const{instance:o}=e;function a(c){c.popup===o&&(o.update(),r(!0))}function l(c){c.popup===o&&r(!1)}return t.map.on({popupopen:a,popupclose:l}),t.overlayContainer==null?(i!=null&&o.setLatLng(i),o.openOn(t.map)):t.overlayContainer.bindPopup(o),function(){t.map.off({popupopen:a,popupclose:l}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(o)}},[e,t,r,i])}),DP=g$(function({url:e,...t},i){const r=new od.TileLayer(e,DS(t,i));return u0(r,i)},function(e,t,i){_$(e,t,i);const{url:r}=t;r!=null&&r!==i.url&&e.setUrl(r)});var ME={},C3;function S$(){return C3||(C3=1,(function(n,e,t){L.AwesomeMarkers={},L.AwesomeMarkers.version="2.0.1",L.AwesomeMarkers.Icon=L.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],shadowAnchor:[10,12],shadowSize:[36,16],className:"awesome-marker",prefix:"glyphicon",spinClass:"fa-spin",extraClasses:"",icon:"home",markerColor:"blue",iconColor:"white"},initialize:function(i){i=L.Util.setOptions(this,i)},createIcon:function(){var i=e.createElement("div"),r=this.options;return r.icon&&(i.innerHTML=this._createInner()),r.bgPos&&(i.style.backgroundPosition=-r.bgPos.x+"px "+-r.bgPos.y+"px"),this._setIconStyles(i,"icon-"+r.markerColor),i},_createInner:function(){var i,r="",s="",o="",a=this.options;return a.icon.slice(0,a.prefix.length+1)===a.prefix+"-"?i=a.icon:i=a.prefix+"-"+a.icon,a.spin&&typeof a.spinClass=="string"&&(r=a.spinClass),a.iconColor&&(a.iconColor==="white"||a.iconColor==="black"?s="icon-"+a.iconColor:o="style='color: "+a.iconColor+"' "),"<i "+o+"class='"+a.extraClasses+" "+a.prefix+" "+i+" "+r+" "+s+"'></i>"},_setIconStyles:function(i,r){var s=this.options,o=L.point(s[r==="shadow"?"shadowSize":"iconSize"]),a;r==="shadow"?a=L.point(s.shadowAnchor||s.iconAnchor):a=L.point(s.iconAnchor),!a&&o&&(a=o.divideBy(2,!0)),i.className="awesome-marker-"+r+" "+s.className,a&&(i.style.marginLeft=-a.x+"px",i.style.marginTop=-a.y+"px"),o&&(i.style.width=o.x+"px",i.style.height=o.y+"px")},createShadow:function(){var i=e.createElement("div");return this._setIconStyles(i,"shadow"),i}}),L.AwesomeMarkers.icon=function(i){return new L.AwesomeMarkers.Icon(i)}})(ME,document)),ME}S$();function i4(n,e){return function(){return n.apply(e,arguments)}}const{toString:T$}=Object.prototype,{getPrototypeOf:FP}=Object,{iterator:US,toStringTag:r4}=Symbol,BS=(n=>e=>{const t=T$.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),fc=n=>(n=n.toLowerCase(),e=>BS(e)===n),zS=n=>e=>typeof e===n,{isArray:T_}=Array,Zg=zS("undefined");function h0(n){return n!==null&&!Zg(n)&&n.constructor!==null&&!Zg(n.constructor)&&da(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const s4=fc("ArrayBuffer");function E$(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&s4(n.buffer),e}const A$=zS("string"),da=zS("function"),o4=zS("number"),f0=n=>n!==null&&typeof n=="object",M$=n=>n===!0||n===!1,ew=n=>{if(BS(n)!=="object")return!1;const e=FP(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(r4 in n)&&!(US in n)},C$=n=>{if(!f0(n)||h0(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},P$=fc("Date"),R$=fc("File"),I$=fc("Blob"),k$=fc("FileList"),O$=n=>f0(n)&&da(n.pipe),L$=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||da(n.append)&&((e=BS(n))==="formdata"||e==="object"&&da(n.toString)&&n.toString()==="[object FormData]"))},N$=fc("URLSearchParams"),[D$,F$,U$,B$]=["ReadableStream","Request","Response","Headers"].map(fc),z$=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function d0(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,r;if(typeof n!="object"&&(n=[n]),T_(n))for(i=0,r=n.length;i<r;i++)e.call(null,n[i],i,n);else{if(h0(n))return;const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(i=0;i<o;i++)a=s[i],e.call(null,n[a],a,n)}}function a4(n,e){if(h0(n))return null;e=e.toLowerCase();const t=Object.keys(n);let i=t.length,r;for(;i-- >0;)if(r=t[i],e===r.toLowerCase())return r;return null}const mp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,l4=n=>!Zg(n)&&n!==mp;function tM(){const{caseless:n,skipUndefined:e}=l4(this)&&this||{},t={},i=(r,s)=>{const o=n&&a4(t,s)||s;ew(t[o])&&ew(r)?t[o]=tM(t[o],r):ew(r)?t[o]=tM({},r):T_(r)?t[o]=r.slice():(!e||!Zg(r))&&(t[o]=r)};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&d0(arguments[r],i);return t}const V$=(n,e,t,{allOwnKeys:i}={})=>(d0(e,(r,s)=>{t&&da(r)?n[s]=i4(r,t):n[s]=r},{allOwnKeys:i}),n),H$=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),W$=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},j$=(n,e,t,i)=>{let r,s,o;const a={};if(e=e||{},n==null)return e;do{for(r=Object.getOwnPropertyNames(n),s=r.length;s-- >0;)o=r[s],(!i||i(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&FP(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},$$=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},X$=n=>{if(!n)return null;if(T_(n))return n;let e=n.length;if(!o4(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},G$=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&FP(Uint8Array)),Y$=(n,e)=>{const i=(n&&n[US]).call(n);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(n,s[0],s[1])}},q$=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},Z$=fc("HTMLFormElement"),K$=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),P3=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),J$=fc("RegExp"),c4=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};d0(t,(r,s)=>{let o;(o=e(r,s,n))!==!1&&(i[s]=o||r)}),Object.defineProperties(n,i)},Q$=n=>{c4(n,(e,t)=>{if(da(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(da(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},eX=(n,e)=>{const t={},i=r=>{r.forEach(s=>{t[s]=!0})};return T_(n)?i(n):i(String(n).split(e)),t},tX=()=>{},nX=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function iX(n){return!!(n&&da(n.append)&&n[r4]==="FormData"&&n[US])}const rX=n=>{const e=new Array(10),t=(i,r)=>{if(f0(i)){if(e.indexOf(i)>=0)return;if(h0(i))return i;if(!("toJSON"in i)){e[r]=i;const s=T_(i)?[]:{};return d0(i,(o,a)=>{const l=t(o,r+1);!Zg(l)&&(s[a]=l)}),e[r]=void 0,s}}return i};return t(n,0)},sX=fc("AsyncFunction"),oX=n=>n&&(f0(n)||da(n))&&da(n.then)&&da(n.catch),u4=((n,e)=>n?setImmediate:e?((t,i)=>(mp.addEventListener("message",({source:r,data:s})=>{r===mp&&s===t&&i.length&&i.shift()()},!1),r=>{i.push(r),mp.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",da(mp.postMessage)),aX=typeof queueMicrotask<"u"?queueMicrotask.bind(mp):typeof process<"u"&&process.nextTick||u4,lX=n=>n!=null&&da(n[US]),Ve={isArray:T_,isArrayBuffer:s4,isBuffer:h0,isFormData:L$,isArrayBufferView:E$,isString:A$,isNumber:o4,isBoolean:M$,isObject:f0,isPlainObject:ew,isEmptyObject:C$,isReadableStream:D$,isRequest:F$,isResponse:U$,isHeaders:B$,isUndefined:Zg,isDate:P$,isFile:R$,isBlob:I$,isRegExp:J$,isFunction:da,isStream:O$,isURLSearchParams:N$,isTypedArray:G$,isFileList:k$,forEach:d0,merge:tM,extend:V$,trim:z$,stripBOM:H$,inherits:W$,toFlatObject:j$,kindOf:BS,kindOfTest:fc,endsWith:$$,toArray:X$,forEachEntry:Y$,matchAll:q$,isHTMLForm:Z$,hasOwnProperty:P3,hasOwnProp:P3,reduceDescriptors:c4,freezeMethods:Q$,toObjectSet:eX,toCamelCase:K$,noop:tX,toFiniteNumber:nX,findKey:a4,global:mp,isContextDefined:l4,isSpecCompliantForm:iX,toJSONObject:rX,isAsyncFn:sX,isThenable:oX,setImmediate:u4,asap:aX,isIterable:lX};function An(n,e,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Ve.inherits(An,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ve.toJSONObject(this.config),code:this.code,status:this.status}}});const h4=An.prototype,f4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{f4[n]={value:n}});Object.defineProperties(An,f4);Object.defineProperty(h4,"isAxiosError",{value:!0});An.from=(n,e,t,i,r,s)=>{const o=Object.create(h4);Ve.toFlatObject(n,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const a=n&&n.message?n.message:"Error",l=e==null&&n?n.code:e;return An.call(o,a,l,t,i,r),n&&o.cause==null&&Object.defineProperty(o,"cause",{value:n,configurable:!0}),o.name=n&&n.name||"Error",s&&Object.assign(o,s),o};const cX=null;function nM(n){return Ve.isPlainObject(n)||Ve.isArray(n)}function d4(n){return Ve.endsWith(n,"[]")?n.slice(0,-2):n}function R3(n,e,t){return n?n.concat(e).map(function(r,s){return r=d4(r),!t&&s?"["+r+"]":r}).join(t?".":""):e}function uX(n){return Ve.isArray(n)&&!n.some(nM)}const hX=Ve.toFlatObject(Ve,{},null,function(e){return/^is[A-Z]/.test(e)});function VS(n,e,t){if(!Ve.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=Ve.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,S){return!Ve.isUndefined(S[T])});const i=t.metaTokens,r=t.visitor||u,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&Ve.isSpecCompliantForm(e);if(!Ve.isFunction(r))throw new TypeError("visitor must be a function");function c(x){if(x===null)return"";if(Ve.isDate(x))return x.toISOString();if(Ve.isBoolean(x))return x.toString();if(!l&&Ve.isBlob(x))throw new An("Blob is not supported. Use a Buffer instead.");return Ve.isArrayBuffer(x)||Ve.isTypedArray(x)?l&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function u(x,T,S){let w=x;if(x&&!S&&typeof x=="object"){if(Ve.endsWith(T,"{}"))T=i?T:T.slice(0,-2),x=JSON.stringify(x);else if(Ve.isArray(x)&&uX(x)||(Ve.isFileList(x)||Ve.endsWith(T,"[]"))&&(w=Ve.toArray(x)))return T=d4(T),w.forEach(function(M,I){!(Ve.isUndefined(M)||M===null)&&e.append(o===!0?R3([T],I,s):o===null?T:T+"[]",c(M))}),!1}return nM(x)?!0:(e.append(R3(S,T,s),c(x)),!1)}const d=[],m=Object.assign(hX,{defaultVisitor:u,convertValue:c,isVisitable:nM});function y(x,T){if(!Ve.isUndefined(x)){if(d.indexOf(x)!==-1)throw Error("Circular reference detected in "+T.join("."));d.push(x),Ve.forEach(x,function(w,P){(!(Ve.isUndefined(w)||w===null)&&r.call(e,w,Ve.isString(P)?P.trim():P,T,m))===!0&&y(w,T?T.concat(P):[P])}),d.pop()}}if(!Ve.isObject(n))throw new TypeError("data must be an object");return y(n),e}function I3(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function UP(n,e){this._pairs=[],n&&VS(n,this,e)}const p4=UP.prototype;p4.append=function(e,t){this._pairs.push([e,t])};p4.toString=function(e){const t=e?function(i){return e.call(this,i,I3)}:I3;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function fX(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function m4(n,e,t){if(!e)return n;const i=t&&t.encode||fX;Ve.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let s;if(r?s=r(e,t):s=Ve.isURLSearchParams(e)?e.toString():new UP(e,t).toString(i),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class k3{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ve.forEach(this.handlers,function(i){i!==null&&e(i)})}}const g4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dX=typeof URLSearchParams<"u"?URLSearchParams:UP,pX=typeof FormData<"u"?FormData:null,mX=typeof Blob<"u"?Blob:null,gX={isBrowser:!0,classes:{URLSearchParams:dX,FormData:pX,Blob:mX},protocols:["http","https","file","blob","url","data"]},BP=typeof window<"u"&&typeof document<"u",iM=typeof navigator=="object"&&navigator||void 0,_X=BP&&(!iM||["ReactNative","NativeScript","NS"].indexOf(iM.product)<0),yX=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vX=BP&&window.location.href||"http://localhost",xX=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:BP,hasStandardBrowserEnv:_X,hasStandardBrowserWebWorkerEnv:yX,navigator:iM,origin:vX},Symbol.toStringTag,{value:"Module"})),ho={...xX,...gX};function bX(n,e){return VS(n,new ho.classes.URLSearchParams,{visitor:function(t,i,r,s){return ho.isNode&&Ve.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function wX(n){return Ve.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function SX(n){const e={},t=Object.keys(n);let i;const r=t.length;let s;for(i=0;i<r;i++)s=t[i],e[s]=n[s];return e}function _4(n){function e(t,i,r,s){let o=t[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&Ve.isArray(r)?r.length:o,l?(Ve.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!Ve.isObject(r[o]))&&(r[o]=[]),e(t,i,r[o],s)&&Ve.isArray(r[o])&&(r[o]=SX(r[o])),!a)}if(Ve.isFormData(n)&&Ve.isFunction(n.entries)){const t={};return Ve.forEachEntry(n,(i,r)=>{e(wX(i),r,t,0)}),t}return null}function TX(n,e,t){if(Ve.isString(n))try{return(e||JSON.parse)(n),Ve.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const p0={transitional:g4,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,s=Ve.isObject(e);if(s&&Ve.isHTMLForm(e)&&(e=new FormData(e)),Ve.isFormData(e))return r?JSON.stringify(_4(e)):e;if(Ve.isArrayBuffer(e)||Ve.isBuffer(e)||Ve.isStream(e)||Ve.isFile(e)||Ve.isBlob(e)||Ve.isReadableStream(e))return e;if(Ve.isArrayBufferView(e))return e.buffer;if(Ve.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return bX(e,this.formSerializer).toString();if((a=Ve.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return VS(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),TX(e)):e}],transformResponse:[function(e){const t=this.transitional||p0.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(Ve.isResponse(e)||Ve.isReadableStream(e))return e;if(e&&Ve.isString(e)&&(i&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?An.from(a,An.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ho.classes.FormData,Blob:ho.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ve.forEach(["delete","get","head","post","put","patch"],n=>{p0.headers[n]={}});const EX=Ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),AX=n=>{const e={};let t,i,r;return n&&n.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!t||e[t]&&EX[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},O3=Symbol("internals");function ry(n){return n&&String(n).trim().toLowerCase()}function tw(n){return n===!1||n==null?n:Ve.isArray(n)?n.map(tw):String(n)}function MX(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const CX=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function CE(n,e,t,i,r){if(Ve.isFunction(i))return i.call(this,e,t);if(r&&(e=t),!!Ve.isString(e)){if(Ve.isString(i))return e.indexOf(i)!==-1;if(Ve.isRegExp(i))return i.test(e)}}function PX(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function RX(n,e){const t=Ve.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(r,s,o){return this[i].call(this,e,r,s,o)},configurable:!0})})}let pa=class{constructor(e){e&&this.set(e)}set(e,t,i){const r=this;function s(a,l,c){const u=ry(l);if(!u)throw new Error("header name must be a non-empty string");const d=Ve.findKey(r,u);(!d||r[d]===void 0||c===!0||c===void 0&&r[d]!==!1)&&(r[d||l]=tw(a))}const o=(a,l)=>Ve.forEach(a,(c,u)=>s(c,u,l));if(Ve.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(Ve.isString(e)&&(e=e.trim())&&!CX(e))o(AX(e),t);else if(Ve.isObject(e)&&Ve.isIterable(e)){let a={},l,c;for(const u of e){if(!Ve.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?Ve.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,t)}else e!=null&&s(t,e,i);return this}get(e,t){if(e=ry(e),e){const i=Ve.findKey(this,e);if(i){const r=this[i];if(!t)return r;if(t===!0)return MX(r);if(Ve.isFunction(t))return t.call(this,r,i);if(Ve.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ry(e),e){const i=Ve.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||CE(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let r=!1;function s(o){if(o=ry(o),o){const a=Ve.findKey(i,o);a&&(!t||CE(i,i[a],a,t))&&(delete i[a],r=!0)}}return Ve.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const s=t[i];(!e||CE(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const t=this,i={};return Ve.forEach(this,(r,s)=>{const o=Ve.findKey(i,s);if(o){t[o]=tw(r),delete t[s];return}const a=e?PX(s):String(s).trim();a!==s&&delete t[s],t[a]=tw(r),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ve.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=e&&Ve.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[O3]=this[O3]={accessors:{}}).accessors,r=this.prototype;function s(o){const a=ry(o);i[a]||(RX(r,o),i[a]=!0)}return Ve.isArray(e)?e.forEach(s):s(e),this}};pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ve.reduceDescriptors(pa.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}});Ve.freezeMethods(pa);function PE(n,e){const t=this||p0,i=e||t,r=pa.from(i.headers);let s=i.data;return Ve.forEach(n,function(a){s=a.call(t,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function y4(n){return!!(n&&n.__CANCEL__)}function E_(n,e,t){An.call(this,n??"canceled",An.ERR_CANCELED,e,t),this.name="CanceledError"}Ve.inherits(E_,An,{__CANCEL__:!0});function v4(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new An("Request failed with status code "+t.status,[An.ERR_BAD_REQUEST,An.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function IX(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function kX(n,e){n=n||10;const t=new Array(n),i=new Array(n);let r=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=i[s];o||(o=c),t[r]=l,i[r]=c;let d=s,m=0;for(;d!==r;)m+=t[d++],d=d%n;if(r=(r+1)%n,r===s&&(s=(s+1)%n),c-o<e)return;const y=u&&c-u;return y?Math.round(m*1e3/y):void 0}}function OX(n,e){let t=0,i=1e3/e,r,s;const o=(c,u=Date.now())=>{t=u,r=null,s&&(clearTimeout(s),s=null),n(...c)};return[(...c)=>{const u=Date.now(),d=u-t;d>=i?o(c,u):(r=c,s||(s=setTimeout(()=>{s=null,o(r)},i-d)))},()=>r&&o(r)]}const Iw=(n,e,t=3)=>{let i=0;const r=kX(50,250);return OX(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-i,c=r(l),u=o<=a;i=o;const d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(d)},t)},L3=(n,e)=>{const t=n!=null;return[i=>e[0]({lengthComputable:t,total:n,loaded:i}),e[1]]},N3=n=>(...e)=>Ve.asap(()=>n(...e)),LX=ho.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,ho.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(ho.origin),ho.navigator&&/(msie|trident)/i.test(ho.navigator.userAgent)):()=>!0,NX=ho.hasStandardBrowserEnv?{write(n,e,t,i,r,s,o){if(typeof document>"u")return;const a=[`${n}=${encodeURIComponent(e)}`];Ve.isNumber(t)&&a.push(`expires=${new Date(t).toUTCString()}`),Ve.isString(i)&&a.push(`path=${i}`),Ve.isString(r)&&a.push(`domain=${r}`),s===!0&&a.push("secure"),Ve.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function DX(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function FX(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function x4(n,e,t){let i=!DX(e);return n&&(i||t==!1)?FX(n,e):e}const D3=n=>n instanceof pa?{...n}:n;function zp(n,e){e=e||{};const t={};function i(c,u,d,m){return Ve.isPlainObject(c)&&Ve.isPlainObject(u)?Ve.merge.call({caseless:m},c,u):Ve.isPlainObject(u)?Ve.merge({},u):Ve.isArray(u)?u.slice():u}function r(c,u,d,m){if(Ve.isUndefined(u)){if(!Ve.isUndefined(c))return i(void 0,c,d,m)}else return i(c,u,d,m)}function s(c,u){if(!Ve.isUndefined(u))return i(void 0,u)}function o(c,u){if(Ve.isUndefined(u)){if(!Ve.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function a(c,u,d){if(d in e)return i(c,u);if(d in n)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,d)=>r(D3(c),D3(u),d,!0)};return Ve.forEach(Object.keys({...n,...e}),function(u){const d=l[u]||r,m=d(n[u],e[u],u);Ve.isUndefined(m)&&d!==a||(t[u]=m)}),t}const b4=n=>{const e=zp({},n);let{data:t,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:o,auth:a}=e;if(e.headers=o=pa.from(o),e.url=m4(x4(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),Ve.isFormData(t)){if(ho.hasStandardBrowserEnv||ho.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Ve.isFunction(t.getHeaders)){const l=t.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([u,d])=>{c.includes(u.toLowerCase())&&o.set(u,d)})}}if(ho.hasStandardBrowserEnv&&(i&&Ve.isFunction(i)&&(i=i(e)),i||i!==!1&&LX(e.url))){const l=r&&s&&NX.read(s);l&&o.set(r,l)}return e},UX=typeof XMLHttpRequest<"u",BX=UX&&function(n){return new Promise(function(t,i){const r=b4(n);let s=r.data;const o=pa.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,d,m,y,x;function T(){y&&y(),x&&x(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let S=new XMLHttpRequest;S.open(r.method.toUpperCase(),r.url,!0),S.timeout=r.timeout;function w(){if(!S)return;const M=pa.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),k={data:!a||a==="text"||a==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:M,config:n,request:S};v4(function(H){t(H),T()},function(H){i(H),T()},k),S=null}"onloadend"in S?S.onloadend=w:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(w)},S.onabort=function(){S&&(i(new An("Request aborted",An.ECONNABORTED,n,S)),S=null)},S.onerror=function(I){const k=I&&I.message?I.message:"Network Error",D=new An(k,An.ERR_NETWORK,n,S);D.event=I||null,i(D),S=null},S.ontimeout=function(){let I=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const k=r.transitional||g4;r.timeoutErrorMessage&&(I=r.timeoutErrorMessage),i(new An(I,k.clarifyTimeoutError?An.ETIMEDOUT:An.ECONNABORTED,n,S)),S=null},s===void 0&&o.setContentType(null),"setRequestHeader"in S&&Ve.forEach(o.toJSON(),function(I,k){S.setRequestHeader(k,I)}),Ve.isUndefined(r.withCredentials)||(S.withCredentials=!!r.withCredentials),a&&a!=="json"&&(S.responseType=r.responseType),c&&([m,x]=Iw(c,!0),S.addEventListener("progress",m)),l&&S.upload&&([d,y]=Iw(l),S.upload.addEventListener("progress",d),S.upload.addEventListener("loadend",y)),(r.cancelToken||r.signal)&&(u=M=>{S&&(i(!M||M.type?new E_(null,n,S):M),S.abort(),S=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const P=IX(r.url);if(P&&ho.protocols.indexOf(P)===-1){i(new An("Unsupported protocol "+P+":",An.ERR_BAD_REQUEST,n));return}S.send(s||null)})},zX=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let i=new AbortController,r;const s=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;i.abort(u instanceof An?u:new E_(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,s(new An(`timeout ${e} of ms exceeded`,An.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),n=null)};n.forEach(c=>c.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>Ve.asap(a),l}},VX=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let i=0,r;for(;i<t;)r=i+e,yield n.slice(i,r),i=r},HX=async function*(n,e){for await(const t of WX(n))yield*VX(t,e)},WX=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},F3=(n,e,t,i)=>{const r=HX(n,e);let s=0,o,a=l=>{o||(o=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let d=u.byteLength;if(t){let m=s+=d;t(m)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},U3=64*1024,{isFunction:Ax}=Ve,jX=(({Request:n,Response:e})=>({Request:n,Response:e}))(Ve.global),{ReadableStream:B3,TextEncoder:z3}=Ve.global,V3=(n,...e)=>{try{return!!n(...e)}catch{return!1}},$X=n=>{n=Ve.merge.call({skipUndefined:!0},jX,n);const{fetch:e,Request:t,Response:i}=n,r=e?Ax(e):typeof fetch=="function",s=Ax(t),o=Ax(i);if(!r)return!1;const a=r&&Ax(B3),l=r&&(typeof z3=="function"?(x=>T=>x.encode(T))(new z3):async x=>new Uint8Array(await new t(x).arrayBuffer())),c=s&&a&&V3(()=>{let x=!1;const T=new t(ho.origin,{body:new B3,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!T}),u=o&&a&&V3(()=>Ve.isReadableStream(new i("").body)),d={stream:u&&(x=>x.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!d[x]&&(d[x]=(T,S)=>{let w=T&&T[x];if(w)return w.call(T);throw new An(`Response type '${x}' is not supported`,An.ERR_NOT_SUPPORT,S)})});const m=async x=>{if(x==null)return 0;if(Ve.isBlob(x))return x.size;if(Ve.isSpecCompliantForm(x))return(await new t(ho.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Ve.isArrayBufferView(x)||Ve.isArrayBuffer(x))return x.byteLength;if(Ve.isURLSearchParams(x)&&(x=x+""),Ve.isString(x))return(await l(x)).byteLength},y=async(x,T)=>{const S=Ve.toFiniteNumber(x.getContentLength());return S??m(T)};return async x=>{let{url:T,method:S,data:w,signal:P,cancelToken:M,timeout:I,onDownloadProgress:k,onUploadProgress:D,responseType:H,headers:W,withCredentials:z="same-origin",fetchOptions:j}=b4(x),J=e||fetch;H=H?(H+"").toLowerCase():"text";let le=zX([P,M&&M.toAbortSignal()],I),ge=null;const te=le&&le.unsubscribe&&(()=>{le.unsubscribe()});let de;try{if(D&&c&&S!=="get"&&S!=="head"&&(de=await y(W,w))!==0){let Y=new t(T,{method:"POST",body:w,duplex:"half"}),ce;if(Ve.isFormData(w)&&(ce=Y.headers.get("content-type"))&&W.setContentType(ce),Y.body){const[Me,Re]=L3(de,Iw(N3(D)));w=F3(Y.body,U3,Me,Re)}}Ve.isString(z)||(z=z?"include":"omit");const ve=s&&"credentials"in t.prototype,me={...j,signal:le,method:S.toUpperCase(),headers:W.normalize().toJSON(),body:w,duplex:"half",credentials:ve?z:void 0};ge=s&&new t(T,me);let q=await(s?J(ge,j):J(T,me));const ie=u&&(H==="stream"||H==="response");if(u&&(k||ie&&te)){const Y={};["status","statusText","headers"].forEach(Fe=>{Y[Fe]=q[Fe]});const ce=Ve.toFiniteNumber(q.headers.get("content-length")),[Me,Re]=k&&L3(ce,Iw(N3(k),!0))||[];q=new i(F3(q.body,U3,Me,()=>{Re&&Re(),te&&te()}),Y)}H=H||"text";let X=await d[Ve.findKey(d,H)||"text"](q,x);return!ie&&te&&te(),await new Promise((Y,ce)=>{v4(Y,ce,{data:X,headers:pa.from(q.headers),status:q.status,statusText:q.statusText,config:x,request:ge})})}catch(ve){throw te&&te(),ve&&ve.name==="TypeError"&&/Load failed|fetch/i.test(ve.message)?Object.assign(new An("Network Error",An.ERR_NETWORK,x,ge),{cause:ve.cause||ve}):An.from(ve,ve&&ve.code,x,ge)}}},XX=new Map,w4=n=>{let e=n&&n.env||{};const{fetch:t,Request:i,Response:r}=e,s=[i,r,t];let o=s.length,a=o,l,c,u=XX;for(;a--;)l=s[a],c=u.get(l),c===void 0&&u.set(l,c=a?new Map:$X(e)),u=c;return c};w4();const zP={http:cX,xhr:BX,fetch:{get:w4}};Ve.forEach(zP,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const H3=n=>`- ${n}`,GX=n=>Ve.isFunction(n)||n===null||n===!1;function YX(n,e){n=Ve.isArray(n)?n:[n];const{length:t}=n;let i,r;const s={};for(let o=0;o<t;o++){i=n[o];let a;if(r=i,!GX(i)&&(r=zP[(a=String(i)).toLowerCase()],r===void 0))throw new An(`Unknown adapter '${a}'`);if(r&&(Ve.isFunction(r)||(r=r.get(e))))break;s[a||"#"+o]=r}if(!r){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=t?o.length>1?`since :
`+o.map(H3).join(`
`):" "+H3(o[0]):"as no adapter specified";throw new An("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r}const S4={getAdapter:YX,adapters:zP};function RE(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new E_(null,n)}function W3(n){return RE(n),n.headers=pa.from(n.headers),n.data=PE.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),S4.getAdapter(n.adapter||p0.adapter,n)(n).then(function(i){return RE(n),i.data=PE.call(n,n.transformResponse,i),i.headers=pa.from(i.headers),i},function(i){return y4(i)||(RE(n),i&&i.response&&(i.response.data=PE.call(n,n.transformResponse,i.response),i.response.headers=pa.from(i.response.headers))),Promise.reject(i)})}const T4="1.13.2",HS={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{HS[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const j3={};HS.transitional=function(e,t,i){function r(s,o){return"[Axios v"+T4+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new An(r(o," has been removed"+(t?" in "+t:"")),An.ERR_DEPRECATED);return t&&!j3[o]&&(j3[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};HS.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function qX(n,e,t){if(typeof n!="object")throw new An("options must be an object",An.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new An("option "+s+" must be "+l,An.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new An("Unknown option "+s,An.ERR_BAD_OPTION)}}const nw={assertOptions:qX,validators:HS},zc=nw.validators;let Ep=class{constructor(e){this.defaults=e||{},this.interceptors={request:new k3,response:new k3}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=zp(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:s}=t;i!==void 0&&nw.assertOptions(i,{silentJSONParsing:zc.transitional(zc.boolean),forcedJSONParsing:zc.transitional(zc.boolean),clarifyTimeoutError:zc.transitional(zc.boolean)},!1),r!=null&&(Ve.isFunction(r)?t.paramsSerializer={serialize:r}:nw.assertOptions(r,{encode:zc.function,serialize:zc.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),nw.assertOptions(t,{baseUrl:zc.spelling("baseURL"),withXsrfToken:zc.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&Ve.merge(s.common,s[t.method]);s&&Ve.forEach(["delete","get","head","post","put","patch","common"],x=>{delete s[x]}),t.headers=pa.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(t)===!1||(l=l&&T.synchronous,a.unshift(T.fulfilled,T.rejected))});const c=[];this.interceptors.response.forEach(function(T){c.push(T.fulfilled,T.rejected)});let u,d=0,m;if(!l){const x=[W3.bind(this),void 0];for(x.unshift(...a),x.push(...c),m=x.length,u=Promise.resolve(t);d<m;)u=u.then(x[d++],x[d++]);return u}m=a.length;let y=t;for(;d<m;){const x=a[d++],T=a[d++];try{y=x(y)}catch(S){T.call(this,S);break}}try{u=W3.call(this,y)}catch(x){return Promise.reject(x)}for(d=0,m=c.length;d<m;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=zp(this.defaults,e);const t=x4(e.baseURL,e.url,e.allowAbsoluteUrls);return m4(t,e.params,e.paramsSerializer)}};Ve.forEach(["delete","get","head","options"],function(e){Ep.prototype[e]=function(t,i){return this.request(zp(i||{},{method:e,url:t,data:(i||{}).data}))}});Ve.forEach(["post","put","patch"],function(e){function t(i){return function(s,o,a){return this.request(zp(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Ep.prototype[e]=t(),Ep.prototype[e+"Form"]=t(!0)});let ZX=class E4{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const o=new Promise(a=>{i.subscribe(a),s=a}).then(r);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new E_(s,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new E4(function(r){e=r}),cancel:e}}};function KX(n){return function(t){return n.apply(null,t)}}function JX(n){return Ve.isObject(n)&&n.isAxiosError===!0}const rM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(rM).forEach(([n,e])=>{rM[e]=n});function A4(n){const e=new Ep(n),t=i4(Ep.prototype.request,e);return Ve.extend(t,Ep.prototype,e,{allOwnKeys:!0}),Ve.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return A4(zp(n,r))},t}const Gi=A4(p0);Gi.Axios=Ep;Gi.CanceledError=E_;Gi.CancelToken=ZX;Gi.isCancel=y4;Gi.VERSION=T4;Gi.toFormData=VS;Gi.AxiosError=An;Gi.Cancel=Gi.CanceledError;Gi.all=function(e){return Promise.all(e)};Gi.spread=KX;Gi.isAxiosError=JX;Gi.mergeConfig=zp;Gi.AxiosHeaders=pa;Gi.formToJSON=n=>_4(Ve.isHTMLForm(n)?new FormData(n):n);Gi.getAdapter=S4.getAdapter;Gi.HttpStatusCode=rM;Gi.default=Gi;const{Axios:CPe,AxiosError:PPe,CanceledError:RPe,isCancel:IPe,CancelToken:kPe,VERSION:OPe,all:LPe,Cancel:NPe,isAxiosError:DPe,spread:FPe,toFormData:UPe,AxiosHeaders:BPe,HttpStatusCode:zPe,formToJSON:VPe,getAdapter:HPe,mergeConfig:WPe}=Gi;var $3={};const M4=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},QX=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},C4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4;let m=(a&15)<<2|c>>6,y=c&63;l||(y=64,o||(m=64)),i.push(t[u],t[d],t[m],t[y])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(M4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):QX(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const c=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||c==null||d==null)throw new eG;const m=s<<2|a>>4;if(i.push(m),c!==64){const y=a<<4&240|c>>2;if(i.push(y),d!==64){const x=c<<6&192|d;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class eG extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tG=function(n){const e=M4(n);return C4.encodeByteArray(e,!0)},P4=function(n){return tG(n).replace(/\./g,"")},R4=function(n){try{return C4.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function nG(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const iG=()=>nG().__FIREBASE_DEFAULTS__,rG=()=>{if(typeof process>"u"||typeof $3>"u")return;const n=$3.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},sG=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&R4(n[1]);return e&&JSON.parse(e)},VP=()=>{try{return iG()||rG()||sG()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},oG=n=>{var e,t;return(t=(e=VP())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},I4=()=>{var n;return(n=VP())===null||n===void 0?void 0:n.config},k4=n=>{var e;return(e=VP())===null||e===void 0?void 0:e[`_${n}`]};class aG{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Bo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lG(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bo())}function cG(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uG(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function hG(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fG(){const n=Bo();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function dG(){try{return typeof indexedDB=="object"}catch{return!1}}function pG(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const mG="FirebaseError";class ad extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=mG,Object.setPrototypeOf(this,ad.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m0.prototype.create)}}class m0{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?gG(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new ad(r,a,i)}}function gG(n,e){return n.replace(_G,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const _G=/\{\$([^}]+)}/g;function yG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function kw(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(X3(s)&&X3(o)){if(!kw(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function X3(n){return n!==null&&typeof n=="object"}function g0(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Cy(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function Py(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function vG(n,e){const t=new xG(n,e);return t.subscribe.bind(t)}class xG{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");bG(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=IE),r.error===void 0&&(r.error=IE),r.complete===void 0&&(r.complete=IE);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bG(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function IE(){}function xl(n){return n&&n._delegate?n._delegate:n}let Kg=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const rp="[DEFAULT]";let wG=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new aG;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TG(e))try{this.getOrInitializeService({instanceIdentifier:rp})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=rp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rp){return this.instances.has(e)}getOptions(e=rp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:SG(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=rp){return this.component?this.component.multipleInstances?e:rp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function SG(n){return n===rp?void 0:n}function TG(n){return n.instantiationMode==="EAGER"}class EG{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new wG(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ei;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ei||(Ei={}));const AG={debug:Ei.DEBUG,verbose:Ei.VERBOSE,info:Ei.INFO,warn:Ei.WARN,error:Ei.ERROR,silent:Ei.SILENT},MG=Ei.INFO,CG={[Ei.DEBUG]:"log",[Ei.VERBOSE]:"log",[Ei.INFO]:"info",[Ei.WARN]:"warn",[Ei.ERROR]:"error"},PG=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=CG[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class O4{constructor(e){this.name=e,this._logLevel=MG,this._logHandler=PG,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ei))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AG[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ei.DEBUG,...e),this._logHandler(this,Ei.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ei.VERBOSE,...e),this._logHandler(this,Ei.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ei.INFO,...e),this._logHandler(this,Ei.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ei.WARN,...e),this._logHandler(this,Ei.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ei.ERROR,...e),this._logHandler(this,Ei.ERROR,...e)}}const RG=(n,e)=>e.some(t=>n instanceof t);let G3,Y3;function IG(){return G3||(G3=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kG(){return Y3||(Y3=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const L4=new WeakMap,sM=new WeakMap,N4=new WeakMap,kE=new WeakMap,HP=new WeakMap;function OG(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Wf(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&L4.set(t,n)}).catch(()=>{}),HP.set(e,n),e}function LG(n){if(sM.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});sM.set(n,e)}let oM={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return sM.get(n);if(e==="objectStoreNames")return n.objectStoreNames||N4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wf(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function NG(n){oM=n(oM)}function DG(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(OE(this),e,...t);return N4.set(i,e.sort?e.sort():[e]),Wf(i)}:kG().includes(n)?function(...e){return n.apply(OE(this),e),Wf(L4.get(this))}:function(...e){return Wf(n.apply(OE(this),e))}}function FG(n){return typeof n=="function"?DG(n):(n instanceof IDBTransaction&&LG(n),RG(n,IG())?new Proxy(n,oM):n)}function Wf(n){if(n instanceof IDBRequest)return OG(n);if(kE.has(n))return kE.get(n);const e=FG(n);return e!==n&&(kE.set(n,e),HP.set(e,n)),e}const OE=n=>HP.get(n);function UG(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Wf(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Wf(o.result),l.oldVersion,l.newVersion,Wf(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const BG=["get","getKey","getAll","getAllKeys","count"],zG=["put","add","delete","clear"],LE=new Map;function q3(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(LE.get(e))return LE.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=zG.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||BG.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),r&&l.done]))[0]};return LE.set(e,s),s}NG(n=>({...n,get:(e,t,i)=>q3(e,t)||n.get(e,t,i),has:(e,t)=>!!q3(e,t)||n.has(e,t)}));class VG{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HG(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function HG(n){const e=n.getComponent();return e?.type==="VERSION"}const aM="@firebase/app",Z3="0.11.1";const fh=new O4("@firebase/app"),WG="@firebase/app-compat",jG="@firebase/analytics-compat",$G="@firebase/analytics",XG="@firebase/app-check-compat",GG="@firebase/app-check",YG="@firebase/auth",qG="@firebase/auth-compat",ZG="@firebase/database",KG="@firebase/data-connect",JG="@firebase/database-compat",QG="@firebase/functions",eY="@firebase/functions-compat",tY="@firebase/installations",nY="@firebase/installations-compat",iY="@firebase/messaging",rY="@firebase/messaging-compat",sY="@firebase/performance",oY="@firebase/performance-compat",aY="@firebase/remote-config",lY="@firebase/remote-config-compat",cY="@firebase/storage",uY="@firebase/storage-compat",hY="@firebase/firestore",fY="@firebase/vertexai",dY="@firebase/firestore-compat",pY="firebase",mY="11.3.1";const lM="[DEFAULT]",gY={[aM]:"fire-core",[WG]:"fire-core-compat",[$G]:"fire-analytics",[jG]:"fire-analytics-compat",[GG]:"fire-app-check",[XG]:"fire-app-check-compat",[YG]:"fire-auth",[qG]:"fire-auth-compat",[ZG]:"fire-rtdb",[KG]:"fire-data-connect",[JG]:"fire-rtdb-compat",[QG]:"fire-fn",[eY]:"fire-fn-compat",[tY]:"fire-iid",[nY]:"fire-iid-compat",[iY]:"fire-fcm",[rY]:"fire-fcm-compat",[sY]:"fire-perf",[oY]:"fire-perf-compat",[aY]:"fire-rc",[lY]:"fire-rc-compat",[cY]:"fire-gcs",[uY]:"fire-gcs-compat",[hY]:"fire-fst",[dY]:"fire-fst-compat",[fY]:"fire-vertex","fire-js":"fire-js",[pY]:"fire-js-all"};const gv=new Map,_Y=new Map,cM=new Map;function K3(n,e){try{n.container.addComponent(e)}catch(t){fh.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function _v(n){const e=n.name;if(cM.has(e))return fh.debug(`There were multiple attempts to register component ${e}.`),!1;cM.set(e,n);for(const t of gv.values())K3(t,n);for(const t of _Y.values())K3(t,n);return!0}function D4(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function sc(n){return n==null?!1:n.settings!==void 0}const yY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jf=new m0("app","Firebase",yY);class vY{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Kg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jf.create("app-deleted",{appName:this._name})}}const _0=mY;function F4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:lM,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw jf.create("bad-app-name",{appName:String(r)});if(t||(t=I4()),!t)throw jf.create("no-options");const s=gv.get(r);if(s){if(kw(t,s.options)&&kw(i,s.config))return s;throw jf.create("duplicate-app",{appName:r})}const o=new EG(r);for(const l of cM.values())o.addComponent(l);const a=new vY(t,i,o);return gv.set(r,a),a}function U4(n=lM){const e=gv.get(n);if(!e&&n===lM&&I4())return F4();if(!e)throw jf.create("no-app",{appName:n});return e}function xY(){return Array.from(gv.values())}function Bg(n,e,t){var i;let r=(i=gY[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fh.warn(a.join(" "));return}_v(new Kg(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const bY="firebase-heartbeat-database",wY=1,yv="firebase-heartbeat-store";let NE=null;function B4(){return NE||(NE=UG(bY,wY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yv)}catch(t){console.warn(t)}}}}).catch(n=>{throw jf.create("idb-open",{originalErrorMessage:n.message})})),NE}async function SY(n){try{const t=(await B4()).transaction(yv),i=await t.objectStore(yv).get(z4(n));return await t.done,i}catch(e){if(e instanceof ad)fh.warn(e.message);else{const t=jf.create("idb-get",{originalErrorMessage:e?.message});fh.warn(t.message)}}}async function J3(n,e){try{const i=(await B4()).transaction(yv,"readwrite");await i.objectStore(yv).put(e,z4(n)),await i.done}catch(t){if(t instanceof ad)fh.warn(t.message);else{const i=jf.create("idb-set",{originalErrorMessage:t?.message});fh.warn(i.message)}}}function z4(n){return`${n.name}!${n.options.appId}`}const TY=1024,EY=30;class AY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CY(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Q3();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>EY){const o=PY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){fh.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Q3(),{heartbeatsToSend:i,unsentEntries:r}=MY(this._heartbeatsCache.heartbeats),s=P4(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return fh.warn(t),""}}}function Q3(){return new Date().toISOString().substring(0,10)}function MY(n,e=TY){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),ek(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),ek(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class CY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dG()?pG().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await SY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return J3(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return J3(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function ek(n){return P4(JSON.stringify({version:2,heartbeats:n})).length}function PY(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function RY(n){_v(new Kg("platform-logger",e=>new VG(e),"PRIVATE")),_v(new Kg("heartbeat",e=>new AY(e),"PRIVATE")),Bg(aM,Z3,n),Bg(aM,Z3,"esm2017"),Bg("fire-js","")}RY("");function WP(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function V4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IY=V4,H4=new m0("auth","Firebase",V4());const Ow=new O4("@firebase/auth");function kY(n,...e){Ow.logLevel<=Ei.WARN&&Ow.warn(`Auth (${_0}): ${n}`,...e)}function iw(n,...e){Ow.logLevel<=Ei.ERROR&&Ow.error(`Auth (${_0}): ${n}`,...e)}function uc(n,...e){throw jP(n,...e)}function Jc(n,...e){return jP(n,...e)}function W4(n,e,t){const i=Object.assign(Object.assign({},IY()),{[e]:t});return new m0("auth","Firebase",i).create(e,{appName:n.name})}function ch(n){return W4(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jP(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return H4.create(n,...e)}function pn(n,e,...t){if(!n)throw jP(e,...t)}function nh(n){const e="INTERNAL ASSERTION FAILED: "+n;throw iw(e),new Error(e)}function dh(n,e){n||nh(e)}function uM(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function OY(){return tk()==="http:"||tk()==="https:"}function tk(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function LY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(OY()||uG()||"connection"in navigator)?navigator.onLine:!0}function NY(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class y0{constructor(e,t){this.shortDelay=e,this.longDelay=t,dh(t>e,"Short delay should be less than long delay!"),this.isMobile=lG()||hG()}get(){return LY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $P(n,e){dh(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class j4{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;nh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;nh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;nh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const DY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const FY=new y0(3e4,6e4);function ld(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function wh(n,e,t,i,r={}){return $4(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=g0(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},s);return cG()||(c.referrerPolicy="no-referrer"),j4.fetch()(X4(n,n.config.apiHost,t,a),c)})}async function $4(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},DY),e);try{const r=new BY(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Mx(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mx(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Mx(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Mx(n,"user-disabled",o);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw W4(n,u,c);uc(n,u)}}catch(r){if(r instanceof ad)throw r;uc(n,"network-request-failed",{message:String(r)})}}async function v0(n,e,t,i,r={}){const s=await wh(n,e,t,i,r);return"mfaPendingCredential"in s&&uc(n,"multi-factor-auth-required",{_serverResponse:s}),s}function X4(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?$P(n.config,r):`${n.config.apiScheme}://${r}`}function UY(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Jc(this.auth,"network-request-failed")),FY.get())})}}function Mx(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Jc(n,e,i);return r.customData._tokenResponse=t,r}function nk(n){return n!==void 0&&n.enterprise!==void 0}class zY{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return UY(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function VY(n,e){return wh(n,"GET","/v2/recaptchaConfig",ld(n,e))}async function HY(n,e){return wh(n,"POST","/v1/accounts:delete",e)}async function G4(n,e){return wh(n,"POST","/v1/accounts:lookup",e)}function Wy(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function WY(n,e=!1){return xl(n).getIdToken(e)}async function Y4(n,e=!1){const t=xl(n),i=await t.getIdToken(e),r=XP(i);pn(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:Wy(DE(r.auth_time)),issuedAtTime:Wy(DE(r.iat)),expirationTime:Wy(DE(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function DE(n){return Number(n)*1e3}function XP(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return iw("JWT malformed, contained fewer than 3 sections"),null;try{const r=R4(t);return r?JSON.parse(r):(iw("Failed to decode base64 JWT payload"),null)}catch(r){return iw("Caught error parsing JWT payload as JSON",r?.toString()),null}}function ik(n){const e=XP(n);return pn(e,"internal-error"),pn(typeof e.exp<"u","internal-error"),pn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Jg(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ad&&jY(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function jY({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class $Y{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class hM{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wy(this.lastLoginAt),this.creationTime=Wy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Lw(n){var e;const t=n.auth,i=await n.getIdToken(),r=await Jg(n,G4(t,{idToken:i}));pn(r?.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?q4(s.providerUserInfo):[],a=GY(n.providerData,o),l=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!a?.length,u=l?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new hM(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function XY(n){const e=xl(n);await Lw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GY(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function q4(n){return n.map(e=>{var{providerId:t}=e,i=WP(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function YY(n,e){const t=await $4(n,{},async()=>{const i=g0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=X4(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",j4.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qY(n,e){return wh(n,"POST","/v2/accounts:revokeToken",ld(n,e))}class zg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pn(e.idToken,"internal-error"),pn(typeof e.idToken<"u","internal-error"),pn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ik(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){pn(e.length!==0,"internal-error");const t=ik(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(pn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await YY(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new zg;return i&&(pn(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(pn(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(pn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zg,this.toJSON())}_performRefresh(){return nh("not implemented")}}function ff(n,e){pn(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ih{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=WP(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $Y(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hM(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Jg(this,this.stsTokenManager.getToken(this.auth,e));return pn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Y4(this,e)}reload(){return XY(this)}_assign(e){this!==e&&(pn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ih(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){pn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Lw(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(sc(this.auth.app))return Promise.reject(ch(this.auth));const e=await this.getIdToken();return await Jg(this,HY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,l,c,u;const d=(i=t.displayName)!==null&&i!==void 0?i:void 0,m=(r=t.email)!==null&&r!==void 0?r:void 0,y=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,x=(o=t.photoURL)!==null&&o!==void 0?o:void 0,T=(a=t.tenantId)!==null&&a!==void 0?a:void 0,S=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,w=(c=t.createdAt)!==null&&c!==void 0?c:void 0,P=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:M,emailVerified:I,isAnonymous:k,providerData:D,stsTokenManager:H}=t;pn(M&&H,e,"internal-error");const W=zg.fromJSON(this.name,H);pn(typeof M=="string",e,"internal-error"),ff(d,e.name),ff(m,e.name),pn(typeof I=="boolean",e,"internal-error"),pn(typeof k=="boolean",e,"internal-error"),ff(y,e.name),ff(x,e.name),ff(T,e.name),ff(S,e.name),ff(w,e.name),ff(P,e.name);const z=new ih({uid:M,auth:e,email:m,emailVerified:I,displayName:d,isAnonymous:k,photoURL:x,phoneNumber:y,tenantId:T,stsTokenManager:W,createdAt:w,lastLoginAt:P});return D&&Array.isArray(D)&&(z.providerData=D.map(j=>Object.assign({},j))),S&&(z._redirectEventId=S),z}static async _fromIdTokenResponse(e,t,i=!1){const r=new zg;r.updateFromServerResponse(t);const s=new ih({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Lw(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];pn(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?q4(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new zg;a.updateFromIdToken(i);const l=new ih({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new hM(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const rk=new Map;function rh(n){dh(n instanceof Function,"Expected a class definition");let e=rk.get(n);return e?(dh(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,rk.set(n,e),e)}class Z4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Z4.type="NONE";const sk=Z4;function rw(n,e,t){return`firebase:${n}:${e}:${t}`}class Vg{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=rw(this.userKey,r.apiKey,s),this.fullPersistenceKey=rw("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ih._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Vg(rh(sk),e,i);const r=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=r[0]||rh(sk);const o=rw(i,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){const d=ih._fromJSON(e,u);c!==s&&(a=d),s=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Vg(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Vg(s,e,i))}}function ok(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ez(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(K4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nz(e))return"Blackberry";if(iz(e))return"Webos";if(J4(e))return"Safari";if((e.includes("chrome/")||Q4(e))&&!e.includes("edge/"))return"Chrome";if(tz(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function K4(n=Bo()){return/firefox\//i.test(n)}function J4(n=Bo()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q4(n=Bo()){return/crios\//i.test(n)}function ez(n=Bo()){return/iemobile/i.test(n)}function tz(n=Bo()){return/android/i.test(n)}function nz(n=Bo()){return/blackberry/i.test(n)}function iz(n=Bo()){return/webos/i.test(n)}function GP(n=Bo()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ZY(n=Bo()){var e;return GP(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KY(){return fG()&&document.documentMode===10}function rz(n=Bo()){return GP(n)||tz(n)||iz(n)||nz(n)||/windows phone/i.test(n)||ez(n)}function sz(n,e=[]){let t;switch(n){case"Browser":t=ok(Bo());break;case"Worker":t=`${ok(Bo())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_0}/${i}`}class JY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function QY(n,e={}){return wh(n,"GET","/v2/passwordPolicy",ld(n,e))}const eq=6;class tq{constructor(e){var t,i,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:eq,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class nq{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ak(this),this.idTokenSubscription=new ak(this),this.beforeStateQueue=new JY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=H4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=rh(t)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await Vg.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await G4(this,{idToken:e}),i=await ih._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(sc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return pn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Lw(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(sc(this.app))return Promise.reject(ch(this));const t=e?xl(e):null;return t&&pn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&pn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return sc(this.app)?Promise.reject(ch(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return sc(this.app)?Promise.reject(ch(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(rh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QY(this),t=new tq(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new m0("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await qY(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&rh(e)||this._popupRedirectResolver;pn(t,this,"argument-error"),this.redirectPersistenceManager=await Vg.create(this,[rh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(pn(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(sc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&kY(`Error while retrieving App Check token: ${t.error}`),t?.token}}function rm(n){return xl(n)}class ak{constructor(e){this.auth=e,this.observer=null,this.addObserver=vG(t=>this.observer=t)}get next(){return pn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let WS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iq(n){WS=n}function oz(n){return WS.loadJS(n)}function rq(){return WS.recaptchaEnterpriseScript}function sq(){return WS.gapiScript}function oq(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class aq{constructor(){this.enterprise=new lq}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class lq{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const cq="recaptcha-enterprise",az="NO_RECAPTCHA";class uq{constructor(e){this.type=cq,this.auth=rm(e)}async verify(e="verify",t=!1){async function i(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{VY(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new zY(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(s,o,a){const l=window.grecaptcha;nk(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(az)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aq().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{i(this.auth).then(a=>{if(!t&&nk(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=rq();l.length!==0&&(l+=a),oz(l).then(()=>{r(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function lk(n,e,t,i=!1,r=!1){const s=new uq(n);let o;if(r)o=az;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function fM(n,e,t,i,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await lk(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await lk(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(o)})}function hq(n,e){const t=D4(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(kw(s,e??{}))return r;uc(r,"already-initialized")}return t.initialize({options:e})}function fq(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(rh);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function dq(n,e,t){const i=rm(n);pn(i._canInitEmulator,i,"emulator-config-failed"),pn(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=lz(e),{host:o,port:a}=pq(e),l=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),mq()}function lz(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pq(n){const e=lz(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:ck(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:ck(o)}}}function ck(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function mq(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class YP{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return nh("not implemented")}_getIdTokenResponse(e){return nh("not implemented")}_linkToIdToken(e,t){return nh("not implemented")}_getReauthenticationResolver(e){return nh("not implemented")}}async function gq(n,e){return wh(n,"POST","/v1/accounts:signUp",e)}async function _q(n,e){return v0(n,"POST","/v1/accounts:signInWithPassword",ld(n,e))}async function yq(n,e){return v0(n,"POST","/v1/accounts:signInWithEmailLink",ld(n,e))}async function vq(n,e){return v0(n,"POST","/v1/accounts:signInWithEmailLink",ld(n,e))}class vv extends YP{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new vv(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new vv(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return fM(e,t,"signInWithPassword",_q);case"emailLink":return yq(e,{email:this._email,oobCode:this._password});default:uc(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return fM(e,i,"signUpPassword",gq);case"emailLink":return vq(e,{idToken:t,email:this._email,oobCode:this._password});default:uc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hg(n,e){return v0(n,"POST","/v1/accounts:signInWithIdp",ld(n,e))}const xq="http://localhost";class Vp extends YP{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):uc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=WP(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new Vp(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Hg(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hg(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hg(e,t)}buildRequest(){const e={requestUri:xq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=g0(t)}return e}}function bq(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wq(n){const e=Cy(Py(n)).link,t=e?Cy(Py(e)).deep_link_id:null,i=Cy(Py(n)).deep_link_id;return(i?Cy(Py(i)).link:null)||i||t||e||n}class qP{constructor(e){var t,i,r,s,o,a;const l=Cy(Py(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(i=l.oobCode)!==null&&i!==void 0?i:null,d=bq((r=l.mode)!==null&&r!==void 0?r:null);pn(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=wq(e);try{return new qP(t)}catch{return null}}}class A_{constructor(){this.providerId=A_.PROVIDER_ID}static credential(e,t){return vv._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=qP.parseLink(t);return pn(i,"argument-error"),vv._fromEmailAndCode(e,i.code,i.tenantId)}}A_.PROVIDER_ID="password";A_.EMAIL_PASSWORD_SIGN_IN_METHOD="password";A_.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class cz{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class x0 extends cz{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Mf extends x0{constructor(){super("facebook.com")}static credential(e){return Vp._fromParams({providerId:Mf.PROVIDER_ID,signInMethod:Mf.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mf.credentialFromTaggedObject(e)}static credentialFromError(e){return Mf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mf.credential(e.oauthAccessToken)}catch{return null}}}Mf.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mf.PROVIDER_ID="facebook.com";class Cf extends x0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vp._fromParams({providerId:Cf.PROVIDER_ID,signInMethod:Cf.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cf.credentialFromTaggedObject(e)}static credentialFromError(e){return Cf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Cf.credential(t,i)}catch{return null}}}Cf.GOOGLE_SIGN_IN_METHOD="google.com";Cf.PROVIDER_ID="google.com";class Pf extends x0{constructor(){super("github.com")}static credential(e){return Vp._fromParams({providerId:Pf.PROVIDER_ID,signInMethod:Pf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pf.credentialFromTaggedObject(e)}static credentialFromError(e){return Pf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pf.credential(e.oauthAccessToken)}catch{return null}}}Pf.GITHUB_SIGN_IN_METHOD="github.com";Pf.PROVIDER_ID="github.com";class Rf extends x0{constructor(){super("twitter.com")}static credential(e,t){return Vp._fromParams({providerId:Rf.PROVIDER_ID,signInMethod:Rf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Rf.credentialFromTaggedObject(e)}static credentialFromError(e){return Rf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Rf.credential(t,i)}catch{return null}}}Rf.TWITTER_SIGN_IN_METHOD="twitter.com";Rf.PROVIDER_ID="twitter.com";async function Sq(n,e){return v0(n,"POST","/v1/accounts:signUp",ld(n,e))}class Hp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await ih._fromIdTokenResponse(e,i,r),o=uk(i);return new Hp({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=uk(i);return new Hp({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function uk(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Nw extends ad{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Nw.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Nw(e,t,i,r)}}function uz(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Nw._fromErrorAndOperation(n,s,e,i):s})}async function Tq(n,e,t=!1){const i=await Jg(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Hp._forOperation(n,"link",i)}async function Eq(n,e,t=!1){const{auth:i}=n;if(sc(i.app))return Promise.reject(ch(i));const r="reauthenticate";try{const s=await Jg(n,uz(i,r,e,n),t);pn(s.idToken,i,"internal-error");const o=XP(s.idToken);pn(o,i,"internal-error");const{sub:a}=o;return pn(n.uid===a,i,"user-mismatch"),Hp._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&uc(i,"user-mismatch"),s}}async function hz(n,e,t=!1){if(sc(n.app))return Promise.reject(ch(n));const i="signIn",r=await uz(n,i,e),s=await Hp._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}async function Aq(n,e){return hz(rm(n),e)}async function fz(n){const e=rm(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Mq(n,e,t){if(sc(n.app))return Promise.reject(ch(n));const i=rm(n),o=await fM(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Sq).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&fz(n),l}),a=await Hp._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function Cq(n,e,t){return sc(n.app)?Promise.reject(ch(n)):Aq(xl(n),A_.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&fz(n),i})}async function Pq(n,e){return wh(n,"POST","/v1/accounts:update",e)}async function Rq(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=xl(n),s={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Jg(i,Pq(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function Iq(n,e){return xl(n).setPersistence(e)}function kq(n,e,t,i){return xl(n).onIdTokenChanged(e,t,i)}function Oq(n,e,t){return xl(n).beforeAuthStateChanged(e,t)}function Lq(n,e,t,i){return xl(n).onAuthStateChanged(e,t,i)}function dz(n){return xl(n).signOut()}const Dw="__sak";class pz{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dw,"1"),this.storage.removeItem(Dw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Nq=1e3,Dq=10;class mz extends pz{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rz(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);KY()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Dq):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Nq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}mz.type="LOCAL";const Fq=mz;class gz extends pz{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}gz.type="SESSION";const ZP=gz;function Uq(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class jS{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new jS(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async c=>c(t.origin,s)),l=await Uq(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jS.receivers=[];function KP(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class Bq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=KP("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const m=d;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Qc(){return window}function zq(n){Qc().location.href=n}function _z(){return typeof Qc().WorkerGlobalScope<"u"&&typeof Qc().importScripts=="function"}async function Vq(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Hq(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Wq(){return _z()?self:null}const yz="firebaseLocalStorageDb",jq=1,Fw="firebaseLocalStorage",vz="fbase_key";class b0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $S(n,e){return n.transaction([Fw],e?"readwrite":"readonly").objectStore(Fw)}function $q(){const n=indexedDB.deleteDatabase(yz);return new b0(n).toPromise()}function dM(){const n=indexedDB.open(yz,jq);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Fw,{keyPath:vz})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Fw)?e(i):(i.close(),await $q(),e(await dM()))})})}async function hk(n,e,t){const i=$S(n,!0).put({[vz]:e,value:t});return new b0(i).toPromise()}async function Xq(n,e){const t=$S(n,!1).get(e),i=await new b0(t).toPromise();return i===void 0?null:i.value}function fk(n,e){const t=$S(n,!0).delete(e);return new b0(t).toPromise()}const Gq=800,Yq=3;class xz{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dM(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Yq)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _z()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jS._getInstance(Wq()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Vq(),!this.activeServiceWorker)return;this.sender=new Bq(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Hq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dM();return await hk(e,Dw,"1"),await fk(e,Dw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>hk(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Xq(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>fk(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=$S(r,!1).getAll();return new b0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Gq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xz.type="LOCAL";const qq=xz;new y0(3e4,6e4);function Zq(n,e){return e?rh(e):(pn(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class JP extends YP{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hg(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hg(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hg(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Kq(n){return hz(n.auth,new JP(n),n.bypassAuthState)}function Jq(n){const{auth:e,user:t}=n;return pn(t,e,"internal-error"),Eq(t,new JP(n),n.bypassAuthState)}async function Qq(n){const{auth:e,user:t}=n;return pn(t,e,"internal-error"),Tq(t,new JP(n),n.bypassAuthState)}class bz{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Kq;case"linkViaPopup":case"linkViaRedirect":return Qq;case"reauthViaPopup":case"reauthViaRedirect":return Jq;default:uc(this.auth,"internal-error")}}resolve(e){dh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const eZ=new y0(2e3,1e4);class wg extends bz{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,wg.currentPopupAction&&wg.currentPopupAction.cancel(),wg.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pn(e,this.auth,"internal-error"),e}async onExecution(){dh(this.filter.length===1,"Popup operations only handle one event");const e=KP();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Jc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Jc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wg.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eZ.get())};e()}}wg.currentPopupAction=null;const tZ="pendingRedirect",sw=new Map;class nZ extends bz{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=sw.get(this.auth._key());if(!e){try{const i=await iZ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}sw.set(this.auth._key(),e)}return this.bypassAuthState||sw.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iZ(n,e){const t=oZ(e),i=sZ(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function rZ(n,e){sw.set(n._key(),e)}function sZ(n){return rh(n._redirectPersistence)}function oZ(n){return rw(tZ,n.config.apiKey,n.name)}async function aZ(n,e,t=!1){if(sc(n.app))return Promise.reject(ch(n));const i=rm(n),r=Zq(i,e),o=await new nZ(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const lZ=600*1e3;class cZ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uZ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!wz(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Jc(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lZ&&this.cachedEventUids.clear(),this.cachedEventUids.has(dk(e))}saveEventToCache(e){this.cachedEventUids.add(dk(e)),this.lastProcessedEventTime=Date.now()}}function dk(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wz({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function uZ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wz(n);default:return!1}}async function hZ(n,e={}){return wh(n,"GET","/v1/projects",e)}const fZ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dZ=/^https?/;async function pZ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await hZ(n);for(const t of e)try{if(mZ(t))return}catch{}uc(n,"unauthorized-domain")}function mZ(n){const e=uM(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!dZ.test(t))return!1;if(fZ.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const gZ=new y0(3e4,6e4);function pk(){const n=Qc().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function _Z(n){return new Promise((e,t)=>{var i,r,s;function o(){pk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pk(),t(Jc(n,"network-request-failed"))},timeout:gZ.get()})}if(!((r=(i=Qc().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=Qc().gapi)===null||s===void 0)&&s.load)o();else{const a=oq("iframefcb");return Qc()[a]=()=>{gapi.load?o():t(Jc(n,"network-request-failed"))},oz(`${sq()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw ow=null,e})}let ow=null;function yZ(n){return ow=ow||_Z(n),ow}const vZ=new y0(5e3,15e3),xZ="__/auth/iframe",bZ="emulator/auth/iframe",wZ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SZ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TZ(n){const e=n.config;pn(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$P(e,bZ):`https://${n.config.authDomain}/${xZ}`,i={apiKey:e.apiKey,appName:n.name,v:_0},r=SZ.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${g0(i).slice(1)}`}async function EZ(n){const e=await yZ(n),t=Qc().gapi;return pn(t,n,"internal-error"),e.open({where:document.body,url:TZ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wZ,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Jc(n,"network-request-failed"),a=Qc().setTimeout(()=>{s(o)},vZ.get());function l(){Qc().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}const AZ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MZ=500,CZ=600,PZ="_blank",RZ="http://localhost";class mk{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function IZ(n,e,t,i=MZ,r=CZ){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},AZ),{width:i.toString(),height:r.toString(),top:s,left:o}),c=Bo().toLowerCase();t&&(a=Q4(c)?PZ:t),K4(c)&&(e=e||RZ,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[y,x])=>`${m}${y}=${x},`,"");if(ZY(c)&&a!=="_self")return kZ(e||"",a),new mk(null);const d=window.open(e||"",a,u);pn(d,n,"popup-blocked");try{d.focus()}catch{}return new mk(d)}function kZ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const OZ="__/auth/handler",LZ="emulator/auth/handler",NZ=encodeURIComponent("fac");async function gk(n,e,t,i,r,s){pn(n.config.authDomain,n,"auth-domain-config-required"),pn(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:_0,eventId:r};if(e instanceof cz){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",yG(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof x0){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${NZ}=${encodeURIComponent(l)}`:"";return`${DZ(n)}?${g0(a).slice(1)}${c}`}function DZ({config:n}){return n.emulator?$P(n,LZ):`https://${n.authDomain}/${OZ}`}const FE="webStorageSupport";class FZ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ZP,this._completeRedirectFn=aZ,this._overrideRedirectResult=rZ}async _openPopup(e,t,i,r){var s;dh((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await gk(e,t,i,uM(),r);return IZ(e,o,KP())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await gk(e,t,i,uM(),r);return zq(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(dh(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await EZ(e),i=new cZ(e);return t.register("authEvent",r=>(pn(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(FE,{type:FE},r=>{var s;const o=(s=r?.[0])===null||s===void 0?void 0:s[FE];o!==void 0&&t(!!o),uc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pZ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rz()||J4()||GP()}}const UZ=FZ;var _k="@firebase/auth",yk="1.9.0";class BZ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){pn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function zZ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function VZ(n){_v(new Kg("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;pn(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sz(n)},c=new nq(i,r,s,l);return fq(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),_v(new Kg("auth-internal",e=>{const t=rm(e.getProvider("auth").getImmediate());return(i=>new BZ(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bg(_k,yk,zZ(n)),Bg(_k,yk,"esm2017")}const HZ=300,WZ=k4("authIdTokenMaxAge")||HZ;let vk=null;const jZ=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>WZ)return;const r=t?.token;vk!==r&&(vk=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function $Z(n=U4()){const e=D4(n,"auth");if(e.isInitialized())return e.getImmediate();const t=hq(n,{popupRedirectResolver:UZ,persistence:[qq,Fq,ZP]}),i=k4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=jZ(s.toString());Oq(t,o,()=>o(t.currentUser)),kq(t,a=>o(a))}}const r=oG("auth");return r&&dq(t,`http://${r}`),t}function XZ(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}iq({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Jc("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",XZ().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});VZ("Browser");var GZ="firebase",YZ="11.3.1";Bg(GZ,YZ,"app");const qZ={apiKey:"AIzaSyB3moJ4WygIWcVlHh2AD6i1BsTctUDMEeo",authDomain:"flighty-20f72.firebaseapp.com",projectId:"flighty-20f72",storageBucket:"flighty-20f72.firebasestorage.app",messagingSenderId:"589633137264",appId:"1:589633137264:web:87e83d6d01e38bfa2962b5"},ZZ=xY().length===0?F4(qZ):U4(),cc=$Z(ZZ);Iq(cc,ZP).then(()=>{console.log("Firebase auth set to session persistence")}).catch(n=>{console.error("Error setting Firebase session persistence:",n)});const is=Gi.create({baseURL:"http://127.0.0.1:8000/api/v1"});is.interceptors.response.use(n=>n,async n=>{const e=n.config;if(n.response?.status===401&&!e._retry&&cc.currentUser){e._retry=!0;try{const t=await WY(cc.currentUser,!0);return console.log(t),e.headers.Authorization=`Bearer ${t}`,is(e)}catch(t){console.error("Error renovando token:",t),await KZ()}}return Promise.reject(n)});const KZ=async()=>{try{await dz(cc),console.log("Usuario desconectado exitosamente."),localStorage.removeItem("token"),is.defaults.headers.Authorization="",console.log("Token borrado del almacenamiento local y los headers de Axios.")}catch(n){console.error("Error al desconectar el usuario:",n)}},Sz=G.createContext();function Sh(){return G.useContext(Sz)}function JZ({children:n}){const[e,t]=G.useState(null),[i,r]=G.useState(!1),[s,o]=G.useState(!0);G.useEffect(()=>{const c=Lq(cc,async u=>{if(o(!0),u)try{const d=await u.getIdToken(!0),m=await Y4(u);t(u),r(m.claims.admin===!0),Gi.defaults.headers.common.Authorization=`Bearer ${d}`}catch(d){console.error("Error al obtener token:",d)}else t(null),r(!1),delete Gi.defaults.headers.common.Authorization;o(!1)});return()=>c()},[]);const l={user:e,isAuthenticated:!!e,isAdmin:i,logout:async()=>{try{if(!cc.currentUser)return;await dz(cc),t(null),r(!1),delete Gi.defaults.headers.common.Authorization,localStorage.clear(),sessionStorage.clear()}catch(c){throw console.error("Error al cerrar sesin:",c),c}}};return U.jsx(Sz.Provider,{value:l,children:!s&&n})}const xk=new c0.Icon({iconUrl:"/a1.png",iconSize:[25,25],markerColor:"yellow",iconColor:"black"}),QZ=new c0.Icon({iconUrl:"/flight1.jpg",iconSize:[25,25],markerColor:"blue",iconColor:"white"});function eK({onGround:n,callSign:e}){let t="",i="";return e==="No Callsign"?(t="Flight is not live",i="status-not-live"):n===!1?(t="Flight is in the air",i="status-in-air"):n===!0?(t="Flight is on the ground",i="status-on-ground"):(t="Flight status is unknown",i="status-unknown"),U.jsx("div",{className:`status-alert ${i}`,children:t})}function tK(){const{user:n,isAuthenticated:e}=Sh();let{icao:t}=kP();const[i,r]=G.useState({ICAOTypeCode:"",Manufacturer:"Unknown",ModeS:"",OperatorFlagCode:"",RegisteredOwners:"Unknown",Registration:"",Type:""}),[s,o]=G.useState(null),[a,l]=G.useState(null),[c,u]=G.useState("Unknown"),[d,m]=G.useState("Unknown"),[y,x]=G.useState({airport:"Unknown",country_code:"N/A",iata:"Unknown",icao:"Unknown",latitude:150,longitude:10,region_name:"Unknown"}),[T,S]=G.useState({airport:"Unknown",country_code:"N/A",iata:"Unknown",icao:"Unknown",latitude:150,longitude:10,region_name:"Unknown"}),w=`https://hexdb.io/hex-image-thumb?hex=${t}`,P=`https://hexdb.io/api/v1/aircraft/${t}`,M=`https://opensky-network.org/api/states/all?icao24=${t}`;G.useEffect(()=>{if(!t)return;fetch(w).then(te=>te.text()).then(te=>o(te.startsWith("https:")?te:`https:${te}`)).catch(()=>o(null)),fetch(P).then(te=>te.json()).then(r).catch(console.error);const W=()=>{const te="an4s3crwt",de="Mentaybolita1",ve=new Headers;ve.set("Authorization","Basic "+btoa(te+":"+de)),fetch(M,{headers:ve}).then(me=>me.json()).then(me=>{if(!me.states||!me.states[0]||me.states[0][6]==null){j();return}l(me),z(me.states[0][1])}).catch(()=>j())},z=te=>{fetch(`https://hexdb.io/callsign-route-iata?callsign=${te}`).then(de=>de.text()).then(de=>{const[ve="Unknown",me="Unknown"]=de.split("-");u(ve),m(me),ve!=="Unknown"?fetch(`https://hexdb.io/api/v1/airport/iata/${ve}`).then(q=>q.json()).then(x).catch(()=>J()):J(),me!=="Unknown"?fetch(`https://hexdb.io/api/v1/airport/iata/${me}`).then(q=>q.json()).then(S).catch(()=>le()):le()}).catch(()=>{u("Unknown"),m("Unknown")})},j=()=>{l({time:Date.now()/1e3,states:[["","No Callsign","Unknown",1e9,1e9,0,0,0,!0,0,0,0,null,0,null,!1,0]]})},J=()=>{x({airport:"Unknown",country_code:"N/A",iata:"Unknown",icao:"Unknown",latitude:150,longitude:20,region_name:"Unknown"})},le=()=>{S({airport:"Unknown",country_code:"N/A",iata:"Unknown",icao:"Unknown",latitude:150,longitude:20,region_name:"Unknown"})};W();const ge=setInterval(W,1e4);return()=>clearInterval(ge)},[t]),a?.states[0][1];const I=a?.states[0][4]?new Date(a.states[0][4]*1e3):null,k=a?.states[0][6]!=null&&a?.states[0][5]!=null?[a.states[0][6],a.states[0][5]]:null;a?.states[0][10];const[D,H]=G.useState(new Set);return G.useEffect(()=>{if(!a||!c||!d)return;const W=a.states[0][1];if(W==="No Callsign"||c==="Unknown"||d==="Unknown")return;const z=`${W}-${c}-${d}`;if(D.has(z))return;const j={callsign:W,flight_number:W.replace(/[^\d]/g,"")||null,from_airport_code:c,to_airport_code:d,firebase_uid:n?.uid||null};H(J=>new Set(J.add(z))),is.post("/flight/view",j).then(J=>console.log("Flight view recorded",J.data)).catch(J=>console.error("Failed to store flight view:",J))},[a,c,d,D,e,n]),U.jsxs("div",{className:"flight-info-container",children:[U.jsxs("div",{className:"flight-header",children:[U.jsx("h2",{children:a?.states[0][1]||"Flight Information"}),I&&U.jsxs("p",{className:"last-update",children:["Last update: ",I.toLocaleDateString()," at ",I.toLocaleTimeString()]})]}),U.jsx(eK,{onGround:a?.states[0][8],callSign:a?.states[0][1]}),U.jsxs("div",{className:"flight-content",children:[U.jsx("div",{className:"map-container",children:k&&U.jsxs(NP,{center:k,zoom:3,scrollWheelZoom:!0,className:"flight-map",children:[U.jsx(DP,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),U.jsx(Ug,{position:[y.latitude,y.longitude],icon:xk,children:U.jsx(mv,{children:U.jsxs("div",{className:"airport-popup",children:[U.jsx("strong",{children:y.airport}),U.jsxs("div",{className:"airport-location",children:[y.country_code!=="N/A"&&U.jsx("img",{src:`https://flagcdn.com/w40/${y.country_code.toLowerCase()}.png`,alt:y.country_code,onError:W=>W.target.style.display="none",loading:"lazy",width:"20"}),U.jsxs("span",{children:["(",c,")"]})]})]})})}),U.jsx(w$,{pathOptions:{color:"#666",weight:2,dashArray:"5,5"},positions:[[y.latitude,y.longitude],k,[T.latitude,T.longitude]]}),U.jsx(Ug,{position:[T.latitude,T.longitude],icon:xk,children:U.jsx(mv,{children:U.jsxs("div",{className:"airport-popup",children:[U.jsx("strong",{children:T.airport}),U.jsxs("div",{className:"airport-location",children:[T.country_code!=="N/A"&&U.jsx("img",{src:`https://flagcdn.com/w40/${T.country_code.toLowerCase()}.png`,alt:T.country_code,onError:W=>W.target.style.display="none",loading:"lazy",width:"20"}),U.jsxs("span",{children:["(",d,")"]})]})]})})}),k&&U.jsx(Ug,{position:k,icon:QZ})]})}),U.jsxs("div",{className:"flight-details",children:[U.jsxs("div",{className:"route-info",children:[U.jsx("h3",{children:"Flight Route"}),U.jsxs("div",{className:"route-airports",children:[U.jsxs("div",{className:"airport",children:[U.jsx("div",{className:"airport-label",children:"From"}),U.jsx("div",{className:"airport-name",children:y.airport}),U.jsxs("div",{className:"airport-code",children:[y.country_code!=="N/A"&&U.jsx("img",{src:`https://flagcdn.com/w40/${y.country_code.toLowerCase()}.png`,alt:y.country_code,onError:W=>W.target.style.display="none",loading:"lazy",width:"20"}),U.jsx("span",{children:c})]})]}),U.jsx("div",{className:"route-separator",children:""}),U.jsxs("div",{className:"airport",children:[U.jsx("div",{className:"airport-label",children:"To"}),U.jsx("div",{className:"airport-name",children:T.airport}),U.jsxs("div",{className:"airport-code",children:[T.country_code!=="N/A"&&U.jsx("img",{src:`https://flagcdn.com/w40/${T.country_code.toLowerCase()}.png`,alt:T.country_code,onError:W=>W.target.style.display="none",loading:"lazy",width:"20"}),U.jsx("span",{children:d})]})]})]})]}),U.jsxs("div",{className:"flight-stats",children:[U.jsxs("div",{className:"stat-item",children:[U.jsx("div",{className:"stat-label",children:"Altitude"}),U.jsxs("div",{className:"stat-value",children:[Math.round(a?.states[0][7]*3.2808)," ft"]})]}),U.jsxs("div",{className:"stat-item",children:[U.jsx("div",{className:"stat-label",children:"Ground Speed"}),U.jsxs("div",{className:"stat-value",children:[Math.round(a?.states[0][9]*18/5)," km/h"]})]})]}),U.jsxs("div",{className:"aircraft-info",children:[U.jsx("h3",{children:"Aircraft Details"}),U.jsxs("div",{className:"aircraft-content",children:[U.jsxs("div",{className:"aircraft-text",children:[U.jsxs("div",{className:"info-row",children:[U.jsx("span",{className:"info-label",children:"Registration:"}),U.jsx("span",{className:"info-value",children:i?.Registration})]}),U.jsxs("div",{className:"info-row",children:[U.jsx("span",{className:"info-label",children:"Type:"}),U.jsxs("span",{className:"info-value",children:[i?.Manufacturer," ",i?.Type]})]}),U.jsxs("div",{className:"info-row",children:[U.jsx("span",{className:"info-label",children:"Airline:"}),U.jsx("span",{className:"info-value",children:i?.RegisteredOwners})]}),U.jsxs("div",{className:"info-row",children:[U.jsx("span",{className:"info-label",children:"Hex Code:"}),U.jsx("span",{className:"info-value",children:i?.ModeS})]}),U.jsxs("div",{className:"info-row",children:[U.jsx("span",{className:"info-label",children:"Operator Code:"}),U.jsx("span",{className:"info-value",children:i?.OperatorFlagCode})]})]}),U.jsx("div",{className:"aircraft-image",children:U.jsx("img",{src:s||"/aircrafttemp.png",alt:"Aircraft",onError:W=>W.target.src="/aircrafttemp.png"})})]})]})]})]})]})}const nK=["IB","AA","BA","LH","AF"],iK=["light","dark","satellite"],rK=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo (Congo-Brazzaville)","Costa Rica","Croatia","Cuba","Cyprus","Czechia","Democratic Republic of the Congo","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Holy See","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","North Macedonia","Norway","Oman","Pakistan","Palau","Palestine State","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],sK=({filters:n,onFiltersChange:e,onResetFilters:t,theme:i,onThemeChange:r,onClose:s})=>{const[o,a]=G.useState(n),[l,c]=G.useState(n.country||""),[u,d]=G.useState(!1);G.useEffect(()=>{a(n),c(n.country||"")},[n]);const m=rK.filter(w=>w.toLowerCase().includes(l.toLowerCase())),y=()=>{e(o),d(!1)},x=()=>{a({airlineCode:"",country:""}),c(""),t()},T=w=>{c(w),a({...o,country:w}),d(!1)},S=w=>{w.key==="Enter"&&y()};return U.jsxs("div",{className:"preferences-panel bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl p-5 space-y-4 animate-fadeIn max-w-xs",children:[U.jsx("button",{className:"absolute top-3 right-3 text-gray-500 hover:text-black text-xl font-bold",onClick:s,"aria-label":"Cerrar panel",children:""}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Aerolnea"}),U.jsxs("select",{value:o.airlineCode,onChange:w=>a({...o,airlineCode:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 transition",children:[U.jsx("option",{value:"",children:"Todas"}),nK.map(w=>U.jsx("option",{value:w,children:w},w))]})]}),U.jsxs("div",{className:"relative",children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Pas"}),U.jsx("input",{type:"text",placeholder:"Escribe para buscar...",value:l,onChange:w=>{const P=w.target.value;c(P),a({...o,country:P}),d(!0)},onFocus:()=>d(!0),onKeyDown:S,className:"w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 transition"}),u&&l&&U.jsx("ul",{className:"absolute z-50 mt-1 max-h-40 w-full overflow-auto bg-white border border-gray-300 rounded-xl shadow-lg",children:m.length>0?m.slice(0,10).map(w=>U.jsx("li",{className:"px-3 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>T(w),children:w},w)):U.jsx("li",{className:"px-3 py-2 text-gray-400",children:"No hay coincidencias"})})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Tema"}),U.jsxs("select",{value:i,onChange:w=>r(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 transition",children:[U.jsx("option",{value:"",children:"Selecciona un tema"}),iK.map(w=>U.jsx("option",{value:w,children:w.charAt(0).toUpperCase()+w.slice(1)},w))]})]}),U.jsxs("div",{className:"flex space-x-3 mt-3",children:[U.jsx("button",{onClick:x,className:"flex-1 py-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition",children:"Reset"}),U.jsx("button",{onClick:y,className:"flex-1 py-2 bg-black text-white rounded-xl hover:opacity-90 transition",children:"Aplicar"})]})]})},bk={FLIGHT_DATA:"flightDataCache",LAST_FETCH:"lastFlightDataFetch",AIRCRAFT_IMAGES:"aircraftImagesCache",AIRCRAFT_DATA:"aircraftDataCache",USER_PREFERENCES:"userPreferencesCache"},wk={light:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",dark:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",satellite:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},oK=300*1e3;function Tz(){return{getFromCache:t=>{try{const i=localStorage.getItem(t);if(!i)return null;const{data:r,timestamp:s}=JSON.parse(i);return Date.now()-s>oK?(localStorage.removeItem(t),null):r}catch(i){return console.error("Error reading cache:",i),null}},setToCache:(t,i)=>{try{const r={data:i,timestamp:Date.now()};localStorage.setItem(t,JSON.stringify(r))}catch(r){console.error("Error writing to cache:",r)}}}}const Sk="user_preferences",Tk={theme:"light",filters:{originCountry:"",destCountry:""}};function aK(){const[n,e]=G.useState(()=>{try{const i=localStorage.getItem(Sk);return i?JSON.parse(i):Tk}catch(i){return console.error("Error reading preferences from localStorage",i),Tk}});return G.useEffect(()=>{try{localStorage.setItem(Sk,JSON.stringify(n))}catch(i){console.error("Error saving preferences to localStorage",i)}},[n]),{preferences:n,savePreferences:i=>{e(r=>({...r,...i}))}}}const Ek={AIRCRAFT_IMAGES:"aircraftImagesCache",AIRCRAFT_DATA:"aircraftDataCache"},UE={ICAOTypeCode:"",Manufacturer:"Unknown",ModeS:"",OperatorFlagCode:"",RegisteredOwners:"Unknown",Registration:"",Type:""};function Ez({icao:n,callsign:e,altitude:t,speed:i,position:r,onSaveFlight:s,onClose:o}){const{getFromCache:a,setToCache:l}=Tz(),[c,u]=G.useState(null),[d,m]=G.useState(UE),[y,x]=G.useState(" - "),[T,S]=G.useState(!0),w=G.useRef(null);return G.useEffect(()=>{(async()=>{if(!n)return;S(!0);const M=n.toUpperCase();try{const I=`${Ek.AIRCRAFT_IMAGES}_${M}`,k=`${Ek.AIRCRAFT_DATA}_${M}`,D=a(I),H=a(k);if(D&&H)u(D),m(H);else{const[W,z]=await Promise.all([fetch(`https://hexdb.io/hex-image-thumb?hex=${M}`),fetch(`https://hexdb.io/api/v1/aircraft/${M}`)]),[j,J]=await Promise.all([W.text(),z.json()]);let le=j.startsWith("https:")?j:`https:${j}`,ge={...UE,...J};if(!J?.RegisteredOwners||J.RegisteredOwners==="Unregistered")try{const te=await fetch(`https://opensky-network.org/api/metadata/aircraft/${M}`);if(te.ok){const de=await te.json();ge={...ge,RegisteredOwners:de.owner||ge.RegisteredOwners,Manufacturer:de.manufacturername||ge.Manufacturer,Model:de.model||ge.Type,Registration:de.registration||ge.Registration}}}catch(te){console.warn("No OpenSky metadata available:",te)}l(I,le),l(k,ge),u(le),m(ge)}if(e)try{const z=await(await fetch(`https://hexdb.io/callsign-route-iata?callsign=${e}`)).text();x(z||" - ")}catch{x(" - ")}else x(" - ")}catch(I){console.error("Error fetching aircraft data:",I),m(UE),u(null)}finally{S(!1)}})()},[n,e]),G.useEffect(()=>{if(!w.current||!r)return;const P=w.current,I=P.parentElement.getBoundingClientRect();let k=r.x,D=r.y-120;const H=P.offsetWidth,W=P.offsetHeight;k+H/2>I.width&&(k=I.width-H/2-10),k-H/2<0&&(k=H/2+10),D-W<0&&(D=W+10),P.style.left=`${k}px`,P.style.top=`${D}px`},[r,T]),T?U.jsxs("div",{className:"popup-card loading",children:[U.jsx("div",{className:"spinner"}),U.jsx("span",{children:"Loading..."})]}):U.jsxs("div",{ref:w,className:"popup-card floating-popup",children:[U.jsx("button",{className:"popup-close-btn",onClick:o,children:""}),U.jsxs("div",{className:"popup-header",children:[U.jsx("h2",{children:d?.RegisteredOwners||"Unknown"}),U.jsx("p",{children:e||d?.ModeS||"N/A"})]}),U.jsx("div",{className:"popup-image-container",children:U.jsx("img",{src:c||"/aircrafttemp.png",alt:"Aircraft",onError:({currentTarget:P})=>{P.onerror=null,P.src="/aircrafttemp.png"}})}),U.jsxs("div",{className:"popup-details",children:[U.jsx("div",{className:"route",children:y}),U.jsxs("div",{className:"specs",children:[U.jsx("span",{children:d?.ICAOTypeCode||d?.Model||"Unknown"}),U.jsx("span",{children:d?.Registration||"N/A"})]}),U.jsxs("div",{className:"alt-speed",children:[U.jsxs("span",{children:[Math.round(t*3.2808)," ft"]}),U.jsxs("span",{children:[Math.round(i*18/5)," km/h"]})]}),U.jsx(LS,{to:`/flight-info/${n}`,className:"details-link",children:"View flight details "})]})]})}const lK=({onBoundsChange:n})=>(v$({moveend:e=>n(e.target.getBounds()),zoomend:e=>n(e.target.getBounds())}),null);function Ak(){const{isAuthenticated:n}=Sh(),{setToCache:e}=Tz(),{infoSlug:t}=kP(),{preferences:i}=aK(),[r,s]=G.useState(null),[o,a]=G.useState(null),[l,c]=G.useState(i?.filters||{airlineCode:"",country:""}),[u,d]=G.useState(i?.theme||"light"),[m,y]=G.useState(!1),[x,T]=G.useState([]),[S,w]=G.useState(""),[P,M]=G.useState(!0),[I,k]=G.useState(null);G.useEffect(()=>{t&&c(W=>({...W,airlineCode:t})),w(t?"../":"")},[t]),G.useEffect(()=>{const W=async()=>{if(o){M(!0);try{const j=await is.get("/opensky/states",{params:{lamin:o.getSouth(),lamax:o.getNorth(),lomin:o.getWest(),lomax:o.getEast()}}),J=j.data.states?.filter(ge=>ge[5]&&ge[6])||[],le={time:j.data.time,states:J.slice(0,1e3)};e(bk.FLIGHT_DATA,le),e(bk.LAST_FETCH,Date.now()),s(le),k(null)}catch(j){console.error(j),k("No se pudieron cargar los vuelos")}finally{M(!1)}}};W();const z=setInterval(W,3e4);return()=>clearInterval(z)},[o]);const D=r?.states?.filter(W=>{const z=(W[1]||"").trim(),j=(W[2]||"").trim();return!(l.airlineCode&&!z.startsWith(l.airlineCode.toUpperCase())||l.country&&!j.toLowerCase().includes(l.country.toLowerCase()))}),H=async(W,z)=>{try{if(x.some(j=>j.flight_icao===W))return alert("Vuelo ya guardado");await is.post("/saved-flights",{flight_icao:W,flight_data:{callsign:z}}),T(j=>[...j,{flight_icao:W}])}catch(j){console.error(j)}};return U.jsxs("div",{className:"flights-container rounded-xl",children:[P&&U.jsxs("div",{className:"absolute top-4 right-4 z-50 flex items-center space-x-3 bg-white/90 backdrop-blur-md px-4 py-2 rounded-2xl shadow-lg animate-fadeIn",children:[U.jsx("div",{className:"w-6 h-6 border-4 border-gray-300 border-t-black rounded-full animate-spin"}),U.jsx("span",{className:"text-gray-800 font-semibold",children:"Cargando vuelos..."})]}),I&&U.jsx("div",{className:"error-banner bg-red-500 text-white p-4 rounded-md",children:I}),!n&&U.jsxs("div",{className:"auth-notice text-center text-gray-600 mb-2",children:[U.jsx(LS,{to:"/login",className:"text-blue-600 underline",children:"Inicia sesin"})," para guardar vuelos y preferencias"]}),U.jsx("button",{className:"preferences-button",onClick:()=>y(!0),children:"Preferencias"}),m&&U.jsx(sK,{filters:l,onFiltersChange:c,onResetFilters:()=>c({airlineCode:"",country:""}),theme:u,onThemeChange:d,onClose:()=>y(!1)}),U.jsx("div",{className:"map-wrapper relative",children:U.jsxs(NP,{center:[37,20],zoom:5,scrollWheelZoom:!0,className:"flight-map rounded-xl shadow-lg",zoomControl:!1,children:[U.jsx(DP,{attribution:" OpenStreetMap",url:wk[u]||wk.light}),U.jsx(lK,{onBoundsChange:a}),D?.length>0?D.map(W=>{const z=Math.floor((W[10]+23)/45)*45;return U.jsx(Ug,{position:[W[6],W[5]],zIndexOffset:Math.round(W[7]*3.2808),icon:new od.Icon({iconUrl:`/directions/d${z}.png`,iconSize:[24,24]}),children:U.jsx(mv,{children:U.jsx(Ez,{icao:W[0],callsign:W[1],altitude:W[7],speed:W[9],bl:S,onSaveFlight:H})})},`${W[0]}-${W[5]}-${W[6]}`)}):!P&&U.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-yellow-100 text-yellow-800 p-3 rounded-xl shadow-lg z-40",children:"No se encontraron vuelos con estos filtros."})]})})]})}const XS="158",sp={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},op={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Az=0,pM=1,Mz=2,cK=3,Cz=0,GS=1,jy=2,nc=3,ph=0,Uo=1,Gc=2,uK=2,uh=0,Ap=1,mM=2,gM=3,_M=4,Pz=5,If=100,Rz=101,Iz=102,yM=103,vM=104,kz=200,Oz=201,Lz=202,Nz=203,Uw=204,Bw=205,Dz=206,Fz=207,Uz=208,Bz=209,zz=210,Vz=211,Hz=212,Wz=213,jz=214,$z=0,Xz=1,Gz=2,xv=3,Yz=4,qz=5,Zz=6,Kz=7,w0=0,Jz=1,Qz=2,eu=0,eV=1,tV=2,nV=3,QP=4,iV=5,xM="attached",rV="detached",YS=300,mh=301,Kf=302,bv=303,wv=304,M_=306,Sv=1e3,fo=1001,Tv=1002,Ar=1003,zw=1004,hK=1004,$y=1005,fK=1005,Mr=1006,eR=1007,dK=1007,Jf=1008,pK=1008,tu=1009,sV=1010,oV=1011,qS=1012,tR=1013,sh=1014,qc=1015,Qg=1016,nR=1017,iR=1018,$f=1020,aV=1021,ca=1023,lV=1024,cV=1025,Xf=1026,Wp=1027,uV=1028,rR=1029,hV=1030,sR=1031,oR=1033,aw=33776,lw=33777,cw=33778,uw=33779,bM=35840,wM=35841,SM=35842,TM=35843,fV=36196,EM=37492,AM=37496,MM=37808,CM=37809,PM=37810,RM=37811,IM=37812,kM=37813,OM=37814,LM=37815,NM=37816,DM=37817,FM=37818,UM=37819,BM=37820,zM=37821,hw=36492,VM=36494,HM=36495,dV=36283,WM=36284,jM=36285,$M=36286,pV=2200,mV=2201,gV=2202,Ev=2300,Av=2301,fw=2302,gp=2400,_p=2401,Mv=2402,ZS=2500,aR=2501,mK=0,gK=1,_K=2,lR=3e3,Gf=3001,_V=3200,yV=3201,cd=0,vV=1,Wa="",es="srgb",ou="srgb-linear",KS="display-p3",S0="display-p3-linear",Cv="linear",Ri="srgb",Pv="rec709",Rv="p3",yK=0,ap=7680,vK=7681,xK=7682,bK=7683,wK=34055,SK=34056,TK=5386,EK=512,AK=513,MK=514,CK=515,PK=516,RK=517,IK=518,XM=519,xV=512,bV=513,wV=514,SV=515,TV=516,EV=517,AV=518,MV=519,Iv=35044,kK=35048,OK=35040,LK=35045,NK=35049,DK=35041,FK=35046,UK=35050,BK=35042,zK="100",GM="300 es",Vw=1035,Zc=2e3,kv=2001;let Th=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const io=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Mk=1234567;const Mp=Math.PI/180,e_=180/Math.PI;function ja(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(io[n&255]+io[n>>8&255]+io[n>>16&255]+io[n>>24&255]+"-"+io[e&255]+io[e>>8&255]+"-"+io[e>>16&15|64]+io[e>>24&255]+"-"+io[t&63|128]+io[t>>8&255]+"-"+io[t>>16&255]+io[t>>24&255]+io[i&255]+io[i>>8&255]+io[i>>16&255]+io[i>>24&255]).toLowerCase()}function dr(n,e,t){return Math.max(e,Math.min(t,n))}function cR(n,e){return(n%e+e)%e}function VK(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function HK(n,e,t){return n!==e?(t-n)/(e-n):0}function Xy(n,e,t){return(1-t)*n+t*e}function WK(n,e,t,i){return Xy(n,e,1-Math.exp(-t*i))}function jK(n,e=1){return e-Math.abs(cR(n,e*2)-e)}function $K(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function XK(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function GK(n,e){return n+Math.floor(Math.random()*(e-n+1))}function YK(n,e){return n+Math.random()*(e-n)}function qK(n){return n*(.5-Math.random())}function ZK(n){n!==void 0&&(Mk=n);let e=Mk+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function KK(n){return n*Mp}function JK(n){return n*e_}function YM(n){return(n&n-1)===0&&n!==0}function CV(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Hw(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function QK(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),m=o((e-i)/2),y=s((i-e)/2),x=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*d,l*m,a*c);break;case"YZY":n.set(l*m,a*u,l*d,a*c);break;case"ZXZ":n.set(l*d,l*m,a*u,a*c);break;case"XZX":n.set(a*u,l*x,l*y,a*c);break;case"YXY":n.set(l*y,a*u,l*x,a*c);break;case"ZYZ":n.set(l*x,l*y,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ua(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Rn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const eJ={DEG2RAD:Mp,RAD2DEG:e_,generateUUID:ja,clamp:dr,euclideanModulo:cR,mapLinear:VK,inverseLerp:HK,lerp:Xy,damp:WK,pingpong:jK,smoothstep:$K,smootherstep:XK,randInt:GK,randFloat:YK,randFloatSpread:qK,seededRandom:ZK,degToRad:KK,radToDeg:JK,isPowerOfTwo:YM,ceilPowerOfTwo:CV,floorPowerOfTwo:Hw,setQuaternionFromProperEuler:QK,normalize:Rn,denormalize:ua};class qe{constructor(e=0,t=0){qe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(dr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class kn{constructor(e,t,i,r,s,o,a,l,c){kn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],m=i[2],y=i[5],x=i[8],T=r[0],S=r[3],w=r[6],P=r[1],M=r[4],I=r[7],k=r[2],D=r[5],H=r[8];return s[0]=o*T+a*P+l*k,s[3]=o*S+a*M+l*D,s[6]=o*w+a*I+l*H,s[1]=c*T+u*P+d*k,s[4]=c*S+u*M+d*D,s[7]=c*w+u*I+d*H,s[2]=m*T+y*P+x*k,s[5]=m*S+y*M+x*D,s[8]=m*w+y*I+x*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,m=a*l-u*s,y=c*s-o*l,x=t*d+i*m+r*y;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/x;return e[0]=d*T,e[1]=(r*c-u*i)*T,e[2]=(a*i-r*o)*T,e[3]=m*T,e[4]=(u*t-r*l)*T,e[5]=(r*s-a*t)*T,e[6]=y*T,e[7]=(i*l-c*t)*T,e[8]=(o*t-i*s)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(BE.makeScale(e,t)),this}rotate(e){return this.premultiply(BE.makeRotation(-e)),this}translate(e,t){return this.premultiply(BE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const BE=new kn;function PV(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const tJ={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Sg(n,e){return new tJ[n](e)}function Ov(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function RV(){const n=Ov("canvas");return n.style.display="block",n}const Ck={};function Gy(n){n in Ck||(Ck[n]=!0,console.warn(n))}const Pk=new kn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Rk=new kn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Cx={[ou]:{transfer:Cv,primaries:Pv,toReference:n=>n,fromReference:n=>n},[es]:{transfer:Ri,primaries:Pv,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[S0]:{transfer:Cv,primaries:Rv,toReference:n=>n.applyMatrix3(Rk),fromReference:n=>n.applyMatrix3(Pk)},[KS]:{transfer:Ri,primaries:Rv,toReference:n=>n.convertSRGBToLinear().applyMatrix3(Rk),fromReference:n=>n.applyMatrix3(Pk).convertLinearToSRGB()}},nJ=new Set([ou,S0]),hi={enabled:!0,_workingColorSpace:ou,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!nJ.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=Cx[e].toReference,r=Cx[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Cx[n].primaries},getTransfer:function(n){return n===Wa?Cv:Cx[n].transfer}};function Wg(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function zE(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Hm;class uR{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Hm===void 0&&(Hm=Ov("canvas")),Hm.width=e.width,Hm.height=e.height;const i=Hm.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Hm}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Ov("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Wg(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Wg(t[i]/255)*255):t[i]=Wg(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let iJ=0;class yp{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:iJ++}),this.uuid=ja(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(VE(r[o].image)):s.push(VE(r[o]))}else s=VE(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function VE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?uR.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let rJ=0,js=class dw extends Th{constructor(e=dw.DEFAULT_IMAGE,t=dw.DEFAULT_MAPPING,i=fo,r=fo,s=Mr,o=Jf,a=ca,l=tu,c=dw.DEFAULT_ANISOTROPY,u=Wa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:rJ++}),this.uuid=ja(),this.name="",this.source=new yp(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new qe(0,0),this.repeat=new qe(1,1),this.center=new qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new kn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Gf?es:Wa),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==YS)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Sv:e.x=e.x-Math.floor(e.x);break;case fo:e.x=e.x<0?0:1;break;case Tv:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Sv:e.y=e.y-Math.floor(e.y);break;case fo:e.y=e.y<0?0:1;break;case Tv:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===es?Gf:lR}set encoding(e){Gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Gf?es:Wa}};js.DEFAULT_IMAGE=null;js.DEFAULT_MAPPING=YS;js.DEFAULT_ANISOTROPY=1;class di{constructor(e=0,t=0,i=0,r=1){di.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],m=l[1],y=l[5],x=l[9],T=l[2],S=l[6],w=l[10];if(Math.abs(u-m)<.01&&Math.abs(d-T)<.01&&Math.abs(x-S)<.01){if(Math.abs(u+m)<.1&&Math.abs(d+T)<.1&&Math.abs(x+S)<.1&&Math.abs(c+y+w-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const M=(c+1)/2,I=(y+1)/2,k=(w+1)/2,D=(u+m)/4,H=(d+T)/4,W=(x+S)/4;return M>I&&M>k?M<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(M),r=D/i,s=H/i):I>k?I<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(I),i=D/r,s=W/r):k<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(k),i=H/s,r=W/s),this.set(i,r,s,t),this}let P=Math.sqrt((S-x)*(S-x)+(d-T)*(d-T)+(m-u)*(m-u));return Math.abs(P)<.001&&(P=1),this.x=(S-x)/P,this.y=(d-T)/P,this.z=(m-u)/P,this.w=Math.acos((c+y+w-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class IV extends Th{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new di(0,0,e,t),this.scissorTest=!1,this.viewport=new di(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(Gy("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Gf?es:Wa),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Mr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new js(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new yp(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class hc extends IV{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class JS extends js{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ar,this.minFilter=Ar,this.wrapR=fo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class sJ extends hc{constructor(e=1,t=1,i=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new JS(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class hR extends js{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ar,this.minFilter=Ar,this.wrapR=fo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class oJ extends hc{constructor(e=1,t=1,i=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new hR(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class aJ extends hc{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class go{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const m=s[o+0],y=s[o+1],x=s[o+2],T=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d;return}if(a===1){e[t+0]=m,e[t+1]=y,e[t+2]=x,e[t+3]=T;return}if(d!==T||l!==m||c!==y||u!==x){let S=1-a;const w=l*m+c*y+u*x+d*T,P=w>=0?1:-1,M=1-w*w;if(M>Number.EPSILON){const k=Math.sqrt(M),D=Math.atan2(k,w*P);S=Math.sin(S*D)/k,a=Math.sin(a*D)/k}const I=a*P;if(l=l*S+m*I,c=c*S+y*I,u=u*S+x*I,d=d*S+T*I,S===1-a){const k=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=k,c*=k,u*=k,d*=k}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],m=s[o+1],y=s[o+2],x=s[o+3];return e[t]=a*x+u*d+l*y-c*m,e[t+1]=l*x+u*m+c*d-a*y,e[t+2]=c*x+u*y+a*m-l*d,e[t+3]=u*x-a*d-l*m-c*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),m=l(i/2),y=l(r/2),x=l(s/2);switch(o){case"XYZ":this._x=m*u*d+c*y*x,this._y=c*y*d-m*u*x,this._z=c*u*x+m*y*d,this._w=c*u*d-m*y*x;break;case"YXZ":this._x=m*u*d+c*y*x,this._y=c*y*d-m*u*x,this._z=c*u*x-m*y*d,this._w=c*u*d+m*y*x;break;case"ZXY":this._x=m*u*d-c*y*x,this._y=c*y*d+m*u*x,this._z=c*u*x+m*y*d,this._w=c*u*d-m*y*x;break;case"ZYX":this._x=m*u*d-c*y*x,this._y=c*y*d+m*u*x,this._z=c*u*x-m*y*d,this._w=c*u*d+m*y*x;break;case"YZX":this._x=m*u*d+c*y*x,this._y=c*y*d+m*u*x,this._z=c*u*x-m*y*d,this._w=c*u*d-m*y*x;break;case"XZY":this._x=m*u*d-c*y*x,this._y=c*y*d-m*u*x,this._z=c*u*x+m*y*d,this._w=c*u*d+m*y*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],m=i+a+d;if(m>0){const y=.5/Math.sqrt(m+1);this._w=.25/y,this._x=(u-l)*y,this._y=(s-c)*y,this._z=(o-r)*y}else if(i>a&&i>d){const y=2*Math.sqrt(1+i-a-d);this._w=(u-l)/y,this._x=.25*y,this._y=(r+o)/y,this._z=(s+c)/y}else if(a>d){const y=2*Math.sqrt(1+a-i-d);this._w=(s-c)/y,this._x=(r+o)/y,this._y=.25*y,this._z=(l+u)/y}else{const y=2*Math.sqrt(1+d-i-a);this._w=(o-r)/y,this._x=(s+c)/y,this._y=(l+u)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(dr(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const y=1-t;return this._w=y*o+t*this._w,this._x=y*i+t*this._x,this._y=y*r+t*this._y,this._z=y*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,m=Math.sin(t*u)/c;return this._w=o*d+this._w*m,this._x=i*d+this._x*m,this._y=r*d+this._y*m,this._z=s*d+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}let re=class kV{constructor(e=0,t=0,i=0){kV.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Ik.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Ik.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),u=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+l*c+o*d-a*u,this.y=i+l*u+a*c-s*d,this.z=r+l*d+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return HE.copy(this).projectOnVector(e),this.sub(HE)}reflect(e){return this.sub(HE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(dr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const HE=new re,Ik=new go;class hu{constructor(e=new re(1/0,1/0,1/0),t=new re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Zl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Zl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Zl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Zl):Zl.fromBufferAttribute(s,o),Zl.applyMatrix4(e.matrixWorld),this.expandByPoint(Zl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Px.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Px.copy(i.boundingBox)),Px.applyMatrix4(e.matrixWorld),this.union(Px)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Zl),Zl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(sy),Rx.subVectors(this.max,sy),Wm.subVectors(e.a,sy),jm.subVectors(e.b,sy),$m.subVectors(e.c,sy),df.subVectors(jm,Wm),pf.subVectors($m,jm),Hd.subVectors(Wm,$m);let t=[0,-df.z,df.y,0,-pf.z,pf.y,0,-Hd.z,Hd.y,df.z,0,-df.x,pf.z,0,-pf.x,Hd.z,0,-Hd.x,-df.y,df.x,0,-pf.y,pf.x,0,-Hd.y,Hd.x,0];return!WE(t,Wm,jm,$m,Rx)||(t=[1,0,0,0,1,0,0,0,1],!WE(t,Wm,jm,$m,Rx))?!1:(Ix.crossVectors(df,pf),t=[Ix.x,Ix.y,Ix.z],WE(t,Wm,jm,$m,Rx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Zl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Zl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Vu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Vu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Vu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Vu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Vu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Vu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Vu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Vu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Vu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Vu=[new re,new re,new re,new re,new re,new re,new re,new re],Zl=new re,Px=new hu,Wm=new re,jm=new re,$m=new re,df=new re,pf=new re,Hd=new re,sy=new re,Rx=new re,Ix=new re,Wd=new re;function WE(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Wd.fromArray(n,s);const a=r.x*Math.abs(Wd.x)+r.y*Math.abs(Wd.y)+r.z*Math.abs(Wd.z),l=e.dot(Wd),c=t.dot(Wd),u=i.dot(Wd);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const lJ=new hu,oy=new re,jE=new re;let dc=class{constructor(e=new re,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):lJ.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;oy.subVectors(e,this.center);const t=oy.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(oy,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(jE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(oy.copy(e.center).add(jE)),this.expandByPoint(oy.copy(e.center).sub(jE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const Hu=new re,$E=new re,kx=new re,mf=new re,XE=new re,Ox=new re,GE=new re;class sm{constructor(e=new re,t=new re(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Hu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Hu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Hu.copy(this.origin).addScaledVector(this.direction,t),Hu.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){$E.copy(e).add(t).multiplyScalar(.5),kx.copy(t).sub(e).normalize(),mf.copy(this.origin).sub($E);const s=e.distanceTo(t)*.5,o=-this.direction.dot(kx),a=mf.dot(this.direction),l=-mf.dot(kx),c=mf.lengthSq(),u=Math.abs(1-o*o);let d,m,y,x;if(u>0)if(d=o*l-a,m=o*a-l,x=s*u,d>=0)if(m>=-x)if(m<=x){const T=1/u;d*=T,m*=T,y=d*(d+o*m+2*a)+m*(o*d+m+2*l)+c}else m=s,d=Math.max(0,-(o*m+a)),y=-d*d+m*(m+2*l)+c;else m=-s,d=Math.max(0,-(o*m+a)),y=-d*d+m*(m+2*l)+c;else m<=-x?(d=Math.max(0,-(-o*s+a)),m=d>0?-s:Math.min(Math.max(-s,-l),s),y=-d*d+m*(m+2*l)+c):m<=x?(d=0,m=Math.min(Math.max(-s,-l),s),y=m*(m+2*l)+c):(d=Math.max(0,-(o*s+a)),m=d>0?s:Math.min(Math.max(-s,-l),s),y=-d*d+m*(m+2*l)+c);else m=o>0?-s:s,d=Math.max(0,-(o*m+a)),y=-d*d+m*(m+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy($E).addScaledVector(kx,m),y}intersectSphere(e,t){Hu.subVectors(e.center,this.origin);const i=Hu.dot(this.direction),r=Hu.dot(Hu)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,m=this.origin;return c>=0?(i=(e.min.x-m.x)*c,r=(e.max.x-m.x)*c):(i=(e.max.x-m.x)*c,r=(e.min.x-m.x)*c),u>=0?(s=(e.min.y-m.y)*u,o=(e.max.y-m.y)*u):(s=(e.max.y-m.y)*u,o=(e.min.y-m.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-m.z)*d,l=(e.max.z-m.z)*d):(a=(e.max.z-m.z)*d,l=(e.min.z-m.z)*d),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Hu)!==null}intersectTriangle(e,t,i,r,s){XE.subVectors(t,e),Ox.subVectors(i,e),GE.crossVectors(XE,Ox);let o=this.direction.dot(GE),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;mf.subVectors(this.origin,e);const l=a*this.direction.dot(Ox.crossVectors(mf,Ox));if(l<0)return null;const c=a*this.direction.dot(XE.cross(mf));if(c<0||l+c>o)return null;const u=-a*mf.dot(GE);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}let On=class qM{constructor(e,t,i,r,s,o,a,l,c,u,d,m,y,x,T,S){qM.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c,u,d,m,y,x,T,S)}set(e,t,i,r,s,o,a,l,c,u,d,m,y,x,T,S){const w=this.elements;return w[0]=e,w[4]=t,w[8]=i,w[12]=r,w[1]=s,w[5]=o,w[9]=a,w[13]=l,w[2]=c,w[6]=u,w[10]=d,w[14]=m,w[3]=y,w[7]=x,w[11]=T,w[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new qM().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Xm.setFromMatrixColumn(e,0).length(),s=1/Xm.setFromMatrixColumn(e,1).length(),o=1/Xm.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const m=o*u,y=o*d,x=a*u,T=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=y+x*c,t[5]=m-T*c,t[9]=-a*l,t[2]=T-m*c,t[6]=x+y*c,t[10]=o*l}else if(e.order==="YXZ"){const m=l*u,y=l*d,x=c*u,T=c*d;t[0]=m+T*a,t[4]=x*a-y,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=y*a-x,t[6]=T+m*a,t[10]=o*l}else if(e.order==="ZXY"){const m=l*u,y=l*d,x=c*u,T=c*d;t[0]=m-T*a,t[4]=-o*d,t[8]=x+y*a,t[1]=y+x*a,t[5]=o*u,t[9]=T-m*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const m=o*u,y=o*d,x=a*u,T=a*d;t[0]=l*u,t[4]=x*c-y,t[8]=m*c+T,t[1]=l*d,t[5]=T*c+m,t[9]=y*c-x,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const m=o*l,y=o*c,x=a*l,T=a*c;t[0]=l*u,t[4]=T-m*d,t[8]=x*d+y,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=y*d+x,t[10]=m-T*d}else if(e.order==="XZY"){const m=o*l,y=o*c,x=a*l,T=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=m*d+T,t[5]=o*u,t[9]=y*d-x,t[2]=x*d-y,t[6]=a*u,t[10]=T*d+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cJ,e,uJ)}lookAt(e,t,i){const r=this.elements;return Da.subVectors(e,t),Da.lengthSq()===0&&(Da.z=1),Da.normalize(),gf.crossVectors(i,Da),gf.lengthSq()===0&&(Math.abs(i.z)===1?Da.x+=1e-4:Da.z+=1e-4,Da.normalize(),gf.crossVectors(i,Da)),gf.normalize(),Lx.crossVectors(Da,gf),r[0]=gf.x,r[4]=Lx.x,r[8]=Da.x,r[1]=gf.y,r[5]=Lx.y,r[9]=Da.y,r[2]=gf.z,r[6]=Lx.z,r[10]=Da.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],m=i[9],y=i[13],x=i[2],T=i[6],S=i[10],w=i[14],P=i[3],M=i[7],I=i[11],k=i[15],D=r[0],H=r[4],W=r[8],z=r[12],j=r[1],J=r[5],le=r[9],ge=r[13],te=r[2],de=r[6],ve=r[10],me=r[14],q=r[3],ie=r[7],X=r[11],Y=r[15];return s[0]=o*D+a*j+l*te+c*q,s[4]=o*H+a*J+l*de+c*ie,s[8]=o*W+a*le+l*ve+c*X,s[12]=o*z+a*ge+l*me+c*Y,s[1]=u*D+d*j+m*te+y*q,s[5]=u*H+d*J+m*de+y*ie,s[9]=u*W+d*le+m*ve+y*X,s[13]=u*z+d*ge+m*me+y*Y,s[2]=x*D+T*j+S*te+w*q,s[6]=x*H+T*J+S*de+w*ie,s[10]=x*W+T*le+S*ve+w*X,s[14]=x*z+T*ge+S*me+w*Y,s[3]=P*D+M*j+I*te+k*q,s[7]=P*H+M*J+I*de+k*ie,s[11]=P*W+M*le+I*ve+k*X,s[15]=P*z+M*ge+I*me+k*Y,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],m=e[10],y=e[14],x=e[3],T=e[7],S=e[11],w=e[15];return x*(+s*l*d-r*c*d-s*a*m+i*c*m+r*a*y-i*l*y)+T*(+t*l*y-t*c*m+s*o*m-r*o*y+r*c*u-s*l*u)+S*(+t*c*d-t*a*y-s*o*d+i*o*y+s*a*u-i*c*u)+w*(-r*a*u-t*l*d+t*a*m+r*o*d-i*o*m+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],m=e[10],y=e[11],x=e[12],T=e[13],S=e[14],w=e[15],P=d*S*c-T*m*c+T*l*y-a*S*y-d*l*w+a*m*w,M=x*m*c-u*S*c-x*l*y+o*S*y+u*l*w-o*m*w,I=u*T*c-x*d*c+x*a*y-o*T*y-u*a*w+o*d*w,k=x*d*l-u*T*l-x*a*m+o*T*m+u*a*S-o*d*S,D=t*P+i*M+r*I+s*k;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const H=1/D;return e[0]=P*H,e[1]=(T*m*s-d*S*s-T*r*y+i*S*y+d*r*w-i*m*w)*H,e[2]=(a*S*s-T*l*s+T*r*c-i*S*c-a*r*w+i*l*w)*H,e[3]=(d*l*s-a*m*s-d*r*c+i*m*c+a*r*y-i*l*y)*H,e[4]=M*H,e[5]=(u*S*s-x*m*s+x*r*y-t*S*y-u*r*w+t*m*w)*H,e[6]=(x*l*s-o*S*s-x*r*c+t*S*c+o*r*w-t*l*w)*H,e[7]=(o*m*s-u*l*s+u*r*c-t*m*c-o*r*y+t*l*y)*H,e[8]=I*H,e[9]=(x*d*s-u*T*s-x*i*y+t*T*y+u*i*w-t*d*w)*H,e[10]=(o*T*s-x*a*s+x*i*c-t*T*c-o*i*w+t*a*w)*H,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*y-t*a*y)*H,e[12]=k*H,e[13]=(u*T*r-x*d*r+x*i*m-t*T*m-u*i*S+t*d*S)*H,e[14]=(x*a*r-o*T*r-x*i*l+t*T*l+o*i*S-t*a*S)*H,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*m+t*a*m)*H,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,m=s*c,y=s*u,x=s*d,T=o*u,S=o*d,w=a*d,P=l*c,M=l*u,I=l*d,k=i.x,D=i.y,H=i.z;return r[0]=(1-(T+w))*k,r[1]=(y+I)*k,r[2]=(x-M)*k,r[3]=0,r[4]=(y-I)*D,r[5]=(1-(m+w))*D,r[6]=(S+P)*D,r[7]=0,r[8]=(x+M)*H,r[9]=(S-P)*H,r[10]=(1-(m+T))*H,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Xm.set(r[0],r[1],r[2]).length();const o=Xm.set(r[4],r[5],r[6]).length(),a=Xm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Kl.copy(this);const c=1/s,u=1/o,d=1/a;return Kl.elements[0]*=c,Kl.elements[1]*=c,Kl.elements[2]*=c,Kl.elements[4]*=u,Kl.elements[5]*=u,Kl.elements[6]*=u,Kl.elements[8]*=d,Kl.elements[9]*=d,Kl.elements[10]*=d,t.setFromRotationMatrix(Kl),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Zc){const l=this.elements,c=2*s/(t-e),u=2*s/(i-r),d=(t+e)/(t-e),m=(i+r)/(i-r);let y,x;if(a===Zc)y=-(o+s)/(o-s),x=-2*o*s/(o-s);else if(a===kv)y=-o/(o-s),x=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=m,l[13]=0,l[2]=0,l[6]=0,l[10]=y,l[14]=x,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Zc){const l=this.elements,c=1/(t-e),u=1/(i-r),d=1/(o-s),m=(t+e)*c,y=(i+r)*u;let x,T;if(a===Zc)x=(o+s)*d,T=-2*d;else if(a===kv)x=s*d,T=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-m,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-y,l[2]=0,l[6]=0,l[10]=T,l[14]=-x,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}};const Xm=new re,Kl=new On,cJ=new re(0,0,0),uJ=new re(1,1,1),gf=new re,Lx=new re,Da=new re,kk=new On,Ok=new go;class T0{constructor(e=0,t=0,i=0,r=T0.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],m=r[6],y=r[10];switch(t){case"XYZ":this._y=Math.asin(dr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,y),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(m,c),this._z=0);break;case"YXZ":this._x=Math.asin(-dr(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,y),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(dr(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-d,y),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-dr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(m,y),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(dr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,y));break;case"XZY":this._z=Math.asin(-dr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(m,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return kk.makeRotationFromQuaternion(e),this.setFromRotationMatrix(kk,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ok.setFromEuler(this),this.setFromQuaternion(Ok,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}T0.DEFAULT_ORDER="XYZ";class Cp{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let hJ=0;const Lk=new re,Gm=new go,Wu=new On,Nx=new re,ay=new re,fJ=new re,dJ=new go,Nk=new re(1,0,0),Dk=new re(0,1,0),Fk=new re(0,0,1),pJ={type:"added"},mJ={type:"removed"};class Qn extends Th{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:hJ++}),this.uuid=ja(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qn.DEFAULT_UP.clone();const e=new re,t=new T0,i=new go,r=new re(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new On},normalMatrix:{value:new kn}}),this.matrix=new On,this.matrixWorld=new On,this.matrixAutoUpdate=Qn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Qn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Cp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Gm.setFromAxisAngle(e,t),this.quaternion.multiply(Gm),this}rotateOnWorldAxis(e,t){return Gm.setFromAxisAngle(e,t),this.quaternion.premultiply(Gm),this}rotateX(e){return this.rotateOnAxis(Nk,e)}rotateY(e){return this.rotateOnAxis(Dk,e)}rotateZ(e){return this.rotateOnAxis(Fk,e)}translateOnAxis(e,t){return Lk.copy(e).applyQuaternion(this.quaternion),this.position.add(Lk.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Nk,e)}translateY(e){return this.translateOnAxis(Dk,e)}translateZ(e){return this.translateOnAxis(Fk,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Wu.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Nx.copy(e):Nx.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),ay.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Wu.lookAt(ay,Nx,this.up):Wu.lookAt(Nx,ay,this.up),this.quaternion.setFromRotationMatrix(Wu),r&&(Wu.extractRotation(r.matrixWorld),Gm.setFromRotationMatrix(Wu),this.quaternion.premultiply(Gm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(pJ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(mJ)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Wu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Wu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Wu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,t);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ay,e,fJ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ay,dJ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),m=o(e.skeletons),y=o(e.animations),x=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),m.length>0&&(i.skeletons=m),y.length>0&&(i.animations=y),x.length>0&&(i.nodes=x)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Qn.DEFAULT_UP=new re(0,1,0);Qn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Qn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Jl=new re,ju=new re,YE=new re,$u=new re,Ym=new re,qm=new re,Uk=new re,qE=new re,ZE=new re,KE=new re;let Dx=!1;class la{constructor(e=new re,t=new re,i=new re){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Jl.subVectors(e,t),r.cross(Jl);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Jl.subVectors(r,t),ju.subVectors(i,t),YE.subVectors(e,t);const o=Jl.dot(Jl),a=Jl.dot(ju),l=Jl.dot(YE),c=ju.dot(ju),u=ju.dot(YE),d=o*c-a*a;if(d===0)return s.set(-2,-1,-1);const m=1/d,y=(c*l-a*u)*m,x=(o*u-a*l)*m;return s.set(1-y-x,x,y)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,$u),$u.x>=0&&$u.y>=0&&$u.x+$u.y<=1}static getUV(e,t,i,r,s,o,a,l){return Dx===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Dx=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,$u),l.setScalar(0),l.addScaledVector(s,$u.x),l.addScaledVector(o,$u.y),l.addScaledVector(a,$u.z),l}static isFrontFacing(e,t,i,r){return Jl.subVectors(i,t),ju.subVectors(e,t),Jl.cross(ju).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Jl.subVectors(this.c,this.b),ju.subVectors(this.a,this.b),Jl.cross(ju).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return la.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return la.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Dx===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Dx=!0),la.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return la.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return la.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return la.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ym.subVectors(r,i),qm.subVectors(s,i),qE.subVectors(e,i);const l=Ym.dot(qE),c=qm.dot(qE);if(l<=0&&c<=0)return t.copy(i);ZE.subVectors(e,r);const u=Ym.dot(ZE),d=qm.dot(ZE);if(u>=0&&d<=u)return t.copy(r);const m=l*d-u*c;if(m<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(Ym,o);KE.subVectors(e,s);const y=Ym.dot(KE),x=qm.dot(KE);if(x>=0&&y<=x)return t.copy(s);const T=y*c-l*x;if(T<=0&&c>=0&&x<=0)return a=c/(c-x),t.copy(i).addScaledVector(qm,a);const S=u*x-y*d;if(S<=0&&d-u>=0&&y-x>=0)return Uk.subVectors(s,r),a=(d-u)/(d-u+(y-x)),t.copy(r).addScaledVector(Uk,a);const w=1/(S+T+m);return o=T*w,a=m*w,t.copy(i).addScaledVector(Ym,o).addScaledVector(qm,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const OV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_f={h:0,s:0,l:0},Fx={h:0,s:0,l:0};function JE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let Ot=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=es){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,hi.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=hi.workingColorSpace){return this.r=e,this.g=t,this.b=i,hi.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=hi.workingColorSpace){if(e=cR(e,1),t=dr(t,0,1),i=dr(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=JE(o,s,e+1/3),this.g=JE(o,s,e),this.b=JE(o,s,e-1/3)}return hi.toWorkingColorSpace(this,r),this}setStyle(e,t=es){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=es){const i=OV[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Wg(e.r),this.g=Wg(e.g),this.b=Wg(e.b),this}copyLinearToSRGB(e){return this.r=zE(e.r),this.g=zE(e.g),this.b=zE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=es){return hi.fromWorkingColorSpace(ro.copy(this),e),Math.round(dr(ro.r*255,0,255))*65536+Math.round(dr(ro.g*255,0,255))*256+Math.round(dr(ro.b*255,0,255))}getHexString(e=es){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hi.workingColorSpace){hi.fromWorkingColorSpace(ro.copy(this),t);const i=ro.r,r=ro.g,s=ro.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=hi.workingColorSpace){return hi.fromWorkingColorSpace(ro.copy(this),t),e.r=ro.r,e.g=ro.g,e.b=ro.b,e}getStyle(e=es){hi.fromWorkingColorSpace(ro.copy(this),e);const t=ro.r,i=ro.g,r=ro.b;return e!==es?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(_f),this.setHSL(_f.h+e,_f.s+t,_f.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(_f),e.getHSL(Fx);const i=Xy(_f.h,Fx.h,t),r=Xy(_f.s,Fx.s,t),s=Xy(_f.l,Fx.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ro=new Ot;Ot.NAMES=OV;let gJ=0;class yo extends Th{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gJ++}),this.uuid=ja(),this.name="",this.type="Material",this.blending=Ap,this.side=ph,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Uw,this.blendDst=Bw,this.blendEquation=If,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ot(0,0,0),this.blendAlpha=0,this.depthFunc=xv,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=XM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ap,this.stencilZFail=ap,this.stencilZPass=ap,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ap&&(i.blending=this.blending),this.side!==ph&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Uw&&(i.blendSrc=this.blendSrc),this.blendDst!==Bw&&(i.blendDst=this.blendDst),this.blendEquation!==If&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==xv&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==XM&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ap&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ap&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ap&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Eh extends yo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ot(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=w0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const eh=_J();function _J(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function aa(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=dr(n,-65504,65504),eh.floatView[0]=n;const e=eh.uint32View[0],t=e>>23&511;return eh.baseTable[t]+((e&8388607)>>eh.shiftTable[t])}function Ry(n){const e=n>>10;return eh.uint32View[0]=eh.mantissaTable[eh.offsetTable[e]+(n&1023)]+eh.exponentTable[e],eh.floatView[0]}const yJ={toHalfFloat:aa,fromHalfFloat:Ry},zr=new re,Ux=new qe;class Ai{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Iv,this.updateRange={offset:0,count:-1},this.gpuType=qc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Ux.fromBufferAttribute(this,t),Ux.applyMatrix3(e),this.setXY(t,Ux.x,Ux.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)zr.fromBufferAttribute(this,t),zr.applyMatrix3(e),this.setXYZ(t,zr.x,zr.y,zr.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)zr.fromBufferAttribute(this,t),zr.applyMatrix4(e),this.setXYZ(t,zr.x,zr.y,zr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)zr.fromBufferAttribute(this,t),zr.applyNormalMatrix(e),this.setXYZ(t,zr.x,zr.y,zr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)zr.fromBufferAttribute(this,t),zr.transformDirection(e),this.setXYZ(t,zr.x,zr.y,zr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=ua(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Rn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ua(t,this.array)),t}setX(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ua(t,this.array)),t}setY(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ua(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ua(t,this.array)),t}setW(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array),r=Rn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array),r=Rn(r,this.array),s=Rn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Iv&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class vJ extends Ai{constructor(e,t,i){super(new Int8Array(e),t,i)}}class xJ extends Ai{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class bJ extends Ai{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class wJ extends Ai{constructor(e,t,i){super(new Int16Array(e),t,i)}}class fR extends Ai{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class SJ extends Ai{constructor(e,t,i){super(new Int32Array(e),t,i)}}class dR extends Ai{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class TJ extends Ai{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=Ry(this.array[e*this.itemSize]);return this.normalized&&(t=ua(t,this.array)),t}setX(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize]=aa(t),this}getY(e){let t=Ry(this.array[e*this.itemSize+1]);return this.normalized&&(t=ua(t,this.array)),t}setY(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize+1]=aa(t),this}getZ(e){let t=Ry(this.array[e*this.itemSize+2]);return this.normalized&&(t=ua(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize+2]=aa(t),this}getW(e){let t=Ry(this.array[e*this.itemSize+3]);return this.normalized&&(t=ua(t,this.array)),t}setW(e,t){return this.normalized&&(t=Rn(t,this.array)),this.array[e*this.itemSize+3]=aa(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array)),this.array[e+0]=aa(t),this.array[e+1]=aa(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array),r=Rn(r,this.array)),this.array[e+0]=aa(t),this.array[e+1]=aa(i),this.array[e+2]=aa(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array),r=Rn(r,this.array),s=Rn(s,this.array)),this.array[e+0]=aa(t),this.array[e+1]=aa(i),this.array[e+2]=aa(r),this.array[e+3]=aa(s),this}}class qt extends Ai{constructor(e,t,i){super(new Float32Array(e),t,i)}}class EJ extends Ai{constructor(e,t,i){super(new Float64Array(e),t,i)}}let AJ=0;const ll=new On,QE=new Qn,Zm=new re,Fa=new hu,ly=new hu,ys=new re;class Dn extends Th{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:AJ++}),this.uuid=ja(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(PV(e)?dR:fR)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new kn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ll.makeRotationFromQuaternion(e),this.applyMatrix4(ll),this}rotateX(e){return ll.makeRotationX(e),this.applyMatrix4(ll),this}rotateY(e){return ll.makeRotationY(e),this.applyMatrix4(ll),this}rotateZ(e){return ll.makeRotationZ(e),this.applyMatrix4(ll),this}translate(e,t,i){return ll.makeTranslation(e,t,i),this.applyMatrix4(ll),this}scale(e,t,i){return ll.makeScale(e,t,i),this.applyMatrix4(ll),this}lookAt(e){return QE.lookAt(e),QE.updateMatrix(),this.applyMatrix4(QE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zm).negate(),this.translate(Zm.x,Zm.y,Zm.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new qt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hu);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new re(-1/0,-1/0,-1/0),new re(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Fa.setFromBufferAttribute(s),this.morphTargetsRelative?(ys.addVectors(this.boundingBox.min,Fa.min),this.boundingBox.expandByPoint(ys),ys.addVectors(this.boundingBox.max,Fa.max),this.boundingBox.expandByPoint(ys)):(this.boundingBox.expandByPoint(Fa.min),this.boundingBox.expandByPoint(Fa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new dc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new re,1/0);return}if(e){const i=this.boundingSphere.center;if(Fa.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];ly.setFromBufferAttribute(a),this.morphTargetsRelative?(ys.addVectors(Fa.min,ly.min),Fa.expandByPoint(ys),ys.addVectors(Fa.max,ly.max),Fa.expandByPoint(ys)):(Fa.expandByPoint(ly.min),Fa.expandByPoint(ly.max))}Fa.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)ys.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(ys));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)ys.fromBufferAttribute(a,c),l&&(Zm.fromBufferAttribute(e,c),ys.add(Zm)),r=Math.max(r,i.distanceToSquared(ys))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ai(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let j=0;j<a;j++)c[j]=new re,u[j]=new re;const d=new re,m=new re,y=new re,x=new qe,T=new qe,S=new qe,w=new re,P=new re;function M(j,J,le){d.fromArray(r,j*3),m.fromArray(r,J*3),y.fromArray(r,le*3),x.fromArray(o,j*2),T.fromArray(o,J*2),S.fromArray(o,le*2),m.sub(d),y.sub(d),T.sub(x),S.sub(x);const ge=1/(T.x*S.y-S.x*T.y);isFinite(ge)&&(w.copy(m).multiplyScalar(S.y).addScaledVector(y,-T.y).multiplyScalar(ge),P.copy(y).multiplyScalar(T.x).addScaledVector(m,-S.x).multiplyScalar(ge),c[j].add(w),c[J].add(w),c[le].add(w),u[j].add(P),u[J].add(P),u[le].add(P))}let I=this.groups;I.length===0&&(I=[{start:0,count:i.length}]);for(let j=0,J=I.length;j<J;++j){const le=I[j],ge=le.start,te=le.count;for(let de=ge,ve=ge+te;de<ve;de+=3)M(i[de+0],i[de+1],i[de+2])}const k=new re,D=new re,H=new re,W=new re;function z(j){H.fromArray(s,j*3),W.copy(H);const J=c[j];k.copy(J),k.sub(H.multiplyScalar(H.dot(J))).normalize(),D.crossVectors(W,J);const ge=D.dot(u[j])<0?-1:1;l[j*4]=k.x,l[j*4+1]=k.y,l[j*4+2]=k.z,l[j*4+3]=ge}for(let j=0,J=I.length;j<J;++j){const le=I[j],ge=le.start,te=le.count;for(let de=ge,ve=ge+te;de<ve;de+=3)z(i[de+0]),z(i[de+1]),z(i[de+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ai(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let m=0,y=i.count;m<y;m++)i.setXYZ(m,0,0,0);const r=new re,s=new re,o=new re,a=new re,l=new re,c=new re,u=new re,d=new re;if(e)for(let m=0,y=e.count;m<y;m+=3){const x=e.getX(m+0),T=e.getX(m+1),S=e.getX(m+2);r.fromBufferAttribute(t,x),s.fromBufferAttribute(t,T),o.fromBufferAttribute(t,S),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,x),l.fromBufferAttribute(i,T),c.fromBufferAttribute(i,S),a.add(u),l.add(u),c.add(u),i.setXYZ(x,a.x,a.y,a.z),i.setXYZ(T,l.x,l.y,l.z),i.setXYZ(S,c.x,c.y,c.z)}else for(let m=0,y=t.count;m<y;m+=3)r.fromBufferAttribute(t,m+0),s.fromBufferAttribute(t,m+1),o.fromBufferAttribute(t,m+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(m+0,u.x,u.y,u.z),i.setXYZ(m+1,u.x,u.y,u.z),i.setXYZ(m+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ys.fromBufferAttribute(e,t),ys.normalize(),e.setXYZ(t,ys.x,ys.y,ys.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,m=new c.constructor(l.length*u);let y=0,x=0;for(let T=0,S=l.length;T<S;T++){a.isInterleavedBufferAttribute?y=l[T]*a.data.stride+a.offset:y=l[T]*u;for(let w=0;w<u;w++)m[x++]=c[y++]}return new Ai(m,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Dn,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const m=c[u],y=e(m,i);l.push(y)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,m=c.length;d<m;d++){const y=c[d];u.push(y.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let m=0,y=d.length;m<y;m++)u.push(d[m].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Bk=new On,jd=new sm,Bx=new dc,zk=new re,Km=new re,Jm=new re,Qm=new re,e1=new re,zx=new re,Vx=new qe,Hx=new qe,Wx=new qe,Vk=new re,Hk=new re,Wk=new re,jx=new re,$x=new re;class xs extends Qn{constructor(e=new Dn,t=new Eh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){zx.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],d=s[l];u!==0&&(e1.fromBufferAttribute(d,e),o?zx.addScaledVector(e1,u):zx.addScaledVector(e1.sub(t),u))}t.add(zx)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Bx.copy(i.boundingSphere),Bx.applyMatrix4(s),jd.copy(e.ray).recast(e.near),!(Bx.containsPoint(jd.origin)===!1&&(jd.intersectSphere(Bx,zk)===null||jd.origin.distanceToSquared(zk)>(e.far-e.near)**2))&&(Bk.copy(s).invert(),jd.copy(e.ray).applyMatrix4(Bk),!(i.boundingBox!==null&&jd.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,jd)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,m=s.groups,y=s.drawRange;if(a!==null)if(Array.isArray(o))for(let x=0,T=m.length;x<T;x++){const S=m[x],w=o[S.materialIndex],P=Math.max(S.start,y.start),M=Math.min(a.count,Math.min(S.start+S.count,y.start+y.count));for(let I=P,k=M;I<k;I+=3){const D=a.getX(I),H=a.getX(I+1),W=a.getX(I+2);r=Xx(this,w,e,i,c,u,d,D,H,W),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=S.materialIndex,t.push(r))}}else{const x=Math.max(0,y.start),T=Math.min(a.count,y.start+y.count);for(let S=x,w=T;S<w;S+=3){const P=a.getX(S),M=a.getX(S+1),I=a.getX(S+2);r=Xx(this,o,e,i,c,u,d,P,M,I),r&&(r.faceIndex=Math.floor(S/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let x=0,T=m.length;x<T;x++){const S=m[x],w=o[S.materialIndex],P=Math.max(S.start,y.start),M=Math.min(l.count,Math.min(S.start+S.count,y.start+y.count));for(let I=P,k=M;I<k;I+=3){const D=I,H=I+1,W=I+2;r=Xx(this,w,e,i,c,u,d,D,H,W),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=S.materialIndex,t.push(r))}}else{const x=Math.max(0,y.start),T=Math.min(l.count,y.start+y.count);for(let S=x,w=T;S<w;S+=3){const P=S,M=S+1,I=S+2;r=Xx(this,o,e,i,c,u,d,P,M,I),r&&(r.faceIndex=Math.floor(S/3),t.push(r))}}}}function MJ(n,e,t,i,r,s,o,a){let l;if(e.side===Uo?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===ph,a),l===null)return null;$x.copy(a),$x.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo($x);return c<t.near||c>t.far?null:{distance:c,point:$x.clone(),object:n}}function Xx(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,Km),n.getVertexPosition(l,Jm),n.getVertexPosition(c,Qm);const u=MJ(n,e,t,i,Km,Jm,Qm,jx);if(u){r&&(Vx.fromBufferAttribute(r,a),Hx.fromBufferAttribute(r,l),Wx.fromBufferAttribute(r,c),u.uv=la.getInterpolation(jx,Km,Jm,Qm,Vx,Hx,Wx,new qe)),s&&(Vx.fromBufferAttribute(s,a),Hx.fromBufferAttribute(s,l),Wx.fromBufferAttribute(s,c),u.uv1=la.getInterpolation(jx,Km,Jm,Qm,Vx,Hx,Wx,new qe),u.uv2=u.uv1),o&&(Vk.fromBufferAttribute(o,a),Hk.fromBufferAttribute(o,l),Wk.fromBufferAttribute(o,c),u.normal=la.getInterpolation(jx,Km,Jm,Qm,Vk,Hk,Wk,new re),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a,b:l,c,normal:new re,materialIndex:0};la.getNormal(Km,Jm,Qm,d.normal),u.face=d}return u}class om extends Dn{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let m=0,y=0;x("z","y","x",-1,-1,i,t,e,o,s,0),x("z","y","x",1,-1,i,t,-e,o,s,1),x("x","z","y",1,1,e,i,t,r,o,2),x("x","z","y",1,-1,e,i,-t,r,o,3),x("x","y","z",1,-1,e,t,i,r,s,4),x("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new qt(c,3)),this.setAttribute("normal",new qt(u,3)),this.setAttribute("uv",new qt(d,2));function x(T,S,w,P,M,I,k,D,H,W,z){const j=I/H,J=k/W,le=I/2,ge=k/2,te=D/2,de=H+1,ve=W+1;let me=0,q=0;const ie=new re;for(let X=0;X<ve;X++){const Y=X*J-ge;for(let ce=0;ce<de;ce++){const Me=ce*j-le;ie[T]=Me*P,ie[S]=Y*M,ie[w]=te,c.push(ie.x,ie.y,ie.z),ie[T]=0,ie[S]=0,ie[w]=D>0?1:-1,u.push(ie.x,ie.y,ie.z),d.push(ce/H),d.push(1-X/W),me+=1}}for(let X=0;X<W;X++)for(let Y=0;Y<H;Y++){const ce=m+Y+de*X,Me=m+Y+de*(X+1),Re=m+(Y+1)+de*(X+1),Fe=m+(Y+1)+de*X;l.push(ce,Me,Fe),l.push(Me,Re,Fe),q+=6}a.addGroup(y,q,z),y+=q,m+=me}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new om(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function t_(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Lo(n){const e={};for(let t=0;t<n.length;t++){const i=t_(n[t]);for(const r in i)e[r]=i[r]}return e}function CJ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function LV(n){return n.getRenderTarget()===null?n.outputColorSpace:hi.workingColorSpace}const NV={clone:t_,merge:Lo};var PJ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,RJ=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class au extends yo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=PJ,this.fragmentShader=RJ,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=t_(e.uniforms),this.uniformsGroups=CJ(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class E0 extends Qn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new On,this.projectionMatrix=new On,this.projectionMatrixInverse=new On,this.coordinateSystem=Zc}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class pr extends E0{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=e_*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Mp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return e_*2*Math.atan(Math.tan(Mp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Mp*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const eg=-90,tg=1;class DV extends Qn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new pr(eg,tg,e,t);r.layers=this.layers,this.add(r);const s=new pr(eg,tg,e,t);s.layers=this.layers,this.add(s);const o=new pr(eg,tg,e,t);o.layers=this.layers,this.add(o);const a=new pr(eg,tg,e,t);a.layers=this.layers,this.add(a);const l=new pr(eg,tg,e,t);l.layers=this.layers,this.add(l);const c=new pr(eg,tg,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Zc)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===kv)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),m=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const T=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=T,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(d,m,y),e.xr.enabled=x,i.texture.needsPMREMUpdate=!0}}class A0 extends js{constructor(e,t,i,r,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:mh,super(e,t,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class FV extends hc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(Gy("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Gf?es:Wa),this.texture=new A0(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Mr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new om(5,5,5),s=new au({name:"CubemapFromEquirect",uniforms:t_(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Uo,blending:uh});s.uniforms.tEquirect.value=t;const o=new xs(r,s),a=t.minFilter;return t.minFilter===Jf&&(t.minFilter=Mr),new DV(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const t1=new re,IJ=new re,kJ=new kn;class Xc{constructor(e=new re(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=t1.subVectors(i,t).cross(IJ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(t1),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||kJ.getNormalMatrix(e),r=this.coplanarPoint(t1).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const $d=new dc,Gx=new re;class QS{constructor(e=new Xc,t=new Xc,i=new Xc,r=new Xc,s=new Xc,o=new Xc){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Zc){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],d=r[6],m=r[7],y=r[8],x=r[9],T=r[10],S=r[11],w=r[12],P=r[13],M=r[14],I=r[15];if(i[0].setComponents(l-s,m-c,S-y,I-w).normalize(),i[1].setComponents(l+s,m+c,S+y,I+w).normalize(),i[2].setComponents(l+o,m+u,S+x,I+P).normalize(),i[3].setComponents(l-o,m-u,S-x,I-P).normalize(),i[4].setComponents(l-a,m-d,S-T,I-M).normalize(),t===Zc)i[5].setComponents(l+a,m+d,S+T,I+M).normalize();else if(t===kv)i[5].setComponents(a,d,T,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),$d.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),$d.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere($d)}intersectsSprite(e){return $d.center.set(0,0,0),$d.radius=.7071067811865476,$d.applyMatrix4(e.matrixWorld),this.intersectsSphere($d)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Gx.x=r.normal.x>0?e.max.x:e.min.x,Gx.y=r.normal.y>0?e.max.y:e.min.y,Gx.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Gx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function UV(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function OJ(n,e){const t=e.isWebGL2,i=new WeakMap;function r(c,u){const d=c.array,m=c.usage,y=n.createBuffer();n.bindBuffer(u,y),n.bufferData(u,d,m),c.onUploadCallback();let x;if(d instanceof Float32Array)x=n.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)x=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)x=n.SHORT;else if(d instanceof Uint32Array)x=n.UNSIGNED_INT;else if(d instanceof Int32Array)x=n.INT;else if(d instanceof Int8Array)x=n.BYTE;else if(d instanceof Uint8Array)x=n.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)x=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:y,type:x,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,d){const m=u.array,y=u.updateRange;n.bindBuffer(d,c),y.count===-1?n.bufferSubData(d,0,m):(t?n.bufferSubData(d,y.offset*m.BYTES_PER_ELEMENT,m,y.offset,y.count):n.bufferSubData(d,y.offset*m.BYTES_PER_ELEMENT,m.subarray(y.offset,y.offset+y.count)),y.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const m=i.get(c);(!m||m.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);d===void 0?i.set(c,r(c,u)):d.version<c.version&&(s(d.buffer,c,u),d.version=c.version)}return{get:o,remove:a,update:l}}class C_ extends Dn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,m=t/l,y=[],x=[],T=[],S=[];for(let w=0;w<u;w++){const P=w*m-o;for(let M=0;M<c;M++){const I=M*d-s;x.push(I,-P,0),T.push(0,0,1),S.push(M/a),S.push(1-w/l)}}for(let w=0;w<l;w++)for(let P=0;P<a;P++){const M=P+c*w,I=P+c*(w+1),k=P+1+c*(w+1),D=P+1+c*w;y.push(M,I,D),y.push(I,k,D)}this.setIndex(y),this.setAttribute("position",new qt(x,3)),this.setAttribute("normal",new qt(T,3)),this.setAttribute("uv",new qt(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new C_(e.width,e.height,e.widthSegments,e.heightSegments)}}var LJ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,NJ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,DJ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,FJ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,UJ=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,BJ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,zJ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,VJ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,HJ=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,WJ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,jJ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$J=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,XJ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,GJ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,YJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,qJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ZJ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,KJ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,JJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,QJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,eQ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,tQ=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,nQ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,iQ=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,rQ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,sQ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,oQ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,aQ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,lQ="gl_FragColor = linearToOutputTexel( gl_FragColor );",cQ=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,uQ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,hQ=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,fQ=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,dQ=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,pQ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,mQ=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,gQ=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,_Q=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,yQ=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,vQ=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,xQ=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,bQ=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,wQ=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,SQ=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,TQ=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,EQ=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,AQ=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,MQ=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,CQ=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,PQ=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,RQ=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,IQ=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,kQ=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,OQ=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,LQ=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,NQ=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,DQ=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,FQ=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,UQ=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,BQ=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,zQ=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,VQ=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,HQ=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,WQ=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,jQ=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,$Q=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,XQ=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,GQ=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,YQ=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,qQ=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,ZQ=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,KQ=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,JQ=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,QQ=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,eee=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,tee=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,nee=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,iee=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,ree=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,see=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,oee=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,aee=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,lee=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,cee=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,uee=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,hee=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fee=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,dee=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,pee=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,mee=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,gee=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,_ee=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,yee=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,vee=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,xee=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,bee=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wee=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,See=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Tee=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Eee=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Aee=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Mee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Cee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Pee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Ree=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Iee=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,kee=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Oee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Lee=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Nee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Dee=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Fee=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Uee=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Bee=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,zee=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Vee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Hee=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Wee=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,jee=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$ee=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Xee=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gee=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yee=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qee=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Zee=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kee=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Jee=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Qee=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ete=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tte=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,nte=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ite=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rte=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ste=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,ote=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ate=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lte=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,cte=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ute=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pn={alphahash_fragment:LJ,alphahash_pars_fragment:NJ,alphamap_fragment:DJ,alphamap_pars_fragment:FJ,alphatest_fragment:UJ,alphatest_pars_fragment:BJ,aomap_fragment:zJ,aomap_pars_fragment:VJ,begin_vertex:HJ,beginnormal_vertex:WJ,bsdfs:jJ,iridescence_fragment:$J,bumpmap_pars_fragment:XJ,clipping_planes_fragment:GJ,clipping_planes_pars_fragment:YJ,clipping_planes_pars_vertex:qJ,clipping_planes_vertex:ZJ,color_fragment:KJ,color_pars_fragment:JJ,color_pars_vertex:QJ,color_vertex:eQ,common:tQ,cube_uv_reflection_fragment:nQ,defaultnormal_vertex:iQ,displacementmap_pars_vertex:rQ,displacementmap_vertex:sQ,emissivemap_fragment:oQ,emissivemap_pars_fragment:aQ,colorspace_fragment:lQ,colorspace_pars_fragment:cQ,envmap_fragment:uQ,envmap_common_pars_fragment:hQ,envmap_pars_fragment:fQ,envmap_pars_vertex:dQ,envmap_physical_pars_fragment:EQ,envmap_vertex:pQ,fog_vertex:mQ,fog_pars_vertex:gQ,fog_fragment:_Q,fog_pars_fragment:yQ,gradientmap_pars_fragment:vQ,lightmap_fragment:xQ,lightmap_pars_fragment:bQ,lights_lambert_fragment:wQ,lights_lambert_pars_fragment:SQ,lights_pars_begin:TQ,lights_toon_fragment:AQ,lights_toon_pars_fragment:MQ,lights_phong_fragment:CQ,lights_phong_pars_fragment:PQ,lights_physical_fragment:RQ,lights_physical_pars_fragment:IQ,lights_fragment_begin:kQ,lights_fragment_maps:OQ,lights_fragment_end:LQ,logdepthbuf_fragment:NQ,logdepthbuf_pars_fragment:DQ,logdepthbuf_pars_vertex:FQ,logdepthbuf_vertex:UQ,map_fragment:BQ,map_pars_fragment:zQ,map_particle_fragment:VQ,map_particle_pars_fragment:HQ,metalnessmap_fragment:WQ,metalnessmap_pars_fragment:jQ,morphcolor_vertex:$Q,morphnormal_vertex:XQ,morphtarget_pars_vertex:GQ,morphtarget_vertex:YQ,normal_fragment_begin:qQ,normal_fragment_maps:ZQ,normal_pars_fragment:KQ,normal_pars_vertex:JQ,normal_vertex:QQ,normalmap_pars_fragment:eee,clearcoat_normal_fragment_begin:tee,clearcoat_normal_fragment_maps:nee,clearcoat_pars_fragment:iee,iridescence_pars_fragment:ree,opaque_fragment:see,packing:oee,premultiplied_alpha_fragment:aee,project_vertex:lee,dithering_fragment:cee,dithering_pars_fragment:uee,roughnessmap_fragment:hee,roughnessmap_pars_fragment:fee,shadowmap_pars_fragment:dee,shadowmap_pars_vertex:pee,shadowmap_vertex:mee,shadowmask_pars_fragment:gee,skinbase_vertex:_ee,skinning_pars_vertex:yee,skinning_vertex:vee,skinnormal_vertex:xee,specularmap_fragment:bee,specularmap_pars_fragment:wee,tonemapping_fragment:See,tonemapping_pars_fragment:Tee,transmission_fragment:Eee,transmission_pars_fragment:Aee,uv_pars_fragment:Mee,uv_pars_vertex:Cee,uv_vertex:Pee,worldpos_vertex:Ree,background_vert:Iee,background_frag:kee,backgroundCube_vert:Oee,backgroundCube_frag:Lee,cube_vert:Nee,cube_frag:Dee,depth_vert:Fee,depth_frag:Uee,distanceRGBA_vert:Bee,distanceRGBA_frag:zee,equirect_vert:Vee,equirect_frag:Hee,linedashed_vert:Wee,linedashed_frag:jee,meshbasic_vert:$ee,meshbasic_frag:Xee,meshlambert_vert:Gee,meshlambert_frag:Yee,meshmatcap_vert:qee,meshmatcap_frag:Zee,meshnormal_vert:Kee,meshnormal_frag:Jee,meshphong_vert:Qee,meshphong_frag:ete,meshphysical_vert:tte,meshphysical_frag:nte,meshtoon_vert:ite,meshtoon_frag:rte,points_vert:ste,points_frag:ote,shadow_vert:ate,shadow_frag:lte,sprite_vert:cte,sprite_frag:ute},St={common:{diffuse:{value:new Ot(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new kn},alphaMap:{value:null},alphaMapTransform:{value:new kn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new kn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new kn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new kn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new kn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new kn},normalScale:{value:new qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new kn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new kn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new kn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new kn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ot(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ot(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new kn},alphaTest:{value:0},uvTransform:{value:new kn}},sprite:{diffuse:{value:new Ot(16777215)},opacity:{value:1},center:{value:new qe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new kn},alphaMap:{value:null},alphaMapTransform:{value:new kn},alphaTest:{value:0}}},rc={basic:{uniforms:Lo([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.fog]),vertexShader:Pn.meshbasic_vert,fragmentShader:Pn.meshbasic_frag},lambert:{uniforms:Lo([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.fog,St.lights,{emissive:{value:new Ot(0)}}]),vertexShader:Pn.meshlambert_vert,fragmentShader:Pn.meshlambert_frag},phong:{uniforms:Lo([St.common,St.specularmap,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.fog,St.lights,{emissive:{value:new Ot(0)},specular:{value:new Ot(1118481)},shininess:{value:30}}]),vertexShader:Pn.meshphong_vert,fragmentShader:Pn.meshphong_frag},standard:{uniforms:Lo([St.common,St.envmap,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.roughnessmap,St.metalnessmap,St.fog,St.lights,{emissive:{value:new Ot(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag},toon:{uniforms:Lo([St.common,St.aomap,St.lightmap,St.emissivemap,St.bumpmap,St.normalmap,St.displacementmap,St.gradientmap,St.fog,St.lights,{emissive:{value:new Ot(0)}}]),vertexShader:Pn.meshtoon_vert,fragmentShader:Pn.meshtoon_frag},matcap:{uniforms:Lo([St.common,St.bumpmap,St.normalmap,St.displacementmap,St.fog,{matcap:{value:null}}]),vertexShader:Pn.meshmatcap_vert,fragmentShader:Pn.meshmatcap_frag},points:{uniforms:Lo([St.points,St.fog]),vertexShader:Pn.points_vert,fragmentShader:Pn.points_frag},dashed:{uniforms:Lo([St.common,St.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pn.linedashed_vert,fragmentShader:Pn.linedashed_frag},depth:{uniforms:Lo([St.common,St.displacementmap]),vertexShader:Pn.depth_vert,fragmentShader:Pn.depth_frag},normal:{uniforms:Lo([St.common,St.bumpmap,St.normalmap,St.displacementmap,{opacity:{value:1}}]),vertexShader:Pn.meshnormal_vert,fragmentShader:Pn.meshnormal_frag},sprite:{uniforms:Lo([St.sprite,St.fog]),vertexShader:Pn.sprite_vert,fragmentShader:Pn.sprite_frag},background:{uniforms:{uvTransform:{value:new kn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pn.background_vert,fragmentShader:Pn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Pn.backgroundCube_vert,fragmentShader:Pn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pn.cube_vert,fragmentShader:Pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pn.equirect_vert,fragmentShader:Pn.equirect_frag},distanceRGBA:{uniforms:Lo([St.common,St.displacementmap,{referencePosition:{value:new re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pn.distanceRGBA_vert,fragmentShader:Pn.distanceRGBA_frag},shadow:{uniforms:Lo([St.lights,St.fog,{color:{value:new Ot(0)},opacity:{value:1}}]),vertexShader:Pn.shadow_vert,fragmentShader:Pn.shadow_frag}};rc.physical={uniforms:Lo([rc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new kn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new kn},clearcoatNormalScale:{value:new qe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new kn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new kn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new kn},sheen:{value:0},sheenColor:{value:new Ot(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new kn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new kn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new kn},transmissionSamplerSize:{value:new qe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new kn},attenuationDistance:{value:0},attenuationColor:{value:new Ot(0)},specularColor:{value:new Ot(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new kn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new kn},anisotropyVector:{value:new qe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new kn}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag};const Yx={r:0,b:0,g:0};function hte(n,e,t,i,r,s,o){const a=new Ot(0);let l=s===!0?0:1,c,u,d=null,m=0,y=null;function x(S,w){let P=!1,M=w.isScene===!0?w.background:null;M&&M.isTexture&&(M=(w.backgroundBlurriness>0?t:e).get(M)),M===null?T(a,l):M&&M.isColor&&(T(M,1),P=!0);const I=n.xr.getEnvironmentBlendMode();I==="additive"?i.buffers.color.setClear(0,0,0,1,o):I==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||P)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),M&&(M.isCubeTexture||M.mapping===M_)?(u===void 0&&(u=new xs(new om(1,1,1),new au({name:"BackgroundCubeMaterial",uniforms:t_(rc.backgroundCube.uniforms),vertexShader:rc.backgroundCube.vertexShader,fragmentShader:rc.backgroundCube.fragmentShader,side:Uo,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(k,D,H){this.matrixWorld.copyPosition(H.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=M,u.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.toneMapped=hi.getTransfer(M.colorSpace)!==Ri,(d!==M||m!==M.version||y!==n.toneMapping)&&(u.material.needsUpdate=!0,d=M,m=M.version,y=n.toneMapping),u.layers.enableAll(),S.unshift(u,u.geometry,u.material,0,0,null)):M&&M.isTexture&&(c===void 0&&(c=new xs(new C_(2,2),new au({name:"BackgroundMaterial",uniforms:t_(rc.background.uniforms),vertexShader:rc.background.vertexShader,fragmentShader:rc.background.fragmentShader,side:ph,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=M,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=hi.getTransfer(M.colorSpace)!==Ri,M.matrixAutoUpdate===!0&&M.updateMatrix(),c.material.uniforms.uvTransform.value.copy(M.matrix),(d!==M||m!==M.version||y!==n.toneMapping)&&(c.material.needsUpdate=!0,d=M,m=M.version,y=n.toneMapping),c.layers.enableAll(),S.unshift(c,c.geometry,c.material,0,0,null))}function T(S,w){S.getRGB(Yx,LV(n)),i.buffers.color.setClear(Yx.r,Yx.g,Yx.b,w,o)}return{getClearColor:function(){return a},setClearColor:function(S,w=1){a.set(S),l=w,T(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(S){l=S,T(a,l)},render:x}}function fte(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=S(null);let c=l,u=!1;function d(te,de,ve,me,q){let ie=!1;if(o){const X=T(me,ve,de);c!==X&&(c=X,y(c.object)),ie=w(te,me,ve,q),ie&&P(te,me,ve,q)}else{const X=de.wireframe===!0;(c.geometry!==me.id||c.program!==ve.id||c.wireframe!==X)&&(c.geometry=me.id,c.program=ve.id,c.wireframe=X,ie=!0)}q!==null&&t.update(q,n.ELEMENT_ARRAY_BUFFER),(ie||u)&&(u=!1,W(te,de,ve,me),q!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(q).buffer))}function m(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function y(te){return i.isWebGL2?n.bindVertexArray(te):s.bindVertexArrayOES(te)}function x(te){return i.isWebGL2?n.deleteVertexArray(te):s.deleteVertexArrayOES(te)}function T(te,de,ve){const me=ve.wireframe===!0;let q=a[te.id];q===void 0&&(q={},a[te.id]=q);let ie=q[de.id];ie===void 0&&(ie={},q[de.id]=ie);let X=ie[me];return X===void 0&&(X=S(m()),ie[me]=X),X}function S(te){const de=[],ve=[],me=[];for(let q=0;q<r;q++)de[q]=0,ve[q]=0,me[q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:de,enabledAttributes:ve,attributeDivisors:me,object:te,attributes:{},index:null}}function w(te,de,ve,me){const q=c.attributes,ie=de.attributes;let X=0;const Y=ve.getAttributes();for(const ce in Y)if(Y[ce].location>=0){const Re=q[ce];let Fe=ie[ce];if(Fe===void 0&&(ce==="instanceMatrix"&&te.instanceMatrix&&(Fe=te.instanceMatrix),ce==="instanceColor"&&te.instanceColor&&(Fe=te.instanceColor)),Re===void 0||Re.attribute!==Fe||Fe&&Re.data!==Fe.data)return!0;X++}return c.attributesNum!==X||c.index!==me}function P(te,de,ve,me){const q={},ie=de.attributes;let X=0;const Y=ve.getAttributes();for(const ce in Y)if(Y[ce].location>=0){let Re=ie[ce];Re===void 0&&(ce==="instanceMatrix"&&te.instanceMatrix&&(Re=te.instanceMatrix),ce==="instanceColor"&&te.instanceColor&&(Re=te.instanceColor));const Fe={};Fe.attribute=Re,Re&&Re.data&&(Fe.data=Re.data),q[ce]=Fe,X++}c.attributes=q,c.attributesNum=X,c.index=me}function M(){const te=c.newAttributes;for(let de=0,ve=te.length;de<ve;de++)te[de]=0}function I(te){k(te,0)}function k(te,de){const ve=c.newAttributes,me=c.enabledAttributes,q=c.attributeDivisors;ve[te]=1,me[te]===0&&(n.enableVertexAttribArray(te),me[te]=1),q[te]!==de&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](te,de),q[te]=de)}function D(){const te=c.newAttributes,de=c.enabledAttributes;for(let ve=0,me=de.length;ve<me;ve++)de[ve]!==te[ve]&&(n.disableVertexAttribArray(ve),de[ve]=0)}function H(te,de,ve,me,q,ie,X){X===!0?n.vertexAttribIPointer(te,de,ve,q,ie):n.vertexAttribPointer(te,de,ve,me,q,ie)}function W(te,de,ve,me){if(i.isWebGL2===!1&&(te.isInstancedMesh||me.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();const q=me.attributes,ie=ve.getAttributes(),X=de.defaultAttributeValues;for(const Y in ie){const ce=ie[Y];if(ce.location>=0){let Me=q[Y];if(Me===void 0&&(Y==="instanceMatrix"&&te.instanceMatrix&&(Me=te.instanceMatrix),Y==="instanceColor"&&te.instanceColor&&(Me=te.instanceColor)),Me!==void 0){const Re=Me.normalized,Fe=Me.itemSize,Be=t.get(Me);if(Be===void 0)continue;const at=Be.buffer,pt=Be.type,Ft=Be.bytesPerElement,yn=i.isWebGL2===!0&&(pt===n.INT||pt===n.UNSIGNED_INT||Me.gpuType===tR);if(Me.isInterleavedBufferAttribute){const Rt=Me.data,he=Rt.stride,nt=Me.offset;if(Rt.isInstancedInterleavedBuffer){for(let Ye=0;Ye<ce.locationSize;Ye++)k(ce.location+Ye,Rt.meshPerAttribute);te.isInstancedMesh!==!0&&me._maxInstanceCount===void 0&&(me._maxInstanceCount=Rt.meshPerAttribute*Rt.count)}else for(let Ye=0;Ye<ce.locationSize;Ye++)I(ce.location+Ye);n.bindBuffer(n.ARRAY_BUFFER,at);for(let Ye=0;Ye<ce.locationSize;Ye++)H(ce.location+Ye,Fe/ce.locationSize,pt,Re,he*Ft,(nt+Fe/ce.locationSize*Ye)*Ft,yn)}else{if(Me.isInstancedBufferAttribute){for(let Rt=0;Rt<ce.locationSize;Rt++)k(ce.location+Rt,Me.meshPerAttribute);te.isInstancedMesh!==!0&&me._maxInstanceCount===void 0&&(me._maxInstanceCount=Me.meshPerAttribute*Me.count)}else for(let Rt=0;Rt<ce.locationSize;Rt++)I(ce.location+Rt);n.bindBuffer(n.ARRAY_BUFFER,at);for(let Rt=0;Rt<ce.locationSize;Rt++)H(ce.location+Rt,Fe/ce.locationSize,pt,Re,Fe*Ft,Fe/ce.locationSize*Rt*Ft,yn)}}else if(X!==void 0){const Re=X[Y];if(Re!==void 0)switch(Re.length){case 2:n.vertexAttrib2fv(ce.location,Re);break;case 3:n.vertexAttrib3fv(ce.location,Re);break;case 4:n.vertexAttrib4fv(ce.location,Re);break;default:n.vertexAttrib1fv(ce.location,Re)}}}}D()}function z(){le();for(const te in a){const de=a[te];for(const ve in de){const me=de[ve];for(const q in me)x(me[q].object),delete me[q];delete de[ve]}delete a[te]}}function j(te){if(a[te.id]===void 0)return;const de=a[te.id];for(const ve in de){const me=de[ve];for(const q in me)x(me[q].object),delete me[q];delete de[ve]}delete a[te.id]}function J(te){for(const de in a){const ve=a[de];if(ve[te.id]===void 0)continue;const me=ve[te.id];for(const q in me)x(me[q].object),delete me[q];delete ve[te.id]}}function le(){ge(),u=!0,c!==l&&(c=l,y(c.object))}function ge(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:le,resetDefaultState:ge,dispose:z,releaseStatesOfGeometry:j,releaseStatesOfProgram:J,initAttributes:M,enableAttribute:I,disableUnusedAttributes:D}}function dte(n,e,t,i){const r=i.isWebGL2;let s;function o(c){s=c}function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)}function l(c,u,d){if(d===0)return;let m,y;if(r)m=n,y="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[y](s,c,u,d),t.update(u,s,d)}this.setMode=o,this.render=a,this.renderInstances=l}function pte(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const H=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(H.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(H){if(H==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";H="mediump"}return H==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_TEXTURE_SIZE),x=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),T=n.getParameter(n.MAX_VERTEX_ATTRIBS),S=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),w=n.getParameter(n.MAX_VARYING_VECTORS),P=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),M=m>0,I=o||e.has("OES_texture_float"),k=M&&I,D=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:m,maxTextureSize:y,maxCubemapSize:x,maxAttributes:T,maxVertexUniforms:S,maxVaryings:w,maxFragmentUniforms:P,vertexTextures:M,floatFragmentTextures:I,floatVertexTextures:k,maxSamples:D}}function mte(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Xc,a=new kn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,m){const y=d.length!==0||m||i!==0||r;return r=m,i=d.length,y},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,m){t=u(d,m,0)},this.setState=function(d,m,y){const x=d.clippingPlanes,T=d.clipIntersection,S=d.clipShadows,w=n.get(d);if(!r||x===null||x.length===0||s&&!S)s?u(null):c();else{const P=s?0:i,M=P*4;let I=w.clippingState||null;l.value=I,I=u(x,m,M,y);for(let k=0;k!==M;++k)I[k]=t[k];w.clippingState=I,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=P}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,m,y,x){const T=d!==null?d.length:0;let S=null;if(T!==0){if(S=l.value,x!==!0||S===null){const w=y+T*4,P=m.matrixWorldInverse;a.getNormalMatrix(P),(S===null||S.length<w)&&(S=new Float32Array(w));for(let M=0,I=y;M!==T;++M,I+=4)o.copy(d[M]).applyMatrix4(P,a),o.normal.toArray(S,I),S[I+3]=o.constant}l.value=S,l.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,S}}function gte(n){let e=new WeakMap;function t(o,a){return a===bv?o.mapping=mh:a===wv&&(o.mapping=Kf),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===bv||a===wv)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new FV(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class Yf extends E0{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Tg=4,jk=[.125,.215,.35,.446,.526,.582],dp=20,n1=new Yf,$k=new Ot;let i1=null,r1=0,s1=0;const lp=(1+Math.sqrt(5))/2,ng=1/lp,Xk=[new re(1,1,1),new re(-1,1,1),new re(1,1,-1),new re(-1,1,-1),new re(0,lp,ng),new re(0,lp,-ng),new re(ng,0,lp),new re(-ng,0,lp),new re(lp,ng,0),new re(-lp,ng,0)];class ZM{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){i1=this._renderer.getRenderTarget(),r1=this._renderer.getActiveCubeFace(),s1=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=qk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Yk(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(i1,r1,s1),e.scissorTest=!1,qx(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===mh||e.mapping===Kf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),i1=this._renderer.getRenderTarget(),r1=this._renderer.getActiveCubeFace(),s1=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Mr,minFilter:Mr,generateMipmaps:!1,type:Qg,format:ca,colorSpace:ou,depthBuffer:!1},r=Gk(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Gk(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_te(s)),this._blurMaterial=yte(s,e,t)}return r}_compileMaterial(e){const t=new xs(this._lodPlanes[0],e);this._renderer.compile(t,n1)}_sceneToCubeUV(e,t,i,r){const a=new pr(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,m=u.toneMapping;u.getClearColor($k),u.toneMapping=eu,u.autoClear=!1;const y=new Eh({name:"PMREM.Background",side:Uo,depthWrite:!1,depthTest:!1}),x=new xs(new om,y);let T=!1;const S=e.background;S?S.isColor&&(y.color.copy(S),e.background=null,T=!0):(y.color.copy($k),T=!0);for(let w=0;w<6;w++){const P=w%3;P===0?(a.up.set(0,l[w],0),a.lookAt(c[w],0,0)):P===1?(a.up.set(0,0,l[w]),a.lookAt(0,c[w],0)):(a.up.set(0,l[w],0),a.lookAt(0,0,c[w]));const M=this._cubeSize;qx(r,P*M,w>2?M:0,M,M),u.setRenderTarget(r),T&&u.render(x,a),u.render(e,a)}x.geometry.dispose(),x.material.dispose(),u.toneMapping=m,u.autoClear=d,e.background=S}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===mh||e.mapping===Kf;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=qk()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Yk());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new xs(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;qx(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,n1)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=Xk[(r-1)%Xk.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,d=new xs(this._lodPlanes[r],c),m=c.uniforms,y=this._sizeLods[i]-1,x=isFinite(s)?Math.PI/(2*y):2*Math.PI/(2*dp-1),T=s/x,S=isFinite(s)?1+Math.floor(u*T):dp;S>dp&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${S} samples when the maximum is set to ${dp}`);const w=[];let P=0;for(let H=0;H<dp;++H){const W=H/T,z=Math.exp(-W*W/2);w.push(z),H===0?P+=z:H<S&&(P+=2*z)}for(let H=0;H<w.length;H++)w[H]=w[H]/P;m.envMap.value=e.texture,m.samples.value=S,m.weights.value=w,m.latitudinal.value=o==="latitudinal",a&&(m.poleAxis.value=a);const{_lodMax:M}=this;m.dTheta.value=x,m.mipInt.value=M-i;const I=this._sizeLods[r],k=3*I*(r>M-Tg?r-M+Tg:0),D=4*(this._cubeSize-I);qx(t,k,D,3*I,2*I),l.setRenderTarget(t),l.render(d,n1)}}function _te(n){const e=[],t=[],i=[];let r=n;const s=n-Tg+1+jk.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-Tg?l=jk[o-n+Tg-1]:o===0&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,m=[u,u,d,u,d,d,u,u,d,d,u,d],y=6,x=6,T=3,S=2,w=1,P=new Float32Array(T*x*y),M=new Float32Array(S*x*y),I=new Float32Array(w*x*y);for(let D=0;D<y;D++){const H=D%3*2/3-1,W=D>2?0:-1,z=[H,W,0,H+2/3,W,0,H+2/3,W+1,0,H,W,0,H+2/3,W+1,0,H,W+1,0];P.set(z,T*x*D),M.set(m,S*x*D);const j=[D,D,D,D,D,D];I.set(j,w*x*D)}const k=new Dn;k.setAttribute("position",new Ai(P,T)),k.setAttribute("uv",new Ai(M,S)),k.setAttribute("faceIndex",new Ai(I,w)),e.push(k),r>Tg&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function Gk(n,e,t){const i=new hc(n,e,t);return i.texture.mapping=M_,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function qx(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function yte(n,e,t){const i=new Float32Array(dp),r=new re(0,1,0);return new au({name:"SphericalGaussianBlur",defines:{n:dp,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:pR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:uh,depthTest:!1,depthWrite:!1})}function Yk(){return new au({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:pR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:uh,depthTest:!1,depthWrite:!1})}function qk(){return new au({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:pR(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:uh,depthTest:!1,depthWrite:!1})}function pR(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function vte(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===bv||l===wv,u=l===mh||l===Kf;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let d=e.get(a);return t===null&&(t=new ZM(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}else{if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&r(d)){t===null&&(t=new ZM(n));const m=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,m),a.addEventListener("dispose",s),m.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function xte(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function bte(n,e,t,i){const r={},s=new WeakMap;function o(d){const m=d.target;m.index!==null&&e.remove(m.index);for(const x in m.attributes)e.remove(m.attributes[x]);for(const x in m.morphAttributes){const T=m.morphAttributes[x];for(let S=0,w=T.length;S<w;S++)e.remove(T[S])}m.removeEventListener("dispose",o),delete r[m.id];const y=s.get(m);y&&(e.remove(y),s.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function a(d,m){return r[m.id]===!0||(m.addEventListener("dispose",o),r[m.id]=!0,t.memory.geometries++),m}function l(d){const m=d.attributes;for(const x in m)e.update(m[x],n.ARRAY_BUFFER);const y=d.morphAttributes;for(const x in y){const T=y[x];for(let S=0,w=T.length;S<w;S++)e.update(T[S],n.ARRAY_BUFFER)}}function c(d){const m=[],y=d.index,x=d.attributes.position;let T=0;if(y!==null){const P=y.array;T=y.version;for(let M=0,I=P.length;M<I;M+=3){const k=P[M+0],D=P[M+1],H=P[M+2];m.push(k,D,D,H,H,k)}}else if(x!==void 0){const P=x.array;T=x.version;for(let M=0,I=P.length/3-1;M<I;M+=3){const k=M+0,D=M+1,H=M+2;m.push(k,D,D,H,H,k)}}else return;const S=new(PV(m)?dR:fR)(m,1);S.version=T;const w=s.get(d);w&&e.remove(w),s.set(d,S)}function u(d){const m=s.get(d);if(m){const y=d.index;y!==null&&m.version<y.version&&c(d)}else c(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:u}}function wte(n,e,t,i){const r=i.isWebGL2;let s;function o(m){s=m}let a,l;function c(m){a=m.type,l=m.bytesPerElement}function u(m,y){n.drawElements(s,y,a,m*l),t.update(y,s,1)}function d(m,y,x){if(x===0)return;let T,S;if(r)T=n,S="drawElementsInstanced";else if(T=e.get("ANGLE_instanced_arrays"),S="drawElementsInstancedANGLE",T===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}T[S](s,y,a,m*l,x),t.update(y,s,x)}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=d}function Ste(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function Tte(n,e){return n[0]-e[0]}function Ete(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Ate(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new di,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,d){const m=c.morphTargetInfluences;if(e.isWebGL2===!0){const y=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,x=y!==void 0?y.length:0;let T=s.get(u);if(T===void 0||T.count!==x){let te=function(){le.dispose(),s.delete(u),u.removeEventListener("dispose",te)};T!==void 0&&T.texture.dispose();const P=u.morphAttributes.position!==void 0,M=u.morphAttributes.normal!==void 0,I=u.morphAttributes.color!==void 0,k=u.morphAttributes.position||[],D=u.morphAttributes.normal||[],H=u.morphAttributes.color||[];let W=0;P===!0&&(W=1),M===!0&&(W=2),I===!0&&(W=3);let z=u.attributes.position.count*W,j=1;z>e.maxTextureSize&&(j=Math.ceil(z/e.maxTextureSize),z=e.maxTextureSize);const J=new Float32Array(z*j*4*x),le=new JS(J,z,j,x);le.type=qc,le.needsUpdate=!0;const ge=W*4;for(let de=0;de<x;de++){const ve=k[de],me=D[de],q=H[de],ie=z*j*4*de;for(let X=0;X<ve.count;X++){const Y=X*ge;P===!0&&(o.fromBufferAttribute(ve,X),J[ie+Y+0]=o.x,J[ie+Y+1]=o.y,J[ie+Y+2]=o.z,J[ie+Y+3]=0),M===!0&&(o.fromBufferAttribute(me,X),J[ie+Y+4]=o.x,J[ie+Y+5]=o.y,J[ie+Y+6]=o.z,J[ie+Y+7]=0),I===!0&&(o.fromBufferAttribute(q,X),J[ie+Y+8]=o.x,J[ie+Y+9]=o.y,J[ie+Y+10]=o.z,J[ie+Y+11]=q.itemSize===4?o.w:1)}}T={count:x,texture:le,size:new qe(z,j)},s.set(u,T),u.addEventListener("dispose",te)}let S=0;for(let P=0;P<m.length;P++)S+=m[P];const w=u.morphTargetsRelative?1:1-S;d.getUniforms().setValue(n,"morphTargetBaseInfluence",w),d.getUniforms().setValue(n,"morphTargetInfluences",m),d.getUniforms().setValue(n,"morphTargetsTexture",T.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",T.size)}else{const y=m===void 0?0:m.length;let x=i[u.id];if(x===void 0||x.length!==y){x=[];for(let M=0;M<y;M++)x[M]=[M,0];i[u.id]=x}for(let M=0;M<y;M++){const I=x[M];I[0]=M,I[1]=m[M]}x.sort(Ete);for(let M=0;M<8;M++)M<y&&x[M][1]?(a[M][0]=x[M][0],a[M][1]=x[M][1]):(a[M][0]=Number.MAX_SAFE_INTEGER,a[M][1]=0);a.sort(Tte);const T=u.morphAttributes.position,S=u.morphAttributes.normal;let w=0;for(let M=0;M<8;M++){const I=a[M],k=I[0],D=I[1];k!==Number.MAX_SAFE_INTEGER&&D?(T&&u.getAttribute("morphTarget"+M)!==T[k]&&u.setAttribute("morphTarget"+M,T[k]),S&&u.getAttribute("morphNormal"+M)!==S[k]&&u.setAttribute("morphNormal"+M,S[k]),r[M]=D,w+=D):(T&&u.hasAttribute("morphTarget"+M)===!0&&u.deleteAttribute("morphTarget"+M),S&&u.hasAttribute("morphNormal"+M)===!0&&u.deleteAttribute("morphNormal"+M),r[M]=0)}const P=u.morphTargetsRelative?1:1-w;d.getUniforms().setValue(n,"morphTargetBaseInfluence",P),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function Mte(n,e,t,i){let r=new WeakMap;function s(l){const c=i.render.frame,u=l.geometry,d=e.get(l,u);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const m=l.skeleton;r.get(m)!==c&&(m.update(),r.set(m,c))}return d}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}const BV=new js,zV=new JS,VV=new hR,HV=new A0,Zk=[],Kk=[],Jk=new Float32Array(16),Qk=new Float32Array(9),eO=new Float32Array(4);function P_(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=Zk[r];if(s===void 0&&(s=new Float32Array(r),Zk[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function rs(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function ss(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function eT(n,e){let t=Kk[e];t===void 0&&(t=new Int32Array(e),Kk[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Cte(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Pte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rs(t,e))return;n.uniform2fv(this.addr,e),ss(t,e)}}function Rte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(rs(t,e))return;n.uniform3fv(this.addr,e),ss(t,e)}}function Ite(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rs(t,e))return;n.uniform4fv(this.addr,e),ss(t,e)}}function kte(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(rs(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ss(t,e)}else{if(rs(t,i))return;eO.set(i),n.uniformMatrix2fv(this.addr,!1,eO),ss(t,i)}}function Ote(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(rs(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ss(t,e)}else{if(rs(t,i))return;Qk.set(i),n.uniformMatrix3fv(this.addr,!1,Qk),ss(t,i)}}function Lte(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(rs(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ss(t,e)}else{if(rs(t,i))return;Jk.set(i),n.uniformMatrix4fv(this.addr,!1,Jk),ss(t,i)}}function Nte(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function Dte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rs(t,e))return;n.uniform2iv(this.addr,e),ss(t,e)}}function Fte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(rs(t,e))return;n.uniform3iv(this.addr,e),ss(t,e)}}function Ute(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rs(t,e))return;n.uniform4iv(this.addr,e),ss(t,e)}}function Bte(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function zte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rs(t,e))return;n.uniform2uiv(this.addr,e),ss(t,e)}}function Vte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(rs(t,e))return;n.uniform3uiv(this.addr,e),ss(t,e)}}function Hte(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rs(t,e))return;n.uniform4uiv(this.addr,e),ss(t,e)}}function Wte(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||BV,r)}function jte(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||VV,r)}function $te(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||HV,r)}function Xte(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||zV,r)}function Gte(n){switch(n){case 5126:return Cte;case 35664:return Pte;case 35665:return Rte;case 35666:return Ite;case 35674:return kte;case 35675:return Ote;case 35676:return Lte;case 5124:case 35670:return Nte;case 35667:case 35671:return Dte;case 35668:case 35672:return Fte;case 35669:case 35673:return Ute;case 5125:return Bte;case 36294:return zte;case 36295:return Vte;case 36296:return Hte;case 35678:case 36198:case 36298:case 36306:case 35682:return Wte;case 35679:case 36299:case 36307:return jte;case 35680:case 36300:case 36308:case 36293:return $te;case 36289:case 36303:case 36311:case 36292:return Xte}}function Yte(n,e){n.uniform1fv(this.addr,e)}function qte(n,e){const t=P_(e,this.size,2);n.uniform2fv(this.addr,t)}function Zte(n,e){const t=P_(e,this.size,3);n.uniform3fv(this.addr,t)}function Kte(n,e){const t=P_(e,this.size,4);n.uniform4fv(this.addr,t)}function Jte(n,e){const t=P_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Qte(n,e){const t=P_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function ene(n,e){const t=P_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function tne(n,e){n.uniform1iv(this.addr,e)}function nne(n,e){n.uniform2iv(this.addr,e)}function ine(n,e){n.uniform3iv(this.addr,e)}function rne(n,e){n.uniform4iv(this.addr,e)}function sne(n,e){n.uniform1uiv(this.addr,e)}function one(n,e){n.uniform2uiv(this.addr,e)}function ane(n,e){n.uniform3uiv(this.addr,e)}function lne(n,e){n.uniform4uiv(this.addr,e)}function cne(n,e,t){const i=this.cache,r=e.length,s=eT(t,r);rs(i,s)||(n.uniform1iv(this.addr,s),ss(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||BV,s[o])}function une(n,e,t){const i=this.cache,r=e.length,s=eT(t,r);rs(i,s)||(n.uniform1iv(this.addr,s),ss(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||VV,s[o])}function hne(n,e,t){const i=this.cache,r=e.length,s=eT(t,r);rs(i,s)||(n.uniform1iv(this.addr,s),ss(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||HV,s[o])}function fne(n,e,t){const i=this.cache,r=e.length,s=eT(t,r);rs(i,s)||(n.uniform1iv(this.addr,s),ss(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||zV,s[o])}function dne(n){switch(n){case 5126:return Yte;case 35664:return qte;case 35665:return Zte;case 35666:return Kte;case 35674:return Jte;case 35675:return Qte;case 35676:return ene;case 5124:case 35670:return tne;case 35667:case 35671:return nne;case 35668:case 35672:return ine;case 35669:case 35673:return rne;case 5125:return sne;case 36294:return one;case 36295:return ane;case 36296:return lne;case 35678:case 36198:case 36298:case 36306:case 35682:return cne;case 35679:case 36299:case 36307:return une;case 35680:case 36300:case 36308:case 36293:return hne;case 36289:case 36303:case 36311:case 36292:return fne}}class pne{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Gte(t.type)}}class mne{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=dne(t.type)}}class gne{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const o1=/(\w+)(\])?(\[|\.)?/g;function tO(n,e){n.seq.push(e),n.map[e.id]=e}function _ne(n,e,t){const i=n.name,r=i.length;for(o1.lastIndex=0;;){const s=o1.exec(i),o=o1.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){tO(t,c===void 0?new pne(a,n,e):new mne(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new gne(a),tO(t,d)),t=d}}}class pw{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);_ne(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function nO(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const yne=37297;let vne=0;function xne(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function bne(n){const e=hi.getPrimaries(hi.workingColorSpace),t=hi.getPrimaries(n);let i;switch(e===t?i="":e===Rv&&t===Pv?i="LinearDisplayP3ToLinearSRGB":e===Pv&&t===Rv&&(i="LinearSRGBToLinearDisplayP3"),n){case ou:case S0:return[i,"LinearTransferOETF"];case es:case KS:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function iO(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+xne(n.getShaderSource(e),o)}else return r}function wne(n,e){const t=bne(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Sne(n,e){let t;switch(e){case eV:t="Linear";break;case tV:t="Reinhard";break;case nV:t="OptimizedCineon";break;case QP:t="ACESFilmic";break;case iV:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Tne(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Iy).join(`
`)}function Ene(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function Ane(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Iy(n){return n!==""}function rO(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function sO(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Mne=/^[ \t]*#include +<([\w\d./]+)>/gm;function KM(n){return n.replace(Mne,Pne)}const Cne=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Pne(n,e){let t=Pn[e];if(t===void 0){const i=Cne.get(e);if(i!==void 0)t=Pn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return KM(t)}const Rne=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function oO(n){return n.replace(Rne,Ine)}function Ine(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function aO(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function kne(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===GS?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===jy?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===nc&&(e="SHADOWMAP_TYPE_VSM"),e}function One(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case mh:case Kf:e="ENVMAP_TYPE_CUBE";break;case M_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Lne(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Kf:e="ENVMAP_MODE_REFRACTION";break}return e}function Nne(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case w0:e="ENVMAP_BLENDING_MULTIPLY";break;case Jz:e="ENVMAP_BLENDING_MIX";break;case Qz:e="ENVMAP_BLENDING_ADD";break}return e}function Dne(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}function Fne(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=kne(t),c=One(t),u=Lne(t),d=Nne(t),m=Dne(t),y=t.isWebGL2?"":Tne(t),x=Ene(s),T=r.createProgram();let S,w,P=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(Iy).join(`
`),S.length>0&&(S+=`
`),w=[y,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(Iy).join(`
`),w.length>0&&(w+=`
`)):(S=[aO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Iy).join(`
`),w=[y,aO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==eu?"#define TONE_MAPPING":"",t.toneMapping!==eu?Pn.tonemapping_pars_fragment:"",t.toneMapping!==eu?Sne("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pn.colorspace_pars_fragment,wne("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Iy).join(`
`)),o=KM(o),o=rO(o,t),o=sO(o,t),a=KM(a),a=rO(a,t),a=sO(a,t),o=oO(o),a=oO(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(P=`#version 300 es
`,S=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,w=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===GM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===GM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const M=P+S+o,I=P+w+a,k=nO(r,r.VERTEX_SHADER,M),D=nO(r,r.FRAGMENT_SHADER,I);r.attachShader(T,k),r.attachShader(T,D),t.index0AttributeName!==void 0?r.bindAttribLocation(T,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(T,0,"position"),r.linkProgram(T);function H(J){if(n.debug.checkShaderErrors){const le=r.getProgramInfoLog(T).trim(),ge=r.getShaderInfoLog(k).trim(),te=r.getShaderInfoLog(D).trim();let de=!0,ve=!0;if(r.getProgramParameter(T,r.LINK_STATUS)===!1)if(de=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,T,k,D);else{const me=iO(r,k,"vertex"),q=iO(r,D,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(T,r.VALIDATE_STATUS)+`

Program Info Log: `+le+`
`+me+`
`+q)}else le!==""?console.warn("THREE.WebGLProgram: Program Info Log:",le):(ge===""||te==="")&&(ve=!1);ve&&(J.diagnostics={runnable:de,programLog:le,vertexShader:{log:ge,prefix:S},fragmentShader:{log:te,prefix:w}})}r.deleteShader(k),r.deleteShader(D),W=new pw(r,T),z=Ane(r,T)}let W;this.getUniforms=function(){return W===void 0&&H(this),W};let z;this.getAttributes=function(){return z===void 0&&H(this),z};let j=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return j===!1&&(j=r.getProgramParameter(T,yne)),j},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(T),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=vne++,this.cacheKey=e,this.usedTimes=1,this.program=T,this.vertexShader=k,this.fragmentShader=D,this}let Une=0;class Bne{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new zne(e),t.set(e,i)),i}}class zne{constructor(e){this.id=Une++,this.code=e,this.usedTimes=0}}function Vne(n,e,t,i,r,s,o){const a=new Cp,l=new Bne,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,m=r.vertexTextures;let y=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function T(z){return z===0?"uv":`uv${z}`}function S(z,j,J,le,ge){const te=le.fog,de=ge.geometry,ve=z.isMeshStandardMaterial?le.environment:null,me=(z.isMeshStandardMaterial?t:e).get(z.envMap||ve),q=me&&me.mapping===M_?me.image.height:null,ie=x[z.type];z.precision!==null&&(y=r.getMaxPrecision(z.precision),y!==z.precision&&console.warn("THREE.WebGLProgram.getParameters:",z.precision,"not supported, using",y,"instead."));const X=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,Y=X!==void 0?X.length:0;let ce=0;de.morphAttributes.position!==void 0&&(ce=1),de.morphAttributes.normal!==void 0&&(ce=2),de.morphAttributes.color!==void 0&&(ce=3);let Me,Re,Fe,Be;if(ie){const jn=rc[ie];Me=jn.vertexShader,Re=jn.fragmentShader}else Me=z.vertexShader,Re=z.fragmentShader,l.update(z),Fe=l.getVertexShaderID(z),Be=l.getFragmentShaderID(z);const at=n.getRenderTarget(),pt=ge.isInstancedMesh===!0,Ft=!!z.map,yn=!!z.matcap,Rt=!!me,he=!!z.aoMap,nt=!!z.lightMap,Ye=!!z.bumpMap,lt=!!z.normalMap,Ke=!!z.displacementMap,Ut=!!z.emissiveMap,bt=!!z.metalnessMap,Ct=!!z.roughnessMap,Zt=z.anisotropy>0,ln=z.clearcoat>0,Xn=z.iridescence>0,ae=z.sheen>0,Q=z.transmission>0,Ne=Zt&&!!z.anisotropyMap,ct=ln&&!!z.clearcoatMap,et=ln&&!!z.clearcoatNormalMap,ot=ln&&!!z.clearcoatRoughnessMap,Bt=Xn&&!!z.iridescenceMap,dt=Xn&&!!z.iridescenceThicknessMap,vt=ae&&!!z.sheenColorMap,nn=ae&&!!z.sheenRoughnessMap,Mn=!!z.specularMap,ht=!!z.specularColorMap,Ln=!!z.specularIntensityMap,pe=Q&&!!z.transmissionMap,$e=Q&&!!z.thicknessMap,it=!!z.gradientMap,tt=!!z.alphaMap,jt=z.alphaTest>0,ye=!!z.alphaHash,mt=!!z.extensions,gt=!!de.attributes.uv1,Ge=!!de.attributes.uv2,ut=!!de.attributes.uv3;let Vt=eu;return z.toneMapped&&(at===null||at.isXRRenderTarget===!0)&&(Vt=n.toneMapping),{isWebGL2:u,shaderID:ie,shaderType:z.type,shaderName:z.name,vertexShader:Me,fragmentShader:Re,defines:z.defines,customVertexShaderID:Fe,customFragmentShaderID:Be,isRawShaderMaterial:z.isRawShaderMaterial===!0,glslVersion:z.glslVersion,precision:y,instancing:pt,instancingColor:pt&&ge.instanceColor!==null,supportsVertexTextures:m,outputColorSpace:at===null?n.outputColorSpace:at.isXRRenderTarget===!0?at.texture.colorSpace:ou,map:Ft,matcap:yn,envMap:Rt,envMapMode:Rt&&me.mapping,envMapCubeUVHeight:q,aoMap:he,lightMap:nt,bumpMap:Ye,normalMap:lt,displacementMap:m&&Ke,emissiveMap:Ut,normalMapObjectSpace:lt&&z.normalMapType===vV,normalMapTangentSpace:lt&&z.normalMapType===cd,metalnessMap:bt,roughnessMap:Ct,anisotropy:Zt,anisotropyMap:Ne,clearcoat:ln,clearcoatMap:ct,clearcoatNormalMap:et,clearcoatRoughnessMap:ot,iridescence:Xn,iridescenceMap:Bt,iridescenceThicknessMap:dt,sheen:ae,sheenColorMap:vt,sheenRoughnessMap:nn,specularMap:Mn,specularColorMap:ht,specularIntensityMap:Ln,transmission:Q,transmissionMap:pe,thicknessMap:$e,gradientMap:it,opaque:z.transparent===!1&&z.blending===Ap,alphaMap:tt,alphaTest:jt,alphaHash:ye,combine:z.combine,mapUv:Ft&&T(z.map.channel),aoMapUv:he&&T(z.aoMap.channel),lightMapUv:nt&&T(z.lightMap.channel),bumpMapUv:Ye&&T(z.bumpMap.channel),normalMapUv:lt&&T(z.normalMap.channel),displacementMapUv:Ke&&T(z.displacementMap.channel),emissiveMapUv:Ut&&T(z.emissiveMap.channel),metalnessMapUv:bt&&T(z.metalnessMap.channel),roughnessMapUv:Ct&&T(z.roughnessMap.channel),anisotropyMapUv:Ne&&T(z.anisotropyMap.channel),clearcoatMapUv:ct&&T(z.clearcoatMap.channel),clearcoatNormalMapUv:et&&T(z.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ot&&T(z.clearcoatRoughnessMap.channel),iridescenceMapUv:Bt&&T(z.iridescenceMap.channel),iridescenceThicknessMapUv:dt&&T(z.iridescenceThicknessMap.channel),sheenColorMapUv:vt&&T(z.sheenColorMap.channel),sheenRoughnessMapUv:nn&&T(z.sheenRoughnessMap.channel),specularMapUv:Mn&&T(z.specularMap.channel),specularColorMapUv:ht&&T(z.specularColorMap.channel),specularIntensityMapUv:Ln&&T(z.specularIntensityMap.channel),transmissionMapUv:pe&&T(z.transmissionMap.channel),thicknessMapUv:$e&&T(z.thicknessMap.channel),alphaMapUv:tt&&T(z.alphaMap.channel),vertexTangents:!!de.attributes.tangent&&(lt||Zt),vertexColors:z.vertexColors,vertexAlphas:z.vertexColors===!0&&!!de.attributes.color&&de.attributes.color.itemSize===4,vertexUv1s:gt,vertexUv2s:Ge,vertexUv3s:ut,pointsUvs:ge.isPoints===!0&&!!de.attributes.uv&&(Ft||tt),fog:!!te,useFog:z.fog===!0,fogExp2:te&&te.isFogExp2,flatShading:z.flatShading===!0,sizeAttenuation:z.sizeAttenuation===!0,logarithmicDepthBuffer:d,skinning:ge.isSkinnedMesh===!0,morphTargets:de.morphAttributes.position!==void 0,morphNormals:de.morphAttributes.normal!==void 0,morphColors:de.morphAttributes.color!==void 0,morphTargetsCount:Y,morphTextureStride:ce,numDirLights:j.directional.length,numPointLights:j.point.length,numSpotLights:j.spot.length,numSpotLightMaps:j.spotLightMap.length,numRectAreaLights:j.rectArea.length,numHemiLights:j.hemi.length,numDirLightShadows:j.directionalShadowMap.length,numPointLightShadows:j.pointShadowMap.length,numSpotLightShadows:j.spotShadowMap.length,numSpotLightShadowsWithMaps:j.numSpotLightShadowsWithMaps,numLightProbes:j.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:z.dithering,shadowMapEnabled:n.shadowMap.enabled&&J.length>0,shadowMapType:n.shadowMap.type,toneMapping:Vt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Ft&&z.map.isVideoTexture===!0&&hi.getTransfer(z.map.colorSpace)===Ri,premultipliedAlpha:z.premultipliedAlpha,doubleSided:z.side===Gc,flipSided:z.side===Uo,useDepthPacking:z.depthPacking>=0,depthPacking:z.depthPacking||0,index0AttributeName:z.index0AttributeName,extensionDerivatives:mt&&z.extensions.derivatives===!0,extensionFragDepth:mt&&z.extensions.fragDepth===!0,extensionDrawBuffers:mt&&z.extensions.drawBuffers===!0,extensionShaderTextureLOD:mt&&z.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:z.customProgramCacheKey()}}function w(z){const j=[];if(z.shaderID?j.push(z.shaderID):(j.push(z.customVertexShaderID),j.push(z.customFragmentShaderID)),z.defines!==void 0)for(const J in z.defines)j.push(J),j.push(z.defines[J]);return z.isRawShaderMaterial===!1&&(P(j,z),M(j,z),j.push(n.outputColorSpace)),j.push(z.customProgramCacheKey),j.join()}function P(z,j){z.push(j.precision),z.push(j.outputColorSpace),z.push(j.envMapMode),z.push(j.envMapCubeUVHeight),z.push(j.mapUv),z.push(j.alphaMapUv),z.push(j.lightMapUv),z.push(j.aoMapUv),z.push(j.bumpMapUv),z.push(j.normalMapUv),z.push(j.displacementMapUv),z.push(j.emissiveMapUv),z.push(j.metalnessMapUv),z.push(j.roughnessMapUv),z.push(j.anisotropyMapUv),z.push(j.clearcoatMapUv),z.push(j.clearcoatNormalMapUv),z.push(j.clearcoatRoughnessMapUv),z.push(j.iridescenceMapUv),z.push(j.iridescenceThicknessMapUv),z.push(j.sheenColorMapUv),z.push(j.sheenRoughnessMapUv),z.push(j.specularMapUv),z.push(j.specularColorMapUv),z.push(j.specularIntensityMapUv),z.push(j.transmissionMapUv),z.push(j.thicknessMapUv),z.push(j.combine),z.push(j.fogExp2),z.push(j.sizeAttenuation),z.push(j.morphTargetsCount),z.push(j.morphAttributeCount),z.push(j.numDirLights),z.push(j.numPointLights),z.push(j.numSpotLights),z.push(j.numSpotLightMaps),z.push(j.numHemiLights),z.push(j.numRectAreaLights),z.push(j.numDirLightShadows),z.push(j.numPointLightShadows),z.push(j.numSpotLightShadows),z.push(j.numSpotLightShadowsWithMaps),z.push(j.numLightProbes),z.push(j.shadowMapType),z.push(j.toneMapping),z.push(j.numClippingPlanes),z.push(j.numClipIntersection),z.push(j.depthPacking)}function M(z,j){a.disableAll(),j.isWebGL2&&a.enable(0),j.supportsVertexTextures&&a.enable(1),j.instancing&&a.enable(2),j.instancingColor&&a.enable(3),j.matcap&&a.enable(4),j.envMap&&a.enable(5),j.normalMapObjectSpace&&a.enable(6),j.normalMapTangentSpace&&a.enable(7),j.clearcoat&&a.enable(8),j.iridescence&&a.enable(9),j.alphaTest&&a.enable(10),j.vertexColors&&a.enable(11),j.vertexAlphas&&a.enable(12),j.vertexUv1s&&a.enable(13),j.vertexUv2s&&a.enable(14),j.vertexUv3s&&a.enable(15),j.vertexTangents&&a.enable(16),j.anisotropy&&a.enable(17),j.alphaHash&&a.enable(18),z.push(a.mask),a.disableAll(),j.fog&&a.enable(0),j.useFog&&a.enable(1),j.flatShading&&a.enable(2),j.logarithmicDepthBuffer&&a.enable(3),j.skinning&&a.enable(4),j.morphTargets&&a.enable(5),j.morphNormals&&a.enable(6),j.morphColors&&a.enable(7),j.premultipliedAlpha&&a.enable(8),j.shadowMapEnabled&&a.enable(9),j.useLegacyLights&&a.enable(10),j.doubleSided&&a.enable(11),j.flipSided&&a.enable(12),j.useDepthPacking&&a.enable(13),j.dithering&&a.enable(14),j.transmission&&a.enable(15),j.sheen&&a.enable(16),j.opaque&&a.enable(17),j.pointsUvs&&a.enable(18),j.decodeVideoTexture&&a.enable(19),z.push(a.mask)}function I(z){const j=x[z.type];let J;if(j){const le=rc[j];J=NV.clone(le.uniforms)}else J=z.uniforms;return J}function k(z,j){let J;for(let le=0,ge=c.length;le<ge;le++){const te=c[le];if(te.cacheKey===j){J=te,++J.usedTimes;break}}return J===void 0&&(J=new Fne(n,j,z,s),c.push(J)),J}function D(z){if(--z.usedTimes===0){const j=c.indexOf(z);c[j]=c[c.length-1],c.pop(),z.destroy()}}function H(z){l.remove(z)}function W(){l.dispose()}return{getParameters:S,getProgramCacheKey:w,getUniforms:I,acquireProgram:k,releaseProgram:D,releaseShaderCache:H,programs:c,dispose:W}}function Hne(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function Wne(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function lO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function cO(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(d,m,y,x,T,S){let w=n[e];return w===void 0?(w={id:d.id,object:d,geometry:m,material:y,groupOrder:x,renderOrder:d.renderOrder,z:T,group:S},n[e]=w):(w.id=d.id,w.object=d,w.geometry=m,w.material=y,w.groupOrder=x,w.renderOrder=d.renderOrder,w.z=T,w.group=S),e++,w}function a(d,m,y,x,T,S){const w=o(d,m,y,x,T,S);y.transmission>0?i.push(w):y.transparent===!0?r.push(w):t.push(w)}function l(d,m,y,x,T,S){const w=o(d,m,y,x,T,S);y.transmission>0?i.unshift(w):y.transparent===!0?r.unshift(w):t.unshift(w)}function c(d,m){t.length>1&&t.sort(d||Wne),i.length>1&&i.sort(m||lO),r.length>1&&r.sort(m||lO)}function u(){for(let d=e,m=n.length;d<m;d++){const y=n[d];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function jne(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new cO,n.set(i,[o])):r>=s.length?(o=new cO,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function $ne(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new re,color:new Ot};break;case"SpotLight":t={position:new re,direction:new re,color:new Ot,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new re,color:new Ot,distance:0,decay:0};break;case"HemisphereLight":t={direction:new re,skyColor:new Ot,groundColor:new Ot};break;case"RectAreaLight":t={color:new Ot,position:new re,halfWidth:new re,halfHeight:new re};break}return n[e.id]=t,t}}}function Xne(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let Gne=0;function Yne(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function qne(n,e){const t=new $ne,i=Xne(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new re);const s=new re,o=new On,a=new On;function l(u,d){let m=0,y=0,x=0;for(let le=0;le<9;le++)r.probe[le].set(0,0,0);let T=0,S=0,w=0,P=0,M=0,I=0,k=0,D=0,H=0,W=0,z=0;u.sort(Yne);const j=d===!0?Math.PI:1;for(let le=0,ge=u.length;le<ge;le++){const te=u[le],de=te.color,ve=te.intensity,me=te.distance,q=te.shadow&&te.shadow.map?te.shadow.map.texture:null;if(te.isAmbientLight)m+=de.r*ve*j,y+=de.g*ve*j,x+=de.b*ve*j;else if(te.isLightProbe){for(let ie=0;ie<9;ie++)r.probe[ie].addScaledVector(te.sh.coefficients[ie],ve);z++}else if(te.isDirectionalLight){const ie=t.get(te);if(ie.color.copy(te.color).multiplyScalar(te.intensity*j),te.castShadow){const X=te.shadow,Y=i.get(te);Y.shadowBias=X.bias,Y.shadowNormalBias=X.normalBias,Y.shadowRadius=X.radius,Y.shadowMapSize=X.mapSize,r.directionalShadow[T]=Y,r.directionalShadowMap[T]=q,r.directionalShadowMatrix[T]=te.shadow.matrix,I++}r.directional[T]=ie,T++}else if(te.isSpotLight){const ie=t.get(te);ie.position.setFromMatrixPosition(te.matrixWorld),ie.color.copy(de).multiplyScalar(ve*j),ie.distance=me,ie.coneCos=Math.cos(te.angle),ie.penumbraCos=Math.cos(te.angle*(1-te.penumbra)),ie.decay=te.decay,r.spot[w]=ie;const X=te.shadow;if(te.map&&(r.spotLightMap[H]=te.map,H++,X.updateMatrices(te),te.castShadow&&W++),r.spotLightMatrix[w]=X.matrix,te.castShadow){const Y=i.get(te);Y.shadowBias=X.bias,Y.shadowNormalBias=X.normalBias,Y.shadowRadius=X.radius,Y.shadowMapSize=X.mapSize,r.spotShadow[w]=Y,r.spotShadowMap[w]=q,D++}w++}else if(te.isRectAreaLight){const ie=t.get(te);ie.color.copy(de).multiplyScalar(ve),ie.halfWidth.set(te.width*.5,0,0),ie.halfHeight.set(0,te.height*.5,0),r.rectArea[P]=ie,P++}else if(te.isPointLight){const ie=t.get(te);if(ie.color.copy(te.color).multiplyScalar(te.intensity*j),ie.distance=te.distance,ie.decay=te.decay,te.castShadow){const X=te.shadow,Y=i.get(te);Y.shadowBias=X.bias,Y.shadowNormalBias=X.normalBias,Y.shadowRadius=X.radius,Y.shadowMapSize=X.mapSize,Y.shadowCameraNear=X.camera.near,Y.shadowCameraFar=X.camera.far,r.pointShadow[S]=Y,r.pointShadowMap[S]=q,r.pointShadowMatrix[S]=te.shadow.matrix,k++}r.point[S]=ie,S++}else if(te.isHemisphereLight){const ie=t.get(te);ie.skyColor.copy(te.color).multiplyScalar(ve*j),ie.groundColor.copy(te.groundColor).multiplyScalar(ve*j),r.hemi[M]=ie,M++}}P>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=St.LTC_FLOAT_1,r.rectAreaLTC2=St.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=St.LTC_HALF_1,r.rectAreaLTC2=St.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=m,r.ambient[1]=y,r.ambient[2]=x;const J=r.hash;(J.directionalLength!==T||J.pointLength!==S||J.spotLength!==w||J.rectAreaLength!==P||J.hemiLength!==M||J.numDirectionalShadows!==I||J.numPointShadows!==k||J.numSpotShadows!==D||J.numSpotMaps!==H||J.numLightProbes!==z)&&(r.directional.length=T,r.spot.length=w,r.rectArea.length=P,r.point.length=S,r.hemi.length=M,r.directionalShadow.length=I,r.directionalShadowMap.length=I,r.pointShadow.length=k,r.pointShadowMap.length=k,r.spotShadow.length=D,r.spotShadowMap.length=D,r.directionalShadowMatrix.length=I,r.pointShadowMatrix.length=k,r.spotLightMatrix.length=D+H-W,r.spotLightMap.length=H,r.numSpotLightShadowsWithMaps=W,r.numLightProbes=z,J.directionalLength=T,J.pointLength=S,J.spotLength=w,J.rectAreaLength=P,J.hemiLength=M,J.numDirectionalShadows=I,J.numPointShadows=k,J.numSpotShadows=D,J.numSpotMaps=H,J.numLightProbes=z,r.version=Gne++)}function c(u,d){let m=0,y=0,x=0,T=0,S=0;const w=d.matrixWorldInverse;for(let P=0,M=u.length;P<M;P++){const I=u[P];if(I.isDirectionalLight){const k=r.directional[m];k.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),k.direction.sub(s),k.direction.transformDirection(w),m++}else if(I.isSpotLight){const k=r.spot[x];k.position.setFromMatrixPosition(I.matrixWorld),k.position.applyMatrix4(w),k.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),k.direction.sub(s),k.direction.transformDirection(w),x++}else if(I.isRectAreaLight){const k=r.rectArea[T];k.position.setFromMatrixPosition(I.matrixWorld),k.position.applyMatrix4(w),a.identity(),o.copy(I.matrixWorld),o.premultiply(w),a.extractRotation(o),k.halfWidth.set(I.width*.5,0,0),k.halfHeight.set(0,I.height*.5,0),k.halfWidth.applyMatrix4(a),k.halfHeight.applyMatrix4(a),T++}else if(I.isPointLight){const k=r.point[y];k.position.setFromMatrixPosition(I.matrixWorld),k.position.applyMatrix4(w),y++}else if(I.isHemisphereLight){const k=r.hemi[S];k.direction.setFromMatrixPosition(I.matrixWorld),k.direction.transformDirection(w),S++}}}return{setup:l,setupView:c,state:r}}function uO(n,e){const t=new qne(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(d){i.push(d)}function a(d){r.push(d)}function l(d){t.setup(i,d)}function c(d){t.setupView(i,d)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function Zne(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new uO(n,e),t.set(s,[l])):o>=a.length?(l=new uO(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class mR extends yo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=_V,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class gR extends yo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Kne=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Jne=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Qne(n,e,t){let i=new QS;const r=new qe,s=new qe,o=new di,a=new mR({depthPacking:yV}),l=new gR,c={},u=t.maxTextureSize,d={[ph]:Uo,[Uo]:ph,[Gc]:Gc},m=new au({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new qe},radius:{value:4}},vertexShader:Kne,fragmentShader:Jne}),y=m.clone();y.defines.HORIZONTAL_PASS=1;const x=new Dn;x.setAttribute("position",new Ai(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new xs(x,m),S=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=GS;let w=this.type;this.render=function(k,D,H){if(S.enabled===!1||S.autoUpdate===!1&&S.needsUpdate===!1||k.length===0)return;const W=n.getRenderTarget(),z=n.getActiveCubeFace(),j=n.getActiveMipmapLevel(),J=n.state;J.setBlending(uh),J.buffers.color.setClear(1,1,1,1),J.buffers.depth.setTest(!0),J.setScissorTest(!1);const le=w!==nc&&this.type===nc,ge=w===nc&&this.type!==nc;for(let te=0,de=k.length;te<de;te++){const ve=k[te],me=ve.shadow;if(me===void 0){console.warn("THREE.WebGLShadowMap:",ve,"has no shadow.");continue}if(me.autoUpdate===!1&&me.needsUpdate===!1)continue;r.copy(me.mapSize);const q=me.getFrameExtents();if(r.multiply(q),s.copy(me.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/q.x),r.x=s.x*q.x,me.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/q.y),r.y=s.y*q.y,me.mapSize.y=s.y)),me.map===null||le===!0||ge===!0){const X=this.type!==nc?{minFilter:Ar,magFilter:Ar}:{};me.map!==null&&me.map.dispose(),me.map=new hc(r.x,r.y,X),me.map.texture.name=ve.name+".shadowMap",me.camera.updateProjectionMatrix()}n.setRenderTarget(me.map),n.clear();const ie=me.getViewportCount();for(let X=0;X<ie;X++){const Y=me.getViewport(X);o.set(s.x*Y.x,s.y*Y.y,s.x*Y.z,s.y*Y.w),J.viewport(o),me.updateMatrices(ve,X),i=me.getFrustum(),I(D,H,me.camera,ve,this.type)}me.isPointLightShadow!==!0&&this.type===nc&&P(me,H),me.needsUpdate=!1}w=this.type,S.needsUpdate=!1,n.setRenderTarget(W,z,j)};function P(k,D){const H=e.update(T);m.defines.VSM_SAMPLES!==k.blurSamples&&(m.defines.VSM_SAMPLES=k.blurSamples,y.defines.VSM_SAMPLES=k.blurSamples,m.needsUpdate=!0,y.needsUpdate=!0),k.mapPass===null&&(k.mapPass=new hc(r.x,r.y)),m.uniforms.shadow_pass.value=k.map.texture,m.uniforms.resolution.value=k.mapSize,m.uniforms.radius.value=k.radius,n.setRenderTarget(k.mapPass),n.clear(),n.renderBufferDirect(D,null,H,m,T,null),y.uniforms.shadow_pass.value=k.mapPass.texture,y.uniforms.resolution.value=k.mapSize,y.uniforms.radius.value=k.radius,n.setRenderTarget(k.map),n.clear(),n.renderBufferDirect(D,null,H,y,T,null)}function M(k,D,H,W){let z=null;const j=H.isPointLight===!0?k.customDistanceMaterial:k.customDepthMaterial;if(j!==void 0)z=j;else if(z=H.isPointLight===!0?l:a,n.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0||D.map&&D.alphaTest>0){const J=z.uuid,le=D.uuid;let ge=c[J];ge===void 0&&(ge={},c[J]=ge);let te=ge[le];te===void 0&&(te=z.clone(),ge[le]=te),z=te}if(z.visible=D.visible,z.wireframe=D.wireframe,W===nc?z.side=D.shadowSide!==null?D.shadowSide:D.side:z.side=D.shadowSide!==null?D.shadowSide:d[D.side],z.alphaMap=D.alphaMap,z.alphaTest=D.alphaTest,z.map=D.map,z.clipShadows=D.clipShadows,z.clippingPlanes=D.clippingPlanes,z.clipIntersection=D.clipIntersection,z.displacementMap=D.displacementMap,z.displacementScale=D.displacementScale,z.displacementBias=D.displacementBias,z.wireframeLinewidth=D.wireframeLinewidth,z.linewidth=D.linewidth,H.isPointLight===!0&&z.isMeshDistanceMaterial===!0){const J=n.properties.get(z);J.light=H}return z}function I(k,D,H,W,z){if(k.visible===!1)return;if(k.layers.test(D.layers)&&(k.isMesh||k.isLine||k.isPoints)&&(k.castShadow||k.receiveShadow&&z===nc)&&(!k.frustumCulled||i.intersectsObject(k))){k.modelViewMatrix.multiplyMatrices(H.matrixWorldInverse,k.matrixWorld);const le=e.update(k),ge=k.material;if(Array.isArray(ge)){const te=le.groups;for(let de=0,ve=te.length;de<ve;de++){const me=te[de],q=ge[me.materialIndex];if(q&&q.visible){const ie=M(k,q,W,z);n.renderBufferDirect(H,null,le,ie,k,me)}}}else if(ge.visible){const te=M(k,ge,W,z);n.renderBufferDirect(H,null,le,te,k,null)}}const J=k.children;for(let le=0,ge=J.length;le<ge;le++)I(J[le],D,H,W,z)}}function eie(n,e,t){const i=t.isWebGL2;function r(){let ye=!1;const mt=new di;let gt=null;const Ge=new di(0,0,0,0);return{setMask:function(ut){gt!==ut&&!ye&&(n.colorMask(ut,ut,ut,ut),gt=ut)},setLocked:function(ut){ye=ut},setClear:function(ut,Vt,vn,jn,pi){pi===!0&&(ut*=jn,Vt*=jn,vn*=jn),mt.set(ut,Vt,vn,jn),Ge.equals(mt)===!1&&(n.clearColor(ut,Vt,vn,jn),Ge.copy(mt))},reset:function(){ye=!1,gt=null,Ge.set(-1,0,0,0)}}}function s(){let ye=!1,mt=null,gt=null,Ge=null;return{setTest:function(ut){ut?Ft(n.DEPTH_TEST):yn(n.DEPTH_TEST)},setMask:function(ut){mt!==ut&&!ye&&(n.depthMask(ut),mt=ut)},setFunc:function(ut){if(gt!==ut){switch(ut){case $z:n.depthFunc(n.NEVER);break;case Xz:n.depthFunc(n.ALWAYS);break;case Gz:n.depthFunc(n.LESS);break;case xv:n.depthFunc(n.LEQUAL);break;case Yz:n.depthFunc(n.EQUAL);break;case qz:n.depthFunc(n.GEQUAL);break;case Zz:n.depthFunc(n.GREATER);break;case Kz:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}gt=ut}},setLocked:function(ut){ye=ut},setClear:function(ut){Ge!==ut&&(n.clearDepth(ut),Ge=ut)},reset:function(){ye=!1,mt=null,gt=null,Ge=null}}}function o(){let ye=!1,mt=null,gt=null,Ge=null,ut=null,Vt=null,vn=null,jn=null,pi=null;return{setTest:function(Cn){ye||(Cn?Ft(n.STENCIL_TEST):yn(n.STENCIL_TEST))},setMask:function(Cn){mt!==Cn&&!ye&&(n.stencilMask(Cn),mt=Cn)},setFunc:function(Cn,qi,Rr){(gt!==Cn||Ge!==qi||ut!==Rr)&&(n.stencilFunc(Cn,qi,Rr),gt=Cn,Ge=qi,ut=Rr)},setOp:function(Cn,qi,Rr){(Vt!==Cn||vn!==qi||jn!==Rr)&&(n.stencilOp(Cn,qi,Rr),Vt=Cn,vn=qi,jn=Rr)},setLocked:function(Cn){ye=Cn},setClear:function(Cn){pi!==Cn&&(n.clearStencil(Cn),pi=Cn)},reset:function(){ye=!1,mt=null,gt=null,Ge=null,ut=null,Vt=null,vn=null,jn=null,pi=null}}}const a=new r,l=new s,c=new o,u=new WeakMap,d=new WeakMap;let m={},y={},x=new WeakMap,T=[],S=null,w=!1,P=null,M=null,I=null,k=null,D=null,H=null,W=null,z=new Ot(0,0,0),j=0,J=!1,le=null,ge=null,te=null,de=null,ve=null;const me=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let q=!1,ie=0;const X=n.getParameter(n.VERSION);X.indexOf("WebGL")!==-1?(ie=parseFloat(/^WebGL (\d)/.exec(X)[1]),q=ie>=1):X.indexOf("OpenGL ES")!==-1&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),q=ie>=2);let Y=null,ce={};const Me=n.getParameter(n.SCISSOR_BOX),Re=n.getParameter(n.VIEWPORT),Fe=new di().fromArray(Me),Be=new di().fromArray(Re);function at(ye,mt,gt,Ge){const ut=new Uint8Array(4),Vt=n.createTexture();n.bindTexture(ye,Vt),n.texParameteri(ye,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ye,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let vn=0;vn<gt;vn++)i&&(ye===n.TEXTURE_3D||ye===n.TEXTURE_2D_ARRAY)?n.texImage3D(mt,0,n.RGBA,1,1,Ge,0,n.RGBA,n.UNSIGNED_BYTE,ut):n.texImage2D(mt+vn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ut);return Vt}const pt={};pt[n.TEXTURE_2D]=at(n.TEXTURE_2D,n.TEXTURE_2D,1),pt[n.TEXTURE_CUBE_MAP]=at(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(pt[n.TEXTURE_2D_ARRAY]=at(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),pt[n.TEXTURE_3D]=at(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ft(n.DEPTH_TEST),l.setFunc(xv),bt(!1),Ct(pM),Ft(n.CULL_FACE),Ke(uh);function Ft(ye){m[ye]!==!0&&(n.enable(ye),m[ye]=!0)}function yn(ye){m[ye]!==!1&&(n.disable(ye),m[ye]=!1)}function Rt(ye,mt){return y[ye]!==mt?(n.bindFramebuffer(ye,mt),y[ye]=mt,i&&(ye===n.DRAW_FRAMEBUFFER&&(y[n.FRAMEBUFFER]=mt),ye===n.FRAMEBUFFER&&(y[n.DRAW_FRAMEBUFFER]=mt)),!0):!1}function he(ye,mt){let gt=T,Ge=!1;if(ye)if(gt=x.get(mt),gt===void 0&&(gt=[],x.set(mt,gt)),ye.isWebGLMultipleRenderTargets){const ut=ye.texture;if(gt.length!==ut.length||gt[0]!==n.COLOR_ATTACHMENT0){for(let Vt=0,vn=ut.length;Vt<vn;Vt++)gt[Vt]=n.COLOR_ATTACHMENT0+Vt;gt.length=ut.length,Ge=!0}}else gt[0]!==n.COLOR_ATTACHMENT0&&(gt[0]=n.COLOR_ATTACHMENT0,Ge=!0);else gt[0]!==n.BACK&&(gt[0]=n.BACK,Ge=!0);Ge&&(t.isWebGL2?n.drawBuffers(gt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(gt))}function nt(ye){return S!==ye?(n.useProgram(ye),S=ye,!0):!1}const Ye={[If]:n.FUNC_ADD,[Rz]:n.FUNC_SUBTRACT,[Iz]:n.FUNC_REVERSE_SUBTRACT};if(i)Ye[yM]=n.MIN,Ye[vM]=n.MAX;else{const ye=e.get("EXT_blend_minmax");ye!==null&&(Ye[yM]=ye.MIN_EXT,Ye[vM]=ye.MAX_EXT)}const lt={[kz]:n.ZERO,[Oz]:n.ONE,[Lz]:n.SRC_COLOR,[Uw]:n.SRC_ALPHA,[zz]:n.SRC_ALPHA_SATURATE,[Uz]:n.DST_COLOR,[Dz]:n.DST_ALPHA,[Nz]:n.ONE_MINUS_SRC_COLOR,[Bw]:n.ONE_MINUS_SRC_ALPHA,[Bz]:n.ONE_MINUS_DST_COLOR,[Fz]:n.ONE_MINUS_DST_ALPHA,[Vz]:n.CONSTANT_COLOR,[Hz]:n.ONE_MINUS_CONSTANT_COLOR,[Wz]:n.CONSTANT_ALPHA,[jz]:n.ONE_MINUS_CONSTANT_ALPHA};function Ke(ye,mt,gt,Ge,ut,Vt,vn,jn,pi,Cn){if(ye===uh){w===!0&&(yn(n.BLEND),w=!1);return}if(w===!1&&(Ft(n.BLEND),w=!0),ye!==Pz){if(ye!==P||Cn!==J){if((M!==If||D!==If)&&(n.blendEquation(n.FUNC_ADD),M=If,D=If),Cn)switch(ye){case Ap:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case mM:n.blendFunc(n.ONE,n.ONE);break;case gM:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case _M:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}else switch(ye){case Ap:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case mM:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case gM:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case _M:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}I=null,k=null,H=null,W=null,z.set(0,0,0),j=0,P=ye,J=Cn}return}ut=ut||mt,Vt=Vt||gt,vn=vn||Ge,(mt!==M||ut!==D)&&(n.blendEquationSeparate(Ye[mt],Ye[ut]),M=mt,D=ut),(gt!==I||Ge!==k||Vt!==H||vn!==W)&&(n.blendFuncSeparate(lt[gt],lt[Ge],lt[Vt],lt[vn]),I=gt,k=Ge,H=Vt,W=vn),(jn.equals(z)===!1||pi!==j)&&(n.blendColor(jn.r,jn.g,jn.b,pi),z.copy(jn),j=pi),P=ye,J=!1}function Ut(ye,mt){ye.side===Gc?yn(n.CULL_FACE):Ft(n.CULL_FACE);let gt=ye.side===Uo;mt&&(gt=!gt),bt(gt),ye.blending===Ap&&ye.transparent===!1?Ke(uh):Ke(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.blendColor,ye.blendAlpha,ye.premultipliedAlpha),l.setFunc(ye.depthFunc),l.setTest(ye.depthTest),l.setMask(ye.depthWrite),a.setMask(ye.colorWrite);const Ge=ye.stencilWrite;c.setTest(Ge),Ge&&(c.setMask(ye.stencilWriteMask),c.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),c.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),ln(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?Ft(n.SAMPLE_ALPHA_TO_COVERAGE):yn(n.SAMPLE_ALPHA_TO_COVERAGE)}function bt(ye){le!==ye&&(ye?n.frontFace(n.CW):n.frontFace(n.CCW),le=ye)}function Ct(ye){ye!==Az?(Ft(n.CULL_FACE),ye!==ge&&(ye===pM?n.cullFace(n.BACK):ye===Mz?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):yn(n.CULL_FACE),ge=ye}function Zt(ye){ye!==te&&(q&&n.lineWidth(ye),te=ye)}function ln(ye,mt,gt){ye?(Ft(n.POLYGON_OFFSET_FILL),(de!==mt||ve!==gt)&&(n.polygonOffset(mt,gt),de=mt,ve=gt)):yn(n.POLYGON_OFFSET_FILL)}function Xn(ye){ye?Ft(n.SCISSOR_TEST):yn(n.SCISSOR_TEST)}function ae(ye){ye===void 0&&(ye=n.TEXTURE0+me-1),Y!==ye&&(n.activeTexture(ye),Y=ye)}function Q(ye,mt,gt){gt===void 0&&(Y===null?gt=n.TEXTURE0+me-1:gt=Y);let Ge=ce[gt];Ge===void 0&&(Ge={type:void 0,texture:void 0},ce[gt]=Ge),(Ge.type!==ye||Ge.texture!==mt)&&(Y!==gt&&(n.activeTexture(gt),Y=gt),n.bindTexture(ye,mt||pt[ye]),Ge.type=ye,Ge.texture=mt)}function Ne(){const ye=ce[Y];ye!==void 0&&ye.type!==void 0&&(n.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function ct(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function et(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ot(){try{n.texSubImage2D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Bt(){try{n.texSubImage3D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function dt(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function vt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function nn(){try{n.texStorage2D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Mn(){try{n.texStorage3D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ht(){try{n.texImage2D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ln(){try{n.texImage3D.apply(n,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function pe(ye){Fe.equals(ye)===!1&&(n.scissor(ye.x,ye.y,ye.z,ye.w),Fe.copy(ye))}function $e(ye){Be.equals(ye)===!1&&(n.viewport(ye.x,ye.y,ye.z,ye.w),Be.copy(ye))}function it(ye,mt){let gt=d.get(mt);gt===void 0&&(gt=new WeakMap,d.set(mt,gt));let Ge=gt.get(ye);Ge===void 0&&(Ge=n.getUniformBlockIndex(mt,ye.name),gt.set(ye,Ge))}function tt(ye,mt){const Ge=d.get(mt).get(ye);u.get(mt)!==Ge&&(n.uniformBlockBinding(mt,Ge,ye.__bindingPointIndex),u.set(mt,Ge))}function jt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),m={},Y=null,ce={},y={},x=new WeakMap,T=[],S=null,w=!1,P=null,M=null,I=null,k=null,D=null,H=null,W=null,z=new Ot(0,0,0),j=0,J=!1,le=null,ge=null,te=null,de=null,ve=null,Fe.set(0,0,n.canvas.width,n.canvas.height),Be.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:Ft,disable:yn,bindFramebuffer:Rt,drawBuffers:he,useProgram:nt,setBlending:Ke,setMaterial:Ut,setFlipSided:bt,setCullFace:Ct,setLineWidth:Zt,setPolygonOffset:ln,setScissorTest:Xn,activeTexture:ae,bindTexture:Q,unbindTexture:Ne,compressedTexImage2D:ct,compressedTexImage3D:et,texImage2D:ht,texImage3D:Ln,updateUBOMapping:it,uniformBlockBinding:tt,texStorage2D:nn,texStorage3D:Mn,texSubImage2D:ot,texSubImage3D:Bt,compressedTexSubImage2D:dt,compressedTexSubImage3D:vt,scissor:pe,viewport:$e,reset:jt}}function tie(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,m=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,y=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let T;const S=new WeakMap;let w=!1;try{w=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function P(ae,Q){return w?new OffscreenCanvas(ae,Q):Ov("canvas")}function M(ae,Q,Ne,ct){let et=1;if((ae.width>ct||ae.height>ct)&&(et=ct/Math.max(ae.width,ae.height)),et<1||Q===!0)if(typeof HTMLImageElement<"u"&&ae instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ae instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ae instanceof ImageBitmap){const ot=Q?Hw:Math.floor,Bt=ot(et*ae.width),dt=ot(et*ae.height);T===void 0&&(T=P(Bt,dt));const vt=Ne?P(Bt,dt):T;return vt.width=Bt,vt.height=dt,vt.getContext("2d").drawImage(ae,0,0,Bt,dt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ae.width+"x"+ae.height+") to ("+Bt+"x"+dt+")."),vt}else return"data"in ae&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ae.width+"x"+ae.height+")."),ae;return ae}function I(ae){return YM(ae.width)&&YM(ae.height)}function k(ae){return a?!1:ae.wrapS!==fo||ae.wrapT!==fo||ae.minFilter!==Ar&&ae.minFilter!==Mr}function D(ae,Q){return ae.generateMipmaps&&Q&&ae.minFilter!==Ar&&ae.minFilter!==Mr}function H(ae){n.generateMipmap(ae)}function W(ae,Q,Ne,ct,et=!1){if(a===!1)return Q;if(ae!==null){if(n[ae]!==void 0)return n[ae];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ae+"'")}let ot=Q;if(Q===n.RED&&(Ne===n.FLOAT&&(ot=n.R32F),Ne===n.HALF_FLOAT&&(ot=n.R16F),Ne===n.UNSIGNED_BYTE&&(ot=n.R8)),Q===n.RED_INTEGER&&(Ne===n.UNSIGNED_BYTE&&(ot=n.R8UI),Ne===n.UNSIGNED_SHORT&&(ot=n.R16UI),Ne===n.UNSIGNED_INT&&(ot=n.R32UI),Ne===n.BYTE&&(ot=n.R8I),Ne===n.SHORT&&(ot=n.R16I),Ne===n.INT&&(ot=n.R32I)),Q===n.RG&&(Ne===n.FLOAT&&(ot=n.RG32F),Ne===n.HALF_FLOAT&&(ot=n.RG16F),Ne===n.UNSIGNED_BYTE&&(ot=n.RG8)),Q===n.RGBA){const Bt=et?Cv:hi.getTransfer(ct);Ne===n.FLOAT&&(ot=n.RGBA32F),Ne===n.HALF_FLOAT&&(ot=n.RGBA16F),Ne===n.UNSIGNED_BYTE&&(ot=Bt===Ri?n.SRGB8_ALPHA8:n.RGBA8),Ne===n.UNSIGNED_SHORT_4_4_4_4&&(ot=n.RGBA4),Ne===n.UNSIGNED_SHORT_5_5_5_1&&(ot=n.RGB5_A1)}return(ot===n.R16F||ot===n.R32F||ot===n.RG16F||ot===n.RG32F||ot===n.RGBA16F||ot===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ot}function z(ae,Q,Ne){return D(ae,Ne)===!0||ae.isFramebufferTexture&&ae.minFilter!==Ar&&ae.minFilter!==Mr?Math.log2(Math.max(Q.width,Q.height))+1:ae.mipmaps!==void 0&&ae.mipmaps.length>0?ae.mipmaps.length:ae.isCompressedTexture&&Array.isArray(ae.image)?Q.mipmaps.length:1}function j(ae){return ae===Ar||ae===zw||ae===$y?n.NEAREST:n.LINEAR}function J(ae){const Q=ae.target;Q.removeEventListener("dispose",J),ge(Q),Q.isVideoTexture&&x.delete(Q)}function le(ae){const Q=ae.target;Q.removeEventListener("dispose",le),de(Q)}function ge(ae){const Q=i.get(ae);if(Q.__webglInit===void 0)return;const Ne=ae.source,ct=S.get(Ne);if(ct){const et=ct[Q.__cacheKey];et.usedTimes--,et.usedTimes===0&&te(ae),Object.keys(ct).length===0&&S.delete(Ne)}i.remove(ae)}function te(ae){const Q=i.get(ae);n.deleteTexture(Q.__webglTexture);const Ne=ae.source,ct=S.get(Ne);delete ct[Q.__cacheKey],o.memory.textures--}function de(ae){const Q=ae.texture,Ne=i.get(ae),ct=i.get(Q);if(ct.__webglTexture!==void 0&&(n.deleteTexture(ct.__webglTexture),o.memory.textures--),ae.depthTexture&&ae.depthTexture.dispose(),ae.isWebGLCubeRenderTarget)for(let et=0;et<6;et++){if(Array.isArray(Ne.__webglFramebuffer[et]))for(let ot=0;ot<Ne.__webglFramebuffer[et].length;ot++)n.deleteFramebuffer(Ne.__webglFramebuffer[et][ot]);else n.deleteFramebuffer(Ne.__webglFramebuffer[et]);Ne.__webglDepthbuffer&&n.deleteRenderbuffer(Ne.__webglDepthbuffer[et])}else{if(Array.isArray(Ne.__webglFramebuffer))for(let et=0;et<Ne.__webglFramebuffer.length;et++)n.deleteFramebuffer(Ne.__webglFramebuffer[et]);else n.deleteFramebuffer(Ne.__webglFramebuffer);if(Ne.__webglDepthbuffer&&n.deleteRenderbuffer(Ne.__webglDepthbuffer),Ne.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Ne.__webglMultisampledFramebuffer),Ne.__webglColorRenderbuffer)for(let et=0;et<Ne.__webglColorRenderbuffer.length;et++)Ne.__webglColorRenderbuffer[et]&&n.deleteRenderbuffer(Ne.__webglColorRenderbuffer[et]);Ne.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Ne.__webglDepthRenderbuffer)}if(ae.isWebGLMultipleRenderTargets)for(let et=0,ot=Q.length;et<ot;et++){const Bt=i.get(Q[et]);Bt.__webglTexture&&(n.deleteTexture(Bt.__webglTexture),o.memory.textures--),i.remove(Q[et])}i.remove(Q),i.remove(ae)}let ve=0;function me(){ve=0}function q(){const ae=ve;return ae>=l&&console.warn("THREE.WebGLTextures: Trying to use "+ae+" texture units while this GPU supports only "+l),ve+=1,ae}function ie(ae){const Q=[];return Q.push(ae.wrapS),Q.push(ae.wrapT),Q.push(ae.wrapR||0),Q.push(ae.magFilter),Q.push(ae.minFilter),Q.push(ae.anisotropy),Q.push(ae.internalFormat),Q.push(ae.format),Q.push(ae.type),Q.push(ae.generateMipmaps),Q.push(ae.premultiplyAlpha),Q.push(ae.flipY),Q.push(ae.unpackAlignment),Q.push(ae.colorSpace),Q.join()}function X(ae,Q){const Ne=i.get(ae);if(ae.isVideoTexture&&ln(ae),ae.isRenderTargetTexture===!1&&ae.version>0&&Ne.__version!==ae.version){const ct=ae.image;if(ct===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ct.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ft(Ne,ae,Q);return}}t.bindTexture(n.TEXTURE_2D,Ne.__webglTexture,n.TEXTURE0+Q)}function Y(ae,Q){const Ne=i.get(ae);if(ae.version>0&&Ne.__version!==ae.version){Ft(Ne,ae,Q);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Ne.__webglTexture,n.TEXTURE0+Q)}function ce(ae,Q){const Ne=i.get(ae);if(ae.version>0&&Ne.__version!==ae.version){Ft(Ne,ae,Q);return}t.bindTexture(n.TEXTURE_3D,Ne.__webglTexture,n.TEXTURE0+Q)}function Me(ae,Q){const Ne=i.get(ae);if(ae.version>0&&Ne.__version!==ae.version){yn(Ne,ae,Q);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Ne.__webglTexture,n.TEXTURE0+Q)}const Re={[Sv]:n.REPEAT,[fo]:n.CLAMP_TO_EDGE,[Tv]:n.MIRRORED_REPEAT},Fe={[Ar]:n.NEAREST,[zw]:n.NEAREST_MIPMAP_NEAREST,[$y]:n.NEAREST_MIPMAP_LINEAR,[Mr]:n.LINEAR,[eR]:n.LINEAR_MIPMAP_NEAREST,[Jf]:n.LINEAR_MIPMAP_LINEAR},Be={[xV]:n.NEVER,[MV]:n.ALWAYS,[bV]:n.LESS,[SV]:n.LEQUAL,[wV]:n.EQUAL,[AV]:n.GEQUAL,[TV]:n.GREATER,[EV]:n.NOTEQUAL};function at(ae,Q,Ne){if(Ne?(n.texParameteri(ae,n.TEXTURE_WRAP_S,Re[Q.wrapS]),n.texParameteri(ae,n.TEXTURE_WRAP_T,Re[Q.wrapT]),(ae===n.TEXTURE_3D||ae===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ae,n.TEXTURE_WRAP_R,Re[Q.wrapR]),n.texParameteri(ae,n.TEXTURE_MAG_FILTER,Fe[Q.magFilter]),n.texParameteri(ae,n.TEXTURE_MIN_FILTER,Fe[Q.minFilter])):(n.texParameteri(ae,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(ae,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(ae===n.TEXTURE_3D||ae===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ae,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(Q.wrapS!==fo||Q.wrapT!==fo)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(ae,n.TEXTURE_MAG_FILTER,j(Q.magFilter)),n.texParameteri(ae,n.TEXTURE_MIN_FILTER,j(Q.minFilter)),Q.minFilter!==Ar&&Q.minFilter!==Mr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Q.compareFunction&&(n.texParameteri(ae,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(ae,n.TEXTURE_COMPARE_FUNC,Be[Q.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const ct=e.get("EXT_texture_filter_anisotropic");if(Q.magFilter===Ar||Q.minFilter!==$y&&Q.minFilter!==Jf||Q.type===qc&&e.has("OES_texture_float_linear")===!1||a===!1&&Q.type===Qg&&e.has("OES_texture_half_float_linear")===!1)return;(Q.anisotropy>1||i.get(Q).__currentAnisotropy)&&(n.texParameterf(ae,ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Q.anisotropy,r.getMaxAnisotropy())),i.get(Q).__currentAnisotropy=Q.anisotropy)}}function pt(ae,Q){let Ne=!1;ae.__webglInit===void 0&&(ae.__webglInit=!0,Q.addEventListener("dispose",J));const ct=Q.source;let et=S.get(ct);et===void 0&&(et={},S.set(ct,et));const ot=ie(Q);if(ot!==ae.__cacheKey){et[ot]===void 0&&(et[ot]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,Ne=!0),et[ot].usedTimes++;const Bt=et[ae.__cacheKey];Bt!==void 0&&(et[ae.__cacheKey].usedTimes--,Bt.usedTimes===0&&te(Q)),ae.__cacheKey=ot,ae.__webglTexture=et[ot].texture}return Ne}function Ft(ae,Q,Ne){let ct=n.TEXTURE_2D;(Q.isDataArrayTexture||Q.isCompressedArrayTexture)&&(ct=n.TEXTURE_2D_ARRAY),Q.isData3DTexture&&(ct=n.TEXTURE_3D);const et=pt(ae,Q),ot=Q.source;t.bindTexture(ct,ae.__webglTexture,n.TEXTURE0+Ne);const Bt=i.get(ot);if(ot.version!==Bt.__version||et===!0){t.activeTexture(n.TEXTURE0+Ne);const dt=hi.getPrimaries(hi.workingColorSpace),vt=Q.colorSpace===Wa?null:hi.getPrimaries(Q.colorSpace),nn=Q.colorSpace===Wa||dt===vt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Q.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Q.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,nn);const Mn=k(Q)&&I(Q.image)===!1;let ht=M(Q.image,Mn,!1,u);ht=Xn(Q,ht);const Ln=I(ht)||a,pe=s.convert(Q.format,Q.colorSpace);let $e=s.convert(Q.type),it=W(Q.internalFormat,pe,$e,Q.colorSpace,Q.isVideoTexture);at(ct,Q,Ln);let tt;const jt=Q.mipmaps,ye=a&&Q.isVideoTexture!==!0,mt=Bt.__version===void 0||et===!0,gt=z(Q,ht,Ln);if(Q.isDepthTexture)it=n.DEPTH_COMPONENT,a?Q.type===qc?it=n.DEPTH_COMPONENT32F:Q.type===sh?it=n.DEPTH_COMPONENT24:Q.type===$f?it=n.DEPTH24_STENCIL8:it=n.DEPTH_COMPONENT16:Q.type===qc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Q.format===Xf&&it===n.DEPTH_COMPONENT&&Q.type!==qS&&Q.type!==sh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Q.type=sh,$e=s.convert(Q.type)),Q.format===Wp&&it===n.DEPTH_COMPONENT&&(it=n.DEPTH_STENCIL,Q.type!==$f&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Q.type=$f,$e=s.convert(Q.type))),mt&&(ye?t.texStorage2D(n.TEXTURE_2D,1,it,ht.width,ht.height):t.texImage2D(n.TEXTURE_2D,0,it,ht.width,ht.height,0,pe,$e,null));else if(Q.isDataTexture)if(jt.length>0&&Ln){ye&&mt&&t.texStorage2D(n.TEXTURE_2D,gt,it,jt[0].width,jt[0].height);for(let Ge=0,ut=jt.length;Ge<ut;Ge++)tt=jt[Ge],ye?t.texSubImage2D(n.TEXTURE_2D,Ge,0,0,tt.width,tt.height,pe,$e,tt.data):t.texImage2D(n.TEXTURE_2D,Ge,it,tt.width,tt.height,0,pe,$e,tt.data);Q.generateMipmaps=!1}else ye?(mt&&t.texStorage2D(n.TEXTURE_2D,gt,it,ht.width,ht.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ht.width,ht.height,pe,$e,ht.data)):t.texImage2D(n.TEXTURE_2D,0,it,ht.width,ht.height,0,pe,$e,ht.data);else if(Q.isCompressedTexture)if(Q.isCompressedArrayTexture){ye&&mt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,gt,it,jt[0].width,jt[0].height,ht.depth);for(let Ge=0,ut=jt.length;Ge<ut;Ge++)tt=jt[Ge],Q.format!==ca?pe!==null?ye?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ge,0,0,0,tt.width,tt.height,ht.depth,pe,tt.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ge,it,tt.width,tt.height,ht.depth,0,tt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ye?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ge,0,0,0,tt.width,tt.height,ht.depth,pe,$e,tt.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ge,it,tt.width,tt.height,ht.depth,0,pe,$e,tt.data)}else{ye&&mt&&t.texStorage2D(n.TEXTURE_2D,gt,it,jt[0].width,jt[0].height);for(let Ge=0,ut=jt.length;Ge<ut;Ge++)tt=jt[Ge],Q.format!==ca?pe!==null?ye?t.compressedTexSubImage2D(n.TEXTURE_2D,Ge,0,0,tt.width,tt.height,pe,tt.data):t.compressedTexImage2D(n.TEXTURE_2D,Ge,it,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ye?t.texSubImage2D(n.TEXTURE_2D,Ge,0,0,tt.width,tt.height,pe,$e,tt.data):t.texImage2D(n.TEXTURE_2D,Ge,it,tt.width,tt.height,0,pe,$e,tt.data)}else if(Q.isDataArrayTexture)ye?(mt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,gt,it,ht.width,ht.height,ht.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ht.width,ht.height,ht.depth,pe,$e,ht.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,it,ht.width,ht.height,ht.depth,0,pe,$e,ht.data);else if(Q.isData3DTexture)ye?(mt&&t.texStorage3D(n.TEXTURE_3D,gt,it,ht.width,ht.height,ht.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ht.width,ht.height,ht.depth,pe,$e,ht.data)):t.texImage3D(n.TEXTURE_3D,0,it,ht.width,ht.height,ht.depth,0,pe,$e,ht.data);else if(Q.isFramebufferTexture){if(mt)if(ye)t.texStorage2D(n.TEXTURE_2D,gt,it,ht.width,ht.height);else{let Ge=ht.width,ut=ht.height;for(let Vt=0;Vt<gt;Vt++)t.texImage2D(n.TEXTURE_2D,Vt,it,Ge,ut,0,pe,$e,null),Ge>>=1,ut>>=1}}else if(jt.length>0&&Ln){ye&&mt&&t.texStorage2D(n.TEXTURE_2D,gt,it,jt[0].width,jt[0].height);for(let Ge=0,ut=jt.length;Ge<ut;Ge++)tt=jt[Ge],ye?t.texSubImage2D(n.TEXTURE_2D,Ge,0,0,pe,$e,tt):t.texImage2D(n.TEXTURE_2D,Ge,it,pe,$e,tt);Q.generateMipmaps=!1}else ye?(mt&&t.texStorage2D(n.TEXTURE_2D,gt,it,ht.width,ht.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,pe,$e,ht)):t.texImage2D(n.TEXTURE_2D,0,it,pe,$e,ht);D(Q,Ln)&&H(ct),Bt.__version=ot.version,Q.onUpdate&&Q.onUpdate(Q)}ae.__version=Q.version}function yn(ae,Q,Ne){if(Q.image.length!==6)return;const ct=pt(ae,Q),et=Q.source;t.bindTexture(n.TEXTURE_CUBE_MAP,ae.__webglTexture,n.TEXTURE0+Ne);const ot=i.get(et);if(et.version!==ot.__version||ct===!0){t.activeTexture(n.TEXTURE0+Ne);const Bt=hi.getPrimaries(hi.workingColorSpace),dt=Q.colorSpace===Wa?null:hi.getPrimaries(Q.colorSpace),vt=Q.colorSpace===Wa||Bt===dt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Q.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Q.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Q.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,vt);const nn=Q.isCompressedTexture||Q.image[0].isCompressedTexture,Mn=Q.image[0]&&Q.image[0].isDataTexture,ht=[];for(let Ge=0;Ge<6;Ge++)!nn&&!Mn?ht[Ge]=M(Q.image[Ge],!1,!0,c):ht[Ge]=Mn?Q.image[Ge].image:Q.image[Ge],ht[Ge]=Xn(Q,ht[Ge]);const Ln=ht[0],pe=I(Ln)||a,$e=s.convert(Q.format,Q.colorSpace),it=s.convert(Q.type),tt=W(Q.internalFormat,$e,it,Q.colorSpace),jt=a&&Q.isVideoTexture!==!0,ye=ot.__version===void 0||ct===!0;let mt=z(Q,Ln,pe);at(n.TEXTURE_CUBE_MAP,Q,pe);let gt;if(nn){jt&&ye&&t.texStorage2D(n.TEXTURE_CUBE_MAP,mt,tt,Ln.width,Ln.height);for(let Ge=0;Ge<6;Ge++){gt=ht[Ge].mipmaps;for(let ut=0;ut<gt.length;ut++){const Vt=gt[ut];Q.format!==ca?$e!==null?jt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut,0,0,Vt.width,Vt.height,$e,Vt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut,tt,Vt.width,Vt.height,0,Vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):jt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut,0,0,Vt.width,Vt.height,$e,it,Vt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut,tt,Vt.width,Vt.height,0,$e,it,Vt.data)}}}else{gt=Q.mipmaps,jt&&ye&&(gt.length>0&&mt++,t.texStorage2D(n.TEXTURE_CUBE_MAP,mt,tt,ht[0].width,ht[0].height));for(let Ge=0;Ge<6;Ge++)if(Mn){jt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,ht[Ge].width,ht[Ge].height,$e,it,ht[Ge].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,tt,ht[Ge].width,ht[Ge].height,0,$e,it,ht[Ge].data);for(let ut=0;ut<gt.length;ut++){const vn=gt[ut].image[Ge].image;jt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut+1,0,0,vn.width,vn.height,$e,it,vn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut+1,tt,vn.width,vn.height,0,$e,it,vn.data)}}else{jt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,$e,it,ht[Ge]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,tt,$e,it,ht[Ge]);for(let ut=0;ut<gt.length;ut++){const Vt=gt[ut];jt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut+1,0,0,$e,it,Vt.image[Ge]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,ut+1,tt,$e,it,Vt.image[Ge])}}}D(Q,pe)&&H(n.TEXTURE_CUBE_MAP),ot.__version=et.version,Q.onUpdate&&Q.onUpdate(Q)}ae.__version=Q.version}function Rt(ae,Q,Ne,ct,et,ot){const Bt=s.convert(Ne.format,Ne.colorSpace),dt=s.convert(Ne.type),vt=W(Ne.internalFormat,Bt,dt,Ne.colorSpace);if(!i.get(Q).__hasExternalTextures){const Mn=Math.max(1,Q.width>>ot),ht=Math.max(1,Q.height>>ot);et===n.TEXTURE_3D||et===n.TEXTURE_2D_ARRAY?t.texImage3D(et,ot,vt,Mn,ht,Q.depth,0,Bt,dt,null):t.texImage2D(et,ot,vt,Mn,ht,0,Bt,dt,null)}t.bindFramebuffer(n.FRAMEBUFFER,ae),Zt(Q)?m.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ct,et,i.get(Ne).__webglTexture,0,Ct(Q)):(et===n.TEXTURE_2D||et>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&et<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ct,et,i.get(Ne).__webglTexture,ot),t.bindFramebuffer(n.FRAMEBUFFER,null)}function he(ae,Q,Ne){if(n.bindRenderbuffer(n.RENDERBUFFER,ae),Q.depthBuffer&&!Q.stencilBuffer){let ct=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(Ne||Zt(Q)){const et=Q.depthTexture;et&&et.isDepthTexture&&(et.type===qc?ct=n.DEPTH_COMPONENT32F:et.type===sh&&(ct=n.DEPTH_COMPONENT24));const ot=Ct(Q);Zt(Q)?m.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ot,ct,Q.width,Q.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ot,ct,Q.width,Q.height)}else n.renderbufferStorage(n.RENDERBUFFER,ct,Q.width,Q.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,ae)}else if(Q.depthBuffer&&Q.stencilBuffer){const ct=Ct(Q);Ne&&Zt(Q)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ct,n.DEPTH24_STENCIL8,Q.width,Q.height):Zt(Q)?m.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ct,n.DEPTH24_STENCIL8,Q.width,Q.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,Q.width,Q.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,ae)}else{const ct=Q.isWebGLMultipleRenderTargets===!0?Q.texture:[Q.texture];for(let et=0;et<ct.length;et++){const ot=ct[et],Bt=s.convert(ot.format,ot.colorSpace),dt=s.convert(ot.type),vt=W(ot.internalFormat,Bt,dt,ot.colorSpace),nn=Ct(Q);Ne&&Zt(Q)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,nn,vt,Q.width,Q.height):Zt(Q)?m.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,nn,vt,Q.width,Q.height):n.renderbufferStorage(n.RENDERBUFFER,vt,Q.width,Q.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function nt(ae,Q){if(Q&&Q.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,ae),!(Q.depthTexture&&Q.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(Q.depthTexture).__webglTexture||Q.depthTexture.image.width!==Q.width||Q.depthTexture.image.height!==Q.height)&&(Q.depthTexture.image.width=Q.width,Q.depthTexture.image.height=Q.height,Q.depthTexture.needsUpdate=!0),X(Q.depthTexture,0);const ct=i.get(Q.depthTexture).__webglTexture,et=Ct(Q);if(Q.depthTexture.format===Xf)Zt(Q)?m.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ct,0,et):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ct,0);else if(Q.depthTexture.format===Wp)Zt(Q)?m.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ct,0,et):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ct,0);else throw new Error("Unknown depthTexture format")}function Ye(ae){const Q=i.get(ae),Ne=ae.isWebGLCubeRenderTarget===!0;if(ae.depthTexture&&!Q.__autoAllocateDepthBuffer){if(Ne)throw new Error("target.depthTexture not supported in Cube render targets");nt(Q.__webglFramebuffer,ae)}else if(Ne){Q.__webglDepthbuffer=[];for(let ct=0;ct<6;ct++)t.bindFramebuffer(n.FRAMEBUFFER,Q.__webglFramebuffer[ct]),Q.__webglDepthbuffer[ct]=n.createRenderbuffer(),he(Q.__webglDepthbuffer[ct],ae,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,Q.__webglFramebuffer),Q.__webglDepthbuffer=n.createRenderbuffer(),he(Q.__webglDepthbuffer,ae,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function lt(ae,Q,Ne){const ct=i.get(ae);Q!==void 0&&Rt(ct.__webglFramebuffer,ae,ae.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Ne!==void 0&&Ye(ae)}function Ke(ae){const Q=ae.texture,Ne=i.get(ae),ct=i.get(Q);ae.addEventListener("dispose",le),ae.isWebGLMultipleRenderTargets!==!0&&(ct.__webglTexture===void 0&&(ct.__webglTexture=n.createTexture()),ct.__version=Q.version,o.memory.textures++);const et=ae.isWebGLCubeRenderTarget===!0,ot=ae.isWebGLMultipleRenderTargets===!0,Bt=I(ae)||a;if(et){Ne.__webglFramebuffer=[];for(let dt=0;dt<6;dt++)if(a&&Q.mipmaps&&Q.mipmaps.length>0){Ne.__webglFramebuffer[dt]=[];for(let vt=0;vt<Q.mipmaps.length;vt++)Ne.__webglFramebuffer[dt][vt]=n.createFramebuffer()}else Ne.__webglFramebuffer[dt]=n.createFramebuffer()}else{if(a&&Q.mipmaps&&Q.mipmaps.length>0){Ne.__webglFramebuffer=[];for(let dt=0;dt<Q.mipmaps.length;dt++)Ne.__webglFramebuffer[dt]=n.createFramebuffer()}else Ne.__webglFramebuffer=n.createFramebuffer();if(ot)if(r.drawBuffers){const dt=ae.texture;for(let vt=0,nn=dt.length;vt<nn;vt++){const Mn=i.get(dt[vt]);Mn.__webglTexture===void 0&&(Mn.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&ae.samples>0&&Zt(ae)===!1){const dt=ot?Q:[Q];Ne.__webglMultisampledFramebuffer=n.createFramebuffer(),Ne.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Ne.__webglMultisampledFramebuffer);for(let vt=0;vt<dt.length;vt++){const nn=dt[vt];Ne.__webglColorRenderbuffer[vt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Ne.__webglColorRenderbuffer[vt]);const Mn=s.convert(nn.format,nn.colorSpace),ht=s.convert(nn.type),Ln=W(nn.internalFormat,Mn,ht,nn.colorSpace,ae.isXRRenderTarget===!0),pe=Ct(ae);n.renderbufferStorageMultisample(n.RENDERBUFFER,pe,Ln,ae.width,ae.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+vt,n.RENDERBUFFER,Ne.__webglColorRenderbuffer[vt])}n.bindRenderbuffer(n.RENDERBUFFER,null),ae.depthBuffer&&(Ne.__webglDepthRenderbuffer=n.createRenderbuffer(),he(Ne.__webglDepthRenderbuffer,ae,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(et){t.bindTexture(n.TEXTURE_CUBE_MAP,ct.__webglTexture),at(n.TEXTURE_CUBE_MAP,Q,Bt);for(let dt=0;dt<6;dt++)if(a&&Q.mipmaps&&Q.mipmaps.length>0)for(let vt=0;vt<Q.mipmaps.length;vt++)Rt(Ne.__webglFramebuffer[dt][vt],ae,Q,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+dt,vt);else Rt(Ne.__webglFramebuffer[dt],ae,Q,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+dt,0);D(Q,Bt)&&H(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ot){const dt=ae.texture;for(let vt=0,nn=dt.length;vt<nn;vt++){const Mn=dt[vt],ht=i.get(Mn);t.bindTexture(n.TEXTURE_2D,ht.__webglTexture),at(n.TEXTURE_2D,Mn,Bt),Rt(Ne.__webglFramebuffer,ae,Mn,n.COLOR_ATTACHMENT0+vt,n.TEXTURE_2D,0),D(Mn,Bt)&&H(n.TEXTURE_2D)}t.unbindTexture()}else{let dt=n.TEXTURE_2D;if((ae.isWebGL3DRenderTarget||ae.isWebGLArrayRenderTarget)&&(a?dt=ae.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(dt,ct.__webglTexture),at(dt,Q,Bt),a&&Q.mipmaps&&Q.mipmaps.length>0)for(let vt=0;vt<Q.mipmaps.length;vt++)Rt(Ne.__webglFramebuffer[vt],ae,Q,n.COLOR_ATTACHMENT0,dt,vt);else Rt(Ne.__webglFramebuffer,ae,Q,n.COLOR_ATTACHMENT0,dt,0);D(Q,Bt)&&H(dt),t.unbindTexture()}ae.depthBuffer&&Ye(ae)}function Ut(ae){const Q=I(ae)||a,Ne=ae.isWebGLMultipleRenderTargets===!0?ae.texture:[ae.texture];for(let ct=0,et=Ne.length;ct<et;ct++){const ot=Ne[ct];if(D(ot,Q)){const Bt=ae.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,dt=i.get(ot).__webglTexture;t.bindTexture(Bt,dt),H(Bt),t.unbindTexture()}}}function bt(ae){if(a&&ae.samples>0&&Zt(ae)===!1){const Q=ae.isWebGLMultipleRenderTargets?ae.texture:[ae.texture],Ne=ae.width,ct=ae.height;let et=n.COLOR_BUFFER_BIT;const ot=[],Bt=ae.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,dt=i.get(ae),vt=ae.isWebGLMultipleRenderTargets===!0;if(vt)for(let nn=0;nn<Q.length;nn++)t.bindFramebuffer(n.FRAMEBUFFER,dt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,dt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,dt.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,dt.__webglFramebuffer);for(let nn=0;nn<Q.length;nn++){ot.push(n.COLOR_ATTACHMENT0+nn),ae.depthBuffer&&ot.push(Bt);const Mn=dt.__ignoreDepthValues!==void 0?dt.__ignoreDepthValues:!1;if(Mn===!1&&(ae.depthBuffer&&(et|=n.DEPTH_BUFFER_BIT),ae.stencilBuffer&&(et|=n.STENCIL_BUFFER_BIT)),vt&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,dt.__webglColorRenderbuffer[nn]),Mn===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Bt]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Bt])),vt){const ht=i.get(Q[nn]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ht,0)}n.blitFramebuffer(0,0,Ne,ct,0,0,Ne,ct,et,n.NEAREST),y&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ot)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),vt)for(let nn=0;nn<Q.length;nn++){t.bindFramebuffer(n.FRAMEBUFFER,dt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.RENDERBUFFER,dt.__webglColorRenderbuffer[nn]);const Mn=i.get(Q[nn]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,dt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+nn,n.TEXTURE_2D,Mn,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,dt.__webglMultisampledFramebuffer)}}function Ct(ae){return Math.min(d,ae.samples)}function Zt(ae){const Q=i.get(ae);return a&&ae.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Q.__useRenderToTexture!==!1}function ln(ae){const Q=o.render.frame;x.get(ae)!==Q&&(x.set(ae,Q),ae.update())}function Xn(ae,Q){const Ne=ae.colorSpace,ct=ae.format,et=ae.type;return ae.isCompressedTexture===!0||ae.isVideoTexture===!0||ae.format===Vw||Ne!==ou&&Ne!==Wa&&(hi.getTransfer(Ne)===Ri?a===!1?e.has("EXT_sRGB")===!0&&ct===ca?(ae.format=Vw,ae.minFilter=Mr,ae.generateMipmaps=!1):Q=uR.sRGBToLinear(Q):(ct!==ca||et!==tu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ne)),Q}this.allocateTextureUnit=q,this.resetTextureUnits=me,this.setTexture2D=X,this.setTexture2DArray=Y,this.setTexture3D=ce,this.setTextureCube=Me,this.rebindTextures=lt,this.setupRenderTarget=Ke,this.updateRenderTargetMipmap=Ut,this.updateMultisampleRenderTarget=bt,this.setupDepthRenderbuffer=Ye,this.setupFrameBufferTexture=Rt,this.useMultisampledRTT=Zt}function WV(n,e,t){const i=t.isWebGL2;function r(s,o=Wa){let a;const l=hi.getTransfer(o);if(s===tu)return n.UNSIGNED_BYTE;if(s===nR)return n.UNSIGNED_SHORT_4_4_4_4;if(s===iR)return n.UNSIGNED_SHORT_5_5_5_1;if(s===sV)return n.BYTE;if(s===oV)return n.SHORT;if(s===qS)return n.UNSIGNED_SHORT;if(s===tR)return n.INT;if(s===sh)return n.UNSIGNED_INT;if(s===qc)return n.FLOAT;if(s===Qg)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===aV)return n.ALPHA;if(s===ca)return n.RGBA;if(s===lV)return n.LUMINANCE;if(s===cV)return n.LUMINANCE_ALPHA;if(s===Xf)return n.DEPTH_COMPONENT;if(s===Wp)return n.DEPTH_STENCIL;if(s===Vw)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===uV)return n.RED;if(s===rR)return n.RED_INTEGER;if(s===hV)return n.RG;if(s===sR)return n.RG_INTEGER;if(s===oR)return n.RGBA_INTEGER;if(s===aw||s===lw||s===cw||s===uw)if(l===Ri)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===aw)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===lw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===cw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===uw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===aw)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===lw)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===cw)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===uw)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===bM||s===wM||s===SM||s===TM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===bM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===wM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===SM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===TM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===fV)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===EM||s===AM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===EM)return l===Ri?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===AM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===MM||s===CM||s===PM||s===RM||s===IM||s===kM||s===OM||s===LM||s===NM||s===DM||s===FM||s===UM||s===BM||s===zM)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===MM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===CM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===PM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===RM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===IM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===kM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===OM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===LM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===NM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===DM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===FM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===UM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===BM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===zM)return l===Ri?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===hw||s===VM||s===HM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===hw)return l===Ri?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===VM)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===HM)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===dV||s===WM||s===jM||s===$M)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===hw)return a.COMPRESSED_RED_RGTC1_EXT;if(s===WM)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===jM)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===$M)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===$f?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class jV extends pr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Eg extends Qn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const nie={type:"move"};class a1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Eg,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Eg,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new re),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Eg,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new re),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const T of e.hand.values()){const S=t.getJointPose(T,i),w=this._getHandJoint(c,T);S!==null&&(w.matrix.fromArray(S.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.matrixWorldNeedsUpdate=!0,w.jointRadius=S.radius),w.visible=S!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],m=u.position.distanceTo(d.position),y=.02,x=.005;c.inputState.pinching&&m>y+x?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&m<=y-x&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(nie)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Eg;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class $V extends js{constructor(e,t,i,r,s,o,a,l,c,u){if(u=u!==void 0?u:Xf,u!==Xf&&u!==Wp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===Xf&&(i=sh),i===void 0&&u===Wp&&(i=$f),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Ar,this.minFilter=l!==void 0?l:Ar,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class iie extends Th{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,m=null,y=null,x=null;const T=t.getContextAttributes();let S=null,w=null;const P=[],M=[],I=new pr;I.layers.enable(1),I.viewport=new di;const k=new pr;k.layers.enable(2),k.viewport=new di;const D=[I,k],H=new jV;H.layers.enable(1),H.layers.enable(2);let W=null,z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Y){let ce=P[Y];return ce===void 0&&(ce=new a1,P[Y]=ce),ce.getTargetRaySpace()},this.getControllerGrip=function(Y){let ce=P[Y];return ce===void 0&&(ce=new a1,P[Y]=ce),ce.getGripSpace()},this.getHand=function(Y){let ce=P[Y];return ce===void 0&&(ce=new a1,P[Y]=ce),ce.getHandSpace()};function j(Y){const ce=M.indexOf(Y.inputSource);if(ce===-1)return;const Me=P[ce];Me!==void 0&&(Me.update(Y.inputSource,Y.frame,c||o),Me.dispatchEvent({type:Y.type,data:Y.inputSource}))}function J(){r.removeEventListener("select",j),r.removeEventListener("selectstart",j),r.removeEventListener("selectend",j),r.removeEventListener("squeeze",j),r.removeEventListener("squeezestart",j),r.removeEventListener("squeezeend",j),r.removeEventListener("end",J),r.removeEventListener("inputsourceschange",le);for(let Y=0;Y<P.length;Y++){const ce=M[Y];ce!==null&&(M[Y]=null,P[Y].disconnect(ce))}W=null,z=null,e.setRenderTarget(S),y=null,m=null,d=null,r=null,w=null,X.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Y){s=Y,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Y){a=Y,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(Y){c=Y},this.getBaseLayer=function(){return m!==null?m:y},this.getBinding=function(){return d},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=async function(Y){if(r=Y,r!==null){if(S=e.getRenderTarget(),r.addEventListener("select",j),r.addEventListener("selectstart",j),r.addEventListener("selectend",j),r.addEventListener("squeeze",j),r.addEventListener("squeezestart",j),r.addEventListener("squeezeend",j),r.addEventListener("end",J),r.addEventListener("inputsourceschange",le),T.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ce={antialias:r.renderState.layers===void 0?T.antialias:!0,alpha:!0,depth:T.depth,stencil:T.stencil,framebufferScaleFactor:s};y=new XRWebGLLayer(r,t,ce),r.updateRenderState({baseLayer:y}),w=new hc(y.framebufferWidth,y.framebufferHeight,{format:ca,type:tu,colorSpace:e.outputColorSpace,stencilBuffer:T.stencil})}else{let ce=null,Me=null,Re=null;T.depth&&(Re=T.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ce=T.stencil?Wp:Xf,Me=T.stencil?$f:sh);const Fe={colorFormat:t.RGBA8,depthFormat:Re,scaleFactor:s};d=new XRWebGLBinding(r,t),m=d.createProjectionLayer(Fe),r.updateRenderState({layers:[m]}),w=new hc(m.textureWidth,m.textureHeight,{format:ca,type:tu,depthTexture:new $V(m.textureWidth,m.textureHeight,Me,void 0,void 0,void 0,void 0,void 0,void 0,ce),stencilBuffer:T.stencil,colorSpace:e.outputColorSpace,samples:T.antialias?4:0});const Be=e.properties.get(w);Be.__ignoreDepthValues=m.ignoreDepthValues}w.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),X.setContext(r),X.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function le(Y){for(let ce=0;ce<Y.removed.length;ce++){const Me=Y.removed[ce],Re=M.indexOf(Me);Re>=0&&(M[Re]=null,P[Re].disconnect(Me))}for(let ce=0;ce<Y.added.length;ce++){const Me=Y.added[ce];let Re=M.indexOf(Me);if(Re===-1){for(let Be=0;Be<P.length;Be++)if(Be>=M.length){M.push(Me),Re=Be;break}else if(M[Be]===null){M[Be]=Me,Re=Be;break}if(Re===-1)break}const Fe=P[Re];Fe&&Fe.connect(Me)}}const ge=new re,te=new re;function de(Y,ce,Me){ge.setFromMatrixPosition(ce.matrixWorld),te.setFromMatrixPosition(Me.matrixWorld);const Re=ge.distanceTo(te),Fe=ce.projectionMatrix.elements,Be=Me.projectionMatrix.elements,at=Fe[14]/(Fe[10]-1),pt=Fe[14]/(Fe[10]+1),Ft=(Fe[9]+1)/Fe[5],yn=(Fe[9]-1)/Fe[5],Rt=(Fe[8]-1)/Fe[0],he=(Be[8]+1)/Be[0],nt=at*Rt,Ye=at*he,lt=Re/(-Rt+he),Ke=lt*-Rt;ce.matrixWorld.decompose(Y.position,Y.quaternion,Y.scale),Y.translateX(Ke),Y.translateZ(lt),Y.matrixWorld.compose(Y.position,Y.quaternion,Y.scale),Y.matrixWorldInverse.copy(Y.matrixWorld).invert();const Ut=at+lt,bt=pt+lt,Ct=nt-Ke,Zt=Ye+(Re-Ke),ln=Ft*pt/bt*Ut,Xn=yn*pt/bt*Ut;Y.projectionMatrix.makePerspective(Ct,Zt,ln,Xn,Ut,bt),Y.projectionMatrixInverse.copy(Y.projectionMatrix).invert()}function ve(Y,ce){ce===null?Y.matrixWorld.copy(Y.matrix):Y.matrixWorld.multiplyMatrices(ce.matrixWorld,Y.matrix),Y.matrixWorldInverse.copy(Y.matrixWorld).invert()}this.updateCamera=function(Y){if(r===null)return;H.near=k.near=I.near=Y.near,H.far=k.far=I.far=Y.far,(W!==H.near||z!==H.far)&&(r.updateRenderState({depthNear:H.near,depthFar:H.far}),W=H.near,z=H.far);const ce=Y.parent,Me=H.cameras;ve(H,ce);for(let Re=0;Re<Me.length;Re++)ve(Me[Re],ce);Me.length===2?de(H,I,k):H.projectionMatrix.copy(I.projectionMatrix),me(Y,H,ce)};function me(Y,ce,Me){Me===null?Y.matrix.copy(ce.matrixWorld):(Y.matrix.copy(Me.matrixWorld),Y.matrix.invert(),Y.matrix.multiply(ce.matrixWorld)),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale),Y.updateMatrixWorld(!0),Y.projectionMatrix.copy(ce.projectionMatrix),Y.projectionMatrixInverse.copy(ce.projectionMatrixInverse),Y.isPerspectiveCamera&&(Y.fov=e_*2*Math.atan(1/Y.projectionMatrix.elements[5]),Y.zoom=1)}this.getCamera=function(){return H},this.getFoveation=function(){if(!(m===null&&y===null))return l},this.setFoveation=function(Y){l=Y,m!==null&&(m.fixedFoveation=Y),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=Y)};let q=null;function ie(Y,ce){if(u=ce.getViewerPose(c||o),x=ce,u!==null){const Me=u.views;y!==null&&(e.setRenderTargetFramebuffer(w,y.framebuffer),e.setRenderTarget(w));let Re=!1;Me.length!==H.cameras.length&&(H.cameras.length=0,Re=!0);for(let Fe=0;Fe<Me.length;Fe++){const Be=Me[Fe];let at=null;if(y!==null)at=y.getViewport(Be);else{const Ft=d.getViewSubImage(m,Be);at=Ft.viewport,Fe===0&&(e.setRenderTargetTextures(w,Ft.colorTexture,m.ignoreDepthValues?void 0:Ft.depthStencilTexture),e.setRenderTarget(w))}let pt=D[Fe];pt===void 0&&(pt=new pr,pt.layers.enable(Fe),pt.viewport=new di,D[Fe]=pt),pt.matrix.fromArray(Be.transform.matrix),pt.matrix.decompose(pt.position,pt.quaternion,pt.scale),pt.projectionMatrix.fromArray(Be.projectionMatrix),pt.projectionMatrixInverse.copy(pt.projectionMatrix).invert(),pt.viewport.set(at.x,at.y,at.width,at.height),Fe===0&&(H.matrix.copy(pt.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale)),Re===!0&&H.cameras.push(pt)}}for(let Me=0;Me<P.length;Me++){const Re=M[Me],Fe=P[Me];Re!==null&&Fe!==void 0&&Fe.update(Re,ce,c||o)}q&&q(Y,ce),ce.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ce}),x=null}const X=new UV;X.setAnimationLoop(ie),this.setAnimationLoop=function(Y){q=Y},this.dispose=function(){}}}function rie(n,e){function t(S,w){S.matrixAutoUpdate===!0&&S.updateMatrix(),w.value.copy(S.matrix)}function i(S,w){w.color.getRGB(S.fogColor.value,LV(n)),w.isFog?(S.fogNear.value=w.near,S.fogFar.value=w.far):w.isFogExp2&&(S.fogDensity.value=w.density)}function r(S,w,P,M,I){w.isMeshBasicMaterial||w.isMeshLambertMaterial?s(S,w):w.isMeshToonMaterial?(s(S,w),d(S,w)):w.isMeshPhongMaterial?(s(S,w),u(S,w)):w.isMeshStandardMaterial?(s(S,w),m(S,w),w.isMeshPhysicalMaterial&&y(S,w,I)):w.isMeshMatcapMaterial?(s(S,w),x(S,w)):w.isMeshDepthMaterial?s(S,w):w.isMeshDistanceMaterial?(s(S,w),T(S,w)):w.isMeshNormalMaterial?s(S,w):w.isLineBasicMaterial?(o(S,w),w.isLineDashedMaterial&&a(S,w)):w.isPointsMaterial?l(S,w,P,M):w.isSpriteMaterial?c(S,w):w.isShadowMaterial?(S.color.value.copy(w.color),S.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}function s(S,w){S.opacity.value=w.opacity,w.color&&S.diffuse.value.copy(w.color),w.emissive&&S.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(S.map.value=w.map,t(w.map,S.mapTransform)),w.alphaMap&&(S.alphaMap.value=w.alphaMap,t(w.alphaMap,S.alphaMapTransform)),w.bumpMap&&(S.bumpMap.value=w.bumpMap,t(w.bumpMap,S.bumpMapTransform),S.bumpScale.value=w.bumpScale,w.side===Uo&&(S.bumpScale.value*=-1)),w.normalMap&&(S.normalMap.value=w.normalMap,t(w.normalMap,S.normalMapTransform),S.normalScale.value.copy(w.normalScale),w.side===Uo&&S.normalScale.value.negate()),w.displacementMap&&(S.displacementMap.value=w.displacementMap,t(w.displacementMap,S.displacementMapTransform),S.displacementScale.value=w.displacementScale,S.displacementBias.value=w.displacementBias),w.emissiveMap&&(S.emissiveMap.value=w.emissiveMap,t(w.emissiveMap,S.emissiveMapTransform)),w.specularMap&&(S.specularMap.value=w.specularMap,t(w.specularMap,S.specularMapTransform)),w.alphaTest>0&&(S.alphaTest.value=w.alphaTest);const P=e.get(w).envMap;if(P&&(S.envMap.value=P,S.flipEnvMap.value=P.isCubeTexture&&P.isRenderTargetTexture===!1?-1:1,S.reflectivity.value=w.reflectivity,S.ior.value=w.ior,S.refractionRatio.value=w.refractionRatio),w.lightMap){S.lightMap.value=w.lightMap;const M=n._useLegacyLights===!0?Math.PI:1;S.lightMapIntensity.value=w.lightMapIntensity*M,t(w.lightMap,S.lightMapTransform)}w.aoMap&&(S.aoMap.value=w.aoMap,S.aoMapIntensity.value=w.aoMapIntensity,t(w.aoMap,S.aoMapTransform))}function o(S,w){S.diffuse.value.copy(w.color),S.opacity.value=w.opacity,w.map&&(S.map.value=w.map,t(w.map,S.mapTransform))}function a(S,w){S.dashSize.value=w.dashSize,S.totalSize.value=w.dashSize+w.gapSize,S.scale.value=w.scale}function l(S,w,P,M){S.diffuse.value.copy(w.color),S.opacity.value=w.opacity,S.size.value=w.size*P,S.scale.value=M*.5,w.map&&(S.map.value=w.map,t(w.map,S.uvTransform)),w.alphaMap&&(S.alphaMap.value=w.alphaMap,t(w.alphaMap,S.alphaMapTransform)),w.alphaTest>0&&(S.alphaTest.value=w.alphaTest)}function c(S,w){S.diffuse.value.copy(w.color),S.opacity.value=w.opacity,S.rotation.value=w.rotation,w.map&&(S.map.value=w.map,t(w.map,S.mapTransform)),w.alphaMap&&(S.alphaMap.value=w.alphaMap,t(w.alphaMap,S.alphaMapTransform)),w.alphaTest>0&&(S.alphaTest.value=w.alphaTest)}function u(S,w){S.specular.value.copy(w.specular),S.shininess.value=Math.max(w.shininess,1e-4)}function d(S,w){w.gradientMap&&(S.gradientMap.value=w.gradientMap)}function m(S,w){S.metalness.value=w.metalness,w.metalnessMap&&(S.metalnessMap.value=w.metalnessMap,t(w.metalnessMap,S.metalnessMapTransform)),S.roughness.value=w.roughness,w.roughnessMap&&(S.roughnessMap.value=w.roughnessMap,t(w.roughnessMap,S.roughnessMapTransform)),e.get(w).envMap&&(S.envMapIntensity.value=w.envMapIntensity)}function y(S,w,P){S.ior.value=w.ior,w.sheen>0&&(S.sheenColor.value.copy(w.sheenColor).multiplyScalar(w.sheen),S.sheenRoughness.value=w.sheenRoughness,w.sheenColorMap&&(S.sheenColorMap.value=w.sheenColorMap,t(w.sheenColorMap,S.sheenColorMapTransform)),w.sheenRoughnessMap&&(S.sheenRoughnessMap.value=w.sheenRoughnessMap,t(w.sheenRoughnessMap,S.sheenRoughnessMapTransform))),w.clearcoat>0&&(S.clearcoat.value=w.clearcoat,S.clearcoatRoughness.value=w.clearcoatRoughness,w.clearcoatMap&&(S.clearcoatMap.value=w.clearcoatMap,t(w.clearcoatMap,S.clearcoatMapTransform)),w.clearcoatRoughnessMap&&(S.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap,t(w.clearcoatRoughnessMap,S.clearcoatRoughnessMapTransform)),w.clearcoatNormalMap&&(S.clearcoatNormalMap.value=w.clearcoatNormalMap,t(w.clearcoatNormalMap,S.clearcoatNormalMapTransform),S.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),w.side===Uo&&S.clearcoatNormalScale.value.negate())),w.iridescence>0&&(S.iridescence.value=w.iridescence,S.iridescenceIOR.value=w.iridescenceIOR,S.iridescenceThicknessMinimum.value=w.iridescenceThicknessRange[0],S.iridescenceThicknessMaximum.value=w.iridescenceThicknessRange[1],w.iridescenceMap&&(S.iridescenceMap.value=w.iridescenceMap,t(w.iridescenceMap,S.iridescenceMapTransform)),w.iridescenceThicknessMap&&(S.iridescenceThicknessMap.value=w.iridescenceThicknessMap,t(w.iridescenceThicknessMap,S.iridescenceThicknessMapTransform))),w.transmission>0&&(S.transmission.value=w.transmission,S.transmissionSamplerMap.value=P.texture,S.transmissionSamplerSize.value.set(P.width,P.height),w.transmissionMap&&(S.transmissionMap.value=w.transmissionMap,t(w.transmissionMap,S.transmissionMapTransform)),S.thickness.value=w.thickness,w.thicknessMap&&(S.thicknessMap.value=w.thicknessMap,t(w.thicknessMap,S.thicknessMapTransform)),S.attenuationDistance.value=w.attenuationDistance,S.attenuationColor.value.copy(w.attenuationColor)),w.anisotropy>0&&(S.anisotropyVector.value.set(w.anisotropy*Math.cos(w.anisotropyRotation),w.anisotropy*Math.sin(w.anisotropyRotation)),w.anisotropyMap&&(S.anisotropyMap.value=w.anisotropyMap,t(w.anisotropyMap,S.anisotropyMapTransform))),S.specularIntensity.value=w.specularIntensity,S.specularColor.value.copy(w.specularColor),w.specularColorMap&&(S.specularColorMap.value=w.specularColorMap,t(w.specularColorMap,S.specularColorMapTransform)),w.specularIntensityMap&&(S.specularIntensityMap.value=w.specularIntensityMap,t(w.specularIntensityMap,S.specularIntensityMapTransform))}function x(S,w){w.matcap&&(S.matcap.value=w.matcap)}function T(S,w){const P=e.get(w).light;S.referencePosition.value.setFromMatrixPosition(P.matrixWorld),S.nearDistance.value=P.shadow.camera.near,S.farDistance.value=P.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function sie(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(P,M){const I=M.program;i.uniformBlockBinding(P,I)}function c(P,M){let I=r[P.id];I===void 0&&(x(P),I=u(P),r[P.id]=I,P.addEventListener("dispose",S));const k=M.program;i.updateUBOMapping(P,k);const D=e.render.frame;s[P.id]!==D&&(m(P),s[P.id]=D)}function u(P){const M=d();P.__bindingPointIndex=M;const I=n.createBuffer(),k=P.__size,D=P.usage;return n.bindBuffer(n.UNIFORM_BUFFER,I),n.bufferData(n.UNIFORM_BUFFER,k,D),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,M,I),I}function d(){for(let P=0;P<a;P++)if(o.indexOf(P)===-1)return o.push(P),P;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(P){const M=r[P.id],I=P.uniforms,k=P.__cache;n.bindBuffer(n.UNIFORM_BUFFER,M);for(let D=0,H=I.length;D<H;D++){const W=I[D];if(y(W,D,k)===!0){const z=W.__offset,j=Array.isArray(W.value)?W.value:[W.value];let J=0;for(let le=0;le<j.length;le++){const ge=j[le],te=T(ge);typeof ge=="number"?(W.__data[0]=ge,n.bufferSubData(n.UNIFORM_BUFFER,z+J,W.__data)):ge.isMatrix3?(W.__data[0]=ge.elements[0],W.__data[1]=ge.elements[1],W.__data[2]=ge.elements[2],W.__data[3]=ge.elements[0],W.__data[4]=ge.elements[3],W.__data[5]=ge.elements[4],W.__data[6]=ge.elements[5],W.__data[7]=ge.elements[0],W.__data[8]=ge.elements[6],W.__data[9]=ge.elements[7],W.__data[10]=ge.elements[8],W.__data[11]=ge.elements[0]):(ge.toArray(W.__data,J),J+=te.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,z,W.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function y(P,M,I){const k=P.value;if(I[M]===void 0){if(typeof k=="number")I[M]=k;else{const D=Array.isArray(k)?k:[k],H=[];for(let W=0;W<D.length;W++)H.push(D[W].clone());I[M]=H}return!0}else if(typeof k=="number"){if(I[M]!==k)return I[M]=k,!0}else{const D=Array.isArray(I[M])?I[M]:[I[M]],H=Array.isArray(k)?k:[k];for(let W=0;W<D.length;W++){const z=D[W];if(z.equals(H[W])===!1)return z.copy(H[W]),!0}}return!1}function x(P){const M=P.uniforms;let I=0;const k=16;let D=0;for(let H=0,W=M.length;H<W;H++){const z=M[H],j={boundary:0,storage:0},J=Array.isArray(z.value)?z.value:[z.value];for(let le=0,ge=J.length;le<ge;le++){const te=J[le],de=T(te);j.boundary+=de.boundary,j.storage+=de.storage}if(z.__data=new Float32Array(j.storage/Float32Array.BYTES_PER_ELEMENT),z.__offset=I,H>0){D=I%k;const le=k-D;D!==0&&le-j.boundary<0&&(I+=k-D,z.__offset=I)}I+=j.storage}return D=I%k,D>0&&(I+=k-D),P.__size=I,P.__cache={},this}function T(P){const M={boundary:0,storage:0};return typeof P=="number"?(M.boundary=4,M.storage=4):P.isVector2?(M.boundary=8,M.storage=8):P.isVector3||P.isColor?(M.boundary=16,M.storage=12):P.isVector4?(M.boundary=16,M.storage=16):P.isMatrix3?(M.boundary=48,M.storage=48):P.isMatrix4?(M.boundary=64,M.storage=64):P.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",P),M}function S(P){const M=P.target;M.removeEventListener("dispose",S);const I=o.indexOf(M.__bindingPointIndex);o.splice(I,1),n.deleteBuffer(r[M.id]),delete r[M.id],delete s[M.id]}function w(){for(const P in r)n.deleteBuffer(r[P]);o=[],r={},s={}}return{bind:l,update:c,dispose:w}}class tT{constructor(e={}){const{canvas:t=RV(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let m;i!==null?m=i.getContextAttributes().alpha:m=o;const y=new Uint32Array(4),x=new Int32Array(4);let T=null,S=null;const w=[],P=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=es,this._useLegacyLights=!1,this.toneMapping=eu,this.toneMappingExposure=1;const M=this;let I=!1,k=0,D=0,H=null,W=-1,z=null;const j=new di,J=new di;let le=null;const ge=new Ot(0);let te=0,de=t.width,ve=t.height,me=1,q=null,ie=null;const X=new di(0,0,de,ve),Y=new di(0,0,de,ve);let ce=!1;const Me=new QS;let Re=!1,Fe=!1,Be=null;const at=new On,pt=new qe,Ft=new re,yn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Rt(){return H===null?me:1}let he=i;function nt(ne,Pe){for(let ze=0;ze<ne.length;ze++){const He=ne[ze],je=t.getContext(He,Pe);if(je!==null)return je}return null}try{const ne={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${XS}`),t.addEventListener("webglcontextlost",jt,!1),t.addEventListener("webglcontextrestored",ye,!1),t.addEventListener("webglcontextcreationerror",mt,!1),he===null){const Pe=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&Pe.shift(),he=nt(Pe,ne),he===null)throw nt(Pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&he instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),he.getShaderPrecisionFormat===void 0&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}let Ye,lt,Ke,Ut,bt,Ct,Zt,ln,Xn,ae,Q,Ne,ct,et,ot,Bt,dt,vt,nn,Mn,ht,Ln,pe,$e;function it(){Ye=new xte(he),lt=new pte(he,Ye,e),Ye.init(lt),Ln=new WV(he,Ye,lt),Ke=new eie(he,Ye,lt),Ut=new Ste(he),bt=new Hne,Ct=new tie(he,Ye,Ke,bt,lt,Ln,Ut),Zt=new gte(M),ln=new vte(M),Xn=new OJ(he,lt),pe=new fte(he,Ye,Xn,lt),ae=new bte(he,Xn,Ut,pe),Q=new Mte(he,ae,Xn,Ut),nn=new Ate(he,lt,Ct),Bt=new mte(bt),Ne=new Vne(M,Zt,ln,Ye,lt,pe,Bt),ct=new rie(M,bt),et=new jne,ot=new Zne(Ye,lt),vt=new hte(M,Zt,ln,Ke,Q,m,l),dt=new Qne(M,Q,lt),$e=new sie(he,Ut,lt,Ke),Mn=new dte(he,Ye,Ut,lt),ht=new wte(he,Ye,Ut,lt),Ut.programs=Ne.programs,M.capabilities=lt,M.extensions=Ye,M.properties=bt,M.renderLists=et,M.shadowMap=dt,M.state=Ke,M.info=Ut}it();const tt=new iie(M,he);this.xr=tt,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){const ne=Ye.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=Ye.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return me},this.setPixelRatio=function(ne){ne!==void 0&&(me=ne,this.setSize(de,ve,!1))},this.getSize=function(ne){return ne.set(de,ve)},this.setSize=function(ne,Pe,ze=!0){if(tt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}de=ne,ve=Pe,t.width=Math.floor(ne*me),t.height=Math.floor(Pe*me),ze===!0&&(t.style.width=ne+"px",t.style.height=Pe+"px"),this.setViewport(0,0,ne,Pe)},this.getDrawingBufferSize=function(ne){return ne.set(de*me,ve*me).floor()},this.setDrawingBufferSize=function(ne,Pe,ze){de=ne,ve=Pe,me=ze,t.width=Math.floor(ne*ze),t.height=Math.floor(Pe*ze),this.setViewport(0,0,ne,Pe)},this.getCurrentViewport=function(ne){return ne.copy(j)},this.getViewport=function(ne){return ne.copy(X)},this.setViewport=function(ne,Pe,ze,He){ne.isVector4?X.set(ne.x,ne.y,ne.z,ne.w):X.set(ne,Pe,ze,He),Ke.viewport(j.copy(X).multiplyScalar(me).floor())},this.getScissor=function(ne){return ne.copy(Y)},this.setScissor=function(ne,Pe,ze,He){ne.isVector4?Y.set(ne.x,ne.y,ne.z,ne.w):Y.set(ne,Pe,ze,He),Ke.scissor(J.copy(Y).multiplyScalar(me).floor())},this.getScissorTest=function(){return ce},this.setScissorTest=function(ne){Ke.setScissorTest(ce=ne)},this.setOpaqueSort=function(ne){q=ne},this.setTransparentSort=function(ne){ie=ne},this.getClearColor=function(ne){return ne.copy(vt.getClearColor())},this.setClearColor=function(){vt.setClearColor.apply(vt,arguments)},this.getClearAlpha=function(){return vt.getClearAlpha()},this.setClearAlpha=function(){vt.setClearAlpha.apply(vt,arguments)},this.clear=function(ne=!0,Pe=!0,ze=!0){let He=0;if(ne){let je=!1;if(H!==null){const Et=H.texture.format;je=Et===oR||Et===sR||Et===rR}if(je){const Et=H.texture.type,Yt=Et===tu||Et===sh||Et===qS||Et===$f||Et===nR||Et===iR,Jt=vt.getClearColor(),Mt=vt.getClearAlpha(),fn=Jt.r,rn=Jt.g,un=Jt.b;Yt?(y[0]=fn,y[1]=rn,y[2]=un,y[3]=Mt,he.clearBufferuiv(he.COLOR,0,y)):(x[0]=fn,x[1]=rn,x[2]=un,x[3]=Mt,he.clearBufferiv(he.COLOR,0,x))}else He|=he.COLOR_BUFFER_BIT}Pe&&(He|=he.DEPTH_BUFFER_BIT),ze&&(He|=he.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),he.clear(He)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",jt,!1),t.removeEventListener("webglcontextrestored",ye,!1),t.removeEventListener("webglcontextcreationerror",mt,!1),et.dispose(),ot.dispose(),bt.dispose(),Zt.dispose(),ln.dispose(),Q.dispose(),pe.dispose(),$e.dispose(),Ne.dispose(),tt.dispose(),tt.removeEventListener("sessionstart",pi),tt.removeEventListener("sessionend",Cn),Be&&(Be.dispose(),Be=null),qi.stop()};function jt(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function ye(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;const ne=Ut.autoReset,Pe=dt.enabled,ze=dt.autoUpdate,He=dt.needsUpdate,je=dt.type;it(),Ut.autoReset=ne,dt.enabled=Pe,dt.autoUpdate=ze,dt.needsUpdate=He,dt.type=je}function mt(ne){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function gt(ne){const Pe=ne.target;Pe.removeEventListener("dispose",gt),Ge(Pe)}function Ge(ne){ut(ne),bt.remove(ne)}function ut(ne){const Pe=bt.get(ne).programs;Pe!==void 0&&(Pe.forEach(function(ze){Ne.releaseProgram(ze)}),ne.isShaderMaterial&&Ne.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Pe,ze,He,je,Et){Pe===null&&(Pe=yn);const Yt=je.isMesh&&je.matrixWorld.determinant()<0,Jt=gu(ne,Pe,ze,He,je);Ke.setMaterial(He,Yt);let Mt=ze.index,fn=1;if(He.wireframe===!0){if(Mt=ae.getWireframeAttribute(ze),Mt===void 0)return;fn=2}const rn=ze.drawRange,un=ze.attributes.position;let ri=rn.start*fn,Zi=(rn.start+rn.count)*fn;Et!==null&&(ri=Math.max(ri,Et.start*fn),Zi=Math.min(Zi,(Et.start+Et.count)*fn)),Mt!==null?(ri=Math.max(ri,0),Zi=Math.min(Zi,Mt.count)):un!=null&&(ri=Math.max(ri,0),Zi=Math.min(Zi,un.count));const Gn=Zi-ri;if(Gn<0||Gn===1/0)return;pe.setup(je,He,Jt,ze,Mt);let Mi,$t=Mn;if(Mt!==null&&(Mi=Xn.get(Mt),$t=ht,$t.setIndex(Mi)),je.isMesh)He.wireframe===!0?(Ke.setLineWidth(He.wireframeLinewidth*Rt()),$t.setMode(he.LINES)):$t.setMode(he.TRIANGLES);else if(je.isLine){let It=He.linewidth;It===void 0&&(It=1),Ke.setLineWidth(It*Rt()),je.isLineSegments?$t.setMode(he.LINES):je.isLineLoop?$t.setMode(he.LINE_LOOP):$t.setMode(he.LINE_STRIP)}else je.isPoints?$t.setMode(he.POINTS):je.isSprite&&$t.setMode(he.TRIANGLES);if(je.isInstancedMesh)$t.renderInstances(ri,Gn,je.count);else if(ze.isInstancedBufferGeometry){const It=ze._maxInstanceCount!==void 0?ze._maxInstanceCount:1/0,Qt=Math.min(ze.instanceCount,It);$t.renderInstances(ri,Gn,Qt)}else $t.render(ri,Gn)};function Vt(ne,Pe,ze){ne.transparent===!0&&ne.side===Gc&&ne.forceSinglePass===!1?(ne.side=Uo,ne.needsUpdate=!0,ga(ne,Pe,ze),ne.side=ph,ne.needsUpdate=!0,ga(ne,Pe,ze),ne.side=Gc):ga(ne,Pe,ze)}this.compile=function(ne,Pe,ze=null){ze===null&&(ze=ne),S=ot.get(ze),S.init(),P.push(S),ze.traverseVisible(function(je){je.isLight&&je.layers.test(Pe.layers)&&(S.pushLight(je),je.castShadow&&S.pushShadow(je))}),ne!==ze&&ne.traverseVisible(function(je){je.isLight&&je.layers.test(Pe.layers)&&(S.pushLight(je),je.castShadow&&S.pushShadow(je))}),S.setupLights(M._useLegacyLights);const He=new Set;return ne.traverse(function(je){const Et=je.material;if(Et)if(Array.isArray(Et))for(let Yt=0;Yt<Et.length;Yt++){const Jt=Et[Yt];Vt(Jt,ze,je),He.add(Jt)}else Vt(Et,ze,je),He.add(Et)}),P.pop(),S=null,He},this.compileAsync=function(ne,Pe,ze=null){const He=this.compile(ne,Pe,ze);return new Promise(je=>{function Et(){if(He.forEach(function(Yt){bt.get(Yt).currentProgram.isReady()&&He.delete(Yt)}),He.size===0){je(ne);return}setTimeout(Et,10)}Ye.get("KHR_parallel_shader_compile")!==null?Et():setTimeout(Et,10)})};let vn=null;function jn(ne){vn&&vn(ne)}function pi(){qi.stop()}function Cn(){qi.start()}const qi=new UV;qi.setAnimationLoop(jn),typeof self<"u"&&qi.setContext(self),this.setAnimationLoop=function(ne){vn=ne,tt.setAnimationLoop(ne),ne===null?qi.stop():qi.start()},tt.addEventListener("sessionstart",pi),tt.addEventListener("sessionend",Cn),this.render=function(ne,Pe){if(Pe!==void 0&&Pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(I===!0)return;ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Pe.parent===null&&Pe.matrixWorldAutoUpdate===!0&&Pe.updateMatrixWorld(),tt.enabled===!0&&tt.isPresenting===!0&&(tt.cameraAutoUpdate===!0&&tt.updateCamera(Pe),Pe=tt.getCamera()),ne.isScene===!0&&ne.onBeforeRender(M,ne,Pe,H),S=ot.get(ne,P.length),S.init(),P.push(S),at.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),Me.setFromProjectionMatrix(at),Fe=this.localClippingEnabled,Re=Bt.init(this.clippingPlanes,Fe),T=et.get(ne,w.length),T.init(),w.push(T),Rr(ne,Pe,0,M.sortObjects),T.finish(),M.sortObjects===!0&&T.sort(q,ie),this.info.render.frame++,Re===!0&&Bt.beginShadows();const ze=S.state.shadowsArray;if(dt.render(ze,ne,Pe),Re===!0&&Bt.endShadows(),this.info.autoReset===!0&&this.info.reset(),vt.render(T,ne),S.setupLights(M._useLegacyLights),Pe.isArrayCamera){const He=Pe.cameras;for(let je=0,Et=He.length;je<Et;je++){const Yt=He[je];du(T,ne,Yt,Yt.viewport)}}else du(T,ne,Pe);H!==null&&(Ct.updateMultisampleRenderTarget(H),Ct.updateRenderTargetMipmap(H)),ne.isScene===!0&&ne.onAfterRender(M,ne,Pe),pe.resetDefaultState(),W=-1,z=null,P.pop(),P.length>0?S=P[P.length-1]:S=null,w.pop(),w.length>0?T=w[w.length-1]:T=null};function Rr(ne,Pe,ze,He){if(ne.visible===!1)return;if(ne.layers.test(Pe.layers)){if(ne.isGroup)ze=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Pe);else if(ne.isLight)S.pushLight(ne),ne.castShadow&&S.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||Me.intersectsSprite(ne)){He&&Ft.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(at);const Yt=Q.update(ne),Jt=ne.material;Jt.visible&&T.push(ne,Yt,Jt,ze,Ft.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||Me.intersectsObject(ne))){const Yt=Q.update(ne),Jt=ne.material;if(He&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),Ft.copy(ne.boundingSphere.center)):(Yt.boundingSphere===null&&Yt.computeBoundingSphere(),Ft.copy(Yt.boundingSphere.center)),Ft.applyMatrix4(ne.matrixWorld).applyMatrix4(at)),Array.isArray(Jt)){const Mt=Yt.groups;for(let fn=0,rn=Mt.length;fn<rn;fn++){const un=Mt[fn],ri=Jt[un.materialIndex];ri&&ri.visible&&T.push(ne,Yt,ri,ze,Ft.z,un)}}else Jt.visible&&T.push(ne,Yt,Jt,ze,Ft.z,null)}}const Et=ne.children;for(let Yt=0,Jt=Et.length;Yt<Jt;Yt++)Rr(Et[Yt],Pe,ze,He)}function du(ne,Pe,ze,He){const je=ne.opaque,Et=ne.transmissive,Yt=ne.transparent;S.setupLightsView(ze),Re===!0&&Bt.setGlobalState(M.clippingPlanes,ze),Et.length>0&&rr(je,Et,Pe,ze),He&&Ke.viewport(j.copy(He)),je.length>0&&Lt(je,Pe,ze),Et.length>0&&Lt(Et,Pe,ze),Yt.length>0&&Lt(Yt,Pe,ze),Ke.buffers.depth.setTest(!0),Ke.buffers.depth.setMask(!0),Ke.buffers.color.setMask(!0),Ke.setPolygonOffset(!1)}function rr(ne,Pe,ze,He){if((ze.isScene===!0?ze.overrideMaterial:null)!==null)return;const Et=lt.isWebGL2;Be===null&&(Be=new hc(1,1,{generateMipmaps:!0,type:Ye.has("EXT_color_buffer_half_float")?Qg:tu,minFilter:Jf,samples:Et?4:0})),M.getDrawingBufferSize(pt),Et?Be.setSize(pt.x,pt.y):Be.setSize(Hw(pt.x),Hw(pt.y));const Yt=M.getRenderTarget();M.setRenderTarget(Be),M.getClearColor(ge),te=M.getClearAlpha(),te<1&&M.setClearColor(16777215,.5),M.clear();const Jt=M.toneMapping;M.toneMapping=eu,Lt(ne,ze,He),Ct.updateMultisampleRenderTarget(Be),Ct.updateRenderTargetMipmap(Be);let Mt=!1;for(let fn=0,rn=Pe.length;fn<rn;fn++){const un=Pe[fn],ri=un.object,Zi=un.geometry,Gn=un.material,Mi=un.group;if(Gn.side===Gc&&ri.layers.test(He.layers)){const $t=Gn.side;Gn.side=Uo,Gn.needsUpdate=!0,$s(ri,ze,He,Zi,Gn,Mi),Gn.side=$t,Gn.needsUpdate=!0,Mt=!0}}Mt===!0&&(Ct.updateMultisampleRenderTarget(Be),Ct.updateRenderTargetMipmap(Be)),M.setRenderTarget(Yt),M.setClearColor(ge,te),M.toneMapping=Jt}function Lt(ne,Pe,ze){const He=Pe.isScene===!0?Pe.overrideMaterial:null;for(let je=0,Et=ne.length;je<Et;je++){const Yt=ne[je],Jt=Yt.object,Mt=Yt.geometry,fn=He===null?Yt.material:He,rn=Yt.group;Jt.layers.test(ze.layers)&&$s(Jt,Pe,ze,Mt,fn,rn)}}function $s(ne,Pe,ze,He,je,Et){ne.onBeforeRender(M,Pe,ze,He,je,Et),ne.modelViewMatrix.multiplyMatrices(ze.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),je.onBeforeRender(M,Pe,ze,He,ne,Et),je.transparent===!0&&je.side===Gc&&je.forceSinglePass===!1?(je.side=Uo,je.needsUpdate=!0,M.renderBufferDirect(ze,Pe,He,je,ne,Et),je.side=ph,je.needsUpdate=!0,M.renderBufferDirect(ze,Pe,He,je,ne,Et),je.side=Gc):M.renderBufferDirect(ze,Pe,He,je,ne,Et),ne.onAfterRender(M,Pe,ze,He,je,Et)}function ga(ne,Pe,ze){Pe.isScene!==!0&&(Pe=yn);const He=bt.get(ne),je=S.state.lights,Et=S.state.shadowsArray,Yt=je.state.version,Jt=Ne.getParameters(ne,je.state,Et,Pe,ze),Mt=Ne.getProgramCacheKey(Jt);let fn=He.programs;He.environment=ne.isMeshStandardMaterial?Pe.environment:null,He.fog=Pe.fog,He.envMap=(ne.isMeshStandardMaterial?ln:Zt).get(ne.envMap||He.environment),fn===void 0&&(ne.addEventListener("dispose",gt),fn=new Map,He.programs=fn);let rn=fn.get(Mt);if(rn!==void 0){if(He.currentProgram===rn&&He.lightsStateVersion===Yt)return mu(ne,Jt),rn}else Jt.uniforms=Ne.getUniforms(ne),ne.onBuild(ze,Jt,M),ne.onBeforeCompile(Jt,M),rn=Ne.acquireProgram(Jt,Mt),fn.set(Mt,rn),He.uniforms=Jt.uniforms;const un=He.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(un.clippingPlanes=Bt.uniform),mu(ne,Jt),He.needsLights=_a(ne),He.lightsStateVersion=Yt,He.needsLights&&(un.ambientLightColor.value=je.state.ambient,un.lightProbe.value=je.state.probe,un.directionalLights.value=je.state.directional,un.directionalLightShadows.value=je.state.directionalShadow,un.spotLights.value=je.state.spot,un.spotLightShadows.value=je.state.spotShadow,un.rectAreaLights.value=je.state.rectArea,un.ltc_1.value=je.state.rectAreaLTC1,un.ltc_2.value=je.state.rectAreaLTC2,un.pointLights.value=je.state.point,un.pointLightShadows.value=je.state.pointShadow,un.hemisphereLights.value=je.state.hemi,un.directionalShadowMap.value=je.state.directionalShadowMap,un.directionalShadowMatrix.value=je.state.directionalShadowMatrix,un.spotShadowMap.value=je.state.spotShadowMap,un.spotLightMatrix.value=je.state.spotLightMatrix,un.spotLightMap.value=je.state.spotLightMap,un.pointShadowMap.value=je.state.pointShadowMap,un.pointShadowMatrix.value=je.state.pointShadowMatrix),He.currentProgram=rn,He.uniformsList=null,rn}function pu(ne){if(ne.uniformsList===null){const Pe=ne.currentProgram.getUniforms();ne.uniformsList=pw.seqWithValue(Pe.seq,ne.uniforms)}return ne.uniformsList}function mu(ne,Pe){const ze=bt.get(ne);ze.outputColorSpace=Pe.outputColorSpace,ze.instancing=Pe.instancing,ze.instancingColor=Pe.instancingColor,ze.skinning=Pe.skinning,ze.morphTargets=Pe.morphTargets,ze.morphNormals=Pe.morphNormals,ze.morphColors=Pe.morphColors,ze.morphTargetsCount=Pe.morphTargetsCount,ze.numClippingPlanes=Pe.numClippingPlanes,ze.numIntersection=Pe.numClipIntersection,ze.vertexAlphas=Pe.vertexAlphas,ze.vertexTangents=Pe.vertexTangents,ze.toneMapping=Pe.toneMapping}function gu(ne,Pe,ze,He,je){Pe.isScene!==!0&&(Pe=yn),Ct.resetTextureUnits();const Et=Pe.fog,Yt=He.isMeshStandardMaterial?Pe.environment:null,Jt=H===null?M.outputColorSpace:H.isXRRenderTarget===!0?H.texture.colorSpace:ou,Mt=(He.isMeshStandardMaterial?ln:Zt).get(He.envMap||Yt),fn=He.vertexColors===!0&&!!ze.attributes.color&&ze.attributes.color.itemSize===4,rn=!!ze.attributes.tangent&&(!!He.normalMap||He.anisotropy>0),un=!!ze.morphAttributes.position,ri=!!ze.morphAttributes.normal,Zi=!!ze.morphAttributes.color;let Gn=eu;He.toneMapped&&(H===null||H.isXRRenderTarget===!0)&&(Gn=M.toneMapping);const Mi=ze.morphAttributes.position||ze.morphAttributes.normal||ze.morphAttributes.color,$t=Mi!==void 0?Mi.length:0,It=bt.get(He),Qt=S.state.lights;if(Re===!0&&(Fe===!0||ne!==z)){const ki=ne===z&&He.id===W;Bt.setState(He,ne,ki)}let Wt=!1;He.version===It.__version?(It.needsLights&&It.lightsStateVersion!==Qt.state.version||It.outputColorSpace!==Jt||je.isInstancedMesh&&It.instancing===!1||!je.isInstancedMesh&&It.instancing===!0||je.isSkinnedMesh&&It.skinning===!1||!je.isSkinnedMesh&&It.skinning===!0||je.isInstancedMesh&&It.instancingColor===!0&&je.instanceColor===null||je.isInstancedMesh&&It.instancingColor===!1&&je.instanceColor!==null||It.envMap!==Mt||He.fog===!0&&It.fog!==Et||It.numClippingPlanes!==void 0&&(It.numClippingPlanes!==Bt.numPlanes||It.numIntersection!==Bt.numIntersection)||It.vertexAlphas!==fn||It.vertexTangents!==rn||It.morphTargets!==un||It.morphNormals!==ri||It.morphColors!==Zi||It.toneMapping!==Gn||lt.isWebGL2===!0&&It.morphTargetsCount!==$t)&&(Wt=!0):(Wt=!0,It.__version=He.version);let ai=It.currentProgram;Wt===!0&&(ai=ga(He,Pe,je));let Xr=!1,Fi=!1,bi=!1;const Dt=ai.getUniforms(),Fn=It.uniforms;if(Ke.useProgram(ai.program)&&(Xr=!0,Fi=!0,bi=!0),He.id!==W&&(W=He.id,Fi=!0),Xr||z!==ne){Dt.setValue(he,"projectionMatrix",ne.projectionMatrix),Dt.setValue(he,"viewMatrix",ne.matrixWorldInverse);const ki=Dt.map.cameraPosition;ki!==void 0&&ki.setValue(he,Ft.setFromMatrixPosition(ne.matrixWorld)),lt.logarithmicDepthBuffer&&Dt.setValue(he,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(He.isMeshPhongMaterial||He.isMeshToonMaterial||He.isMeshLambertMaterial||He.isMeshBasicMaterial||He.isMeshStandardMaterial||He.isShaderMaterial)&&Dt.setValue(he,"isOrthographic",ne.isOrthographicCamera===!0),z!==ne&&(z=ne,Fi=!0,bi=!0)}if(je.isSkinnedMesh){Dt.setOptional(he,je,"bindMatrix"),Dt.setOptional(he,je,"bindMatrixInverse");const ki=je.skeleton;ki&&(lt.floatVertexTextures?(ki.boneTexture===null&&ki.computeBoneTexture(),Dt.setValue(he,"boneTexture",ki.boneTexture,Ct),Dt.setValue(he,"boneTextureSize",ki.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Ga=ze.morphAttributes;if((Ga.position!==void 0||Ga.normal!==void 0||Ga.color!==void 0&&lt.isWebGL2===!0)&&nn.update(je,ze,ai),(Fi||It.receiveShadow!==je.receiveShadow)&&(It.receiveShadow=je.receiveShadow,Dt.setValue(he,"receiveShadow",je.receiveShadow)),He.isMeshGouraudMaterial&&He.envMap!==null&&(Fn.envMap.value=Mt,Fn.flipEnvMap.value=Mt.isCubeTexture&&Mt.isRenderTargetTexture===!1?-1:1),Fi&&(Dt.setValue(he,"toneMappingExposure",M.toneMappingExposure),It.needsLights&&Vo(Fn,bi),Et&&He.fog===!0&&ct.refreshFogUniforms(Fn,Et),ct.refreshMaterialUniforms(Fn,He,me,ve,Be),pw.upload(he,pu(It),Fn,Ct)),He.isShaderMaterial&&He.uniformsNeedUpdate===!0&&(pw.upload(he,pu(It),Fn,Ct),He.uniformsNeedUpdate=!1),He.isSpriteMaterial&&Dt.setValue(he,"center",je.center),Dt.setValue(he,"modelViewMatrix",je.modelViewMatrix),Dt.setValue(he,"normalMatrix",je.normalMatrix),Dt.setValue(he,"modelMatrix",je.matrixWorld),He.isShaderMaterial||He.isRawShaderMaterial){const ki=He.uniformsGroups;for(let Ki=0,os=ki.length;Ki<os;Ki++)if(lt.isWebGL2){const ya=ki[Ki];$e.update(ya,ai),$e.bind(ya,ai)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return ai}function Vo(ne,Pe){ne.ambientLightColor.needsUpdate=Pe,ne.lightProbe.needsUpdate=Pe,ne.directionalLights.needsUpdate=Pe,ne.directionalLightShadows.needsUpdate=Pe,ne.pointLights.needsUpdate=Pe,ne.pointLightShadows.needsUpdate=Pe,ne.spotLights.needsUpdate=Pe,ne.spotLightShadows.needsUpdate=Pe,ne.rectAreaLights.needsUpdate=Pe,ne.hemisphereLights.needsUpdate=Pe}function _a(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return k},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return H},this.setRenderTargetTextures=function(ne,Pe,ze){bt.get(ne.texture).__webglTexture=Pe,bt.get(ne.depthTexture).__webglTexture=ze;const He=bt.get(ne);He.__hasExternalTextures=!0,He.__hasExternalTextures&&(He.__autoAllocateDepthBuffer=ze===void 0,He.__autoAllocateDepthBuffer||Ye.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),He.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ne,Pe){const ze=bt.get(ne);ze.__webglFramebuffer=Pe,ze.__useDefaultFramebuffer=Pe===void 0},this.setRenderTarget=function(ne,Pe=0,ze=0){H=ne,k=Pe,D=ze;let He=!0,je=null,Et=!1,Yt=!1;if(ne){const Mt=bt.get(ne);Mt.__useDefaultFramebuffer!==void 0?(Ke.bindFramebuffer(he.FRAMEBUFFER,null),He=!1):Mt.__webglFramebuffer===void 0?Ct.setupRenderTarget(ne):Mt.__hasExternalTextures&&Ct.rebindTextures(ne,bt.get(ne.texture).__webglTexture,bt.get(ne.depthTexture).__webglTexture);const fn=ne.texture;(fn.isData3DTexture||fn.isDataArrayTexture||fn.isCompressedArrayTexture)&&(Yt=!0);const rn=bt.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(rn[Pe])?je=rn[Pe][ze]:je=rn[Pe],Et=!0):lt.isWebGL2&&ne.samples>0&&Ct.useMultisampledRTT(ne)===!1?je=bt.get(ne).__webglMultisampledFramebuffer:Array.isArray(rn)?je=rn[ze]:je=rn,j.copy(ne.viewport),J.copy(ne.scissor),le=ne.scissorTest}else j.copy(X).multiplyScalar(me).floor(),J.copy(Y).multiplyScalar(me).floor(),le=ce;if(Ke.bindFramebuffer(he.FRAMEBUFFER,je)&&lt.drawBuffers&&He&&Ke.drawBuffers(ne,je),Ke.viewport(j),Ke.scissor(J),Ke.setScissorTest(le),Et){const Mt=bt.get(ne.texture);he.framebufferTexture2D(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,Mt.__webglTexture,ze)}else if(Yt){const Mt=bt.get(ne.texture),fn=Pe||0;he.framebufferTextureLayer(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,Mt.__webglTexture,ze||0,fn)}W=-1},this.readRenderTargetPixels=function(ne,Pe,ze,He,je,Et,Yt){if(!(ne&&ne.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Jt=bt.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&Yt!==void 0&&(Jt=Jt[Yt]),Jt){Ke.bindFramebuffer(he.FRAMEBUFFER,Jt);try{const Mt=ne.texture,fn=Mt.format,rn=Mt.type;if(fn!==ca&&Ln.convert(fn)!==he.getParameter(he.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const un=rn===Qg&&(Ye.has("EXT_color_buffer_half_float")||lt.isWebGL2&&Ye.has("EXT_color_buffer_float"));if(rn!==tu&&Ln.convert(rn)!==he.getParameter(he.IMPLEMENTATION_COLOR_READ_TYPE)&&!(rn===qc&&(lt.isWebGL2||Ye.has("OES_texture_float")||Ye.has("WEBGL_color_buffer_float")))&&!un){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Pe>=0&&Pe<=ne.width-He&&ze>=0&&ze<=ne.height-je&&he.readPixels(Pe,ze,He,je,Ln.convert(fn),Ln.convert(rn),Et)}finally{const Mt=H!==null?bt.get(H).__webglFramebuffer:null;Ke.bindFramebuffer(he.FRAMEBUFFER,Mt)}}},this.copyFramebufferToTexture=function(ne,Pe,ze=0){const He=Math.pow(2,-ze),je=Math.floor(Pe.image.width*He),Et=Math.floor(Pe.image.height*He);Ct.setTexture2D(Pe,0),he.copyTexSubImage2D(he.TEXTURE_2D,ze,0,0,ne.x,ne.y,je,Et),Ke.unbindTexture()},this.copyTextureToTexture=function(ne,Pe,ze,He=0){const je=Pe.image.width,Et=Pe.image.height,Yt=Ln.convert(ze.format),Jt=Ln.convert(ze.type);Ct.setTexture2D(ze,0),he.pixelStorei(he.UNPACK_FLIP_Y_WEBGL,ze.flipY),he.pixelStorei(he.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ze.premultiplyAlpha),he.pixelStorei(he.UNPACK_ALIGNMENT,ze.unpackAlignment),Pe.isDataTexture?he.texSubImage2D(he.TEXTURE_2D,He,ne.x,ne.y,je,Et,Yt,Jt,Pe.image.data):Pe.isCompressedTexture?he.compressedTexSubImage2D(he.TEXTURE_2D,He,ne.x,ne.y,Pe.mipmaps[0].width,Pe.mipmaps[0].height,Yt,Pe.mipmaps[0].data):he.texSubImage2D(he.TEXTURE_2D,He,ne.x,ne.y,Yt,Jt,Pe.image),He===0&&ze.generateMipmaps&&he.generateMipmap(he.TEXTURE_2D),Ke.unbindTexture()},this.copyTextureToTexture3D=function(ne,Pe,ze,He,je=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Et=ne.max.x-ne.min.x+1,Yt=ne.max.y-ne.min.y+1,Jt=ne.max.z-ne.min.z+1,Mt=Ln.convert(He.format),fn=Ln.convert(He.type);let rn;if(He.isData3DTexture)Ct.setTexture3D(He,0),rn=he.TEXTURE_3D;else if(He.isDataArrayTexture)Ct.setTexture2DArray(He,0),rn=he.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}he.pixelStorei(he.UNPACK_FLIP_Y_WEBGL,He.flipY),he.pixelStorei(he.UNPACK_PREMULTIPLY_ALPHA_WEBGL,He.premultiplyAlpha),he.pixelStorei(he.UNPACK_ALIGNMENT,He.unpackAlignment);const un=he.getParameter(he.UNPACK_ROW_LENGTH),ri=he.getParameter(he.UNPACK_IMAGE_HEIGHT),Zi=he.getParameter(he.UNPACK_SKIP_PIXELS),Gn=he.getParameter(he.UNPACK_SKIP_ROWS),Mi=he.getParameter(he.UNPACK_SKIP_IMAGES),$t=ze.isCompressedTexture?ze.mipmaps[0]:ze.image;he.pixelStorei(he.UNPACK_ROW_LENGTH,$t.width),he.pixelStorei(he.UNPACK_IMAGE_HEIGHT,$t.height),he.pixelStorei(he.UNPACK_SKIP_PIXELS,ne.min.x),he.pixelStorei(he.UNPACK_SKIP_ROWS,ne.min.y),he.pixelStorei(he.UNPACK_SKIP_IMAGES,ne.min.z),ze.isDataTexture||ze.isData3DTexture?he.texSubImage3D(rn,je,Pe.x,Pe.y,Pe.z,Et,Yt,Jt,Mt,fn,$t.data):ze.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),he.compressedTexSubImage3D(rn,je,Pe.x,Pe.y,Pe.z,Et,Yt,Jt,Mt,$t.data)):he.texSubImage3D(rn,je,Pe.x,Pe.y,Pe.z,Et,Yt,Jt,Mt,fn,$t),he.pixelStorei(he.UNPACK_ROW_LENGTH,un),he.pixelStorei(he.UNPACK_IMAGE_HEIGHT,ri),he.pixelStorei(he.UNPACK_SKIP_PIXELS,Zi),he.pixelStorei(he.UNPACK_SKIP_ROWS,Gn),he.pixelStorei(he.UNPACK_SKIP_IMAGES,Mi),je===0&&He.generateMipmaps&&he.generateMipmap(rn),Ke.unbindTexture()},this.initTexture=function(ne){ne.isCubeTexture?Ct.setTextureCube(ne,0):ne.isData3DTexture?Ct.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?Ct.setTexture2DArray(ne,0):Ct.setTexture2D(ne,0),Ke.unbindTexture()},this.resetState=function(){k=0,D=0,H=null,Ke.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Zc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===KS?"display-p3":"srgb",t.unpackColorSpace=hi.workingColorSpace===S0?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===es?Gf:lR}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Gf?es:ou}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class XV extends tT{}XV.prototype.isWebGL1Renderer=!0;class nT{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ot(e),this.density=t}clone(){return new nT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class iT{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Ot(e),this.near=t,this.far=i}clone(){return new iT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class rT extends Qn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class sT{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Iv,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ja()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ja()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ja()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ko=new re;class jp{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ko.fromBufferAttribute(this,t),ko.applyMatrix4(e),this.setXYZ(t,ko.x,ko.y,ko.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ko.fromBufferAttribute(this,t),ko.applyNormalMatrix(e),this.setXYZ(t,ko.x,ko.y,ko.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ko.fromBufferAttribute(this,t),ko.transformDirection(e),this.setXYZ(t,ko.x,ko.y,ko.z);return this}setX(e,t){return this.normalized&&(t=Rn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Rn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Rn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Rn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ua(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ua(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ua(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ua(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array),r=Rn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Rn(t,this.array),i=Rn(i,this.array),r=Rn(r,this.array),s=Rn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Ai(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new jp(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class _R extends yo{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ot(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ig;const cy=new re,rg=new re,sg=new re,og=new qe,uy=new qe,GV=new On,Zx=new re,hy=new re,Kx=new re,hO=new qe,l1=new qe,fO=new qe;class YV extends Qn{constructor(e=new _R){if(super(),this.isSprite=!0,this.type="Sprite",ig===void 0){ig=new Dn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new sT(t,5);ig.setIndex([0,1,2,0,2,3]),ig.setAttribute("position",new jp(i,3,0,!1)),ig.setAttribute("uv",new jp(i,2,3,!1))}this.geometry=ig,this.material=e,this.center=new qe(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),rg.setFromMatrixScale(this.matrixWorld),GV.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),sg.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&rg.multiplyScalar(-sg.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Jx(Zx.set(-.5,-.5,0),sg,o,rg,r,s),Jx(hy.set(.5,-.5,0),sg,o,rg,r,s),Jx(Kx.set(.5,.5,0),sg,o,rg,r,s),hO.set(0,0),l1.set(1,0),fO.set(1,1);let a=e.ray.intersectTriangle(Zx,hy,Kx,!1,cy);if(a===null&&(Jx(hy.set(-.5,.5,0),sg,o,rg,r,s),l1.set(0,1),a=e.ray.intersectTriangle(Zx,Kx,hy,!1,cy),a===null))return;const l=e.ray.origin.distanceTo(cy);l<e.near||l>e.far||t.push({distance:l,point:cy.clone(),uv:la.getInterpolation(cy,Zx,hy,Kx,hO,l1,fO,new qe),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Jx(n,e,t,i,r,s){og.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(uy.x=s*og.x-r*og.y,uy.y=r*og.x+s*og.y):uy.copy(og),n.copy(e),n.x+=uy.x,n.y+=uy.y,n.applyMatrix4(GV)}const Qx=new re,dO=new re;class qV extends Qn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Qx.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Qx);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Qx.setFromMatrixPosition(e.matrixWorld),dO.setFromMatrixPosition(this.matrixWorld);const i=Qx.distanceTo(dO)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),i>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const pO=new re,mO=new di,gO=new di,oie=new re,_O=new On,eb=new re,c1=new dc,yO=new On,u1=new sm;class ZV extends xs{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=xM,this.bindMatrix=new On,this.bindMatrixInverse=new On,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new hu),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,eb),this.boundingBox.expandByPoint(eb)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new dc),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,eb),this.boundingSphere.expandByPoint(eb)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),c1.copy(this.boundingSphere),c1.applyMatrix4(r),e.ray.intersectsSphere(c1)!==!1&&(yO.copy(r).invert(),u1.copy(e.ray).applyMatrix4(yO),!(this.boundingBox!==null&&u1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,u1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new di,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===xM?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===rV?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;mO.fromBufferAttribute(r.attributes.skinIndex,e),gO.fromBufferAttribute(r.attributes.skinWeight,e),pO.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=gO.getComponent(s);if(o!==0){const a=mO.getComponent(s);_O.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(oie.copy(pO).applyMatrix4(_O),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class yR extends Qn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class jg extends js{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Ar,u=Ar,d,m){super(null,o,a,l,c,u,r,s,d,m),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const vO=new On,aie=new On;class oT{constructor(e=[],t=[]){this.uuid=ja(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new On)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new On;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:aie;vO.multiplyMatrices(a,t[s]),vO.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new oT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=CV(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new jg(t,e,e,ca,qc);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new yR),this.bones.push(o),this.boneInverses.push(new On().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class n_ extends Ai{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ag=new On,xO=new On,tb=[],bO=new hu,lie=new On,fy=new xs,dy=new dc;class KV extends xs{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new n_(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,lie)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new hu),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,ag),bO.copy(e.boundingBox).applyMatrix4(ag),this.boundingBox.union(bO)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new dc),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,ag),dy.copy(e.boundingSphere).applyMatrix4(ag),this.boundingSphere.union(dy)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(fy.geometry=this.geometry,fy.material=this.material,fy.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),dy.copy(this.boundingSphere),dy.applyMatrix4(i),e.ray.intersectsSphere(dy)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,ag),xO.multiplyMatrices(i,ag),fy.matrixWorld=xO,fy.raycast(e,tb);for(let o=0,a=tb.length;o<a;o++){const l=tb[o];l.instanceId=s,l.object=this,t.push(l)}tb.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new n_(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class zo extends yo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ot(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const wO=new re,SO=new re,TO=new On,h1=new sm,nb=new dc;class Qf extends Qn{constructor(e=new Dn,t=new zo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)wO.fromBufferAttribute(t,r-1),SO.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=wO.distanceTo(SO);e.setAttribute("lineDistance",new qt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),nb.copy(i.boundingSphere),nb.applyMatrix4(r),nb.radius+=s,e.ray.intersectsSphere(nb)===!1)return;TO.copy(r).invert(),h1.copy(e.ray).applyMatrix4(TO);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new re,u=new re,d=new re,m=new re,y=this.isLineSegments?2:1,x=i.index,S=i.attributes.position;if(x!==null){const w=Math.max(0,o.start),P=Math.min(x.count,o.start+o.count);for(let M=w,I=P-1;M<I;M+=y){const k=x.getX(M),D=x.getX(M+1);if(c.fromBufferAttribute(S,k),u.fromBufferAttribute(S,D),h1.distanceSqToSegment(c,u,m,d)>l)continue;m.applyMatrix4(this.matrixWorld);const W=e.ray.origin.distanceTo(m);W<e.near||W>e.far||t.push({distance:W,point:d.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{const w=Math.max(0,o.start),P=Math.min(S.count,o.start+o.count);for(let M=w,I=P-1;M<I;M+=y){if(c.fromBufferAttribute(S,M),u.fromBufferAttribute(S,M+1),h1.distanceSqToSegment(c,u,m,d)>l)continue;m.applyMatrix4(this.matrixWorld);const D=e.ray.origin.distanceTo(m);D<e.near||D>e.far||t.push({distance:D,point:d.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const EO=new re,AO=new re;class fu extends Qf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)EO.fromBufferAttribute(t,r),AO.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+EO.distanceTo(AO);e.setAttribute("lineDistance",new qt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class JV extends Qf{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class vR extends yo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ot(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const MO=new On,JM=new sm,ib=new dc,rb=new re;class QV extends Qn{constructor(e=new Dn,t=new vR){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ib.copy(i.boundingSphere),ib.applyMatrix4(r),ib.radius+=s,e.ray.intersectsSphere(ib)===!1)return;MO.copy(r).invert(),JM.copy(e.ray).applyMatrix4(MO);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(c!==null){const m=Math.max(0,o.start),y=Math.min(c.count,o.start+o.count);for(let x=m,T=y;x<T;x++){const S=c.getX(x);rb.fromBufferAttribute(d,S),CO(rb,S,l,r,e,t,this)}}else{const m=Math.max(0,o.start),y=Math.min(d.count,o.start+o.count);for(let x=m,T=y;x<T;x++)rb.fromBufferAttribute(d,x),CO(rb,x,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function CO(n,e,t,i,r,s,o){const a=JM.distanceSqToPoint(n);if(a<t){const l=new re;JM.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class cie extends js{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Mr,this.magFilter=s!==void 0?s:Mr,this.generateMipmaps=!1;const u=this;function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class uie extends js{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ar,this.minFilter=Ar,this.generateMipmaps=!1,this.needsUpdate=!0}}class aT extends js{constructor(e,t,i,r,s,o,a,l,c,u,d,m){super(null,o,a,l,c,u,r,s,d,m),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class hie extends aT{constructor(e,t,i,r,s,o){super(e,t,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=fo}}class fie extends aT{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,mh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class die extends js{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class pc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const u=i[r],m=i[r+1]-u,y=(o-u)/m;return(r+y)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new qe:new re);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new re,r=[],s=[],o=[],a=new re,l=new On;for(let y=0;y<=e;y++){const x=y/e;r[y]=this.getTangentAt(x,new re)}s[0]=new re,o[0]=new re;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),m=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),m<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let y=1;y<=e;y++){if(s[y]=s[y-1].clone(),o[y]=o[y-1].clone(),a.crossVectors(r[y-1],r[y]),a.length()>Number.EPSILON){a.normalize();const x=Math.acos(dr(r[y-1].dot(r[y]),-1,1));s[y].applyMatrix4(l.makeRotationAxis(a,x))}o[y].crossVectors(r[y],s[y])}if(t===!0){let y=Math.acos(dr(s[0].dot(s[e]),-1,1));y/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(y=-y);for(let x=1;x<=e;x++)s[x].applyMatrix4(l.makeRotationAxis(r[x],y*x)),o[x].crossVectors(r[x],s[x])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class lT extends pc{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new qe,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),m=l-this.aX,y=c-this.aY;l=m*u-y*d+this.aX,c=m*d+y*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class e6 extends lT{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function xR(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let m=(o-s)/c-(a-s)/(c+u)+(a-o)/u,y=(a-o)/u-(l-o)/(u+d)+(l-a)/d;m*=u,y*=u,r(o,a,m,y)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const sb=new re,f1=new xR,d1=new xR,p1=new xR;class t6 extends pc{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new re){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(sb.subVectors(r[0],r[1]).add(r[0]),c=sb);const d=r[a%s],m=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(sb.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=sb),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let x=Math.pow(c.distanceToSquared(d),y),T=Math.pow(d.distanceToSquared(m),y),S=Math.pow(m.distanceToSquared(u),y);T<1e-4&&(T=1),x<1e-4&&(x=T),S<1e-4&&(S=T),f1.initNonuniformCatmullRom(c.x,d.x,m.x,u.x,x,T,S),d1.initNonuniformCatmullRom(c.y,d.y,m.y,u.y,x,T,S),p1.initNonuniformCatmullRom(c.z,d.z,m.z,u.z,x,T,S)}else this.curveType==="catmullrom"&&(f1.initCatmullRom(c.x,d.x,m.x,u.x,this.tension),d1.initCatmullRom(c.y,d.y,m.y,u.y,this.tension),p1.initCatmullRom(c.z,d.z,m.z,u.z,this.tension));return i.set(f1.calc(l),d1.calc(l),p1.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new re().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function PO(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function pie(n,e){const t=1-n;return t*t*e}function mie(n,e){return 2*(1-n)*n*e}function gie(n,e){return n*n*e}function Yy(n,e,t,i){return pie(n,e)+mie(n,t)+gie(n,i)}function _ie(n,e){const t=1-n;return t*t*t*e}function yie(n,e){const t=1-n;return 3*t*t*n*e}function vie(n,e){return 3*(1-n)*n*n*e}function xie(n,e){return n*n*n*e}function qy(n,e,t,i,r){return _ie(n,e)+yie(n,t)+vie(n,i)+xie(n,r)}class bR extends pc{constructor(e=new qe,t=new qe,i=new qe,r=new qe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new qe){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(qy(e,r.x,s.x,o.x,a.x),qy(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class n6 extends pc{constructor(e=new re,t=new re,i=new re,r=new re){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new re){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(qy(e,r.x,s.x,o.x,a.x),qy(e,r.y,s.y,o.y,a.y),qy(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class wR extends pc{constructor(e=new qe,t=new qe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new qe){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new qe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class i6 extends pc{constructor(e=new re,t=new re){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new re){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new re){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class SR extends pc{constructor(e=new qe,t=new qe,i=new qe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new qe){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Yy(e,r.x,s.x,o.x),Yy(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class TR extends pc{constructor(e=new re,t=new re,i=new re){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new re){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Yy(e,r.x,s.x,o.x),Yy(e,r.y,s.y,o.y),Yy(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ER extends pc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new qe){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(PO(a,l.x,c.x,u.x,d.x),PO(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new qe().fromArray(r))}return this}}var Ww=Object.freeze({__proto__:null,ArcCurve:e6,CatmullRomCurve3:t6,CubicBezierCurve:bR,CubicBezierCurve3:n6,EllipseCurve:lT,LineCurve:wR,LineCurve3:i6,QuadraticBezierCurve:SR,QuadraticBezierCurve3:TR,SplineCurve:ER});class r6 extends pc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Ww[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new Ww[r.type]().fromJSON(r))}return this}}class Lv extends r6{constructor(e){super(),this.type="Path",this.currentPoint=new qe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new wR(this.currentPoint.clone(),new qe(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new SR(this.currentPoint.clone(),new qe(e,t),new qe(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new bR(this.currentPoint.clone(),new qe(e,t),new qe(i,r),new qe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new ER(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new lT(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class M0 extends Dn{constructor(e=[new qe(0,-.5),new qe(.5,0),new qe(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=dr(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/t,d=new re,m=new qe,y=new re,x=new re,T=new re;let S=0,w=0;for(let P=0;P<=e.length-1;P++)switch(P){case 0:S=e[P+1].x-e[P].x,w=e[P+1].y-e[P].y,y.x=w*1,y.y=-S,y.z=w*0,T.copy(y),y.normalize(),l.push(y.x,y.y,y.z);break;case e.length-1:l.push(T.x,T.y,T.z);break;default:S=e[P+1].x-e[P].x,w=e[P+1].y-e[P].y,y.x=w*1,y.y=-S,y.z=w*0,x.copy(y),y.x+=T.x,y.y+=T.y,y.z+=T.z,y.normalize(),l.push(y.x,y.y,y.z),T.copy(x)}for(let P=0;P<=t;P++){const M=i+P*u*r,I=Math.sin(M),k=Math.cos(M);for(let D=0;D<=e.length-1;D++){d.x=e[D].x*I,d.y=e[D].y,d.z=e[D].x*k,o.push(d.x,d.y,d.z),m.x=P/t,m.y=D/(e.length-1),a.push(m.x,m.y);const H=l[3*D+0]*I,W=l[3*D+1],z=l[3*D+0]*k;c.push(H,W,z)}}for(let P=0;P<t;P++)for(let M=0;M<e.length-1;M++){const I=M+P*e.length,k=I,D=I+e.length,H=I+e.length+1,W=I+1;s.push(k,D,W),s.push(H,W,D)}this.setIndex(s),this.setAttribute("position",new qt(o,3)),this.setAttribute("uv",new qt(a,2)),this.setAttribute("normal",new qt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new M0(e.points,e.segments,e.phiStart,e.phiLength)}}class cT extends M0{constructor(e=1,t=1,i=4,r=8){const s=new Lv;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new cT(e.radius,e.length,e.capSegments,e.radialSegments)}}class uT extends Dn{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new re,u=new qe;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,m=3;d<=t;d++,m+=3){const y=i+d/t*r;c.x=e*Math.cos(y),c.y=e*Math.sin(y),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[m]/e+1)/2,u.y=(o[m+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new qt(o,3)),this.setAttribute("normal",new qt(a,3)),this.setAttribute("uv",new qt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uT(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class R_ extends Dn{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],d=[],m=[],y=[];let x=0;const T=[],S=i/2;let w=0;P(),o===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(u),this.setAttribute("position",new qt(d,3)),this.setAttribute("normal",new qt(m,3)),this.setAttribute("uv",new qt(y,2));function P(){const I=new re,k=new re;let D=0;const H=(t-e)/i;for(let W=0;W<=s;W++){const z=[],j=W/s,J=j*(t-e)+e;for(let le=0;le<=r;le++){const ge=le/r,te=ge*l+a,de=Math.sin(te),ve=Math.cos(te);k.x=J*de,k.y=-j*i+S,k.z=J*ve,d.push(k.x,k.y,k.z),I.set(de,H,ve).normalize(),m.push(I.x,I.y,I.z),y.push(ge,1-j),z.push(x++)}T.push(z)}for(let W=0;W<r;W++)for(let z=0;z<s;z++){const j=T[z][W],J=T[z+1][W],le=T[z+1][W+1],ge=T[z][W+1];u.push(j,J,ge),u.push(J,le,ge),D+=6}c.addGroup(w,D,0),w+=D}function M(I){const k=x,D=new qe,H=new re;let W=0;const z=I===!0?e:t,j=I===!0?1:-1;for(let le=1;le<=r;le++)d.push(0,S*j,0),m.push(0,j,0),y.push(.5,.5),x++;const J=x;for(let le=0;le<=r;le++){const te=le/r*l+a,de=Math.cos(te),ve=Math.sin(te);H.x=z*ve,H.y=S*j,H.z=z*de,d.push(H.x,H.y,H.z),m.push(0,j,0),D.x=de*.5+.5,D.y=ve*.5*j+.5,y.push(D.x,D.y),x++}for(let le=0;le<r;le++){const ge=k+le,te=J+le;I===!0?u.push(te,te+1,ge):u.push(te+1,te,ge),W+=3}c.addGroup(w,W,I===!0?1:2),w+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new R_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class hT extends R_{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new hT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ud extends Dn{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];a(r),c(i),u(),this.setAttribute("position",new qt(s,3)),this.setAttribute("normal",new qt(s.slice(),3)),this.setAttribute("uv",new qt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(P){const M=new re,I=new re,k=new re;for(let D=0;D<t.length;D+=3)y(t[D+0],M),y(t[D+1],I),y(t[D+2],k),l(M,I,k,P)}function l(P,M,I,k){const D=k+1,H=[];for(let W=0;W<=D;W++){H[W]=[];const z=P.clone().lerp(I,W/D),j=M.clone().lerp(I,W/D),J=D-W;for(let le=0;le<=J;le++)le===0&&W===D?H[W][le]=z:H[W][le]=z.clone().lerp(j,le/J)}for(let W=0;W<D;W++)for(let z=0;z<2*(D-W)-1;z++){const j=Math.floor(z/2);z%2===0?(m(H[W][j+1]),m(H[W+1][j]),m(H[W][j])):(m(H[W][j+1]),m(H[W+1][j+1]),m(H[W+1][j]))}}function c(P){const M=new re;for(let I=0;I<s.length;I+=3)M.x=s[I+0],M.y=s[I+1],M.z=s[I+2],M.normalize().multiplyScalar(P),s[I+0]=M.x,s[I+1]=M.y,s[I+2]=M.z}function u(){const P=new re;for(let M=0;M<s.length;M+=3){P.x=s[M+0],P.y=s[M+1],P.z=s[M+2];const I=S(P)/2/Math.PI+.5,k=w(P)/Math.PI+.5;o.push(I,1-k)}x(),d()}function d(){for(let P=0;P<o.length;P+=6){const M=o[P+0],I=o[P+2],k=o[P+4],D=Math.max(M,I,k),H=Math.min(M,I,k);D>.9&&H<.1&&(M<.2&&(o[P+0]+=1),I<.2&&(o[P+2]+=1),k<.2&&(o[P+4]+=1))}}function m(P){s.push(P.x,P.y,P.z)}function y(P,M){const I=P*3;M.x=e[I+0],M.y=e[I+1],M.z=e[I+2]}function x(){const P=new re,M=new re,I=new re,k=new re,D=new qe,H=new qe,W=new qe;for(let z=0,j=0;z<s.length;z+=9,j+=6){P.set(s[z+0],s[z+1],s[z+2]),M.set(s[z+3],s[z+4],s[z+5]),I.set(s[z+6],s[z+7],s[z+8]),D.set(o[j+0],o[j+1]),H.set(o[j+2],o[j+3]),W.set(o[j+4],o[j+5]),k.copy(P).add(M).add(I).divideScalar(3);const J=S(k);T(D,j+0,P,J),T(H,j+2,M,J),T(W,j+4,I,J)}}function T(P,M,I,k){k<0&&P.x===1&&(o[M]=P.x-1),I.x===0&&I.z===0&&(o[M]=k/2/Math.PI+.5)}function S(P){return Math.atan2(P.z,-P.x)}function w(P){return Math.atan2(-P.y,Math.sqrt(P.x*P.x+P.z*P.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ud(e.vertices,e.indices,e.radius,e.details)}}class fT extends ud{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new fT(e.radius,e.detail)}}const ob=new re,ab=new re,m1=new re,lb=new la;class s6 extends Dn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Mp*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),m={},y=[];for(let x=0;x<l;x+=3){o?(c[0]=o.getX(x),c[1]=o.getX(x+1),c[2]=o.getX(x+2)):(c[0]=x,c[1]=x+1,c[2]=x+2);const{a:T,b:S,c:w}=lb;if(T.fromBufferAttribute(a,c[0]),S.fromBufferAttribute(a,c[1]),w.fromBufferAttribute(a,c[2]),lb.getNormal(m1),d[0]=`${Math.round(T.x*r)},${Math.round(T.y*r)},${Math.round(T.z*r)}`,d[1]=`${Math.round(S.x*r)},${Math.round(S.y*r)},${Math.round(S.z*r)}`,d[2]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let P=0;P<3;P++){const M=(P+1)%3,I=d[P],k=d[M],D=lb[u[P]],H=lb[u[M]],W=`${I}_${k}`,z=`${k}_${I}`;z in m&&m[z]?(m1.dot(m[z].normal)<=s&&(y.push(D.x,D.y,D.z),y.push(H.x,H.y,H.z)),m[z]=null):W in m||(m[W]={index0:c[P],index1:c[M],normal:m1.clone()})}}for(const x in m)if(m[x]){const{index0:T,index1:S}=m[x];ob.fromBufferAttribute(a,T),ab.fromBufferAttribute(a,S),y.push(ob.x,ob.y,ob.z),y.push(ab.x,ab.y,ab.z)}this.setAttribute("position",new qt(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Pp extends Lv{constructor(e){super(e),this.uuid=ja(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Lv().fromJSON(r))}return this}}const bie={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=o6(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,d,m,y;if(i&&(s=Aie(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let x=t;x<r;x+=t)d=n[x],m=n[x+1],d<a&&(a=d),m<l&&(l=m),d>c&&(c=d),m>u&&(u=m);y=Math.max(c-a,u-l),y=y!==0?32767/y:0}return Nv(s,o,t,a,l,y,0),o}};function o6(n,e,t,i,r){let s,o;if(r===Fie(n,e,t,i)>0)for(s=e;s<t;s+=i)o=RO(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=RO(s,n[s],n[s+1],o);return o&&dT(o,o.next)&&(Fv(o),o=o.next),o}function $p(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(dT(t,t.next)||nr(t.prev,t,t.next)===0)){if(Fv(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Nv(n,e,t,i,r,s,o){if(!n)return;!o&&s&&Iie(n,i,r,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?Sie(n,i,r,s):wie(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Fv(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=Tie($p(n),e,t),Nv(n,e,t,i,r,s,2)):o===2&&Eie(n,e,t,i,r,s):Nv($p(n),e,t,i,r,s,1);break}}}function wie(n){const e=n.prev,t=n,i=n.next;if(nr(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,m=r>s?r>o?r:o:s>o?s:o,y=a>l?a>c?a:c:l>c?l:c;let x=i.next;for(;x!==e;){if(x.x>=u&&x.x<=m&&x.y>=d&&x.y<=y&&Ag(r,a,s,l,o,c,x.x,x.y)&&nr(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function Sie(n,e,t,i){const r=n.prev,s=n,o=n.next;if(nr(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,d=s.y,m=o.y,y=a<l?a<c?a:c:l<c?l:c,x=u<d?u<m?u:m:d<m?d:m,T=a>l?a>c?a:c:l>c?l:c,S=u>d?u>m?u:m:d>m?d:m,w=QM(y,x,e,t,i),P=QM(T,S,e,t,i);let M=n.prevZ,I=n.nextZ;for(;M&&M.z>=w&&I&&I.z<=P;){if(M.x>=y&&M.x<=T&&M.y>=x&&M.y<=S&&M!==r&&M!==o&&Ag(a,u,l,d,c,m,M.x,M.y)&&nr(M.prev,M,M.next)>=0||(M=M.prevZ,I.x>=y&&I.x<=T&&I.y>=x&&I.y<=S&&I!==r&&I!==o&&Ag(a,u,l,d,c,m,I.x,I.y)&&nr(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;M&&M.z>=w;){if(M.x>=y&&M.x<=T&&M.y>=x&&M.y<=S&&M!==r&&M!==o&&Ag(a,u,l,d,c,m,M.x,M.y)&&nr(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;I&&I.z<=P;){if(I.x>=y&&I.x<=T&&I.y>=x&&I.y<=S&&I!==r&&I!==o&&Ag(a,u,l,d,c,m,I.x,I.y)&&nr(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function Tie(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!dT(r,s)&&a6(r,i,i.next,s)&&Dv(r,s)&&Dv(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Fv(i),Fv(i.next),i=n=s),i=i.next}while(i!==n);return $p(i)}function Eie(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Lie(o,a)){let l=l6(o,a);o=$p(o,o.next),l=$p(l,l.next),Nv(o,e,t,i,r,s,0),Nv(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function Aie(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=o6(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(Oie(c));for(r.sort(Mie),s=0;s<r.length;s++)t=Cie(r[s],t);return t}function Mie(n,e){return n.x-e.x}function Cie(n,e){const t=Pie(n,e);if(!t)return e;const i=l6(t,n);return $p(i,i.next),$p(t,t.next)}function Pie(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const m=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=s&&m>i&&(i=m,r=t.x<t.next.x?t:t.next,m===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let u=1/0,d;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&Ag(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),Dv(t,n)&&(d<u||d===u&&(t.x>r.x||t.x===r.x&&Rie(r,t)))&&(r=t,u=d)),t=t.next;while(t!==a);return r}function Rie(n,e){return nr(n.prev,n,e.prev)<0&&nr(e.next,n,n.next)<0}function Iie(n,e,t,i){let r=n;do r.z===0&&(r.z=QM(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,kie(r)}function kie(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1);return n}function QM(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Oie(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Ag(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Lie(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Nie(n,e)&&(Dv(n,e)&&Dv(e,n)&&Die(n,e)&&(nr(n.prev,n,e.prev)||nr(n,e.prev,e))||dT(n,e)&&nr(n.prev,n,n.next)>0&&nr(e.prev,e,e.next)>0)}function nr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function dT(n,e){return n.x===e.x&&n.y===e.y}function a6(n,e,t,i){const r=ub(nr(n,e,t)),s=ub(nr(n,e,i)),o=ub(nr(t,i,n)),a=ub(nr(t,i,e));return!!(r!==s&&o!==a||r===0&&cb(n,t,e)||s===0&&cb(n,i,e)||o===0&&cb(t,n,i)||a===0&&cb(t,e,i))}function cb(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function ub(n){return n>0?1:n<0?-1:0}function Nie(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&a6(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Dv(n,e){return nr(n.prev,n,n.next)<0?nr(n,e,n.next)>=0&&nr(n,n.prev,e)>=0:nr(n,e,n.prev)<0||nr(n,n.next,e)<0}function Die(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function l6(n,e){const t=new eC(n.i,n.x,n.y),i=new eC(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function RO(n,e,t,i){const r=new eC(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Fv(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function eC(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Fie(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class nu{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return nu.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];IO(e),kO(i,e);let o=e.length;t.forEach(IO);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,kO(i,t[l]);const a=bie.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function IO(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function kO(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class pT extends Dn{constructor(e=new Pp([new qe(.5,.5),new qe(-.5,.5),new qe(-.5,-.5),new qe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new qt(r,3)),this.setAttribute("uv",new qt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let m=t.bevelEnabled!==void 0?t.bevelEnabled:!0,y=t.bevelThickness!==void 0?t.bevelThickness:.2,x=t.bevelSize!==void 0?t.bevelSize:y-.1,T=t.bevelOffset!==void 0?t.bevelOffset:0,S=t.bevelSegments!==void 0?t.bevelSegments:3;const w=t.extrudePath,P=t.UVGenerator!==void 0?t.UVGenerator:Uie;let M,I=!1,k,D,H,W;w&&(M=w.getSpacedPoints(u),I=!0,m=!1,k=w.computeFrenetFrames(u,!1),D=new re,H=new re,W=new re),m||(S=0,y=0,x=0,T=0);const z=a.extractPoints(c);let j=z.shape;const J=z.holes;if(!nu.isClockWise(j)){j=j.reverse();for(let he=0,nt=J.length;he<nt;he++){const Ye=J[he];nu.isClockWise(Ye)&&(J[he]=Ye.reverse())}}const ge=nu.triangulateShape(j,J),te=j;for(let he=0,nt=J.length;he<nt;he++){const Ye=J[he];j=j.concat(Ye)}function de(he,nt,Ye){return nt||console.error("THREE.ExtrudeGeometry: vec does not exist"),he.clone().addScaledVector(nt,Ye)}const ve=j.length,me=ge.length;function q(he,nt,Ye){let lt,Ke,Ut;const bt=he.x-nt.x,Ct=he.y-nt.y,Zt=Ye.x-he.x,ln=Ye.y-he.y,Xn=bt*bt+Ct*Ct,ae=bt*ln-Ct*Zt;if(Math.abs(ae)>Number.EPSILON){const Q=Math.sqrt(Xn),Ne=Math.sqrt(Zt*Zt+ln*ln),ct=nt.x-Ct/Q,et=nt.y+bt/Q,ot=Ye.x-ln/Ne,Bt=Ye.y+Zt/Ne,dt=((ot-ct)*ln-(Bt-et)*Zt)/(bt*ln-Ct*Zt);lt=ct+bt*dt-he.x,Ke=et+Ct*dt-he.y;const vt=lt*lt+Ke*Ke;if(vt<=2)return new qe(lt,Ke);Ut=Math.sqrt(vt/2)}else{let Q=!1;bt>Number.EPSILON?Zt>Number.EPSILON&&(Q=!0):bt<-Number.EPSILON?Zt<-Number.EPSILON&&(Q=!0):Math.sign(Ct)===Math.sign(ln)&&(Q=!0),Q?(lt=-Ct,Ke=bt,Ut=Math.sqrt(Xn)):(lt=bt,Ke=Ct,Ut=Math.sqrt(Xn/2))}return new qe(lt/Ut,Ke/Ut)}const ie=[];for(let he=0,nt=te.length,Ye=nt-1,lt=he+1;he<nt;he++,Ye++,lt++)Ye===nt&&(Ye=0),lt===nt&&(lt=0),ie[he]=q(te[he],te[Ye],te[lt]);const X=[];let Y,ce=ie.concat();for(let he=0,nt=J.length;he<nt;he++){const Ye=J[he];Y=[];for(let lt=0,Ke=Ye.length,Ut=Ke-1,bt=lt+1;lt<Ke;lt++,Ut++,bt++)Ut===Ke&&(Ut=0),bt===Ke&&(bt=0),Y[lt]=q(Ye[lt],Ye[Ut],Ye[bt]);X.push(Y),ce=ce.concat(Y)}for(let he=0;he<S;he++){const nt=he/S,Ye=y*Math.cos(nt*Math.PI/2),lt=x*Math.sin(nt*Math.PI/2)+T;for(let Ke=0,Ut=te.length;Ke<Ut;Ke++){const bt=de(te[Ke],ie[Ke],lt);at(bt.x,bt.y,-Ye)}for(let Ke=0,Ut=J.length;Ke<Ut;Ke++){const bt=J[Ke];Y=X[Ke];for(let Ct=0,Zt=bt.length;Ct<Zt;Ct++){const ln=de(bt[Ct],Y[Ct],lt);at(ln.x,ln.y,-Ye)}}}const Me=x+T;for(let he=0;he<ve;he++){const nt=m?de(j[he],ce[he],Me):j[he];I?(H.copy(k.normals[0]).multiplyScalar(nt.x),D.copy(k.binormals[0]).multiplyScalar(nt.y),W.copy(M[0]).add(H).add(D),at(W.x,W.y,W.z)):at(nt.x,nt.y,0)}for(let he=1;he<=u;he++)for(let nt=0;nt<ve;nt++){const Ye=m?de(j[nt],ce[nt],Me):j[nt];I?(H.copy(k.normals[he]).multiplyScalar(Ye.x),D.copy(k.binormals[he]).multiplyScalar(Ye.y),W.copy(M[he]).add(H).add(D),at(W.x,W.y,W.z)):at(Ye.x,Ye.y,d/u*he)}for(let he=S-1;he>=0;he--){const nt=he/S,Ye=y*Math.cos(nt*Math.PI/2),lt=x*Math.sin(nt*Math.PI/2)+T;for(let Ke=0,Ut=te.length;Ke<Ut;Ke++){const bt=de(te[Ke],ie[Ke],lt);at(bt.x,bt.y,d+Ye)}for(let Ke=0,Ut=J.length;Ke<Ut;Ke++){const bt=J[Ke];Y=X[Ke];for(let Ct=0,Zt=bt.length;Ct<Zt;Ct++){const ln=de(bt[Ct],Y[Ct],lt);I?at(ln.x,ln.y+M[u-1].y,M[u-1].x+Ye):at(ln.x,ln.y,d+Ye)}}}Re(),Fe();function Re(){const he=r.length/3;if(m){let nt=0,Ye=ve*nt;for(let lt=0;lt<me;lt++){const Ke=ge[lt];pt(Ke[2]+Ye,Ke[1]+Ye,Ke[0]+Ye)}nt=u+S*2,Ye=ve*nt;for(let lt=0;lt<me;lt++){const Ke=ge[lt];pt(Ke[0]+Ye,Ke[1]+Ye,Ke[2]+Ye)}}else{for(let nt=0;nt<me;nt++){const Ye=ge[nt];pt(Ye[2],Ye[1],Ye[0])}for(let nt=0;nt<me;nt++){const Ye=ge[nt];pt(Ye[0]+ve*u,Ye[1]+ve*u,Ye[2]+ve*u)}}i.addGroup(he,r.length/3-he,0)}function Fe(){const he=r.length/3;let nt=0;Be(te,nt),nt+=te.length;for(let Ye=0,lt=J.length;Ye<lt;Ye++){const Ke=J[Ye];Be(Ke,nt),nt+=Ke.length}i.addGroup(he,r.length/3-he,1)}function Be(he,nt){let Ye=he.length;for(;--Ye>=0;){const lt=Ye;let Ke=Ye-1;Ke<0&&(Ke=he.length-1);for(let Ut=0,bt=u+S*2;Ut<bt;Ut++){const Ct=ve*Ut,Zt=ve*(Ut+1),ln=nt+lt+Ct,Xn=nt+Ke+Ct,ae=nt+Ke+Zt,Q=nt+lt+Zt;Ft(ln,Xn,ae,Q)}}}function at(he,nt,Ye){l.push(he),l.push(nt),l.push(Ye)}function pt(he,nt,Ye){yn(he),yn(nt),yn(Ye);const lt=r.length/3,Ke=P.generateTopUV(i,r,lt-3,lt-2,lt-1);Rt(Ke[0]),Rt(Ke[1]),Rt(Ke[2])}function Ft(he,nt,Ye,lt){yn(he),yn(nt),yn(lt),yn(nt),yn(Ye),yn(lt);const Ke=r.length/3,Ut=P.generateSideWallUV(i,r,Ke-6,Ke-3,Ke-2,Ke-1);Rt(Ut[0]),Rt(Ut[1]),Rt(Ut[3]),Rt(Ut[1]),Rt(Ut[2]),Rt(Ut[3])}function yn(he){r.push(l[he*3+0]),r.push(l[he*3+1]),r.push(l[he*3+2])}function Rt(he){s.push(he.x),s.push(he.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return Bie(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Ww[r.type]().fromJSON(r)),new pT(i,e.options)}}const Uie={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],u=e[r*3+1];return[new qe(s,o),new qe(a,l),new qe(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[i*3],u=e[i*3+1],d=e[i*3+2],m=e[r*3],y=e[r*3+1],x=e[r*3+2],T=e[s*3],S=e[s*3+1],w=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new qe(o,1-l),new qe(c,1-d),new qe(m,1-x),new qe(T,1-w)]:[new qe(a,1-l),new qe(u,1-d),new qe(y,1-x),new qe(S,1-w)]}};function Bie(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class mT extends ud{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new mT(e.radius,e.detail)}}class C0 extends ud{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new C0(e.radius,e.detail)}}class gT extends Dn{constructor(e=.5,t=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],c=[],u=[];let d=e;const m=(t-e)/r,y=new re,x=new qe;for(let T=0;T<=r;T++){for(let S=0;S<=i;S++){const w=s+S/i*o;y.x=d*Math.cos(w),y.y=d*Math.sin(w),l.push(y.x,y.y,y.z),c.push(0,0,1),x.x=(y.x/t+1)/2,x.y=(y.y/t+1)/2,u.push(x.x,x.y)}d+=m}for(let T=0;T<r;T++){const S=T*(i+1);for(let w=0;w<i;w++){const P=w+S,M=P,I=P+i+1,k=P+i+2,D=P+1;a.push(M,I,D),a.push(I,k,D)}}this.setIndex(a),this.setAttribute("position",new qt(l,3)),this.setAttribute("normal",new qt(c,3)),this.setAttribute("uv",new qt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gT(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class _T extends Dn{constructor(e=new Pp([new qe(0,.5),new qe(-.5,-.5),new qe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new qt(r,3)),this.setAttribute("normal",new qt(s,3)),this.setAttribute("uv",new qt(o,2));function c(u){const d=r.length/3,m=u.extractPoints(t);let y=m.shape;const x=m.holes;nu.isClockWise(y)===!1&&(y=y.reverse());for(let S=0,w=x.length;S<w;S++){const P=x[S];nu.isClockWise(P)===!0&&(x[S]=P.reverse())}const T=nu.triangulateShape(y,x);for(let S=0,w=x.length;S<w;S++){const P=x[S];y=y.concat(P)}for(let S=0,w=y.length;S<w;S++){const P=y[S];r.push(P.x,P.y,0),s.push(0,0,1),o.push(P.x,P.y)}for(let S=0,w=T.length;S<w;S++){const P=T[S],M=P[0]+d,I=P[1]+d,k=P[2]+d;i.push(M,I,k),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return zie(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}return new _T(i,e.curveSegments)}}function zie(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class I_ extends Dn{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new re,m=new re,y=[],x=[],T=[],S=[];for(let w=0;w<=i;w++){const P=[],M=w/i;let I=0;w===0&&o===0?I=.5/t:w===i&&l===Math.PI&&(I=-.5/t);for(let k=0;k<=t;k++){const D=k/t;d.x=-e*Math.cos(r+D*s)*Math.sin(o+M*a),d.y=e*Math.cos(o+M*a),d.z=e*Math.sin(r+D*s)*Math.sin(o+M*a),x.push(d.x,d.y,d.z),m.copy(d).normalize(),T.push(m.x,m.y,m.z),S.push(D+I,1-M),P.push(c++)}u.push(P)}for(let w=0;w<i;w++)for(let P=0;P<t;P++){const M=u[w][P+1],I=u[w][P],k=u[w+1][P],D=u[w+1][P+1];(w!==0||o>0)&&y.push(M,I,D),(w!==i-1||l<Math.PI)&&y.push(I,k,D)}this.setIndex(y),this.setAttribute("position",new qt(x,3)),this.setAttribute("normal",new qt(T,3)),this.setAttribute("uv",new qt(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new I_(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class yT extends ud{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new yT(e.radius,e.detail)}}class vT extends Dn{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new re,d=new re,m=new re;for(let y=0;y<=i;y++)for(let x=0;x<=r;x++){const T=x/r*s,S=y/i*Math.PI*2;d.x=(e+t*Math.cos(S))*Math.cos(T),d.y=(e+t*Math.cos(S))*Math.sin(T),d.z=t*Math.sin(S),a.push(d.x,d.y,d.z),u.x=e*Math.cos(T),u.y=e*Math.sin(T),m.subVectors(d,u).normalize(),l.push(m.x,m.y,m.z),c.push(x/r),c.push(y/i)}for(let y=1;y<=i;y++)for(let x=1;x<=r;x++){const T=(r+1)*y+x-1,S=(r+1)*(y-1)+x-1,w=(r+1)*(y-1)+x,P=(r+1)*y+x;o.push(T,S,P),o.push(S,w,P)}this.setIndex(o),this.setAttribute("position",new qt(a,3)),this.setAttribute("normal",new qt(l,3)),this.setAttribute("uv",new qt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vT(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class xT extends Dn{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],u=[],d=new re,m=new re,y=new re,x=new re,T=new re,S=new re,w=new re;for(let M=0;M<=i;++M){const I=M/i*s*Math.PI*2;P(I,s,o,e,y),P(I+.01,s,o,e,x),S.subVectors(x,y),w.addVectors(x,y),T.crossVectors(S,w),w.crossVectors(T,S),T.normalize(),w.normalize();for(let k=0;k<=r;++k){const D=k/r*Math.PI*2,H=-t*Math.cos(D),W=t*Math.sin(D);d.x=y.x+(H*w.x+W*T.x),d.y=y.y+(H*w.y+W*T.y),d.z=y.z+(H*w.z+W*T.z),l.push(d.x,d.y,d.z),m.subVectors(d,y).normalize(),c.push(m.x,m.y,m.z),u.push(M/i),u.push(k/r)}}for(let M=1;M<=i;M++)for(let I=1;I<=r;I++){const k=(r+1)*(M-1)+(I-1),D=(r+1)*M+(I-1),H=(r+1)*M+I,W=(r+1)*(M-1)+I;a.push(k,D,W),a.push(D,H,W)}this.setIndex(a),this.setAttribute("position",new qt(l,3)),this.setAttribute("normal",new qt(c,3)),this.setAttribute("uv",new qt(u,2));function P(M,I,k,D,H){const W=Math.cos(M),z=Math.sin(M),j=k/I*M,J=Math.cos(j);H.x=D*(2+J)*.5*W,H.y=D*(2+J)*z*.5,H.z=D*Math.sin(j)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xT(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class bT extends Dn{constructor(e=new TR(new re(-1,-1,0),new re(-1,1,0),new re(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new re,l=new re,c=new qe;let u=new re;const d=[],m=[],y=[],x=[];T(),this.setIndex(x),this.setAttribute("position",new qt(d,3)),this.setAttribute("normal",new qt(m,3)),this.setAttribute("uv",new qt(y,2));function T(){for(let M=0;M<t;M++)S(M);S(s===!1?t:0),P(),w()}function S(M){u=e.getPointAt(M/t,u);const I=o.normals[M],k=o.binormals[M];for(let D=0;D<=r;D++){const H=D/r*Math.PI*2,W=Math.sin(H),z=-Math.cos(H);l.x=z*I.x+W*k.x,l.y=z*I.y+W*k.y,l.z=z*I.z+W*k.z,l.normalize(),m.push(l.x,l.y,l.z),a.x=u.x+i*l.x,a.y=u.y+i*l.y,a.z=u.z+i*l.z,d.push(a.x,a.y,a.z)}}function w(){for(let M=1;M<=t;M++)for(let I=1;I<=r;I++){const k=(r+1)*(M-1)+(I-1),D=(r+1)*M+(I-1),H=(r+1)*M+I,W=(r+1)*(M-1)+I;x.push(k,D,W),x.push(D,H,W)}}function P(){for(let M=0;M<=t;M++)for(let I=0;I<=r;I++)c.x=M/t,c.y=I/r,y.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new bT(new Ww[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class c6 extends Dn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new re,s=new re;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const d=l[c],m=d.start,y=d.count;for(let x=m,T=m+y;x<T;x+=3)for(let S=0;S<3;S++){const w=a.getX(x+S),P=a.getX(x+(S+1)%3);r.fromBufferAttribute(o,w),s.fromBufferAttribute(o,P),OO(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,d=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,d),OO(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new qt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function OO(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var LO=Object.freeze({__proto__:null,BoxGeometry:om,CapsuleGeometry:cT,CircleGeometry:uT,ConeGeometry:hT,CylinderGeometry:R_,DodecahedronGeometry:fT,EdgesGeometry:s6,ExtrudeGeometry:pT,IcosahedronGeometry:mT,LatheGeometry:M0,OctahedronGeometry:C0,PlaneGeometry:C_,PolyhedronGeometry:ud,RingGeometry:gT,ShapeGeometry:_T,SphereGeometry:I_,TetrahedronGeometry:yT,TorusGeometry:vT,TorusKnotGeometry:xT,TubeGeometry:bT,WireframeGeometry:c6});class u6 extends yo{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ot(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class h6 extends au{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class wT extends yo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ot(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ot(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class f6 extends wT{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return dr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ot(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ot(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ot(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class d6 extends yo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ot(16777215),this.specular=new Ot(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ot(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=w0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class p6 extends yo{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ot(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ot(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class m6 extends yo{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class g6 extends yo{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ot(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ot(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=w0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _6 extends yo{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ot(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cd,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class y6 extends zo{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function vp(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function v6(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function x6(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function tC(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function AR(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}function Vie(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],m=[];for(let y=0;y<c.times.length;++y){const x=c.times[y]*r;if(!(x<t||x>=i)){d.push(c.times[y]);for(let T=0;T<u;++T)m.push(c.values[y*u+T])}}d.length!==0&&(c.times=vp(d,c.times.constructor),c.values=vp(m,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function Hie(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(w){return w.name===a.name&&w.ValueTypeName===l});if(c===void 0)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let m=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=y/3);const x=a.times.length-1;let T;if(s<=a.times[0]){const w=u,P=d-u;T=a.values.slice(w,P)}else if(s>=a.times[x]){const w=x*d+u,P=w+d-u;T=a.values.slice(w,P)}else{const w=a.createInterpolant(),P=u,M=d-u;w.evaluate(s),T=w.resultBuffer.slice(P,M)}l==="quaternion"&&new go().fromArray(T).normalize().conjugate().toArray(T);const S=c.times.length;for(let w=0;w<S;++w){const P=w*y+m;if(l==="quaternion")go.multiplyQuaternionsFlat(c.values,P,T,0,c.values,P);else{const M=y-m*2;for(let I=0;I<M;++I)c.values[P+I]-=T[I]}}}return n.blendMode=aR,n}const Wie={convertArray:vp,isTypedArray:v6,getKeyframeOrder:x6,sortedArray:tC,flattenJSON:AR,subclip:Vie,makeClipAdditive:Hie};class P0{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class b6 extends P0{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:gp,endingEnd:gp}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case _p:s=e,a=2*t-i;break;case Mv:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case _p:o=e,l=2*i-t;break;case Mv:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=(i-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,m=this._weightPrev,y=this._weightNext,x=(i-t)/(r-t),T=x*x,S=T*x,w=-m*S+2*m*T-m*x,P=(1+m)*S+(-1.5-2*m)*T+(-.5+m)*x+1,M=(-1-y)*S+(1.5+y)*T+.5*x,I=y*S-y*T;for(let k=0;k!==a;++k)s[k]=w*o[u+k]+P*o[c+k]+M*o[l+k]+I*o[d+k];return s}}class MR extends P0{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let m=0;m!==a;++m)s[m]=o[c+m]*d+o[l+m]*u;return s}}class w6 extends P0{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class mc{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vp(t,this.TimeBufferType),this.values=vp(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:vp(e.times,Array),values:vp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new w6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new MR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new b6(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ev:t=this.InterpolantFactoryMethodDiscrete;break;case Av:t=this.InterpolantFactoryMethodLinear;break;case fw:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ev;case this.InterpolantFactoryMethodLinear:return Av;case this.InterpolantFactoryMethodSmooth:return fw}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&v6(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===fw,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(r)l=!0;else{const d=a*i,m=d-i,y=d+i;for(let x=0;x!==i;++x){const T=t[d+x];if(T!==t[m+x]||T!==t[y+x]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,m=o*i;for(let y=0;y!==i;++y)t[m+y]=t[d+y]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}mc.prototype.TimeBufferType=Float32Array;mc.prototype.ValueBufferType=Float32Array;mc.prototype.DefaultInterpolation=Av;class am extends mc{}am.prototype.ValueTypeName="bool";am.prototype.ValueBufferType=Array;am.prototype.DefaultInterpolation=Ev;am.prototype.InterpolantFactoryMethodLinear=void 0;am.prototype.InterpolantFactoryMethodSmooth=void 0;class CR extends mc{}CR.prototype.ValueTypeName="color";class Uv extends mc{}Uv.prototype.ValueTypeName="number";class S6 extends P0{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)go.slerpFlat(s,0,o,c-a,o,c,l);return s}}class k_ extends mc{InterpolantFactoryMethodLinear(e){return new S6(this.times,this.values,this.getValueSize(),e)}}k_.prototype.ValueTypeName="quaternion";k_.prototype.DefaultInterpolation=Av;k_.prototype.InterpolantFactoryMethodSmooth=void 0;class lm extends mc{}lm.prototype.ValueTypeName="string";lm.prototype.ValueBufferType=Array;lm.prototype.DefaultInterpolation=Ev;lm.prototype.InterpolantFactoryMethodLinear=void 0;lm.prototype.InterpolantFactoryMethodSmooth=void 0;class Bv extends mc{}Bv.prototype.ValueTypeName="vector";class zv{constructor(e,t=-1,i,r=ZS){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=ja(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push($ie(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(mc.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=x6(l);l=tC(l,1,u),c=tC(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Uv(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let m=r[d];m||(r[d]=m=[]),m.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,m,y,x,T){if(y.length!==0){const S=[],w=[];AR(y,S,w,x),S.length!==0&&T.push(new d(m,S,w))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const m=c[d].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const y={};let x;for(x=0;x<m.length;x++)if(m[x].morphTargets)for(let T=0;T<m[x].morphTargets.length;T++)y[m[x].morphTargets[T]]=-1;for(const T in y){const S=[],w=[];for(let P=0;P!==m[x].morphTargets.length;++P){const M=m[x];S.push(M.time),w.push(M.morphTarget===T?1:0)}r.push(new Uv(".morphTargetInfluence["+T+"]",S,w))}l=y.length*o}else{const y=".bones["+t[d].name+"]";i(Bv,y+".position",m,"pos",r),i(k_,y+".quaternion",m,"rot",r),i(Bv,y+".scale",m,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function jie(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Uv;case"vector":case"vector2":case"vector3":case"vector4":return Bv;case"color":return CR;case"quaternion":return k_;case"bool":case"boolean":return am;case"string":return lm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function $ie(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=jie(n.type);if(n.times===void 0){const t=[],i=[];AR(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xp={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class PR{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,m=c.length;d<m;d+=2){const y=c[d],x=c[d+1];if(y.global&&(y.lastIndex=0),y.test(u))return x}return null}}}const T6=new PR;class ma{constructor(e){this.manager=e!==void 0?e:T6,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}ma.DEFAULT_MATERIAL_NAME="__DEFAULT";const Xu={};class Xie extends Error{constructor(e,t){super(e),this.response=t}}class gh extends ma{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Xp.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Xu[e]!==void 0){Xu[e].push({onLoad:t,onProgress:i,onError:r});return}Xu[e]=[],Xu[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=Xu[e],d=c.body.getReader(),m=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),y=m?parseInt(m):0,x=y!==0;let T=0;const S=new ReadableStream({start(w){P();function P(){d.read().then(({done:M,value:I})=>{if(M)w.close();else{T+=I.byteLength;const k=new ProgressEvent("progress",{lengthComputable:x,loaded:T,total:y});for(let D=0,H=u.length;D<H;D++){const W=u[D];W.onProgress&&W.onProgress(k)}w.enqueue(I),P()}})}}});return new Response(S)}else throw new Xie(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),m=d&&d[1]?d[1].toLowerCase():void 0,y=new TextDecoder(m);return c.arrayBuffer().then(x=>y.decode(x))}}}).then(c=>{Xp.add(e,c);const u=Xu[e];delete Xu[e];for(let d=0,m=u.length;d<m;d++){const y=u[d];y.onLoad&&y.onLoad(c)}}).catch(c=>{const u=Xu[e];if(u===void 0)throw this.manager.itemError(e),c;delete Xu[e];for(let d=0,m=u.length;d<m;d++){const y=u[d];y.onError&&y.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Gie extends ma{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new gh(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=zv.parse(e[i]);t.push(r)}return t}}class Yie extends ma{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new aT,l=new gh(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(m){const y=s.parse(m,!0);o[d]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},c+=1,c===6&&(y.mipmapCount===1&&(a.minFilter=Mr),a.image=o,a.format=y.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let d=0,m=e.length;d<m;++d)u(d);else l.load(e,function(d){const m=s.parse(d,!0);if(m.isCubemap){const y=m.mipmaps.length/m.mipmapCount;for(let x=0;x<y;x++){o[x]={mipmaps:[]};for(let T=0;T<m.mipmapCount;T++)o[x].mipmaps.push(m.mipmaps[x*m.mipmapCount+T]),o[x].format=m.format,o[x].width=m.width,o[x].height=m.height}a.image=o}else a.image.width=m.width,a.image.height=m.height,a.mipmaps=m.mipmaps;m.mipmapCount===1&&(a.minFilter=Mr),a.format=m.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}let Vv=class extends ma{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xp.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Ov("img");function l(){u(),Xp.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}};class qie extends ma{constructor(e){super(e)}load(e,t,i,r){const s=new A0;s.colorSpace=es;const o=new Vv(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Zie extends ma{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new jg,a=new gh(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:fo,o.wrapT=c.wrapT!==void 0?c.wrapT:fo,o.magFilter=c.magFilter!==void 0?c.magFilter:Mr,o.minFilter=c.minFilter!==void 0?c.minFilter:Mr,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Jf),c.mipmapCount===1&&(o.minFilter=Mr),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},i,r),o}}class Kie extends ma{constructor(e){super(e)}load(e,t,i,r){const s=new js,o=new Vv(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class hd extends Qn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ot(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class E6 extends hd{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ot(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const g1=new On,NO=new re,DO=new re;class RR{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new qe(512,512),this.map=null,this.mapPass=null,this.matrix=new On,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new QS,this._frameExtents=new qe(1,1),this._viewportCount=1,this._viewports=[new di(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;NO.setFromMatrixPosition(e.matrixWorld),t.position.copy(NO),DO.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(DO),t.updateMatrixWorld(),g1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g1),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(g1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Jie extends RR{constructor(){super(new pr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=e_*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class A6 extends hd{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.target=new Qn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Jie}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const FO=new On,py=new re,_1=new re;class Qie extends RR{constructor(){super(new pr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new qe(4,2),this._viewportCount=6,this._viewports=[new di(2,1,1,1),new di(0,1,1,1),new di(3,1,1,1),new di(1,1,1,1),new di(3,0,1,1),new di(1,0,1,1)],this._cubeDirections=[new re(1,0,0),new re(-1,0,0),new re(0,0,1),new re(0,0,-1),new re(0,1,0),new re(0,-1,0)],this._cubeUps=[new re(0,1,0),new re(0,1,0),new re(0,1,0),new re(0,1,0),new re(0,0,1),new re(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),py.setFromMatrixPosition(e.matrixWorld),i.position.copy(py),_1.copy(i.position),_1.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(_1),i.updateMatrixWorld(),r.makeTranslation(-py.x,-py.y,-py.z),FO.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(FO)}}class IR extends hd{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Qie}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class ere extends RR{constructor(){super(new Yf(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}let M6=class extends hd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.target=new Qn,this.shadow=new ere}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},kR=class extends hd{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};class C6 extends hd{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class P6{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new re)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class R6 extends hd{constructor(e=new P6,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class ST extends ma{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new gh(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=ST.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Ot().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new Ot().setHex(o.value);break;case"v2":r.uniforms[s].value=new qe().fromArray(o.value);break;case"v3":r.uniforms[s].value=new re().fromArray(o.value);break;case"v4":r.uniforms[s].value=new di().fromArray(o.value);break;case"m3":r.uniforms[s].value=new kn().fromArray(o.value);break;case"m4":r.uniforms[s].value=new On().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new qe().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new qe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:u6,SpriteMaterial:_R,RawShaderMaterial:h6,ShaderMaterial:au,PointsMaterial:vR,MeshPhysicalMaterial:f6,MeshStandardMaterial:wT,MeshPhongMaterial:d6,MeshToonMaterial:p6,MeshNormalMaterial:m6,MeshLambertMaterial:g6,MeshDepthMaterial:mR,MeshDistanceMaterial:gR,MeshBasicMaterial:Eh,MeshMatcapMaterial:_6,LineDashedMaterial:y6,LineBasicMaterial:zo,Material:yo};return new t[e]}}class nC{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class I6 extends Dn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class k6 extends ma{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new gh(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(y,x){if(t[x]!==void 0)return t[x];const S=y.interleavedBuffers[x],w=s(y,S.buffer),P=Sg(S.type,w),M=new sT(P,S.stride);return M.uuid=S.uuid,t[x]=M,M}function s(y,x){if(i[x]!==void 0)return i[x];const S=y.arrayBuffers[x],w=new Uint32Array(S).buffer;return i[x]=w,w}const o=e.isInstancedBufferGeometry?new I6:new Dn,a=e.data.index;if(a!==void 0){const y=Sg(a.type,a.array);o.setIndex(new Ai(y,1))}const l=e.data.attributes;for(const y in l){const x=l[y];let T;if(x.isInterleavedBufferAttribute){const S=r(e.data,x.data);T=new jp(S,x.itemSize,x.offset,x.normalized)}else{const S=Sg(x.type,x.array),w=x.isInstancedBufferAttribute?n_:Ai;T=new w(S,x.itemSize,x.normalized)}x.name!==void 0&&(T.name=x.name),x.usage!==void 0&&T.setUsage(x.usage),x.updateRange!==void 0&&(T.updateRange.offset=x.updateRange.offset,T.updateRange.count=x.updateRange.count),o.setAttribute(y,T)}const c=e.data.morphAttributes;if(c)for(const y in c){const x=c[y],T=[];for(let S=0,w=x.length;S<w;S++){const P=x[S];let M;if(P.isInterleavedBufferAttribute){const I=r(e.data,P.data);M=new jp(I,P.itemSize,P.offset,P.normalized)}else{const I=Sg(P.type,P.array);M=new Ai(I,P.itemSize,P.normalized)}P.name!==void 0&&(M.name=P.name),T.push(M)}o.morphAttributes[y]=T}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let y=0,x=d.length;y!==x;++y){const T=d[y];o.addGroup(T.start,T.count,T.materialIndex)}const m=e.data.boundingSphere;if(m!==void 0){const y=new re;m.center!==void 0&&y.fromArray(m.center),o.boundingSphere=new dc(y,m.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class tre extends ma{constructor(e){super(e)}load(e,t,i,r){const s=this,o=this.path===""?nC.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new gh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){r!==void 0&&r(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?nC.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new gh(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),t!==void 0){let d=!1;for(const m in o)if(o[m].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new Pp().fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new oT().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new k6;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in LO?a=LO[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const s=new ST;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=zv.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return o(u)}else return l.data?{data:Sg(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new PR(t);s=new Vv(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const d=e[c],m=d.url;if(Array.isArray(m)){const y=[];for(let x=0,T=m.length;x<T;x++){const S=m[x],w=a(S);w!==null&&(w instanceof HTMLImageElement?y.push(w):y.push(new jg(w.data,w.width,w.height)))}r[d.uuid]=new yp(y)}else{const y=a(d.url);r[d.uuid]=new yp(y)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Sg(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Vv(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let d=0,m=c.length;d<m;d++){const y=c[d],x=await s(y);x!==null&&(x instanceof HTMLImageElement?u.push(x):u.push(new jg(x.data,x.width,x.height)))}i[l.uuid]=new yp(u)}else{const u=await s(l.url);i[l.uuid]=new yp(u)}}}return i}parseTextures(e,t){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new A0,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new jg:u=new js,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=i(a.mapping,nre)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=i(a.wrap[0],UO),u.wrapT=i(a.wrap[1],UO)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=i(a.minFilter,BO)),a.magFilter!==void 0&&(u.magFilter=i(a.magFilter,BO)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,i,r,s){let o;function a(m){return t[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),t[m]}function l(m){if(m!==void 0){if(Array.isArray(m)){const y=[];for(let x=0,T=m.length;x<T;x++){const S=m[x];i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),y.push(i[S])}return y}return i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),i[m]}}function c(m){return r[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),r[m]}let u,d;switch(e.type){case"Scene":o=new rT,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ot(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new iT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new nT(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new pr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Yf(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new kR(e.color,e.intensity);break;case"DirectionalLight":o=new M6(e.color,e.intensity);break;case"PointLight":o=new IR(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new C6(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new A6(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new E6(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new R6().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),d=l(e.material),o=new ZV(u,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=l(e.material),o=new xs(u,d);break;case"InstancedMesh":u=a(e.geometry),d=l(e.material);const m=e.count,y=e.instanceMatrix,x=e.instanceColor;o=new KV(u,d,m),o.instanceMatrix=new n_(new Float32Array(y.array),16),x!==void 0&&(o.instanceColor=new n_(new Float32Array(x.array),x.itemSize));break;case"LOD":o=new qV;break;case"Line":o=new Qf(a(e.geometry),l(e.material));break;case"LineLoop":o=new JV(a(e.geometry),l(e.material));break;case"LineSegments":o=new fu(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new QV(a(e.geometry),l(e.material));break;case"Sprite":o=new YV(l(e.material));break;case"Group":o=new Eg;break;case"Bone":o=new yR;break;default:o=new Qn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let y=0;y<m.length;y++)o.add(this.parseObject(m[y],t,i,r,s))}if(e.animations!==void 0){const m=e.animations;for(let y=0;y<m.length;y++){const x=m[y];o.animations.push(s[x])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const m=e.levels;for(let y=0;y<m.length;y++){const x=m[y],T=o.getObjectByProperty("uuid",x.object);T!==void 0&&o.addLevel(T,x.distance,x.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const nre={UVMapping:YS,CubeReflectionMapping:mh,CubeRefractionMapping:Kf,EquirectangularReflectionMapping:bv,EquirectangularRefractionMapping:wv,CubeUVReflectionMapping:M_},UO={RepeatWrapping:Sv,ClampToEdgeWrapping:fo,MirroredRepeatWrapping:Tv},BO={NearestFilter:Ar,NearestMipmapNearestFilter:zw,NearestMipmapLinearFilter:$y,LinearFilter:Mr,LinearMipmapNearestFilter:eR,LinearMipmapLinearFilter:Jf};class ire extends ma{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xp.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Xp.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let hb;class OR{static getContext(){return hb===void 0&&(hb=new(window.AudioContext||window.webkitAudioContext)),hb}static setContext(e){hb=e}}class rre extends ma{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new gh(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);OR.getContext().decodeAudioData(c,function(d){t(d)},a)}catch(c){a(c)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}const zO=new On,VO=new On,Xd=new On;class sre{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new pr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new pr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Xd.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Mp*t.fov*.5)/t.zoom;let a,l;VO.elements[12]=-r,zO.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,Xd.elements[0]=2*t.near/(l-a),Xd.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Xd),a=-o*t.aspect-s,l=o*t.aspect-s,Xd.elements[0]=2*t.near/(l-a),Xd.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Xd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(VO),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zO)}}class LR{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=HO(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=HO();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function HO(){return(typeof performance>"u"?Date:performance).now()}const Gd=new re,WO=new go,ore=new re,Yd=new re;class are extends Qn{constructor(){super(),this.type="AudioListener",this.context=OR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new LR}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Gd,WO,ore),Yd.set(0,0,-1).applyQuaternion(WO),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Gd.x,r),t.positionY.linearRampToValueAtTime(Gd.y,r),t.positionZ.linearRampToValueAtTime(Gd.z,r),t.forwardX.linearRampToValueAtTime(Yd.x,r),t.forwardY.linearRampToValueAtTime(Yd.y,r),t.forwardZ.linearRampToValueAtTime(Yd.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Gd.x,Gd.y,Gd.z),t.setOrientation(Yd.x,Yd.y,Yd.z,i.x,i.y,i.z)}}let O6=class extends Qn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const qd=new re,jO=new go,lre=new re,Zd=new re;class cre extends O6{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(qd,jO,lre),Zd.set(0,0,1).applyQuaternion(jO);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(qd.x,i),t.positionY.linearRampToValueAtTime(qd.y,i),t.positionZ.linearRampToValueAtTime(qd.z,i),t.orientationX.linearRampToValueAtTime(Zd.x,i),t.orientationY.linearRampToValueAtTime(Zd.y,i),t.orientationZ.linearRampToValueAtTime(Zd.z,i)}else t.setPosition(qd.x,qd.y,qd.z),t.setOrientation(Zd.x,Zd.y,Zd.z)}}class ure{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class L6{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(i,r,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){go.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;go.multiplyQuaternionsFlat(e,o,e,t,e,i),go.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const NR="\\[\\]\\.:\\/",hre=new RegExp("["+NR+"]","g"),DR="[^"+NR+"]",fre="[^"+NR.replace("\\.","")+"]",dre=/((?:WC+[\/:])*)/.source.replace("WC",DR),pre=/(WCOD+)?/.source.replace("WCOD",fre),mre=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",DR),gre=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",DR),_re=new RegExp("^"+dre+pre+mre+gre+"$"),yre=["material","materials","bones","map"];class vre{constructor(e,t,i){const r=i||qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class qn{constructor(e,t,i){this.path=t,this.parsedPath=i||qn.parseTrackName(t),this.node=qn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new qn.Composite(e,t,i):new qn(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(hre,"")}static parseTrackName(e){const t=_re.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);yre.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=qn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}qn.Composite=vre;qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};qn.prototype.GetterByBindingType=[qn.prototype._getValue_direct,qn.prototype._getValue_array,qn.prototype._getValue_arrayElement,qn.prototype._getValue_toArray];qn.prototype.SetterByBindingTypeAndVersioning=[[qn.prototype._setValue_direct,qn.prototype._setValue_direct_setNeedsUpdate,qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_array,qn.prototype._setValue_array_setNeedsUpdate,qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_arrayElement,qn.prototype._setValue_arrayElement_setNeedsUpdate,qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_fromArray,qn.prototype._setValue_fromArray_setNeedsUpdate,qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class xre{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ja(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){const m=arguments[u],y=m.uuid;let x=t[y];if(x===void 0){x=l++,t[y]=x,e.push(m);for(let T=0,S=o;T!==S;++T)s[T].push(new qn(m,i[T],r[T]))}else if(x<c){a=e[x];const T=--c,S=e[T];t[S.uuid]=x,e[x]=S,t[y]=T,e[T]=m;for(let w=0,P=o;w!==P;++w){const M=s[w],I=M[T];let k=M[x];M[x]=I,k===void 0&&(k=new qn(m,i[w],r[w])),M[T]=k}}else e[x]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const d=s++,m=e[d];t[m.uuid]=u,e[u]=m,t[c]=d,e[d]=l;for(let y=0,x=r;y!==x;++y){const T=i[y],S=T[d],w=T[u];T[u]=S,T[d]=w}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,d=t[u];if(d!==void 0)if(delete t[u],d<s){const m=--s,y=e[m],x=--o,T=e[x];t[y.uuid]=d,e[d]=y,t[T.uuid]=m,e[m]=T,e.pop();for(let S=0,w=r;S!==w;++S){const P=i[S],M=P[m],I=P[x];P[d]=M,P[m]=I,P.pop()}}else{const m=--o,y=e[m];m>0&&(t[y.uuid]=d),e[d]=y,e.pop();for(let x=0,T=r;x!==T;++x){const S=i[x];S[d]=S[m],S.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,d=new Array(c);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(d);for(let m=u,y=l.length;m!==y;++m){const x=l[m];d[m]=new qn(x,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class N6{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:gp,endingEnd:gp};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=mV,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case aR:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case ZS:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===gV;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===pV){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=_p,r.endingEnd=_p):(e?r.endingStart=this.zeroSlopeAtStart?_p:gp:r.endingStart=Mv,t?r.endingEnd=this.zeroSlopeAtEnd?_p:gp:r.endingEnd=Mv)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const bre=new Float32Array(1);class wre extends Th{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let d=0;d!==s;++d){const m=r[d],y=m.name;let x=u[y];if(x!==void 0)++x.referenceCount,o[d]=x;else{if(x=o[d],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,l,y));continue}const T=t&&t._propertyBindings[d].binding.parsedPath;x=new L6(qn.create(i,y,T),m.ValueTypeName,m.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,l,y),o[d]=x}a[d].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,m=(e._localRoot||this._root).uuid;delete d[m],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new MR(new Float32Array(2),new Float32Array(2),1,bre),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?zv.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=ZS),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new N6(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?zv.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class FR{constructor(e){this.value=e}clone(){return new FR(this.value.clone===void 0?this.value:this.value.clone())}}let Sre=0;class Tre extends Th{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Sre++}),this.name="",this.usage=Iv,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++)this.uniforms.push(t[i].clone());return this}clone(){return new this.constructor().copy(this)}}class Ere extends sT{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Are{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class UR{constructor(e,t,i=0,r=1/0){this.ray=new sm(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new Cp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return iC(e,this,i,t),i.sort($O),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)iC(e[r],this,i,t);return i.sort($O),i}}function $O(n,e){return n.distance-e.distance}function iC(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let s=0,o=r.length;s<o;s++)iC(r[s],e,t,!0)}}class rC{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(dr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Mre{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const XO=new qe;class Cre{constructor(e=new qe(1/0,1/0),t=new qe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=XO.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,XO).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const GO=new re,fb=new re;class Pre{constructor(e=new re,t=new re){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){GO.subVectors(e,this.start),fb.subVectors(this.end,this.start);const i=fb.dot(fb);let s=fb.dot(GO)/i;return t&&(s=dr(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const YO=new re;class Rre extends Qn{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new Dn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new qt(r,3));const s=new zo({fog:!1,toneMapped:!1});this.cone=new fu(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),YO.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(YO),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const yf=new re,db=new On,y1=new On;class Ire extends fu{constructor(e){const t=D6(e),i=new Dn,r=[],s=[],o=new Ot(0,0,1),a=new Ot(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new qt(r,3)),i.setAttribute("color",new qt(s,3));const l=new zo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");y1.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(db.multiplyMatrices(y1,a.matrixWorld),yf.setFromMatrixPosition(db),r.setXYZ(o,yf.x,yf.y,yf.z),db.multiplyMatrices(y1,a.parent.matrixWorld),yf.setFromMatrixPosition(db),r.setXYZ(o+1,yf.x,yf.y,yf.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function D6(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,D6(n.children[t]));return e}class kre extends xs{constructor(e,t,i){const r=new I_(t,4,2),s=new Eh({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ore=new re,qO=new Ot,ZO=new Ot;class Lre extends Qn{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new C0(t);r.rotateY(Math.PI*.5),this.material=new Eh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Ai(o,3)),this.add(new xs(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");qO.copy(this.light.color),ZO.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?qO:ZO;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Ore.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Nre extends fu{constructor(e=10,t=10,i=4473924,r=8947848){i=new Ot(i),r=new Ot(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let m=0,y=0,x=-a;m<=t;m++,x+=o){l.push(-a,0,x,a,0,x),l.push(x,0,-a,x,0,a);const T=m===s?i:r;T.toArray(c,y),y+=3,T.toArray(c,y),y+=3,T.toArray(c,y),y+=3,T.toArray(c,y),y+=3}const u=new Dn;u.setAttribute("position",new qt(l,3)),u.setAttribute("color",new qt(c,3));const d=new zo({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Dre extends fu{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new Ot(s),o=new Ot(o);const a=[],l=[];if(t>1)for(let d=0;d<t;d++){const m=d/t*(Math.PI*2),y=Math.sin(m)*e,x=Math.cos(m)*e;a.push(0,0,0),a.push(y,0,x);const T=d&1?s:o;l.push(T.r,T.g,T.b),l.push(T.r,T.g,T.b)}for(let d=0;d<i;d++){const m=d&1?s:o,y=e-e/i*d;for(let x=0;x<r;x++){let T=x/r*(Math.PI*2),S=Math.sin(T)*y,w=Math.cos(T)*y;a.push(S,0,w),l.push(m.r,m.g,m.b),T=(x+1)/r*(Math.PI*2),S=Math.sin(T)*y,w=Math.cos(T)*y,a.push(S,0,w),l.push(m.r,m.g,m.b)}}const c=new Dn;c.setAttribute("position",new qt(a,3)),c.setAttribute("color",new qt(l,3));const u=new zo({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const KO=new re,pb=new re,JO=new re;class Fre extends Qn{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Dn;r.setAttribute("position",new qt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new zo({fog:!1,toneMapped:!1});this.lightPlane=new Qf(r,s),this.add(this.lightPlane),r=new Dn,r.setAttribute("position",new qt([0,0,0,0,0,1],3)),this.targetLine=new Qf(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),KO.setFromMatrixPosition(this.light.matrixWorld),pb.setFromMatrixPosition(this.light.target.matrixWorld),JO.subVectors(pb,KO),this.lightPlane.lookAt(pb),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(pb),this.targetLine.scale.z=JO.length()}}const mb=new re,cr=new E0;class Ure extends fu{constructor(e){const t=new Dn,i=new zo({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(x,T){l(x),l(T)}function l(x){r.push(0,0,0),s.push(0,0,0),o[x]===void 0&&(o[x]=[]),o[x].push(r.length/3-1)}t.setAttribute("position",new qt(r,3)),t.setAttribute("color",new qt(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Ot(16755200),u=new Ot(16711680),d=new Ot(43775),m=new Ot(16777215),y=new Ot(3355443);this.setColors(c,u,d,m,y)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;cr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Tr("c",t,e,cr,0,0,-1),Tr("t",t,e,cr,0,0,1),Tr("n1",t,e,cr,-i,-r,-1),Tr("n2",t,e,cr,i,-r,-1),Tr("n3",t,e,cr,-i,r,-1),Tr("n4",t,e,cr,i,r,-1),Tr("f1",t,e,cr,-i,-r,1),Tr("f2",t,e,cr,i,-r,1),Tr("f3",t,e,cr,-i,r,1),Tr("f4",t,e,cr,i,r,1),Tr("u1",t,e,cr,i*.7,r*1.1,-1),Tr("u2",t,e,cr,-i*.7,r*1.1,-1),Tr("u3",t,e,cr,0,r*2,-1),Tr("cf1",t,e,cr,-i,0,1),Tr("cf2",t,e,cr,i,0,1),Tr("cf3",t,e,cr,0,-r,1),Tr("cf4",t,e,cr,0,r,1),Tr("cn1",t,e,cr,-i,0,-1),Tr("cn2",t,e,cr,i,0,-1),Tr("cn3",t,e,cr,0,-r,-1),Tr("cn4",t,e,cr,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Tr(n,e,t,i,r,s,o){mb.set(r,s,o).unproject(i);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],mb.x,mb.y,mb.z)}}const gb=new hu;class Bre extends fu{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Dn;s.setIndex(new Ai(i,1)),s.setAttribute("position",new Ai(r,3)),super(s,new zo({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&gb.setFromObject(this.object),gb.isEmpty())return;const t=gb.min,i=gb.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class zre extends fu{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Dn;s.setIndex(new Ai(i,1)),s.setAttribute("position",new qt(r,3)),super(s,new zo({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Vre extends Qf{constructor(e,t=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Dn;o.setAttribute("position",new qt(s,3)),o.computeBoundingSphere(),super(o,new zo({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Dn;l.setAttribute("position",new qt(a,3)),l.computeBoundingSphere(),this.add(new xs(l,new Eh({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const QO=new re;let _b,v1;class Hre extends Qn{constructor(e=new re(0,0,1),t=new re(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",_b===void 0&&(_b=new Dn,_b.setAttribute("position",new qt([0,0,0,0,1,0],3)),v1=new R_(0,.5,1,5,1),v1.translate(0,-.5,0)),this.position.copy(t),this.line=new Qf(_b,new zo({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new xs(v1,new Eh({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{QO.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(QO,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Wre extends fu{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Dn;r.setAttribute("position",new qt(t,3)),r.setAttribute("color",new qt(i,3));const s=new zo({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new Ot,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class jre{constructor(){this.type="ShapePath",this.color=new Ot,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Lv,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(w){const P=[];for(let M=0,I=w.length;M<I;M++){const k=w[M],D=new Pp;D.curves=k.curves,P.push(D)}return P}function i(w,P){const M=P.length;let I=!1;for(let k=M-1,D=0;D<M;k=D++){let H=P[k],W=P[D],z=W.x-H.x,j=W.y-H.y;if(Math.abs(j)>Number.EPSILON){if(j<0&&(H=P[D],z=-z,W=P[k],j=-j),w.y<H.y||w.y>W.y)continue;if(w.y===H.y){if(w.x===H.x)return!0}else{const J=j*(w.x-H.x)-z*(w.y-H.y);if(J===0)return!0;if(J<0)continue;I=!I}}else{if(w.y!==H.y)continue;if(W.x<=w.x&&w.x<=H.x||H.x<=w.x&&w.x<=W.x)return!0}}return I}const r=nu.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new Pp,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const d=[],m=[];let y=[],x=0,T;m[x]=void 0,y[x]=[];for(let w=0,P=s.length;w<P;w++)a=s[w],T=a.getPoints(),o=r(T),o=e?!o:o,o?(!u&&m[x]&&x++,m[x]={s:new Pp,p:T},m[x].s.curves=a.curves,u&&x++,y[x]=[]):y[x].push({h:a,p:T[0]});if(!m[0])return t(s);if(m.length>1){let w=!1,P=0;for(let M=0,I=m.length;M<I;M++)d[M]=[];for(let M=0,I=m.length;M<I;M++){const k=y[M];for(let D=0;D<k.length;D++){const H=k[D];let W=!0;for(let z=0;z<m.length;z++)i(H.p,m[z].p)&&(M!==z&&P++,W?(W=!1,d[z].push(H)):w=!0);W&&d[M].push(H)}}P>0&&w===!1&&(y=d)}let S;for(let w=0,P=m.length;w<P;w++){l=m[w].s,c.push(l),S=y[w];for(let M=0,I=S.length;M<I;M++)l.holes.push(S[M].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:XS}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=XS);const $re=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:QP,AddEquation:If,AddOperation:Qz,AdditiveAnimationBlendMode:aR,AdditiveBlending:mM,AlphaFormat:aV,AlwaysCompare:MV,AlwaysDepth:Xz,AlwaysStencilFunc:XM,AmbientLight:kR,AnimationAction:N6,AnimationClip:zv,AnimationLoader:Gie,AnimationMixer:wre,AnimationObjectGroup:xre,AnimationUtils:Wie,ArcCurve:e6,ArrayCamera:jV,ArrowHelper:Hre,AttachedBindMode:xM,Audio:O6,AudioAnalyser:ure,AudioContext:OR,AudioListener:are,AudioLoader:rre,AxesHelper:Wre,BackSide:Uo,BasicDepthPacking:_V,BasicShadowMap:Cz,Bone:yR,BooleanKeyframeTrack:am,Box2:Cre,Box3:hu,Box3Helper:zre,BoxGeometry:om,BoxHelper:Bre,BufferAttribute:Ai,BufferGeometry:Dn,BufferGeometryLoader:k6,ByteType:sV,Cache:Xp,Camera:E0,CameraHelper:Ure,CanvasTexture:die,CapsuleGeometry:cT,CatmullRomCurve3:t6,CineonToneMapping:nV,CircleGeometry:uT,ClampToEdgeWrapping:fo,Clock:LR,Color:Ot,ColorKeyframeTrack:CR,ColorManagement:hi,CompressedArrayTexture:hie,CompressedCubeTexture:fie,CompressedTexture:aT,CompressedTextureLoader:Yie,ConeGeometry:hT,ConstantAlphaFactor:Wz,ConstantColorFactor:Vz,CubeCamera:DV,CubeReflectionMapping:mh,CubeRefractionMapping:Kf,CubeTexture:A0,CubeTextureLoader:qie,CubeUVReflectionMapping:M_,CubicBezierCurve:bR,CubicBezierCurve3:n6,CubicInterpolant:b6,CullFaceBack:pM,CullFaceFront:Mz,CullFaceFrontBack:cK,CullFaceNone:Az,Curve:pc,CurvePath:r6,CustomBlending:Pz,CustomToneMapping:iV,CylinderGeometry:R_,Cylindrical:Mre,Data3DTexture:hR,DataArrayTexture:JS,DataTexture:jg,DataTextureLoader:Zie,DataUtils:yJ,DecrementStencilOp:bK,DecrementWrapStencilOp:SK,DefaultLoadingManager:T6,DepthFormat:Xf,DepthStencilFormat:Wp,DepthTexture:$V,DetachedBindMode:rV,DirectionalLight:M6,DirectionalLightHelper:Fre,DiscreteInterpolant:w6,DisplayP3ColorSpace:KS,DodecahedronGeometry:fT,DoubleSide:Gc,DstAlphaFactor:Dz,DstColorFactor:Uz,DynamicCopyUsage:UK,DynamicDrawUsage:kK,DynamicReadUsage:NK,EdgesGeometry:s6,EllipseCurve:lT,EqualCompare:wV,EqualDepth:Yz,EqualStencilFunc:MK,EquirectangularReflectionMapping:bv,EquirectangularRefractionMapping:wv,Euler:T0,EventDispatcher:Th,ExtrudeGeometry:pT,FileLoader:gh,Float16BufferAttribute:TJ,Float32BufferAttribute:qt,Float64BufferAttribute:EJ,FloatType:qc,Fog:iT,FogExp2:nT,FramebufferTexture:uie,FrontSide:ph,Frustum:QS,GLBufferAttribute:Are,GLSL1:zK,GLSL3:GM,GreaterCompare:TV,GreaterDepth:Zz,GreaterEqualCompare:AV,GreaterEqualDepth:qz,GreaterEqualStencilFunc:IK,GreaterStencilFunc:PK,GridHelper:Nre,Group:Eg,HalfFloatType:Qg,HemisphereLight:E6,HemisphereLightHelper:Lre,IcosahedronGeometry:mT,ImageBitmapLoader:ire,ImageLoader:Vv,ImageUtils:uR,IncrementStencilOp:xK,IncrementWrapStencilOp:wK,InstancedBufferAttribute:n_,InstancedBufferGeometry:I6,InstancedInterleavedBuffer:Ere,InstancedMesh:KV,Int16BufferAttribute:wJ,Int32BufferAttribute:SJ,Int8BufferAttribute:vJ,IntType:tR,InterleavedBuffer:sT,InterleavedBufferAttribute:jp,Interpolant:P0,InterpolateDiscrete:Ev,InterpolateLinear:Av,InterpolateSmooth:fw,InvertStencilOp:TK,KeepStencilOp:ap,KeyframeTrack:mc,LOD:qV,LatheGeometry:M0,Layers:Cp,LessCompare:bV,LessDepth:Gz,LessEqualCompare:SV,LessEqualDepth:xv,LessEqualStencilFunc:CK,LessStencilFunc:AK,Light:hd,LightProbe:R6,Line:Qf,Line3:Pre,LineBasicMaterial:zo,LineCurve:wR,LineCurve3:i6,LineDashedMaterial:y6,LineLoop:JV,LineSegments:fu,LinearDisplayP3ColorSpace:S0,LinearEncoding:lR,LinearFilter:Mr,LinearInterpolant:MR,LinearMipMapLinearFilter:pK,LinearMipMapNearestFilter:dK,LinearMipmapLinearFilter:Jf,LinearMipmapNearestFilter:eR,LinearSRGBColorSpace:ou,LinearToneMapping:eV,LinearTransfer:Cv,Loader:ma,LoaderUtils:nC,LoadingManager:PR,LoopOnce:pV,LoopPingPong:gV,LoopRepeat:mV,LuminanceAlphaFormat:cV,LuminanceFormat:lV,MOUSE:sp,Material:yo,MaterialLoader:ST,MathUtils:eJ,Matrix3:kn,Matrix4:On,MaxEquation:vM,Mesh:xs,MeshBasicMaterial:Eh,MeshDepthMaterial:mR,MeshDistanceMaterial:gR,MeshLambertMaterial:g6,MeshMatcapMaterial:_6,MeshNormalMaterial:m6,MeshPhongMaterial:d6,MeshPhysicalMaterial:f6,MeshStandardMaterial:wT,MeshToonMaterial:p6,MinEquation:yM,MirroredRepeatWrapping:Tv,MixOperation:Jz,MultiplyBlending:_M,MultiplyOperation:w0,NearestFilter:Ar,NearestMipMapLinearFilter:fK,NearestMipMapNearestFilter:hK,NearestMipmapLinearFilter:$y,NearestMipmapNearestFilter:zw,NeverCompare:xV,NeverDepth:$z,NeverStencilFunc:EK,NoBlending:uh,NoColorSpace:Wa,NoToneMapping:eu,NormalAnimationBlendMode:ZS,NormalBlending:Ap,NotEqualCompare:EV,NotEqualDepth:Kz,NotEqualStencilFunc:RK,NumberKeyframeTrack:Uv,Object3D:Qn,ObjectLoader:tre,ObjectSpaceNormalMap:vV,OctahedronGeometry:C0,OneFactor:Oz,OneMinusConstantAlphaFactor:jz,OneMinusConstantColorFactor:Hz,OneMinusDstAlphaFactor:Fz,OneMinusDstColorFactor:Bz,OneMinusSrcAlphaFactor:Bw,OneMinusSrcColorFactor:Nz,OrthographicCamera:Yf,P3Primaries:Rv,PCFShadowMap:GS,PCFSoftShadowMap:jy,PMREMGenerator:ZM,Path:Lv,PerspectiveCamera:pr,Plane:Xc,PlaneGeometry:C_,PlaneHelper:Vre,PointLight:IR,PointLightHelper:kre,Points:QV,PointsMaterial:vR,PolarGridHelper:Dre,PolyhedronGeometry:ud,PositionalAudio:cre,PropertyBinding:qn,PropertyMixer:L6,QuadraticBezierCurve:SR,QuadraticBezierCurve3:TR,Quaternion:go,QuaternionKeyframeTrack:k_,QuaternionLinearInterpolant:S6,RED_GREEN_RGTC2_Format:jM,RED_RGTC1_Format:dV,REVISION:XS,RGBADepthPacking:yV,RGBAFormat:ca,RGBAIntegerFormat:oR,RGBA_ASTC_10x10_Format:UM,RGBA_ASTC_10x5_Format:NM,RGBA_ASTC_10x6_Format:DM,RGBA_ASTC_10x8_Format:FM,RGBA_ASTC_12x10_Format:BM,RGBA_ASTC_12x12_Format:zM,RGBA_ASTC_4x4_Format:MM,RGBA_ASTC_5x4_Format:CM,RGBA_ASTC_5x5_Format:PM,RGBA_ASTC_6x5_Format:RM,RGBA_ASTC_6x6_Format:IM,RGBA_ASTC_8x5_Format:kM,RGBA_ASTC_8x6_Format:OM,RGBA_ASTC_8x8_Format:LM,RGBA_BPTC_Format:hw,RGBA_ETC2_EAC_Format:AM,RGBA_PVRTC_2BPPV1_Format:TM,RGBA_PVRTC_4BPPV1_Format:SM,RGBA_S3TC_DXT1_Format:lw,RGBA_S3TC_DXT3_Format:cw,RGBA_S3TC_DXT5_Format:uw,RGB_BPTC_SIGNED_Format:VM,RGB_BPTC_UNSIGNED_Format:HM,RGB_ETC1_Format:fV,RGB_ETC2_Format:EM,RGB_PVRTC_2BPPV1_Format:wM,RGB_PVRTC_4BPPV1_Format:bM,RGB_S3TC_DXT1_Format:aw,RGFormat:hV,RGIntegerFormat:sR,RawShaderMaterial:h6,Ray:sm,Raycaster:UR,Rec709Primaries:Pv,RectAreaLight:C6,RedFormat:uV,RedIntegerFormat:rR,ReinhardToneMapping:tV,RenderTarget:IV,RepeatWrapping:Sv,ReplaceStencilOp:vK,ReverseSubtractEquation:Iz,RingGeometry:gT,SIGNED_RED_GREEN_RGTC2_Format:$M,SIGNED_RED_RGTC1_Format:WM,SRGBColorSpace:es,SRGBTransfer:Ri,Scene:rT,ShaderChunk:Pn,ShaderLib:rc,ShaderMaterial:au,ShadowMaterial:u6,Shape:Pp,ShapeGeometry:_T,ShapePath:jre,ShapeUtils:nu,ShortType:oV,Skeleton:oT,SkeletonHelper:Ire,SkinnedMesh:ZV,Source:yp,Sphere:dc,SphereGeometry:I_,Spherical:rC,SphericalHarmonics3:P6,SplineCurve:ER,SpotLight:A6,SpotLightHelper:Rre,Sprite:YV,SpriteMaterial:_R,SrcAlphaFactor:Uw,SrcAlphaSaturateFactor:zz,SrcColorFactor:Lz,StaticCopyUsage:FK,StaticDrawUsage:Iv,StaticReadUsage:LK,StereoCamera:sre,StreamCopyUsage:BK,StreamDrawUsage:OK,StreamReadUsage:DK,StringKeyframeTrack:lm,SubtractEquation:Rz,SubtractiveBlending:gM,TOUCH:op,TangentSpaceNormalMap:cd,TetrahedronGeometry:yT,Texture:js,TextureLoader:Kie,TorusGeometry:vT,TorusKnotGeometry:xT,Triangle:la,TriangleFanDrawMode:_K,TriangleStripDrawMode:gK,TrianglesDrawMode:mK,TubeGeometry:bT,TwoPassDoubleSide:uK,UVMapping:YS,Uint16BufferAttribute:fR,Uint32BufferAttribute:dR,Uint8BufferAttribute:xJ,Uint8ClampedBufferAttribute:bJ,Uniform:FR,UniformsGroup:Tre,UniformsLib:St,UniformsUtils:NV,UnsignedByteType:tu,UnsignedInt248Type:$f,UnsignedIntType:sh,UnsignedShort4444Type:nR,UnsignedShort5551Type:iR,UnsignedShortType:qS,VSMShadowMap:nc,Vector2:qe,Vector3:re,Vector4:di,VectorKeyframeTrack:Bv,VideoTexture:cie,WebGL1Renderer:XV,WebGL3DRenderTarget:oJ,WebGLArrayRenderTarget:sJ,WebGLCoordinateSystem:Zc,WebGLCubeRenderTarget:FV,WebGLMultipleRenderTargets:aJ,WebGLRenderTarget:hc,WebGLRenderer:tT,WebGLUtils:WV,WebGPUCoordinateSystem:kv,WireframeGeometry:c6,WrapAroundEnding:Mv,ZeroCurvatureEnding:gp,ZeroFactor:kz,ZeroSlopeEnding:_p,ZeroStencilOp:yK,_SRGBAFormat:Vw,createCanvasElement:RV,sRGBEncoding:Gf},Symbol.toStringTag,{value:"Module"}));function Xre(){const n=G.useRef(null),e=G.useRef(null);return G.useEffect(()=>{const t=n.current,i=e.current,r=new rT;r.background=new Ot(657930);const s=new pr(50,window.innerWidth/window.innerHeight,.1,100);s.position.z=5;const o=new tT({antialias:!0});o.setSize(window.innerWidth,window.innerHeight),o.setPixelRatio(window.devicePixelRatio),t.appendChild(o.domElement);const a=new C_(10,10),l=new wT({color:1579032,roughness:.8,metalness:.1}),c=new xs(a,l);r.add(c);const u=new IR(16777215,1.5,10,2);u.position.set(0,0,1),r.add(u);const d=new kR(2236962);r.add(d);const m=new qe(0,0),y=new qe(0,0);let x=1,T=Date.now();const S=1e3,w=1500,P=D=>{m.x=D.clientX/window.innerWidth*2-1,m.y=-(D.clientY/window.innerHeight)*2+1,i&&(i.style.left=`${D.clientX}px`,i.style.top=`${D.clientY}px`,i.style.backgroundColor=`rgba(255, 255, 255, ${x*.4})`,i.style.width=`${6+10*x}px`,i.style.height=`${6+10*x}px`,i.style.boxShadow=`0 0 8px rgba(255, 255, 255, ${x*.15})`),T=Date.now(),x=1,u.intensity=1.5*x};window.addEventListener("mousemove",P);const M=()=>{s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)};window.addEventListener("resize",M);const I=new UR,k=()=>{requestAnimationFrame(k),y.lerp(m,.15),I.setFromCamera(y,s);const D=new Xc(new re(0,0,1),0),H=new re;I.ray.intersectPlane(D,H),u.position.copy(H).add(new re(0,0,1));const z=Date.now()-T;z>S&&(x=1-Math.min(1,(z-S)/w),x=Math.max(x,0),u.intensity=1.5*x,i&&(i.style.backgroundColor=`rgba(255, 255, 255, ${x*.4})`,i.style.width=`${6+10*x}px`,i.style.height=`${6+10*x}px`,i.style.boxShadow=`0 0 8px rgba(255, 255, 255, ${x*.15})`)),o.render(r,s)};return k(),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("resize",M),t.removeChild(o.domElement)}},[]),U.jsxs(U.Fragment,{children:[U.jsx("div",{ref:n,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:0,pointerEvents:"none"}}),U.jsx("div",{ref:e,style:{position:"fixed",width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.4)",pointerEvents:"none",mixBlendMode:"difference",transform:"translate(-50%, -50%)",zIndex:9999,transition:"width 0.3s ease, height 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease",boxShadow:"0 0 8px rgba(255, 255, 255, 0.15)"}})]})}function Gre(){const{isAuthenticated:n}=Sh();return G.useEffect(()=>{const e=document.querySelector(".custom-cursor"),t=i=>{e.style.left=`${i.clientX}px`,e.style.top=`${i.clientY}px`};return document.addEventListener("mousemove",t),()=>document.removeEventListener("mousemove",t)},[]),U.jsxs("div",{className:"home-container relative w-full h-screen overflow-hidden font-[Inter]",children:[U.jsx(Xre,{}),U.jsx("div",{className:"home-image home-background absolute inset-0 w-full h-full z-0 pointer-events-none"}),U.jsxs("div",{className:"content relative z-10 text-gray-200 flex flex-col justify-center items-center text-center p-5 h-full pointer-events-auto",children:[U.jsxs("div",{className:"quote-container max-w-4xl relative",children:[U.jsx("img",{src:"/DEFO.png",alt:"Airplane",className:"plane-image"}),U.jsx("div",{className:"quote uppercase font-bold text-[8vw] mb-20 relative z-10",children:"Flight Tracker"}),U.jsx("div",{className:"author italic opacity-80 mt-8 text-sm md:text-base",children:"Rastrea vuelos en tiempo real alrededor del mundo."}),U.jsx("div",{className:"book opacity-60 mt-4 text-sm",children:"Pulsa 'Live Map' para empezar."})]}),U.jsx("a",{href:"/map",className:"live-map-link",children:U.jsxs("button",{className:"learn-more",children:[U.jsx("span",{className:"circle","aria-hidden":"true",children:U.jsx("span",{className:"icon arrow"})}),U.jsx("span",{className:"button-text",children:"Live Map"})]})})]}),U.jsx("div",{className:"custom-cursor"})]})}const Yre=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qre=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),eL=n=>{const e=qre(n);return e.charAt(0).toUpperCase()+e.slice(1)},F6=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),Zre=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Kre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Jre=G.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},l)=>G.createElement("svg",{ref:l,...Kre,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:F6("lucide",r),...!s&&!Zre(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>G.createElement(c,u)),...Array.isArray(s)?s:[s]]));const fd=(n,e)=>{const t=G.forwardRef(({className:i,...r},s)=>G.createElement(Jre,{ref:s,iconNode:e,className:F6(`lucide-${Yre(eL(n))}`,`lucide-${n}`,i),...r}));return t.displayName=eL(n),t};const Qre=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ese=fd("database",Qre);const tse=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],nse=fd("house",tse);const ise=[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]],rse=fd("log-in",ise);const sse=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],ose=fd("log-out",sse);const ase=[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]],lse=fd("radio",ase);const cse=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],use=fd("user-plus",cse);const hse=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fse=fd("user",hse);const dse=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],pse=fd("users",dse);function mse({visible:n,setVisible:e}){const{isAuthenticated:t,logout:i}=Sh(),r=bh(),[s,o]=G.useState(null),a=G.useRef(null);G.useEffect(()=>{if(s!==null&&a.current){const x=document.querySelectorAll(".navbar__item")[s];x&&(a.current.style.top=`${x.offsetTop}px`)}},[s]);const l=im();G.useEffect(()=>{e(!1)},[l.pathname]);const c=async()=>{try{await i(),e(!1),r("/login")}catch(y){console.error("Error al cerrar sesin:",y),alert("Hubo un problema al cerrar sesin.")}},u=[{to:"/",icon:U.jsx(nse,{size:24}),label:"Inicio"},{to:"/map",icon:U.jsx(lse,{size:24}),label:"Live Map"},{to:"/scanner",icon:U.jsx(pse,{size:24}),label:"Scanner"}],d=t?[{to:"/data",icon:U.jsx(ese,{size:24}),label:"Data"},{to:"/profile",icon:U.jsx(fse,{size:24}),label:"Perfil"},{icon:U.jsx(ose,{size:24}),label:"Cerrar sesin",onClick:c}]:[{to:"/login",icon:U.jsx(rse,{size:20}),label:"Iniciar sesin"},{to:"/register",icon:U.jsx(use,{size:20}),label:"Registrarse"}],m=[...u,...d];return U.jsxs(U.Fragment,{children:[U.jsxs("label",{className:"hamburger",children:[U.jsx("input",{type:"checkbox",checked:n,onChange:()=>e(!n)}),U.jsxs("svg",{viewBox:"0 0 42 42",children:[U.jsx("path",{d:"M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22",className:"line line-top-bottom"}),U.jsx("path",{d:"M7 16 27 16",className:"line"})]})]}),U.jsx("nav",{className:`navbar ${n?"":"navbar--hidden"}`,children:U.jsxs("ul",{className:"navbar__menu",children:[m.map((y,x)=>U.jsx("li",{className:"navbar__item",onMouseEnter:()=>o(x),onMouseLeave:()=>o(null),children:y.onClick?U.jsxs("button",{onClick:y.onClick,className:"navbar__link text-left w-full",children:[y.icon,U.jsx("span",{children:y.label})]}):U.jsxs(LS,{to:y.to,className:"navbar__link",onClick:()=>e(!1),children:[y.icon,U.jsx("span",{children:y.label})]})},x)),U.jsx("li",{className:"navbar__indicator",ref:a})]})})]})}function gse(){const[n,e]=G.useState(!0);return G.useEffect(()=>{const t=document.querySelector(".custom-cursor");if(!t)return;const i=o=>{t.style.left=`${o.clientX}px`,t.style.top=`${o.clientY}px`},r=()=>t.classList.add("cursor-hover"),s=()=>t.classList.remove("cursor-hover");return document.addEventListener("mousemove",i),document.querySelectorAll("a, button").forEach(o=>{o.addEventListener("mouseenter",r),o.addEventListener("mouseleave",s)}),()=>{document.removeEventListener("mousemove",i),document.querySelectorAll("a, button").forEach(o=>{o.removeEventListener("mouseenter",r),o.removeEventListener("mouseleave",s)})}},[]),U.jsxs("div",{className:"app-layout",children:[U.jsx(mse,{visible:n,setVisible:e}),U.jsx("main",{className:`content-area ${n?"":"navbar-hidden"}`,children:U.jsx(qB,{})}),U.jsx("div",{className:"custom-cursor"})]})}function _se(){const n=bh();return G.useEffect(()=>{window.history.pushState(null,"",window.location.href),window.onpopstate=()=>window.history.go(1);const e=t=>{(t.key==="F12"||t.ctrlKey&&t.key.toLowerCase()==="u"||t.ctrlKey&&t.shiftKey&&t.key.toLowerCase()==="i")&&(t.preventDefault(),t.stopPropagation())};return document.addEventListener("contextmenu",t=>t.preventDefault()),document.addEventListener("keydown",e),cc?.currentUser&&(cc.signOut(),localStorage.clear(),sessionStorage.clear()),()=>{document.removeEventListener("keydown",e),document.oncontextmenu=null,window.onpopstate=null}},[]),U.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen text-center transition-all",style:{backgroundColor:"#ffffff",color:"#000000",fontFamily:"Arial, Helvetica, sans-serif",letterSpacing:"0.05em"},children:[U.jsx("h1",{className:"text-[12vw] font-extrabold leading-none tracking-tighter",style:{borderBottom:"2px solid #000",paddingBottom:"0.3em",marginBottom:"0.2em"},children:"404"}),U.jsx("h2",{className:"text-[1.5rem] uppercase tracking-widest font-medium",style:{marginBottom:"1.5rem"},children:"Page Not Found"}),U.jsxs("p",{className:"max-w-md text-sm font-light text-gray-700",style:{color:"#111",opacity:.7,marginBottom:"2.5rem"},children:["This page does not exist or has been restricted.",U.jsx("br",{}),"Please return to the home page."]}),U.jsx("button",{onClick:()=>n("/"),style:{backgroundColor:"#000",color:"#fff",border:"2px solid #000",padding:"0.75rem 2rem",fontWeight:"600",letterSpacing:"0.05em",textTransform:"uppercase",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.backgroundColor="#fff",e.target.style.color="#000"},onMouseOut:e=>{e.target.style.backgroundColor="#000",e.target.style.color="#fff"},children:"Return Home"})]})}(function(){var n=L.Marker.prototype._initIcon,e=L.Marker.prototype._setPos,t=L.DomUtil.TRANSFORM==="msTransform";L.Marker.addInitHook(function(){var i=this.options.icon&&this.options.icon.options,r=i&&this.options.icon.options.iconAnchor;r&&(r=r[0]+"px "+r[1]+"px"),this.options.rotationOrigin=this.options.rotationOrigin||r||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",function(s){s.target._applyRotation()})}),L.Marker.include({_initIcon:function(){n.call(this)},_setPos:function(i){e.call(this,i),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[L.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,t?this._icon.style[L.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[L.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(i){return this.options.rotationAngle=i,this.update(),this},setRotationOrigin:function(i){return this.options.rotationOrigin=i,this.update(),this}})})();const yse=new c0.Icon({iconUrl:'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="%2300ff00" stroke-width="3"/><circle cx="12" cy="12" r="6" fill="none" stroke="%2300ff00" stroke-width="3"/><circle cx="12" cy="12" r="2" fill="%2300ff00"/><line x1="12" y1="2" x2="12" y2="6" stroke="%2300ff00" stroke-width="3"/></svg>',iconSize:[28,28],iconAnchor:[14,14]}),vse=(n,e)=>new c0.Icon({iconUrl:`data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${n}"><path d="M22,16.21V14l-8-5V3.5c0-0.83-0.67-1.5-1.5-1.5S11,2.67,11,3.5V9l-8,5v2.21l8-2.81V19l-2,1.5V22l3.5-1l3.5,1v-1.5L14,19v-5.62L22,16.21z" stroke="black" stroke-width="0.5"/></svg>`,iconSize:[28,28],iconAnchor:[14,14],rotationAngle:e||0}),xse=({center:n,radii:e,rotation:t,...i})=>{const r=G.useRef();return G.useEffect(()=>{r.current&&(r.current.setLatLng(n),r.current.setRadius(Math.max(...e)),r.current.setStyle({...i,transform:`rotate(${t}deg) scaleX(${e[0]/e[1]})`}))},[n,e,t,i]),U.jsx(x$,{center:n,radius:1,ref:r,...i})};function bse(){const[n,e]=G.useState(null),[t,i]=G.useState([]),[r,s]=G.useState(null),[o,a]=G.useState(0),[l,c]=G.useState(null),u=G.useRef(null),d=G.useRef(null),m=G.useRef(null);G.useEffect(()=>{const S=setInterval(()=>{a(w=>(w+1.5)%360)},30);return()=>clearInterval(S)},[]),G.useEffect(()=>{if(!u.current||!n)return;d.current&&u.current.removeLayer(d.current);const S=.6,w=.3,P=o*Math.PI/180,M=c0.polygon([[n.lat,n.lon],[n.lat+S*Math.cos(P-.15),n.lon+w*Math.sin(P-.15)],[n.lat+S*Math.cos(P+.15),n.lon+w*Math.sin(P+.15)]],{color:"#00ff00",fillColor:"rgba(0, 255, 0, 0.3)",weight:2,opacity:.8}).addTo(u.current);return d.current=M,()=>{d.current&&u.current.removeLayer(d.current)}},[o,n]),G.useEffect(()=>(navigator.geolocation.getCurrentPosition(S=>{const w={lat:S.coords.latitude,lon:S.coords.longitude};e(w),y(w.lat,w.lon)},S=>s("Error getting location: "+S.message)),m.current=new Audio("https://assets.mixkit.co/sfx/preview/mixkit-sonar-sweep-1494.mp3"),m.current.loop=!0,m.current.volume=.3,m.current.play(),()=>{m.current&&(m.current.pause(),m.current=null)}),[]);const y=async(S,w)=>{try{const M=(await is.get("/flights/nearby",{params:{lat:S,lon:w,radius:100},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.nearby_flights.map(I=>{const k=I[I.length-1];return[...I,k]});i(M),x(M)}catch(P){console.error(P),s(P.response?.data?.message||"Failed to fetch flights")}},x=S=>{if(S.length===0)return;const w=S.reduce((P,M)=>{const I=M[M.length-1];return I<P.distance?{distance:I,flight:M}:P},{distance:1/0,flight:null});w.distance<10?(c({level:"danger",message:`WARNING! Flight ${w.flight[1]?.trim()} is ${w.distance.toFixed(1)} km away!`}),T("danger")):w.distance<30?(c({level:"warning",message:`Flight ${w.flight[1]?.trim()} approaching (${w.distance.toFixed(1)} km)`}),T("warning")):c(null)},T=S=>{const w=new Audio(S==="danger"?"https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3":"https://assets.mixkit.co/sfx/preview/mixkit-sci-fi-positive-interface-beep-158.mp3");w.volume=.5,w.play()};return U.jsxs("div",{className:"p-4 bg-black text-green-400 font-mono",style:{textShadow:"0 0 5px #00ff00"},children:[U.jsxs("h2",{className:"text-3xl font-extrabold mb-4 border-b-2 border-green-400 pb-2 tracking-wider",children:[U.jsx("span",{className:"text-green-300",children:"CHEMISNATION"})," | ",U.jsx("span",{className:"text-green-200",children:"RICO PLANET"})]}),U.jsx("h3",{className:"text-xl font-bold mb-6 text-green-300",children:"LOCATIONS | CLUTTER CHRIST"}),r&&U.jsx("div",{className:"bg-red-900/50 border-l-4 border-red-500 p-3 mb-4",children:r}),l&&U.jsx("div",{className:`p-3 mb-4 border-l-4 ${l.level==="danger"?"bg-red-900/30 border-red-500 text-red-100":"bg-yellow-900/30 border-yellow-500 text-yellow-100"}`,children:U.jsxs("div",{className:"flex items-center",children:[U.jsx("span",{className:"mr-2",children:""}),U.jsx("span",{children:l.message})]})}),n&&U.jsxs("div",{className:"relative",children:[U.jsxs(NP,{center:[n.lat,n.lon],zoom:9,style:{height:"600px",width:"100%",marginBottom:"20px"},whenCreated:S=>u.current=S,className:"radar-screen",children:[U.jsx(DP,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",className:"radar-tiles"}),[1.2,.8,.4].map((S,w)=>U.jsx(xse,{center:[n.lat,n.lon],radii:[S*.6*1e5,S*.3*1e5],rotation:o,color:"rgba(0, 255, 0, 0.2)",weight:1},w)),U.jsx(Ug,{position:[n.lat,n.lon],icon:yse,children:U.jsx(mv,{className:"radar-popup",children:"RADAR STATION"})}),t.map((S,w)=>{const P=S[6],M=S[5];if(P===null||M===null)return null;const I=S[S.length-1],k=I<20?"red":I<50?"orange":"green",D=S[10]||0;return U.jsx(Ug,{position:[P,M],icon:vse(k==="red"?"#ff0000":k==="orange"?"#ff8000":"#00ff00",D),children:U.jsx(mv,{className:`radar-popup ${k}`,children:U.jsxs("div",{className:"text-sm",children:[U.jsxs("div",{className:"flex justify-between",children:[U.jsx("strong",{children:S[1]?.trim()||"UNKNOWN"}),U.jsxs("span",{children:[I.toFixed(1)," km"]})]}),U.jsxs("div",{children:["ALT: ",Math.round(S[7])," m"]}),U.jsxs("div",{children:["SPD: ",Math.round(S[9])," km/h"]}),U.jsxs("div",{children:["HDG: ",D,""]}),U.jsxs("div",{children:["ORG: ",S[2]]})]})})},w)})]}),U.jsx("div",{className:"radar-scan-overlay",style:{background:`radial-gradient(ellipse at center, 
                transparent 0%, 
                rgba(0, 255, 0, 0.05) 30%,
                transparent 70%)`}})]}),U.jsx("div",{className:"overflow-x-auto",children:U.jsxs("table",{className:"w-full border border-green-400",children:[U.jsx("thead",{children:U.jsxs("tr",{className:"bg-green-900/50",children:[U.jsx("th",{className:"p-2 border border-green-400",children:"Callsign"}),U.jsx("th",{className:"p-2 border border-green-400",children:"Country"}),U.jsx("th",{className:"p-2 border border-green-400",children:"Altitude"}),U.jsx("th",{className:"p-2 border border-green-400",children:"Speed"}),U.jsx("th",{className:"p-2 border border-green-400",children:"Heading"}),U.jsx("th",{className:"p-2 border border-green-400",children:"Distance"})]})}),U.jsx("tbody",{children:t.length===0?U.jsx("tr",{children:U.jsx("td",{colSpan:"6",className:"p-2 text-center",children:"No flights detected"})}):t.map((S,w)=>U.jsxs("tr",{className:"hover:bg-green-900/10",children:[U.jsx("td",{className:"p-2 border border-green-400",children:S[1]?.trim()}),U.jsx("td",{className:"p-2 border border-green-400",children:S[2]}),U.jsxs("td",{className:"p-2 border border-green-400",children:[Math.round(S[7])," m"]}),U.jsxs("td",{className:"p-2 border border-green-400",children:[Math.round(S[9])," km/h"]}),U.jsxs("td",{className:"p-2 border border-green-400",children:[S[10]||0,""]}),U.jsxs("td",{className:"p-2 border border-green-400",children:[S[S.length-1]?.toFixed(2)," km"]})]},w))})]})}),U.jsx("style",{jsx:!0,children:`
        .radar-screen {
          background-color: #000;
          border: 3px solid #00ff00;
          box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }
        .radar-tiles {
          filter: grayscale(100%) contrast(150%) brightness(0.5) hue-rotate(90deg);
        }
        .radar-popup {
          background: #111;
          color: #0f0;
          border: 2px solid #0f0;
          font-family: 'Courier New', monospace;
          font-weight: bold;
          text-shadow: 0 0 3px #00ff00;
        }
        .radar-popup.red {
          border-color: #f00;
          color: #f00;
        }
        .radar-popup.orange {
          border-color: #ff8000;
          color: #ff8000;
        }
        .radar-scan-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          pointer-events: none;
          z-index: 1000;
          mix-blend-mode: screen;
          transform-origin: center;
        }
      `})]})}var x1={exports:{}},b1={};var tL;function wse(){if(tL)return b1;tL=1;var n=l0();function e(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var t=typeof Object.is=="function"?Object.is:e,i=n.useSyncExternalStore,r=n.useRef,s=n.useEffect,o=n.useMemo,a=n.useDebugValue;return b1.useSyncExternalStoreWithSelector=function(l,c,u,d,m){var y=r(null);if(y.current===null){var x={hasValue:!1,value:null};y.current=x}else x=y.current;y=o(function(){function S(k){if(!w){if(w=!0,P=k,k=d(k),m!==void 0&&x.hasValue){var D=x.value;if(m(D,k))return M=D}return M=k}if(D=M,t(P,k))return D;var H=d(k);return m!==void 0&&m(D,H)?(P=k,D):(P=k,M=H)}var w=!1,P,M,I=u===void 0?null:u;return[function(){return S(c())},I===null?void 0:function(){return S(I())}]},[c,u,d,m]);var T=i(l,y[0],y[1]);return s(function(){x.hasValue=!0,x.value=T},[T]),a(T),T},b1}var nL;function Sse(){return nL||(nL=1,x1.exports=wse()),x1.exports}Sse();function Tse(n){n()}function Ese(){let n=null,e=null;return{clear(){n=null,e=null},notify(){Tse(()=>{let t=n;for(;t;)t.callback(),t=t.next})},get(){const t=[];let i=n;for(;i;)t.push(i),i=i.next;return t},subscribe(t){let i=!0;const r=e={callback:t,next:null,prev:e};return r.prev?r.prev.next=r:n=r,function(){!i||n===null||(i=!1,r.next?r.next.prev=r.prev:e=r.prev,r.prev?r.prev.next=r.next:n=r.next)}}}}var iL={notify(){},get:()=>[]};function Ase(n,e){let t,i=iL,r=0,s=!1;function o(T){u();const S=i.subscribe(T);let w=!1;return()=>{w||(w=!0,S(),d())}}function a(){i.notify()}function l(){x.onStateChange&&x.onStateChange()}function c(){return s}function u(){r++,t||(t=n.subscribe(l),i=Ese())}function d(){r--,t&&r===0&&(t(),t=void 0,i.clear(),i=iL)}function m(){s||(s=!0,u())}function y(){s&&(s=!1,d())}const x={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:m,tryUnsubscribe:y,getListeners:()=>i};return x}var Mse=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Cse=Mse(),Pse=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Rse=Pse(),Ise=()=>Cse||Rse?G.useLayoutEffect:G.useEffect,kse=Ise(),Ose=Symbol.for("react-redux-context"),Lse=typeof globalThis<"u"?globalThis:{};function Nse(){if(!G.createContext)return{};const n=Lse[Ose]??=new Map;let e=n.get(G.createContext);return e||(e=G.createContext(null),n.set(G.createContext,e)),e}var i_=Nse();function Dse(n){const{children:e,context:t,serverState:i,store:r}=n,s=G.useMemo(()=>{const l=Ase(r);return{store:r,subscription:l,getServerState:i?()=>i:void 0}},[r,i]),o=G.useMemo(()=>r.getState(),[r]);kse(()=>{const{subscription:l}=s;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==r.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[s,o]);const a=t||i_;return G.createElement(a.Provider,{value:s},e)}var Fse=Dse;function U6(n=i_){return function(){return G.useContext(n)}}var Use=U6();function B6(n=i_){const e=n===i_?Use:U6(n),t=()=>{const{store:i}=e();return i};return Object.assign(t,{withTypes:()=>t}),t}var Bse=B6();function zse(n=i_){const e=n===i_?Bse:B6(n),t=()=>e().dispatch;return Object.assign(t,{withTypes:()=>t}),t}var BR=zse();function Hs(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var Vse=typeof Symbol=="function"&&Symbol.observable||"@@observable",rL=Vse,w1=()=>Math.random().toString(36).substring(7).split("").join("."),Hse={INIT:`@@redux/INIT${w1()}`,REPLACE:`@@redux/REPLACE${w1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${w1()}`},jw=Hse;function zR(n){if(typeof n!="object"||n===null)return!1;let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e||Object.getPrototypeOf(n)===null}function z6(n,e,t){if(typeof n!="function")throw new Error(Hs(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(Hs(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(Hs(1));return t(z6)(n,e)}let i=n,r=e,s=new Map,o=s,a=0,l=!1;function c(){o===s&&(o=new Map,s.forEach((S,w)=>{o.set(w,S)}))}function u(){if(l)throw new Error(Hs(3));return r}function d(S){if(typeof S!="function")throw new Error(Hs(4));if(l)throw new Error(Hs(5));let w=!0;c();const P=a++;return o.set(P,S),function(){if(w){if(l)throw new Error(Hs(6));w=!1,c(),o.delete(P),s=null}}}function m(S){if(!zR(S))throw new Error(Hs(7));if(typeof S.type>"u")throw new Error(Hs(8));if(typeof S.type!="string")throw new Error(Hs(17));if(l)throw new Error(Hs(9));try{l=!0,r=i(r,S)}finally{l=!1}return(s=o).forEach(P=>{P()}),S}function y(S){if(typeof S!="function")throw new Error(Hs(10));i=S,m({type:jw.REPLACE})}function x(){const S=d;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(Hs(11));function P(){const I=w;I.next&&I.next(u())}return P(),{unsubscribe:S(P)}},[rL](){return this}}}return m({type:jw.INIT}),{dispatch:m,subscribe:d,getState:u,replaceReducer:y,[rL]:x}}function Wse(n){Object.keys(n).forEach(e=>{const t=n[e];if(typeof t(void 0,{type:jw.INIT})>"u")throw new Error(Hs(12));if(typeof t(void 0,{type:jw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Hs(13))})}function jse(n){const e=Object.keys(n),t={};for(let s=0;s<e.length;s++){const o=e[s];typeof n[o]=="function"&&(t[o]=n[o])}const i=Object.keys(t);let r;try{Wse(t)}catch(s){r=s}return function(o={},a){if(r)throw r;let l=!1;const c={};for(let u=0;u<i.length;u++){const d=i[u],m=t[d],y=o[d],x=m(y,a);if(typeof x>"u")throw a&&a.type,new Error(Hs(14));c[d]=x,l=l||x!==y}return l=l||i.length!==Object.keys(o).length,l?c:o}}function $w(...n){return n.length===0?e=>e:n.length===1?n[0]:n.reduce((e,t)=>(...i)=>e(t(...i)))}function $se(...n){return e=>(t,i)=>{const r=e(t,i);let s=()=>{throw new Error(Hs(15))};const o={getState:r.getState,dispatch:(l,...c)=>s(l,...c)},a=n.map(l=>l(o));return s=$w(...a)(r.dispatch),{...r,dispatch:s}}}function Xse(n){return zR(n)&&"type"in n&&typeof n.type=="string"}var V6=Symbol.for("immer-nothing"),sL=Symbol.for("immer-draftable"),$a=Symbol.for("immer-state");function oc(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var r_=Object.getPrototypeOf;function Gp(n){return!!n&&!!n[$a]}function _h(n){return n?H6(n)||Array.isArray(n)||!!n[sL]||!!n.constructor?.[sL]||ET(n)||AT(n):!1}var Gse=Object.prototype.constructor.toString();function H6(n){if(!n||typeof n!="object")return!1;const e=r_(n);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Gse}function Xw(n,e){TT(n)===0?Reflect.ownKeys(n).forEach(t=>{e(t,n[t],n)}):n.forEach((t,i)=>e(i,t,n))}function TT(n){const e=n[$a];return e?e.type_:Array.isArray(n)?1:ET(n)?2:AT(n)?3:0}function sC(n,e){return TT(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function W6(n,e,t){const i=TT(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function Yse(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function ET(n){return n instanceof Map}function AT(n){return n instanceof Set}function cp(n){return n.copy_||n.base_}function oC(n,e){if(ET(n))return new Map(n);if(AT(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=H6(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[$a];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(r_(n),i)}else{const i=r_(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function VR(n,e=!1){return MT(n)||Gp(n)||!_h(n)||(TT(n)>1&&(n.set=n.add=n.clear=n.delete=qse),Object.freeze(n),e&&Object.entries(n).forEach(([t,i])=>VR(i,!0))),n}function qse(){oc(2)}function MT(n){return Object.isFrozen(n)}var Zse={};function Yp(n){const e=Zse[n];return e||oc(0,n),e}var Hv;function j6(){return Hv}function Kse(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function oL(n,e){e&&(Yp("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function aC(n){lC(n),n.drafts_.forEach(Jse),n.drafts_=null}function lC(n){n===Hv&&(Hv=n.parent_)}function aL(n){return Hv=Kse(Hv,n)}function Jse(n){const e=n[$a];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function lL(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[$a].modified_&&(aC(e),oc(4)),_h(n)&&(n=Gw(e,n),e.parent_||Yw(e,n)),e.patches_&&Yp("Patches").generateReplacementPatches_(t[$a].base_,n,e.patches_,e.inversePatches_)):n=Gw(e,t,[]),aC(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==V6?n:void 0}function Gw(n,e,t){if(MT(e))return e;const i=e[$a];if(!i)return Xw(e,(r,s)=>cL(n,i,e,r,s,t)),e;if(i.scope_!==n)return e;if(!i.modified_)return Yw(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const r=i.copy_;let s=r,o=!1;i.type_===3&&(s=new Set(r),r.clear(),o=!0),Xw(s,(a,l)=>cL(n,i,r,a,l,t,o)),Yw(n,r,!1),t&&n.patches_&&Yp("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function cL(n,e,t,i,r,s,o){if(Gp(r)){const a=s&&e&&e.type_!==3&&!sC(e.assigned_,i)?s.concat(i):void 0,l=Gw(n,r,a);if(W6(t,i,l),Gp(l))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(_h(r)&&!MT(r)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;Gw(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,i)&&Yw(n,r)}}function Yw(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&VR(e,t)}function Qse(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:j6(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=HR;t&&(r=[i],s=Wv);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var HR={get(n,e){if(e===$a)return n;const t=cp(n);if(!sC(t,e))return eoe(n,t,e);const i=t[e];return n.finalized_||!_h(i)?i:i===S1(n.base_,e)?(T1(n),n.copy_[e]=uC(i,n)):i},has(n,e){return e in cp(n)},ownKeys(n){return Reflect.ownKeys(cp(n))},set(n,e,t){const i=$6(cp(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=S1(cp(n),e),s=r?.[$a];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Yse(t,r)&&(t!==void 0||sC(n.base_,e)))return!0;T1(n),cC(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return S1(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,T1(n),cC(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=cp(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){oc(11)},getPrototypeOf(n){return r_(n.base_)},setPrototypeOf(){oc(12)}},Wv={};Xw(HR,(n,e)=>{Wv[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wv.deleteProperty=function(n,e){return Wv.set.call(this,n,e,void 0)};Wv.set=function(n,e,t){return HR.set.call(this,n[0],e,t,n[0])};function S1(n,e){const t=n[$a];return(t?cp(t):n)[e]}function eoe(n,e,t){const i=$6(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function $6(n,e){if(!(e in n))return;let t=r_(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=r_(t)}}function cC(n){n.modified_||(n.modified_=!0,n.parent_&&cC(n.parent_))}function T1(n){n.copy_||(n.copy_=oC(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var toe=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(l=s,...c){return o.produce(l,u=>t.call(this,u,...c))}}typeof t!="function"&&oc(6),i!==void 0&&typeof i!="function"&&oc(7);let r;if(_h(e)){const s=aL(this),o=uC(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?aC(s):lC(s)}return oL(s,i),lL(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===V6&&(r=void 0),this.autoFreeze_&&VR(r,!0),i){const s=[],o=[];Yp("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else oc(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let i,r;return[this.produce(e,t,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){_h(n)||oc(8),Gp(n)&&(n=noe(n));const e=aL(this),t=uC(n,void 0);return t[$a].isManual_=!0,lC(e),t}finishDraft(n,e){const t=n&&n[$a];(!t||!t.isManual_)&&oc(9);const{scope_:i}=t;return oL(i,e),lL(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=Yp("Patches").applyPatches_;return Gp(n)?i(n,e):this.produce(n,r=>i(r,e))}};function uC(n,e){const t=ET(n)?Yp("MapSet").proxyMap_(n,e):AT(n)?Yp("MapSet").proxySet_(n,e):Qse(n,e);return(e?e.scope_:j6()).drafts_.push(t),t}function noe(n){return Gp(n)||oc(10,n),X6(n)}function X6(n){if(!_h(n)||MT(n))return n;const e=n[$a];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=oC(n,e.scope_.immer_.useStrictShallowCopy_)}else t=oC(n,!0);return Xw(t,(i,r)=>{W6(t,i,X6(r))}),e&&(e.finalized_=!1),t}var Xa=new toe,G6=Xa.produce;Xa.produceWithPatches.bind(Xa);Xa.setAutoFreeze.bind(Xa);Xa.setUseStrictShallowCopy.bind(Xa);Xa.applyPatches.bind(Xa);Xa.createDraft.bind(Xa);Xa.finishDraft.bind(Xa);function Y6(n){return({dispatch:t,getState:i})=>r=>s=>typeof s=="function"?s(t,i,n):r(s)}var ioe=Y6(),roe=Y6,soe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$w:$w.apply(null,arguments)};function uL(n,e){function t(...i){if(e){let r=e(...i);if(!r)throw new Error(hh(0));return{type:n,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:n,payload:i[0]}}return t.toString=()=>`${n}`,t.type=n,t.match=i=>Xse(i)&&i.type===n,t}var q6=class ky extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ky.prototype)}static get[Symbol.species](){return ky}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ky(...e[0].concat(this)):new ky(...e.concat(this))}};function hL(n){return _h(n)?G6(n,()=>{}):n}function yb(n,e,t){return n.has(e)?n.get(e):n.set(e,t(e)).get(e)}function ooe(n){return typeof n=="boolean"}var aoe=()=>function(e){const{thunk:t=!0,immutableCheck:i=!0,serializableCheck:r=!0,actionCreatorCheck:s=!0}=e??{};let o=new q6;return t&&(ooe(t)?o.push(ioe):o.push(roe(t.extraArgument))),o},loe="RTK_autoBatch",fL=n=>e=>{setTimeout(e,n)},coe=(n={type:"raf"})=>e=>(...t)=>{const i=e(...t);let r=!0,s=!1,o=!1;const a=new Set,l=n.type==="tick"?queueMicrotask:n.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:fL(10):n.type==="callback"?n.queueNotification:fL(n.timeout),c=()=>{o=!1,s&&(s=!1,a.forEach(u=>u()))};return Object.assign({},i,{subscribe(u){const d=()=>r&&u(),m=i.subscribe(d);return a.add(u),()=>{m(),a.delete(u)}},dispatch(u){try{return r=!u?.meta?.[loe],s=!r,s&&(o||(o=!0,l(c))),i.dispatch(u)}finally{r=!0}}})},uoe=n=>function(t){const{autoBatch:i=!0}=t??{};let r=new q6(n);return i&&r.push(coe(typeof i=="object"?i:void 0)),r};function hoe(n){const e=aoe(),{reducer:t=void 0,middleware:i,devTools:r=!0,preloadedState:s=void 0,enhancers:o=void 0}=n||{};let a;if(typeof t=="function")a=t;else if(zR(t))a=jse(t);else throw new Error(hh(1));let l;typeof i=="function"?l=i(e):l=e();let c=$w;r&&(c=soe({trace:!1,...typeof r=="object"&&r}));const u=$se(...l),d=uoe(u);let m=typeof o=="function"?o(d):d();const y=c(...m);return z6(a,s,y)}function Z6(n){const e={},t=[];let i;const r={addCase(s,o){const a=typeof s=="string"?s:s.type;if(!a)throw new Error(hh(28));if(a in e)throw new Error(hh(29));return e[a]=o,r},addMatcher(s,o){return t.push({matcher:s,reducer:o}),r},addDefaultCase(s){return i=s,r}};return n(r),[e,t,i]}function foe(n){return typeof n=="function"}function doe(n,e){let[t,i,r]=Z6(e),s;if(foe(n))s=()=>hL(n());else{const a=hL(n);s=()=>a}function o(a=s(),l){let c=[t[l.type],...i.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[r]),c.reduce((u,d)=>{if(d)if(Gp(u)){const y=d(u,l);return y===void 0?u:y}else{if(_h(u))return G6(u,m=>d(m,l));{const m=d(u,l);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},a)}return o.getInitialState=s,o}var poe=Symbol.for("rtk-slice-createasyncthunk");function moe(n,e){return`${n}/${e}`}function goe({creators:n}={}){const e=n?.asyncThunk?.[poe];return function(i){const{name:r,reducerPath:s=r}=i;if(!r)throw new Error(hh(11));const o=(typeof i.reducers=="function"?i.reducers(voe()):i.reducers)||{},a=Object.keys(o),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(M,I){const k=typeof M=="string"?M:M.type;if(!k)throw new Error(hh(12));if(k in l.sliceCaseReducersByType)throw new Error(hh(13));return l.sliceCaseReducersByType[k]=I,c},addMatcher(M,I){return l.sliceMatchers.push({matcher:M,reducer:I}),c},exposeAction(M,I){return l.actionCreators[M]=I,c},exposeCaseReducer(M,I){return l.sliceCaseReducersByName[M]=I,c}};a.forEach(M=>{const I=o[M],k={reducerName:M,type:moe(r,M),createNotation:typeof i.reducers=="function"};boe(I)?Soe(k,I,c,e):xoe(k,I,c)});function u(){const[M={},I=[],k=void 0]=typeof i.extraReducers=="function"?Z6(i.extraReducers):[i.extraReducers],D={...M,...l.sliceCaseReducersByType};return doe(i.initialState,H=>{for(let W in D)H.addCase(W,D[W]);for(let W of l.sliceMatchers)H.addMatcher(W.matcher,W.reducer);for(let W of I)H.addMatcher(W.matcher,W.reducer);k&&H.addDefaultCase(k)})}const d=M=>M,m=new Map,y=new WeakMap;let x;function T(M,I){return x||(x=u()),x(M,I)}function S(){return x||(x=u()),x.getInitialState()}function w(M,I=!1){function k(H){let W=H[M];return typeof W>"u"&&I&&(W=yb(y,k,S)),W}function D(H=d){const W=yb(m,I,()=>new WeakMap);return yb(W,H,()=>{const z={};for(const[j,J]of Object.entries(i.selectors??{}))z[j]=_oe(J,H,()=>yb(y,H,S),I);return z})}return{reducerPath:M,getSelectors:D,get selectors(){return D(k)},selectSlice:k}}const P={name:r,reducer:T,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:S,...w(s),injectInto(M,{reducerPath:I,...k}={}){const D=I??s;return M.inject({reducerPath:D,reducer:T},k),{...P,...w(D,!0)}}};return P}}function _oe(n,e,t,i){function r(s,...o){let a=e(s);return typeof a>"u"&&i&&(a=t()),n(a,...o)}return r.unwrapped=n,r}var yoe=goe();function voe(){function n(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return n.withTypes=()=>n,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:n}}function xoe({type:n,reducerName:e,createNotation:t},i,r){let s,o;if("reducer"in i){if(t&&!woe(i))throw new Error(hh(17));s=i.reducer,o=i.prepare}else s=i;r.addCase(n,s).exposeCaseReducer(e,s).exposeAction(e,o?uL(n,o):uL(n))}function boe(n){return n._reducerDefinitionType==="asyncThunk"}function woe(n){return n._reducerDefinitionType==="reducerWithPrepare"}function Soe({type:n,reducerName:e},t,i,r){if(!r)throw new Error(hh(18));const{payloadCreator:s,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=t,d=r(n,s,u);i.exposeAction(e,d),o&&i.addCase(d.fulfilled,o),a&&i.addCase(d.pending,a),l&&i.addCase(d.rejected,l),c&&i.addMatcher(d.settled,c),i.exposeCaseReducer(e,{fulfilled:o||vb,pending:a||vb,rejected:l||vb,settled:c||vb})}function vb(){}function hh(n){return`Minified Redux Toolkit error #${n}; visit https://redux-toolkit.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}const Toe={user:null,firebaseToken:null},K6=yoe({name:"auth",initialState:Toe,reducers:{login:(n,e)=>{n.user=e.payload.user,n.firebaseToken=e.payload.token},logout:n=>{n.user=null,n.firebaseToken=null}}}),{login:J6,logout:Eoe}=K6.actions,Aoe=K6.reducer;function Moe(){const[n,e]=G.useState(""),[t,i]=G.useState(""),[r,s]=G.useState(!1),[o,a]=G.useState(null),[l,c]=G.useState(!1),u=bh(),d=BR(),m=async y=>{y.preventDefault(),a(null),c(!0);try{const x=await Cq(cc,n,t),S=(await is.post("/login")).data;d(J6({user:S.user,token:null})),u("/")}catch(x){console.error("Login error:",x),a("Invalid credentials or connection issue.")}c(!1)};return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white to-neutral-100 flex items-center justify-center px-4 font-[Inter]",children:U.jsxs("div",{className:"w-full max-w-sm bg-white/60 backdrop-blur-2xl border border-black/10 rounded-3xl shadow-xl p-10 transition-all duration-300",children:[U.jsxs("div",{className:"text-center mb-10 animate-fade-in",children:[U.jsx("h1",{className:"text-5xl font-semibold tracking-tight text-black mb-3",children:"Flighty"}),U.jsx("p",{className:"text-sm text-neutral-600 tracking-wide",children:"Sign in to your control panel"})]}),U.jsxs("form",{onSubmit:m,className:"space-y-7",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-medium uppercase tracking-widest text-neutral-700 mb-2",children:"Email Address"}),U.jsx("input",{type:"email",value:n,onChange:y=>e(y.target.value),required:!0,className:"w-full px-4 py-3 text-sm bg-transparent border border-black/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-black/80 shadow-sm transition-all"})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-medium uppercase tracking-widest text-neutral-700 mb-2",children:"Password"}),U.jsx("div",{className:"relative",children:U.jsx("input",{type:r?"text":"password",value:t,onChange:y=>i(y.target.value),required:!0,className:"w-full px-4 py-3 text-sm bg-transparent border border-black/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-black/80 shadow-sm transition-all"})}),U.jsxs("div",{className:"flex items-center mt-2",children:[U.jsx("input",{type:"checkbox",id:"showPassword",checked:r,onChange:()=>s(!r),className:"h-4 w-4 text-black border-gray-400 rounded focus:ring-black"}),U.jsx("label",{htmlFor:"showPassword",className:"ml-2 text-sm text-neutral-700",children:"Show password"})]})]}),U.jsx("button",{type:"submit",disabled:l,className:"relative w-full py-3 bg-black text-white text-sm font-medium rounded-xl transition-all duration-300 hover:bg-neutral-900 hover:shadow-[0_0_12px_rgba(0,0,0,0.4)] disabled:opacity-50 disabled:cursor-not-allowed",children:l?U.jsxs("span",{className:"flex items-center justify-center",children:[U.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[U.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),U.jsx("path",{className:"opacity-75",fill:"currentColor",d:`M4 12a8 8 0 018-8V0C5.373 
                    0 0 5.373 0 12h4zm2 5.291A7.962 
                    7.962 0 014 12H0c0 3.042 1.135 
                    5.824 3 7.938l3-2.647z`})]}),"Logging in..."]}):"Login"}),o&&U.jsx("p",{className:"text-xs text-red-500 text-center mt-2 font-medium",children:o})]}),U.jsx("div",{className:"mt-6 text-center",children:U.jsxs("p",{className:"text-sm text-neutral-600",children:["Dont have an account?"," ",U.jsx("a",{href:"/register",className:"text-black font-medium hover:opacity-80 transition-opacity",children:"Create one"})]})}),U.jsx("div",{className:"mt-16 text-center text-xs text-neutral-500 tracking-wider",children:U.jsx("p",{children:" 2025 Flighty. Precision. Design. Flight."})})]})})}function Coe(){const[n,e]=G.useState({name:"",email:"",password:"",password_confirmation:""}),[t,i]=G.useState({}),[r,s]=G.useState(!1),o=bh(),a=BR(),l=u=>{const{name:d,value:m}=u.target;e(y=>({...y,[d]:m})),i(y=>({...y,[d]:"",general:""}))},c=async u=>{if(u.preventDefault(),s(!0),i({}),n.password!==n.password_confirmation){i({password:"Passwords do not match"}),s(!1);return}try{const d=await Mq(cc,n.email,n.password);await Rq(d.user,{displayName:n.name});const m=d.user,x=(await is.post("/register",{firebase_uid:m.uid,email:m.email,name:n.name})).data;a(J6({user:x.user,token:null})),o("/")}catch(d){let m="Registration error";d.code==="auth/email-already-in-use"?m="This email is already registered.":d.code==="auth/invalid-email"&&(m="Invalid email address."),i({general:m})}finally{s(!1)}};return U.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white to-neutral-100 flex items-center justify-center px-6 py-10 font-[Inter] overflow-y-auto",children:U.jsxs("div",{className:"w-full max-w-3xl bg-white/60 backdrop-blur-2xl border border-black/10 rounded-3xl shadow-xl p-12 transition-all duration-300 flex flex-col md:flex-row gap-12 items-center",children:[U.jsxs("div",{className:"flex-1 text-center md:text-left",children:[U.jsx("h1",{className:"text-6xl font-semibold tracking-tight text-black mb-3",children:"Flighty"}),U.jsx("p",{className:"text-sm text-neutral-600 tracking-wide max-w-sm",children:"Create your Flighty account and start exploring the skies."})]}),U.jsxs("div",{className:"flex-1 w-full flex flex-col",children:[U.jsxs("form",{onSubmit:c,className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-medium uppercase tracking-widest text-neutral-700 mb-2",children:"Full Name"}),U.jsx("input",{type:"text",name:"name",value:n.name,onChange:l,required:!0,className:"w-full px-4 py-3 text-sm bg-transparent border border-black/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-black/80 shadow-sm transition-all"})]}),U.jsxs("div",{children:[U.jsx("label",{className:"block text-xs font-medium uppercase tracking-widest text-neutral-700 mb-2",children:"Email Address"}),U.jsx("input",{type:"email",name:"email",value:n.email,onChange:l,required:!0,className:"w-full px-4 py-3 text-sm bg-transparent border border-black/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-black/80 shadow-sm transition-all"})]}),U.jsxs("div",{className:"flex gap-4",children:[U.jsxs("div",{className:"flex-1",children:[U.jsx("label",{className:"block text-xs font-medium uppercase tracking-widest text-neutral-700 mb-2",children:"Password"}),U.jsx("input",{type:"password",name:"password",value:n.password,onChange:l,required:!0,minLength:"8",className:"w-full px-4 py-3 text-sm bg-transparent border border-black/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-black/80 shadow-sm transition-all"})]}),U.jsxs("div",{className:"flex-1",children:[U.jsx("label",{className:"block text-xs font-medium uppercase tracking-widest text-neutral-700 mb-2",children:"Confirm"}),U.jsx("input",{type:"password",name:"password_confirmation",value:n.password_confirmation,onChange:l,required:!0,className:"w-full px-4 py-3 text-sm bg-transparent border border-black/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-black/80 shadow-sm transition-all"})]})]}),U.jsx("button",{type:"submit",disabled:r,className:"relative w-full py-3 bg-black text-white text-sm font-medium rounded-xl transition-all duration-300 hover:bg-neutral-900 hover:shadow-[0_0_12px_rgba(0,0,0,0.4)] disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Creating account...":"Register"}),t.general&&U.jsx("p",{className:"text-xs text-red-500 text-center mt-2 font-medium",children:t.general})]}),U.jsx("div",{className:"mt-6 text-center",children:U.jsxs("p",{className:"text-sm text-neutral-600",children:["Already have an account?"," ",U.jsx("a",{href:"/login",className:"text-black font-medium hover:opacity-80 transition-opacity",children:"Login"})]})}),U.jsx("div",{className:"mt-8 md:mt-auto text-center md:text-right",children:U.jsx("p",{className:"text-xs text-neutral-500 tracking-wider",children:" 2025 Flighty. Precision. Design. Flight."})})]})]})})}function Poe(){const[n,e]=G.useState(null),[t,i]=G.useState(null),[r,s]=G.useState([]);return G.useEffect(()=>{const o=async()=>{try{const l=await is.get("/auth/me");e(l.data)}catch(l){console.error(l),i("Error al cargar el perfil.")}},a=async()=>{try{const l=await is.get("/saved-flights");s(l.data.saved_flights)}catch(l){console.error(l),i("Error al cargar los vuelos guardados.")}};o(),a()},[]),t?U.jsx("div",{children:t}):n?U.jsxs("div",{children:[U.jsx("h1",{children:"Perfil"}),U.jsxs("p",{children:[U.jsx("strong",{children:"Nombre:"})," ",n.name]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Email:"})," ",n.email]}),U.jsx("h2",{children:"Vuelos Guardados"}),r.length===0?U.jsx("p",{children:"No tienes vuelos guardados."}):U.jsx("ul",{children:r.map((o,a)=>U.jsxs("li",{children:[U.jsxs("p",{children:[U.jsx("strong",{children:"Vuelo ICAO:"})," ",o.flight_icao]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Detalles:"})," ",JSON.stringify(o.flight_data)]}),U.jsxs("p",{children:[U.jsx("strong",{children:"Guardado en:"})," ",o.saved_at]})]},a))})]}):U.jsx("div",{children:"Cargando..."})}const Roe=()=>{const n=BR(),e=bh();return G.useEffect(()=>{n(Eoe()),e("/login")},[n,e]),U.jsx("div",{children:"Logging out..."})},Ioe=()=>{const[n,e]=G.useState(""),[t,i]=G.useState(""),[r,s]=G.useState(null),[o,a]=G.useState(!1),l=async c=>{c.preventDefault();try{const u=await is.post("/create-first-admin",{email:n,password:t});a(!0),s(null),console.log("Admin creado:",u.data)}catch(u){s(u.response?.data?.error||"Hubo un error al crear el administrador"),a(!1)}};return U.jsxs("div",{children:[U.jsx("h1",{children:"Crear Primer Admin"}),o&&U.jsx("p",{children:"Administrador creado exitosamente!"}),r&&U.jsx("p",{style:{color:"red"},children:r}),U.jsxs("form",{onSubmit:l,children:[U.jsxs("div",{children:[U.jsx("label",{children:"Email"}),U.jsx("input",{type:"email",value:n,onChange:c=>e(c.target.value),required:!0})]}),U.jsxs("div",{children:[U.jsx("label",{children:"Contrasea"}),U.jsx("input",{type:"password",value:t,onChange:c=>i(c.target.value),required:!0})]}),U.jsx("button",{type:"submit",children:"Crear Admin"})]})]})};function R0(n){return n+.5|0}const Nf=(n,e,t)=>Math.max(Math.min(n,t),e);function Oy(n){return Nf(R0(n*2.55),0,255)}function qf(n){return Nf(R0(n*255),0,255)}function Ku(n){return Nf(R0(n/2.55)/100,0,1)}function dL(n){return Nf(R0(n*100),0,100)}const cl={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hC=[..."0123456789ABCDEF"],koe=n=>hC[n&15],Ooe=n=>hC[(n&240)>>4]+hC[n&15],xb=n=>(n&240)>>4===(n&15),Loe=n=>xb(n.r)&&xb(n.g)&&xb(n.b)&&xb(n.a);function Noe(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&cl[n[1]]*17,g:255&cl[n[2]]*17,b:255&cl[n[3]]*17,a:e===5?cl[n[4]]*17:255}:(e===7||e===9)&&(t={r:cl[n[1]]<<4|cl[n[2]],g:cl[n[3]]<<4|cl[n[4]],b:cl[n[5]]<<4|cl[n[6]],a:e===9?cl[n[7]]<<4|cl[n[8]]:255})),t}const Doe=(n,e)=>n<255?e(n):"";function Foe(n){var e=Loe(n)?koe:Ooe;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Doe(n.a,e):void 0}const Uoe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Q6(n,e,t){const i=e*Math.min(t,1-t),r=(s,o=(s+n/30)%12)=>t-i*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function Boe(n,e,t){const i=(r,s=(r+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function zoe(n,e,t){const i=Q6(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)i[r]*=1-e-t,i[r]+=e;return i}function Voe(n,e,t,i,r){return n===r?(e-t)/i+(e<t?6:0):e===r?(t-n)/i+2:(n-e)/i+4}function WR(n){const t=n.r/255,i=n.g/255,r=n.b/255,s=Math.max(t,i,r),o=Math.min(t,i,r),a=(s+o)/2;let l,c,u;return s!==o&&(u=s-o,c=a>.5?u/(2-s-o):u/(s+o),l=Voe(t,i,r,u,s),l=l*60+.5),[l|0,c||0,a]}function jR(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(qf)}function $R(n,e,t){return jR(Q6,n,e,t)}function Hoe(n,e,t){return jR(zoe,n,e,t)}function Woe(n,e,t){return jR(Boe,n,e,t)}function e5(n){return(n%360+360)%360}function joe(n){const e=Uoe.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?Oy(+e[5]):qf(+e[5]));const r=e5(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?i=Hoe(r,s,o):e[1]==="hsv"?i=Woe(r,s,o):i=$R(r,s,o),{r:i[0],g:i[1],b:i[2],a:t}}function $oe(n,e){var t=WR(n);t[0]=e5(t[0]+e),t=$R(t),n.r=t[0],n.g=t[1],n.b=t[2]}function Xoe(n){if(!n)return;const e=WR(n),t=e[0],i=dL(e[1]),r=dL(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${r}%, ${Ku(n.a)})`:`hsl(${t}, ${i}%, ${r}%)`}const pL={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},mL={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Goe(){const n={},e=Object.keys(mL),t=Object.keys(pL);let i,r,s,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],r=0;r<t.length;r++)s=t[r],a=a.replace(s,pL[s]);s=parseInt(mL[o],16),n[a]=[s>>16&255,s>>8&255,s&255]}return n}let bb;function Yoe(n){bb||(bb=Goe(),bb.transparent=[0,0,0,0]);const e=bb[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const qoe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Zoe(n){const e=qoe.exec(n);let t=255,i,r,s;if(e){if(e[7]!==i){const o=+e[7];t=e[8]?Oy(o):Nf(o*255,0,255)}return i=+e[1],r=+e[3],s=+e[5],i=255&(e[2]?Oy(i):Nf(i,0,255)),r=255&(e[4]?Oy(r):Nf(r,0,255)),s=255&(e[6]?Oy(s):Nf(s,0,255)),{r:i,g:r,b:s,a:t}}}function Koe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Ku(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const E1=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,lg=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Joe(n,e,t){const i=lg(Ku(n.r)),r=lg(Ku(n.g)),s=lg(Ku(n.b));return{r:qf(E1(i+t*(lg(Ku(e.r))-i))),g:qf(E1(r+t*(lg(Ku(e.g))-r))),b:qf(E1(s+t*(lg(Ku(e.b))-s))),a:n.a+t*(e.a-n.a)}}function wb(n,e,t){if(n){let i=WR(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=$R(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function t5(n,e){return n&&Object.assign(e||{},n)}function gL(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=qf(n[3]))):(e=t5(n,{r:0,g:0,b:0,a:1}),e.a=qf(e.a)),e}function Qoe(n){return n.charAt(0)==="r"?Zoe(n):joe(n)}class jv{constructor(e){if(e instanceof jv)return e;const t=typeof e;let i;t==="object"?i=gL(e):t==="string"&&(i=Noe(e)||Yoe(e)||Qoe(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=t5(this._rgb);return e&&(e.a=Ku(e.a)),e}set rgb(e){this._rgb=gL(e)}rgbString(){return this._valid?Koe(this._rgb):void 0}hexString(){return this._valid?Foe(this._rgb):void 0}hslString(){return this._valid?Xoe(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,r=e.rgb;let s;const o=t===s?.5:t,a=2*o-1,l=i.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,i.r=255&c*i.r+s*r.r+.5,i.g=255&c*i.g+s*r.g+.5,i.b=255&c*i.b+s*r.b+.5,i.a=o*i.a+(1-o)*r.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=Joe(this._rgb,e._rgb,t)),this}clone(){return new jv(this.rgb)}alpha(e){return this._rgb.a=qf(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=R0(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return wb(this._rgb,2,e),this}darken(e){return wb(this._rgb,2,-e),this}saturate(e){return wb(this._rgb,1,e),this}desaturate(e){return wb(this._rgb,1,-e),this}rotate(e){return $oe(this._rgb,e),this}}function Gu(){}const eae=(()=>{let n=0;return()=>n++})();function Bn(n){return n==null}function ji(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Wn(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function mr(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function za(n,e){return mr(n)?n:e}function wn(n,e){return typeof n>"u"?e:n}const tae=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,n5=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Ii(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function fi(n,e,t,i){let r,s,o;if(ji(n))for(s=n.length,r=0;r<s;r++)e.call(t,n[r],r);else if(Wn(n))for(o=Object.keys(n),s=o.length,r=0;r<s;r++)e.call(t,n[o[r]],o[r])}function qw(n,e){let t,i,r,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(r=n[t],s=e[t],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Zw(n){if(ji(n))return n.map(Zw);if(Wn(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let r=0;for(;r<i;++r)e[t[r]]=Zw(n[t[r]]);return e}return n}function i5(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function nae(n,e,t,i){if(!i5(n))return;const r=e[n],s=t[n];Wn(r)&&Wn(s)?$v(r,s,i):e[n]=Zw(s)}function $v(n,e,t){const i=ji(e)?e:[e],r=i.length;if(!Wn(n))return n;t=t||{};const s=t.merger||nae;let o;for(let a=0;a<r;++a){if(o=i[a],!Wn(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],n,o,t)}return n}function Zy(n,e){return $v(n,e,{merger:iae})}function iae(n,e,t){if(!i5(n))return;const i=e[n],r=t[n];Wn(i)&&Wn(r)?Zy(i,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Zw(r))}const _L={"":n=>n,x:n=>n.x,y:n=>n.y};function rae(n){const e=n.split("."),t=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function sae(n){const e=rae(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function ed(n,e){return(_L[e]||(_L[e]=sae(e)))(n)}function XR(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Xv=n=>typeof n<"u",td=n=>typeof n=="function",yL=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function oae(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Jn=Math.PI,Di=2*Jn,aae=Di+Jn,Kw=Number.POSITIVE_INFINITY,lae=Jn/180,Cr=Jn/2,Kd=Jn/4,vL=Jn*2/3,Df=Math.log10,iu=Math.sign;function Ky(n,e,t){return Math.abs(n-e)<t}function xL(n){const e=Math.round(n);n=Ky(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(Df(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function cae(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((r,s)=>r-s).pop(),e}function uae(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function s_(n){return!uae(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function hae(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function r5(n,e,t){let i,r,s;for(i=0,r=n.length;i<r;i++)s=n[i][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function ac(n){return n*(Jn/180)}function GR(n){return n*(180/Jn)}function bL(n){if(!mr(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function s5(n,e){const t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i);let s=Math.atan2(i,t);return s<-.5*Jn&&(s+=Di),{angle:s,distance:r}}function fC(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function fae(n,e){return(n-e+aae)%Di-Jn}function co(n){return(n%Di+Di)%Di}function Gv(n,e,t,i){const r=co(n),s=co(e),o=co(t),a=co(s-r),l=co(o-r),c=co(r-s),u=co(r-o);return r===s||r===o||i&&s===o||a>l&&c<u}function bs(n,e,t){return Math.max(e,Math.min(t,n))}function dae(n){return bs(n,-32768,32767)}function oh(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function YR(n,e,t){t=t||(o=>n[o]<e);let i=n.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,t(s)?r=s:i=s;return{lo:r,hi:i}}const ah=(n,e,t,i)=>YR(n,t,i?r=>{const s=n[r][e];return s<t||s===t&&n[r+1][e]===t}:r=>n[r][e]<t),pae=(n,e,t)=>YR(n,t,i=>n[i][e]>=t);function mae(n,e,t){let i=0,r=n.length;for(;i<r&&n[i]<e;)i++;for(;r>i&&n[r-1]>t;)r--;return i>0||r<n.length?n.slice(i,r):n}const o5=["push","pop","shift","splice","unshift"];function gae(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),o5.forEach(t=>{const i="_onData"+XR(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const o=r.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function wL(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(o5.forEach(s=>{delete n[s]}),delete n._chartjs)}function a5(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const l5=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function c5(n,e){let t=[],i=!1;return function(...r){t=r,i||(i=!0,l5.call(window,()=>{i=!1,n.apply(e,t)}))}}function _ae(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const qR=n=>n==="start"?"left":n==="end"?"right":"center",ao=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,yae=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function u5(n,e,t){const i=e.length;let r=0,s=i;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:d,max:m,minDefined:y,maxDefined:x}=o.getUserBounds();if(y){if(r=Math.min(ah(l,u,d).lo,t?i:ah(e,u,o.getPixelForValue(d)).lo),c){const T=l.slice(0,r+1).reverse().findIndex(S=>!Bn(S[a.axis]));r-=Math.max(0,T)}r=bs(r,0,i-1)}if(x){let T=Math.max(ah(l,o.axis,m,!0).hi+1,t?0:ah(e,u,o.getPixelForValue(m),!0).hi+1);if(c){const S=l.slice(T-1).findIndex(w=>!Bn(w[a.axis]));T+=Math.max(0,S)}s=bs(T,r,i)-r}else s=i-r}return{start:r,count:s}}function h5(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=r,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,r),s}const Sb=n=>n===0||n===1,SL=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Di/t)),TL=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Di/t)+1,Jy={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Cr)+1,easeOutSine:n=>Math.sin(n*Cr),easeInOutSine:n=>-.5*(Math.cos(Jn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Sb(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Sb(n)?n:SL(n,.075,.3),easeOutElastic:n=>Sb(n)?n:TL(n,.075,.3),easeInOutElastic(n){return Sb(n)?n:n<.5?.5*SL(n*2,.1125,.45):.5+.5*TL(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Jy.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Jy.easeInBounce(n*2)*.5:Jy.easeOutBounce(n*2-1)*.5+.5};function ZR(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function EL(n){return ZR(n)?n:new jv(n)}function A1(n){return ZR(n)?n:new jv(n).saturate(.5).darken(.1).hexString()}const vae=["x","y","borderWidth","radius","tension"],xae=["color","borderColor","backgroundColor"];function bae(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:xae},numbers:{type:"number",properties:vae}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function wae(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const AL=new Map;function Sae(n,e){e=e||{};const t=n+JSON.stringify(e);let i=AL.get(t);return i||(i=new Intl.NumberFormat(n,e),AL.set(t,i)),i}function I0(n,e,t){return Sae(e,t).format(n)}const f5={values(n){return ji(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let r,s=n;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),s=Tae(n,t)}const o=Df(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),I0(n,i,l)},logarithmic(n,e,t){if(n===0)return"0";const i=t[e].significand||n/Math.pow(10,Math.floor(Df(n)));return[1,2,3,5,10,15].includes(i)||e>.8*t.length?f5.numeric.call(this,n,e,t):""}};function Tae(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var CT={formatters:f5};function Eae(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:CT.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const qp=Object.create(null),dC=Object.create(null);function Qy(n,e){if(!e)return n;const t=e.split(".");for(let i=0,r=t.length;i<r;++i){const s=t[i];n=n[s]||(n[s]=Object.create(null))}return n}function M1(n,e,t){return typeof e=="string"?$v(Qy(n,e),t):$v(Qy(n,""),e)}class Aae{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>A1(r.backgroundColor),this.hoverBorderColor=(i,r)=>A1(r.borderColor),this.hoverColor=(i,r)=>A1(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return M1(this,e,t)}get(e){return Qy(this,e)}describe(e,t){return M1(dC,e,t)}override(e,t){return M1(qp,e,t)}route(e,t,i,r){const s=Qy(this,e),o=Qy(this,i),a="_"+t;Object.defineProperties(s,{[a]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[a],c=o[r];return Wn(l)?Object.assign({},c,l):wn(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(t=>t(this))}}var $i=new Aae({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[bae,wae,Eae]);function Mae(n){return!n||Bn(n.size)||Bn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Jw(n,e,t,i,r){let s=e[r];return s||(s=e[r]=n.measureText(r).width,t.push(r)),s>i&&(i=s),i}function Cae(n,e,t,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},s=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let o=0;const a=t.length;let l,c,u,d,m;for(l=0;l<a;l++)if(d=t[l],d!=null&&!ji(d))o=Jw(n,r,s,o,d);else if(ji(d))for(c=0,u=d.length;c<u;c++)m=d[c],m!=null&&!ji(m)&&(o=Jw(n,r,s,o,m));n.restore();const y=s.length/2;if(y>t.length){for(l=0;l<y;l++)delete r[s[l]];s.splice(0,y)}return o}function Jd(n,e,t){const i=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*i)/i+r}function ML(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function pC(n,e,t,i){d5(n,e,t,i,null)}function d5(n,e,t,i,r){let s,o,a,l,c,u,d,m;const y=e.pointStyle,x=e.rotation,T=e.radius;let S=(x||0)*lae;if(y&&typeof y=="object"&&(s=y.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(S),n.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),n.restore();return}if(!(isNaN(T)||T<=0)){switch(n.beginPath(),y){default:r?n.ellipse(t,i,r/2,T,0,0,Di):n.arc(t,i,T,0,Di),n.closePath();break;case"triangle":u=r?r/2:T,n.moveTo(t+Math.sin(S)*u,i-Math.cos(S)*T),S+=vL,n.lineTo(t+Math.sin(S)*u,i-Math.cos(S)*T),S+=vL,n.lineTo(t+Math.sin(S)*u,i-Math.cos(S)*T),n.closePath();break;case"rectRounded":c=T*.516,l=T-c,o=Math.cos(S+Kd)*l,d=Math.cos(S+Kd)*(r?r/2-c:l),a=Math.sin(S+Kd)*l,m=Math.sin(S+Kd)*(r?r/2-c:l),n.arc(t-d,i-a,c,S-Jn,S-Cr),n.arc(t+m,i-o,c,S-Cr,S),n.arc(t+d,i+a,c,S,S+Cr),n.arc(t-m,i+o,c,S+Cr,S+Jn),n.closePath();break;case"rect":if(!x){l=Math.SQRT1_2*T,u=r?r/2:l,n.rect(t-u,i-l,2*u,2*l);break}S+=Kd;case"rectRot":d=Math.cos(S)*(r?r/2:T),o=Math.cos(S)*T,a=Math.sin(S)*T,m=Math.sin(S)*(r?r/2:T),n.moveTo(t-d,i-a),n.lineTo(t+m,i-o),n.lineTo(t+d,i+a),n.lineTo(t-m,i+o),n.closePath();break;case"crossRot":S+=Kd;case"cross":d=Math.cos(S)*(r?r/2:T),o=Math.cos(S)*T,a=Math.sin(S)*T,m=Math.sin(S)*(r?r/2:T),n.moveTo(t-d,i-a),n.lineTo(t+d,i+a),n.moveTo(t+m,i-o),n.lineTo(t-m,i+o);break;case"star":d=Math.cos(S)*(r?r/2:T),o=Math.cos(S)*T,a=Math.sin(S)*T,m=Math.sin(S)*(r?r/2:T),n.moveTo(t-d,i-a),n.lineTo(t+d,i+a),n.moveTo(t+m,i-o),n.lineTo(t-m,i+o),S+=Kd,d=Math.cos(S)*(r?r/2:T),o=Math.cos(S)*T,a=Math.sin(S)*T,m=Math.sin(S)*(r?r/2:T),n.moveTo(t-d,i-a),n.lineTo(t+d,i+a),n.moveTo(t+m,i-o),n.lineTo(t-m,i+o);break;case"line":o=r?r/2:Math.cos(S)*T,a=Math.sin(S)*T,n.moveTo(t-o,i-a),n.lineTo(t+o,i+a);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(S)*(r?r/2:T),i+Math.sin(S)*T);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function lh(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function PT(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function RT(n){n.restore()}function Pae(n,e,t,i,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else r==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function Rae(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function Iae(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Bn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function kae(n,e,t,i,r){if(r.strikethrough||r.underline){const s=n.measureText(i),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=t-s.actualBoundingBoxAscent,c=t+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function Oae(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Zp(n,e,t,i,r,s={}){const o=ji(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(n.save(),n.font=r.string,Iae(n,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&Oae(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),Bn(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(c,t,i,s.maxWidth)),n.fillText(c,t,i,s.maxWidth),kae(n,t,i,c,s),i+=Number(r.lineHeight);n.restore()}function Yv(n,e){const{x:t,y:i,w:r,h:s,radius:o}=e;n.arc(t+o.topLeft,i+o.topLeft,o.topLeft,1.5*Jn,Jn,!0),n.lineTo(t,i+s-o.bottomLeft),n.arc(t+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,Jn,Cr,!0),n.lineTo(t+r-o.bottomRight,i+s),n.arc(t+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,Cr,0,!0),n.lineTo(t+r,i+o.topRight),n.arc(t+r-o.topRight,i+o.topRight,o.topRight,0,-Cr,!0),n.lineTo(t+o.topLeft,i)}const Lae=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Nae=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Dae(n,e){const t=(""+n).match(Lae);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const Fae=n=>+n||0;function KR(n,e){const t={},i=Wn(e),r=i?Object.keys(e):e,s=Wn(n)?i?o=>wn(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of r)t[o]=Fae(s(o));return t}function p5(n){return KR(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Rp(n){return KR(n,["topLeft","topRight","bottomLeft","bottomRight"])}function _o(n){const e=p5(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ns(n,e){n=n||{},e=e||$i.font;let t=wn(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=wn(n.style,e.style);i&&!(""+i).match(Nae)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:wn(n.family,e.family),lineHeight:Dae(wn(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:wn(n.weight,e.weight),string:""};return r.string=Mae(r),r}function Ly(n,e,t,i){let r,s,o;for(r=0,s=n.length;r<s;++r)if(o=n[r],o!==void 0&&o!==void 0)return o}function Uae(n,e,t){const{min:i,max:r}=n,s=n5(e,(r-i)/2),o=(a,l)=>t&&a===0?0:a+l;return{min:o(i,-Math.abs(s)),max:o(r,s)}}function dd(n,e){return Object.assign(Object.create(n),e)}function JR(n,e=[""],t,i,r=()=>n[0]){const s=t||n;typeof i>"u"&&(i=y5("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:i,_getTarget:r,override:a=>JR([a,...n],e,s,i)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return g5(a,l,()=>Xae(l,e,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return PL(a).includes(l)},ownKeys(a){return PL(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function o_(n,e,t,i){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:m5(n,i),setContext:s=>o_(n,s,t,i),override:s=>o_(n.override(s),e,t,i)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return g5(s,o,()=>zae(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function m5(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:i,isScriptable:td(t)?t:()=>t,isIndexable:td(i)?i:()=>i}}const Bae=(n,e)=>n?n+XR(e):e,QR=(n,e)=>Wn(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function g5(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const i=t();return n[e]=i,i}function zae(n,e,t){const{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=n;let a=i[e];return td(a)&&o.isScriptable(e)&&(a=Vae(e,a,n,t)),ji(a)&&a.length&&(a=Hae(e,a,n,o.isIndexable)),QR(e,a)&&(a=o_(a,r,s&&s[e],o)),a}function Vae(n,e,t,i){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=e(s,o||i);return a.delete(n),QR(n,l)&&(l=e2(r._scopes,r,n,l)),l}function Hae(n,e,t,i){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=t;if(typeof s.index<"u"&&i(n))return e[s.index%e.length];if(Wn(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=e2(c,r,n,u);e.push(o_(d,s,o&&o[n],a))}}return e}function _5(n,e,t){return td(n)?n(e,t):n}const Wae=(n,e)=>n===!0?e:typeof n=="string"?ed(e,n):void 0;function jae(n,e,t,i,r){for(const s of e){const o=Wae(t,s);if(o){n.add(o);const a=_5(o._fallback,t,r);if(typeof a<"u"&&a!==t&&a!==i)return a}else if(o===!1&&typeof i<"u"&&t!==i)return null}return!1}function e2(n,e,t,i){const r=e._rootScopes,s=_5(e._fallback,t,i),o=[...n,...r],a=new Set;a.add(i);let l=CL(a,o,t,s||t,i);return l===null||typeof s<"u"&&s!==t&&(l=CL(a,o,s,l,i),l===null)?!1:JR(Array.from(a),[""],r,s,()=>$ae(e,t,i))}function CL(n,e,t,i,r){for(;t;)t=jae(n,e,t,i,r);return t}function $ae(n,e,t){const i=n._getTarget();e in i||(i[e]={});const r=i[e];return ji(r)&&Wn(t)?t:r||{}}function Xae(n,e,t,i){let r;for(const s of e)if(r=y5(Bae(s,n),t),typeof r<"u")return QR(n,r)?e2(t,i,n,r):r}function y5(n,e){for(const t of e){if(!t)continue;const i=t[n];if(typeof i<"u")return i}}function PL(n){let e=n._keys;return e||(e=n._keys=Gae(n._scopes)),e}function Gae(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function v5(n,e,t,i){const{iScale:r}=n,{key:s="r"}=this._parsing,o=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+t,u=e[c],o[a]={r:r.parse(ed(u,s),c)};return o}const Yae=Number.EPSILON||1e-14,a_=(n,e)=>e<n.length&&!n[e].skip&&n[e],x5=n=>n==="x"?"y":"x";function qae(n,e,t,i){const r=n.skip?e:n,s=e,o=t.skip?e:t,a=fC(s,r),l=fC(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=i*c,m=i*u;return{previous:{x:s.x-d*(o.x-r.x),y:s.y-d*(o.y-r.y)},next:{x:s.x+m*(o.x-r.x),y:s.y+m*(o.y-r.y)}}}function Zae(n,e,t){const i=n.length;let r,s,o,a,l,c=a_(n,0);for(let u=0;u<i-1;++u)if(l=c,c=a_(n,u+1),!(!l||!c)){if(Ky(e[u],0,Yae)){t[u]=t[u+1]=0;continue}r=t[u]/e[u],s=t[u+1]/e[u],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=r*o*e[u],t[u+1]=s*o*e[u])}}function Kae(n,e,t="x"){const i=x5(t),r=n.length;let s,o,a,l=a_(n,0);for(let c=0;c<r;++c){if(o=a,a=l,l=a_(n,c+1),!a)continue;const u=a[t],d=a[i];o&&(s=(u-o[t])/3,a[`cp1${t}`]=u-s,a[`cp1${i}`]=d-s*e[c]),l&&(s=(l[t]-u)/3,a[`cp2${t}`]=u+s,a[`cp2${i}`]=d+s*e[c])}}function Jae(n,e="x"){const t=x5(e),i=n.length,r=Array(i).fill(0),s=Array(i);let o,a,l,c=a_(n,0);for(o=0;o<i;++o)if(a=l,l=c,c=a_(n,o+1),!!l){if(c){const u=c[e]-l[e];r[o]=u!==0?(c[t]-l[t])/u:0}s[o]=a?c?iu(r[o-1])!==iu(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}Zae(n,r,s),Kae(n,s,e)}function Tb(n,e,t){return Math.max(Math.min(n,t),e)}function Qae(n,e){let t,i,r,s,o,a=lh(n[0],e);for(t=0,i=n.length;t<i;++t)o=s,s=a,a=t<i-1&&lh(n[t+1],e),s&&(r=n[t],o&&(r.cp1x=Tb(r.cp1x,e.left,e.right),r.cp1y=Tb(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=Tb(r.cp2x,e.left,e.right),r.cp2y=Tb(r.cp2y,e.top,e.bottom)))}function ele(n,e,t,i,r){let s,o,a,l;if(e.spanGaps&&(n=n.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")Jae(n,r);else{let c=i?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],l=qae(c,a,n[Math.min(s+1,o-(i?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&Qae(n,t)}function t2(){return typeof window<"u"&&typeof document<"u"}function n2(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Qw(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const IT=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function tle(n,e){return IT(n).getPropertyValue(e)}const nle=["top","right","bottom","left"];function Ip(n,e,t){const i={};t=t?"-"+t:"";for(let r=0;r<4;r++){const s=nle[r];i[s]=parseFloat(n[e+"-"+s+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const ile=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function rle(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:r,offsetY:s}=i;let o=!1,a,l;if(ile(r,s,n.target))a=r,l=s;else{const c=e.getBoundingClientRect();a=i.clientX-c.left,l=i.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function up(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,r=IT(t),s=r.boxSizing==="border-box",o=Ip(r,"padding"),a=Ip(r,"border","width"),{x:l,y:c,box:u}=rle(n,t),d=o.left+(u&&a.left),m=o.top+(u&&a.top);let{width:y,height:x}=e;return s&&(y-=o.width+a.width,x-=o.height+a.height),{x:Math.round((l-d)/y*t.width/i),y:Math.round((c-m)/x*t.height/i)}}function sle(n,e,t){let i,r;if(e===void 0||t===void 0){const s=n&&n2(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const o=s.getBoundingClientRect(),a=IT(s),l=Ip(a,"border","width"),c=Ip(a,"padding");e=o.width-c.width-l.width,t=o.height-c.height-l.height,i=Qw(a.maxWidth,s,"clientWidth"),r=Qw(a.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:i||Kw,maxHeight:r||Kw}}const Ff=n=>Math.round(n*10)/10;function ole(n,e,t,i){const r=IT(n),s=Ip(r,"margin"),o=Qw(r.maxWidth,n,"clientWidth")||Kw,a=Qw(r.maxHeight,n,"clientHeight")||Kw,l=sle(n,e,t);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const m=Ip(r,"border","width"),y=Ip(r,"padding");c-=y.width+m.width,u-=y.height+m.height}return c=Math.max(0,c-s.width),u=Math.max(0,i?c/i:u-s.height),c=Ff(Math.min(c,o,l.maxWidth)),u=Ff(Math.min(u,a,l.maxHeight)),c&&!u&&(u=Ff(c/2)),(e!==void 0||t!==void 0)&&i&&l.height&&u>l.height&&(u=l.height,c=Ff(Math.floor(u*i))),{width:c,height:u}}function RL(n,e,t){const i=e||1,r=Ff(n.height*i),s=Ff(n.width*i);n.height=Ff(n.height),n.width=Ff(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==r||o.width!==s?(n.currentDevicePixelRatio=i,o.height=r,o.width=s,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const ale=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};t2()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function IL(n,e){const t=tle(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function hp(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function lle(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function cle(n,e,t,i){const r={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},o=hp(n,r,t),a=hp(r,s,t),l=hp(s,e,t),c=hp(o,a,t),u=hp(a,l,t);return hp(c,u,t)}const ule=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},hle=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function $g(n,e,t){return n?ule(e,t):hle()}function b5(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function w5(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function S5(n){return n==="angle"?{between:Gv,compare:fae,normalize:co}:{between:oh,compare:(e,t)=>e-t,normalize:e=>e}}function kL({start:n,end:e,count:t,loop:i,style:r}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:r}}function fle(n,e,t){const{property:i,start:r,end:s}=t,{between:o,normalize:a}=S5(i),l=e.length;let{start:c,end:u,loop:d}=n,m,y;if(d){for(c+=l,u+=l,m=0,y=l;m<y&&o(a(e[c%l][i]),r,s);++m)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:n.style}}function T5(n,e,t){if(!t)return[n];const{property:i,start:r,end:s}=t,o=e.length,{compare:a,between:l,normalize:c}=S5(i),{start:u,end:d,loop:m,style:y}=fle(n,e,t),x=[];let T=!1,S=null,w,P,M;const I=()=>l(r,M,w)&&a(r,M)!==0,k=()=>a(s,w)===0||l(s,M,w),D=()=>T||I(),H=()=>!T||k();for(let W=u,z=u;W<=d;++W)P=e[W%o],!P.skip&&(w=c(P[i]),w!==M&&(T=l(w,r,s),S===null&&D()&&(S=a(w,r)===0?W:z),S!==null&&H()&&(x.push(kL({start:S,end:W,loop:m,count:o,style:y})),S=null),z=W,M=w));return S!==null&&x.push(kL({start:S,end:d,loop:m,count:o,style:y})),x}function E5(n,e){const t=[],i=n.segments;for(let r=0;r<i.length;r++){const s=T5(i[r],n.points,e);s.length&&t.push(...s)}return t}function dle(n,e,t,i){let r=0,s=e-1;if(t&&!i)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(s+=r);s>r&&n[s%e].skip;)s--;return s%=e,{start:r,end:s}}function ple(n,e,t,i){const r=n.length,s=[];let o=e,a=n[e],l;for(l=e+1;l<=t;++l){const c=n[l%r];c.skip||c.stop?a.skip||(i=!1,s.push({start:e%r,end:(l-1)%r,loop:i}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%r,end:o%r,loop:i}),s}function mle(n,e){const t=n.points,i=n.options.spanGaps,r=t.length;if(!r)return[];const s=!!n._loop,{start:o,end:a}=dle(t,r,s,i);if(i===!0)return OL(n,[{start:o,end:a,loop:s}],t,e);const l=a<o?a+r:a,c=!!n._fullLoop&&o===0&&a===r-1;return OL(n,ple(t,o,l,c),t,e)}function OL(n,e,t,i){return!i||!i.setContext||!t?e:gle(n,e,t,i)}function gle(n,e,t,i){const r=n._chart.getContext(),s=LL(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=t.length,c=[];let u=s,d=e[0].start,m=d;function y(x,T,S,w){const P=a?-1:1;if(x!==T){for(x+=l;t[x%l].skip;)x-=P;for(;t[T%l].skip;)T+=P;x%l!==T%l&&(c.push({start:x%l,end:T%l,loop:S,style:w}),u=w,d=T%l)}}for(const x of e){d=a?d:x.start;let T=t[d%l],S;for(m=d+1;m<=x.end;m++){const w=t[m%l];S=LL(i.setContext(dd(r,{type:"segment",p0:T,p1:w,p0DataIndex:(m-1)%l,p1DataIndex:m%l,datasetIndex:o}))),_le(S,u)&&y(d,m-1,x.loop,u),T=w,u=S}d<m-1&&y(d,m-1,x.loop,u)}return c}function LL(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function _le(n,e){if(!e)return!1;const t=[],i=function(r,s){return ZR(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function Eb(n,e,t){return n.options.clip?n[t]:e[t]}function yle(n,e){const{xScale:t,yScale:i}=n;return t&&i?{left:Eb(t,e,"left"),right:Eb(t,e,"right"),top:Eb(i,e,"top"),bottom:Eb(i,e,"bottom")}:e}function A5(n,e){const t=e._clip;if(t.disabled)return!1;const i=yle(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}class vle{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){const s=t.listeners[r],o=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(i-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=l5.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,i,e,"progress")),s.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var qu=new vle;const NL="transparent",xle={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=EL(n||NL),r=i.valid&&EL(e||NL);return r&&r.valid?r.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class ble{constructor(e,t,i,r){const s=t[i];r=Ly([e.to,r,s,e.from]);const o=Ly([e.from,s,r]);this._active=!0,this._fn=e.fn||xle[e.type||typeof o],this._easing=Jy[e.easing]||Jy.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Ly([e.to,t,r,e.from]),this._from=Ly([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||t<i),!this._active){this._target[r]=a,this._notify(!0);return}if(t<0){this._target[r]=s;return}l=t/i%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}}class M5{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Wn(e))return;const t=Object.keys($i.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const s=e[r];if(!Wn(s))return;const o={};for(const a of t)o[a]=s[a];(ji(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!i.has(a))&&i.set(a,o)})})}_animateOptions(e,t){const i=t.options,r=Sle(e,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&wle(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,t){const i=this._properties,r=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,t));continue}const u=t[c];let d=s[c];const m=i.get(c);if(d)if(m&&d.active()){d.update(m,u,a);continue}else d.cancel();if(!m||!m.duration){e[c]=u;continue}s[c]=d=new ble(m,e,c,u),r.push(d)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return qu.add(this._chart,i),!0}}function wle(n,e){const t=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const s=n[i[r]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function Sle(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function DL(n,e){const t=n&&n.options||{},i=t.reverse,r=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:i?s:r,end:i?r:s}}function Tle(n,e,t){if(t===!1)return!1;const i=DL(n,t),r=DL(e,t);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function Ele(n){let e,t,i,r;return Wn(n)?(e=n.top,t=n.right,i=n.bottom,r=n.left):e=t=i=r=n,{top:e,right:t,bottom:i,left:r,disabled:n===!1}}function C5(n,e){const t=[],i=n._getSortedDatasetMetas(e);let r,s;for(r=0,s=i.length;r<s;++r)t.push(i[r].index);return t}function FL(n,e,t,i={}){const r=n.keys,s=i.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===t){if(u=!0,i.all)continue;break}c=n.values[l],mr(c)&&(s||e===0||iu(e)===iu(c))&&(e+=c)}return!u&&!i.all?0:e}function Ale(n,e){const{iScale:t,vScale:i}=e,r=t.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[s]:n[u]};return a}function C1(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Mle(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Cle(n){const{min:e,max:t,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function Ple(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function UL(n,e,t,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const s=n[r.index];if(t&&s>0||!t&&s<0)return r.index}return null}function BL(n,e){const{chart:t,_cachedMeta:i}=n,r=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:a}=i,l=s.axis,c=o.axis,u=Mle(s,o,i),d=e.length;let m;for(let y=0;y<d;++y){const x=e[y],{[l]:T,[c]:S}=x,w=x._stacks||(x._stacks={});m=w[c]=Ple(r,u,T),m[a]=S,m._top=UL(m,o,!0,i.type),m._bottom=UL(m,o,!1,i.type);const P=m._visualValues||(m._visualValues={});P[a]=S}}function P1(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function Rle(n,e){return dd(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Ile(n,e,t){return dd(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function my(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const r of e){const s=r._stacks;if(!s||s[i]===void 0||s[i][t]===void 0)return;delete s[i][t],s[i]._visualValues!==void 0&&s[i]._visualValues[t]!==void 0&&delete s[i]._visualValues[t]}}}const R1=n=>n==="reset"||n==="none",zL=(n,e)=>e?n:Object.assign({},n),kle=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:C5(t,!0),values:null};class pd{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=C1(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&my(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),r=(d,m,y,x)=>d==="x"?m:d==="r"?x:y,s=t.xAxisID=wn(i.xAxisID,P1(e,"x")),o=t.yAxisID=wn(i.yAxisID,P1(e,"y")),a=t.rAxisID=wn(i.rAxisID,P1(e,"r")),l=t.indexAxis,c=t.iAxisID=r(l,s,o,a),u=t.vAxisID=r(l,o,s,a);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&wL(this._data,this),e._stacked&&my(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(Wn(t)){const r=this._cachedMeta;this._data=Ale(t,r)}else if(i!==t){if(i){wL(i,this);const r=this._cachedMeta;my(r),r._parsed=[]}t&&Object.isExtensible(t)&&gae(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=t._stacked;t._stacked=C1(t.vScale,t),t.stack!==i.stack&&(r=!0,my(t),t.stack=i.stack),this._resyncElements(e),(r||s!==t._stacked)&&(BL(this,t._parsed),t._stacked=C1(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:o}=i,a=s.axis;let l=e===0&&t===r.length?!0:i._sorted,c=e>0&&i._parsed[e-1],u,d,m;if(this._parsing===!1)i._parsed=r,i._sorted=!0,m=r;else{ji(r[e])?m=this.parseArrayData(i,r,e,t):Wn(r[e])?m=this.parseObjectData(i,r,e,t):m=this.parsePrimitiveData(i,r,e,t);const y=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<t;++u)i._parsed[u+e]=d=m[u],l&&(y()&&(l=!1),c=d);i._sorted=l}o&&BL(this,m)}parsePrimitiveData(e,t,i,r){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,d=new Array(r);let m,y,x;for(m=0,y=r;m<y;++m)x=m+i,d[m]={[a]:u||s.parse(c[x],x),[l]:o.parse(t[x],x)};return d}parseArrayData(e,t,i,r){const{xScale:s,yScale:o}=e,a=new Array(r);let l,c,u,d;for(l=0,c=r;l<c;++l)u=l+i,d=t[u],a[l]={x:s.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(e,t,i,r){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,d,m,y;for(u=0,d=r;u<d;++u)m=u+i,y=t[m],c[u]={x:s.parse(ed(y,a),m),y:o.parse(ed(y,l),m)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const r=this.chart,s=this._cachedMeta,o=t[e.axis],a={keys:C5(r,!0),values:t._stacks[e.axis]._visualValues};return FL(a,o,s.index,{mode:i})}updateRangeFromParsed(e,t,i,r){const s=i[t.axis];let o=s===null?NaN:s;const a=r&&i._stacks[t.axis];r&&a&&(r.values=a,o=FL(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&e===i.iScale,o=r.length,a=this._getOtherScale(e),l=kle(t,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=Cle(a);let m,y;function x(){y=r[m];const T=y[a.axis];return!mr(y[e.axis])||u>T||d<T}for(m=0;m<o&&!(!x()&&(this.updateRangeFromParsed(c,e,y,l),s));++m);if(s){for(m=o-1;m>=0;--m)if(!x()){this.updateRangeFromParsed(c,e,y,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let r,s,o;for(r=0,s=t.length;r<s;++r)o=t[r][e.axis],mr(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,r=t.vScale,s=this.getParsed(e);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Ele(wn(this.options.clip,Tle(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,r=i.data||[],s=t.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const d=r[u];d.hidden||(d.active&&c?o.push(d):d.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=Ile(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=Rle(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=i,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const r=t==="active",s=this._cachedDataOpts,o=e+"-"+t,a=s[o],l=this.enableOptionSharing&&Xv(i);if(a)return zL(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],m=c.getOptionScopes(this.getDataset(),u),y=Object.keys($i.elements[e]),x=()=>this.getContext(i,r,t),T=c.resolveNamedOptions(m,y,x,d);return T.$shared&&(T.$shared=l,s[o]=Object.freeze(zL(T,l))),T}_resolveAnimations(e,t,i){const r=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,a=s[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,t),m=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(m,this.getContext(e,i,t))}const c=new M5(r,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||R1(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),r=this._sharedOptions,s=this.getSharedOptions(i),o=this.includeOptions(t,s)||s!==r;return this.updateSharedOptions(s,t,i),{sharedOptions:s,includeOptions:o}}updateElement(e,t,i,r){R1(r)?Object.assign(e,i):this._resolveAnimations(t,r).update(e,i)}updateSharedOptions(e,t,i){e&&!R1(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,r){e.active=r;const s=this.getStyle(t,r);this._resolveAnimations(t,i,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=i.length,s=t.length,o=Math.min(s,r);o&&this.parse(0,o),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,t,i=!0){const r=this._cachedMeta,s=r.data,o=e+t;let a;const l=c=>{for(c.length+=t,a=c.length-1;a>=o;a--)c[a]=c[a-t]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,t),i&&this.updateElements(s,e,t,"reset")}updateElements(e,t,i,r){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,t);i._stacked&&my(i,r)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,r]=e;this[t](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Ole(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let r=0,s=t.length;r<s;r++)i=i.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=a5(i.sort((r,s)=>r-s))}return n._cache.$bar}function Lle(n){const e=n.iScale,t=Ole(e,n.type);let i=e._length,r,s,o,a;const l=()=>{o===32767||o===-32768||(Xv(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(r=0,s=t.length;r<s;++r)o=e.getPixelForValue(t[r]),l();for(a=void 0,r=0,s=e.ticks.length;r<s;++r)o=e.getPixelForTick(r),l();return i}function Nle(n,e,t,i){const r=t.barThickness;let s,o;return Bn(r)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=r*i,o=1),{chunk:s/i,ratio:o,start:e.pixels[n]-s/2}}function Dle(n,e,t,i){const r=e.pixels,s=r[n];let o=n>0?r[n-1]:null,a=n<r.length-1?r[n+1]:null;const l=t.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:t.barPercentage,start:c}}function Fle(n,e,t,i){const r=t.parse(n[0],i),s=t.parse(n[1],i),o=Math.min(r,s),a=Math.max(r,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:s,min:o,max:a}}function P5(n,e,t,i){return ji(n)?Fle(n,e,t,i):e[t.axis]=t.parse(n,i),e}function VL(n,e,t,i){const r=n.iScale,s=n.vScale,o=r.getLabels(),a=r===s,l=[];let c,u,d,m;for(c=t,u=t+i;c<u;++c)m=e[c],d={},d[r.axis]=a||r.parse(o[c],c),l.push(P5(m,d,s,c));return l}function I1(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Ule(n,e,t){return n!==0?iu(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Ble(n){let e,t,i,r,s;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(r="end",s="start"):(r="start",s="end"),{start:t,end:i,reverse:e,top:r,bottom:s}}function zle(n,e,t,i){let r=e.borderSkipped;const s={};if(!r){n.borderSkipped=s;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=Ble(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?r=c:(t._bottom||0)===i?r=u:(s[HL(u,o,a,l)]=!0,r=c)),s[HL(r,o,a,l)]=!0,n.borderSkipped=s}function HL(n,e,t,i){return i?(n=Vle(n,e,t),n=WL(n,t,e)):n=WL(n,e,t),n}function Vle(n,e,t){return n===e?t:n===t?e:n}function WL(n,e,t){return n==="start"?e:n==="end"?t:n}function Hle(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class R5 extends pd{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,r){return VL(e,t,i,r)}parseArrayData(e,t,i,r){return VL(e,t,i,r)}parseObjectData(e,t,i,r){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,u=o.axis==="x"?a:l,d=[];let m,y,x,T;for(m=i,y=i+r;m<y;++m)T=t[m],x={},x[s.axis]=s.parse(ed(T,c),m),d.push(P5(ed(T,u),x,o,m));return d}updateRangeFromParsed(e,t,i,r){super.updateRangeFromParsed(e,t,i,r);const s=i._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:r}=t,s=this.getParsed(e),o=s._custom,a=I1(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,r){const s=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:m}=this._getSharedOptions(t,r);for(let y=t;y<t+i;y++){const x=this.getParsed(y),T=s||Bn(x[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(y),S=this._calculateBarIndexPixels(y,u),w=(x._stacks||{})[a.axis],P={horizontal:c,base:T.base,enableBorderRadius:!w||I1(x._custom)||o===w._top||o===w._bottom,x:c?T.head:S.center,y:c?S.center:T.head,height:c?S.size:Math.abs(T.size),width:c?Math.abs(T.size):S.size};m&&(P.options=d||this.resolveDataElementOptions(y,e[y].active?"active":r));const M=P.options||e[y].options;zle(P,M,w,o),Hle(P,M,u.ratio),this.updateElement(e[y],y,P,r)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(t),l=a&&a[i.axis],c=u=>{const d=u._parsed.find(y=>y[i.axis]===l),m=d&&d[u.vScale.axis];if(Bn(m)||isNaN(m))return!0};for(const u of r)if(!(t!==void 0&&c(u))&&((s===!1||o.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(i=>e[i].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)e[wn(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,i){const r=this._getStacks(e,i),s=t!==void 0?r.indexOf(t):-1;return s===-1?r.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,r=[];let s,o;for(s=0,o=t.data.length;s<o;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const a=e.barThickness;return{min:a||Lle(t),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:r},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,u=I1(c);let d=l[t.axis],m=0,y=i?this.applyStack(t,l,i):d,x,T;y!==d&&(m=y-d,y=d),u&&(d=c.barStart,y=c.barEnd-c.barStart,d!==0&&iu(d)!==iu(c.barEnd)&&(m=0),m+=d);const S=!Bn(s)&&!u?s:m;let w=t.getPixelForValue(S);if(this.chart.getDataVisibility(e)?x=t.getPixelForValue(m+y):x=w,T=x-w,Math.abs(T)<o){T=Ule(T,t,a)*o,d===a&&(w-=T/2);const P=t.getPixelForDecimal(0),M=t.getPixelForDecimal(1),I=Math.min(P,M),k=Math.max(P,M);w=Math.max(Math.min(w,k),I),x=w+T,i&&!u&&(l._stacks[t.axis]._visualValues[r]=t.getValueForPixel(x)-t.getValueForPixel(w))}if(w===t.getPixelForValue(a)){const P=iu(T)*t.getLineWidthForValue(a)/2;w+=P,T-=P}return{size:T,base:w,head:x,center:x+T/2}}_calculateBarIndexPixels(e,t){const i=t.scale,r=this.options,s=r.skipNull,o=wn(r.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(t.grouped){const u=s?this._getStackCount(e):t.stackCount,d=r.barThickness==="flex"?Dle(e,t,r,u*c):Nle(e,t,r,u*c),m=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,y=this._getAxis().indexOf(wn(m,this.getFirstScaleIdForIndexAxis())),x=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+y;a=d.start+d.chunk*x+d.chunk/2,l=Math.min(o,d.chunk*d.ratio)}else a=i.getPixelForValue(this.getParsed(e)[i.axis],e),l=Math.min(o,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[t.axis]!==null&&!i[s].hidden&&i[s].draw(this._ctx)}}class Wle extends pd{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,r){const s=super.parsePrimitiveData(e,t,i,r);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+i).radius;return s}parseArrayData(e,t,i,r){const s=super.parseArrayData(e,t,i,r);for(let o=0;o<s.length;o++){const a=t[i+o];s[o]._custom=wn(a[2],this.resolveDataElementOptions(o+i).radius)}return s}parseObjectData(e,t,i,r){const s=super.parseObjectData(e,t,i,r);for(let o=0;o<s.length;o++){const a=t[i+o];s[o]._custom=wn(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=t,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=s.getLabelForValue(o.y),c=o._custom;return{label:i[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,i,r){const s=r==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(t,r),u=o.axis,d=a.axis;for(let m=t;m<t+i;m++){const y=e[m],x=!s&&this.getParsed(m),T={},S=T[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(x[u]),w=T[d]=s?a.getBasePixel():a.getPixelForValue(x[d]);T.skip=isNaN(S)||isNaN(w),c&&(T.options=l||this.resolveDataElementOptions(m,y.active?"active":r),s&&(T.options.radius=0)),this.updateElement(y,m,T,r)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let r=super.resolveDataElementOptions(e,t);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return t!=="active"&&(r.radius=0),r.radius+=wn(i&&i._custom,s),r}}function jle(n,e,t){let i=1,r=1,s=0,o=0;if(e<Di){const a=n,l=a+e,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),m=Math.sin(l),y=(M,I,k)=>Gv(M,a,l,!0)?1:Math.max(I,I*t,k,k*t),x=(M,I,k)=>Gv(M,a,l,!0)?-1:Math.min(I,I*t,k,k*t),T=y(0,c,d),S=y(Cr,u,m),w=x(Jn,c,d),P=x(Jn+Cr,u,m);i=(T-w)/2,r=(S-P)/2,s=-(T+w)/2,o=-(S+P)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:o}}class i2 extends pd{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((l,c)=>{const d=e.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:d.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(c),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:r,pointStyle:i,borderRadius:o&&(a||d.borderRadius),index:c}}):[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=l=>+i[l];if(Wn(i[e])){const{key:l="value"}=this._parsing;s=c=>+ed(i[c],l)}let o,a;for(o=e,a=e+t;o<a;++o)r._parsed[o]=s(o)}}_getRotation(){return ac(this.options.rotation-90)}_getCircumference(){return ac(this.options.circumference)}_getRotationExtents(){let e=Di,t=-Di;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),o=r._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,r=this._cachedMeta,s=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),l=Math.min(tae(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:m,ratioY:y,offsetX:x,offsetY:T}=jle(d,u,l),S=(i.width-o)/m,w=(i.height-o)/y,P=Math.max(Math.min(S,w)/2,0),M=n5(this.options.radius,P),I=Math.max(M*l,0),k=(M-I)/this._getVisibleDatasetWeightTotal();this.offsetX=x*M,this.offsetY=T*M,r.total=this.calculateTotal(),this.outerRadius=M-k*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-k*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*s/Di)}updateElements(e,t,i,r){const s=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,m=s&&c.animateScale,y=m?0:this.innerRadius,x=m?0:this.outerRadius,{sharedOptions:T,includeOptions:S}=this._getSharedOptions(t,r);let w=this._getRotation(),P;for(P=0;P<t;++P)w+=this._circumference(P,s);for(P=t;P<t+i;++P){const M=this._circumference(P,s),I=e[P],k={x:u+this.offsetX,y:d+this.offsetY,startAngle:w,endAngle:w+M,circumference:M,outerRadius:x,innerRadius:y};S&&(k.options=T||this.resolveDataElementOptions(P,I.active?"active":r)),w+=M,this.updateElement(I,P,k,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,r;for(r=0;r<t.length;r++){const s=e._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Di*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=I0(t._parsed[e],i.options.locale);return{label:r[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const i=this.chart;let r,s,o,a,l;if(!e){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){o=i.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,s=e.length;r<s;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,r=e.length;i<r;++i){const s=this.resolveDataElementOptions(i);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(wn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class $le extends pd{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:a,count:l}=u5(t,r,o);this._drawStart=a,this._drawCount=l,h5(t)&&(a=0,l=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,t,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(t,r),m=o.axis,y=a.axis,{spanGaps:x,segment:T}=this.options,S=s_(x)?x:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||s||r==="none",P=t+i,M=e.length;let I=t>0&&this.getParsed(t-1);for(let k=0;k<M;++k){const D=e[k],H=w?D:{};if(k<t||k>=P){H.skip=!0;continue}const W=this.getParsed(k),z=Bn(W[y]),j=H[m]=o.getPixelForValue(W[m],k),J=H[y]=s||z?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,W,l):W[y],k);H.skip=isNaN(j)||isNaN(J)||z,H.stop=k>0&&Math.abs(W[m]-I[m])>S,T&&(H.parsed=W,H.raw=c.data[k]),d&&(H.options=u||this.resolveDataElementOptions(k,D.active?"active":r)),w||this.updateElement(D,k,H,r),I=W}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class I5 extends pd{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:r}}=e.legend.options;return t.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=I0(t._parsed[e].r,i.options.locale);return{label:r[e]||"",value:s}}parseObjectData(e,t,i,r){return v5.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<t.min&&(t.min=s),s>t.max&&(t.max=s))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(r/2,0),o=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,t,i,r){const s=r==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,d=c.yCenter,m=c.getIndexAngle(0)-.5*Jn;let y=m,x;const T=360/this.countVisibleElements();for(x=0;x<t;++x)y+=this._computeAngle(x,r,T);for(x=t;x<t+i;x++){const S=e[x];let w=y,P=y+this._computeAngle(x,r,T),M=o.getDataVisibility(x)?c.getDistanceFromCenterForValue(this.getParsed(x).r):0;y=P,s&&(l.animateScale&&(M=0),l.animateRotate&&(w=P=m));const I={x:u,y:d,innerRadius:0,outerRadius:M,startAngle:w,endAngle:P,options:this.resolveDataElementOptions(x,S.active?"active":r)};this.updateElement(S,x,I,r)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&t++}),t}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?ac(this.resolveDataElementOptions(e,t).angle||i):0}}class Xle extends i2{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class Gle extends pd{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,r){return v5.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta,i=t.dataset,r=t.data||[],s=t.iScale.getLabels();if(i.points=r,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===r.length,options:o};this.updateElement(i,void 0,a,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,i,r){const s=this._cachedMeta.rScale,o=r==="reset";for(let a=t;a<t+i;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":r),u=s.getPointPositionForValue(a,this.getParsed(a).r),d=o?s.xCenter:u.x,m=o?s.yCenter:u.y,y={x:d,y:m,angle:u.angle,skip:isNaN(d)||isNaN(m),options:c};this.updateElement(l,a,y,r)}}}class Yle extends pd{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const t=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=t,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=s.getLabelForValue(o.y);return{label:i[e]||"",value:"("+a+", "+l+")"}}update(e){const t=this._cachedMeta,{data:i=[]}=t,r=this.chart._animationsDisabled;let{start:s,count:o}=u5(t,i,r);if(this._drawStart=s,this._drawCount=o,h5(t)&&(s=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=i;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:c},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(i,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(t,r),d=this.getSharedOptions(u),m=this.includeOptions(r,d),y=o.axis,x=a.axis,{spanGaps:T,segment:S}=this.options,w=s_(T)?T:Number.POSITIVE_INFINITY,P=this.chart._animationsDisabled||s||r==="none";let M=t>0&&this.getParsed(t-1);for(let I=t;I<t+i;++I){const k=e[I],D=this.getParsed(I),H=P?k:{},W=Bn(D[x]),z=H[y]=o.getPixelForValue(D[y],I),j=H[x]=s||W?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,D,l):D[x],I);H.skip=isNaN(z)||isNaN(j)||W,H.stop=I>0&&Math.abs(D[y]-M[y])>w,S&&(H.parsed=D,H.raw=c.data[I]),m&&(H.options=d||this.resolveDataElementOptions(I,k.active?"active":r)),P||this.updateElement(k,I,H,r),M=D}this.updateSharedOptions(d,r,u)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let a=0;for(let l=t.length-1;l>=0;--l)a=Math.max(a,t[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const i=e.dataset,r=i.options&&i.options.borderWidth||0;if(!t.length)return r;const s=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(r,s,o)/2}}var qle=Object.freeze({__proto__:null,BarController:R5,BubbleController:Wle,DoughnutController:i2,LineController:$le,PieController:Xle,PolarAreaController:I5,RadarController:Gle,ScatterController:Yle});function Qd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class r2{static override(e){Object.assign(r2.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Qd()}parse(){return Qd()}format(){return Qd()}add(){return Qd()}diff(){return Qd()}startOf(){return Qd()}endOf(){return Qd()}}var Zle={_date:r2};function Kle(n,e,t,i){const{controller:r,data:s,_sorted:o}=n,a=r._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const c=a._reversePixels?pae:ah;if(i){if(r._sharedOptions){const u=s[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){const m=c(s,e,t-d),y=c(s,e,t+d);return{lo:m.lo,hi:y.hi}}}}else{const u=c(s,e,t);if(l){const{vScale:d}=r._cachedMeta,{_parsed:m}=n,y=m.slice(0,u.lo+1).reverse().findIndex(T=>!Bn(T[d.axis]));u.lo-=Math.max(0,y);const x=m.slice(u.hi).findIndex(T=>!Bn(T[d.axis]));u.hi+=Math.max(0,x)}return u}}return{lo:0,hi:s.length-1}}function kT(n,e,t,i,r){const s=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:d,hi:m}=Kle(s[a],e,o,r);for(let y=d;y<=m;++y){const x=u[y];x.skip||i(x,c,y)}}}function Jle(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,r){const s=e?Math.abs(i.x-r.x):0,o=t?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function k1(n,e,t,i,r){const s=[];return!r&&!n.isPointInArea(e)||kT(n,t,e,function(a,l,c){!r&&!lh(a,n.chartArea,0)||a.inRange(e.x,e.y,i)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function Qle(n,e,t,i){let r=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:d}=s5(o,{x:e.x,y:e.y});Gv(d,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return kT(n,t,e,s),r}function ece(n,e,t,i,r,s){let o=[];const a=Jle(t);let l=Number.POSITIVE_INFINITY;function c(u,d,m){const y=u.inRange(e.x,e.y,r);if(i&&!y)return;const x=u.getCenterPoint(r);if(!(!!s||n.isPointInArea(x))&&!y)return;const S=a(e,x);S<l?(o=[{element:u,datasetIndex:d,index:m}],l=S):S===l&&o.push({element:u,datasetIndex:d,index:m})}return kT(n,t,e,c),o}function O1(n,e,t,i,r,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!i?Qle(n,e,t,r):ece(n,e,t,i,r,s)}function jL(n,e,t,i,r){const s=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return kT(n,t,e,(l,c,u)=>{l[o]&&l[o](e[t],r)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),i&&!a?[]:s}var tce={modes:{index(n,e,t,i){const r=up(e,n),s=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?k1(n,r,s,i,o):O1(n,r,s,!1,i,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(n,e,t,i){const r=up(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?k1(n,r,s,i,o):O1(n,r,s,!1,i,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(n,e,t,i){const r=up(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return k1(n,r,s,i,o)},nearest(n,e,t,i){const r=up(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return O1(n,r,s,t.intersect,i,o)},x(n,e,t,i){const r=up(e,n);return jL(n,r,"x",t.intersect,i)},y(n,e,t,i){const r=up(e,n);return jL(n,r,"y",t.intersect,i)}}};const k5=["left","top","right","bottom"];function gy(n,e){return n.filter(t=>t.pos===e)}function $L(n,e){return n.filter(t=>k5.indexOf(t.pos)===-1&&t.box.axis===e)}function _y(n,e){return n.sort((t,i)=>{const r=e?i:t,s=e?t:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function nce(n){const e=[];let t,i,r,s,o,a;for(t=0,i=(n||[]).length;t<i;++t)r=n[t],{position:s,options:{stack:o,stackWeight:a=1}}=r,e.push({index:t,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}function ice(n){const e={};for(const t of n){const{stack:i,pos:r,stackWeight:s}=t;if(!i||!k5.includes(r))continue;const o=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function rce(n,e){const t=ice(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];const{fullSize:l}=a.box,c=t[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*i:l&&e.availableWidth,a.height=r):(a.width=i,a.height=u?u*r:l&&e.availableHeight)}return t}function sce(n){const e=nce(n),t=_y(e.filter(c=>c.box.fullSize),!0),i=_y(gy(e,"left"),!0),r=_y(gy(e,"right")),s=_y(gy(e,"top"),!0),o=_y(gy(e,"bottom")),a=$L(e,"x"),l=$L(e,"y");return{fullSize:t,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:gy(e,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}function XL(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function O5(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function oce(n,e,t,i){const{pos:r,box:s}=t,o=n.maxPadding;if(!Wn(r)){t.size&&(n[r]-=t.size);const d=i[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?s.height:s.width),t.size=d.size/d.count,n[r]+=t.size}s.getPadding&&O5(o,s.getPadding());const a=Math.max(0,e.outerWidth-XL(o,n,"left","right")),l=Math.max(0,e.outerHeight-XL(o,n,"top","bottom")),c=a!==n.w,u=l!==n.h;return n.w=a,n.h=l,t.horizontal?{same:c,other:u}:{same:u,other:c}}function ace(n){const e=n.maxPadding;function t(i){const r=Math.max(e[i]-n[i],0);return n[i]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function lce(n,e){const t=e.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return i(n?["left","right"]:["top","bottom"])}function Ny(n,e,t,i){const r=[];let s,o,a,l,c,u;for(s=0,o=n.length,c=0;s<o;++s){a=n[s],l=a.box,l.update(a.width||e.w,a.height||e.h,lce(a.horizontal,e));const{same:d,other:m}=oce(e,t,a,i);c|=d&&r.length,u=u||m,l.fullSize||r.push(a)}return c&&Ny(r,e,t,i)||u}function Ab(n,e,t,i,r){n.top=t,n.left=e,n.right=e+i,n.bottom=t+r,n.width=i,n.height=r}function GL(n,e,t,i){const r=t.padding;let{x:s,y:o}=e;for(const a of n){const l=a.box,c=i[a.stack]||{placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,m=c.size||l.height;Xv(c.start)&&(o=c.start),l.fullSize?Ab(l,r.left,o,t.outerWidth-r.right-r.left,m):Ab(l,e.left+c.placed,o,d,m),c.start=o,c.placed+=d,o=l.bottom}else{const d=e.h*u,m=c.size||l.width;Xv(c.start)&&(s=c.start),l.fullSize?Ab(l,s,r.top,m,t.outerHeight-r.bottom-r.top):Ab(l,s,e.top+c.placed,m,d),c.start=s,c.placed+=d,s=l.right}}e.x=s,e.y=o}var po={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const r=_o(n.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(t-r.height,0),a=sce(n.boxes),l=a.vertical,c=a.horizontal;fi(n.boxes,T=>{typeof T.beforeLayout=="function"&&T.beforeLayout()});const u=l.reduce((T,S)=>S.box.options&&S.box.options.display===!1?T:T+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),m=Object.assign({},r);O5(m,_o(i));const y=Object.assign({maxPadding:m,w:s,h:o,x:r.left,y:r.top},r),x=rce(l.concat(c),d);Ny(a.fullSize,y,d,x),Ny(l,y,d,x),Ny(c,y,d,x)&&Ny(l,y,d,x),ace(y),GL(a.leftAndTop,y,d,x),y.x+=y.w,y.y+=y.h,GL(a.rightAndBottom,y,d,x),n.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},fi(a.chartArea,T=>{const S=T.box;Object.assign(S,n.chartArea),S.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class L5{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}}class cce extends L5{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const mw="$chartjs",uce={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},YL=n=>n===null||n==="";function hce(n,e){const t=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[mw]={initial:{height:i,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",YL(r)){const s=IL(n,"width");s!==void 0&&(n.width=s)}if(YL(i))if(n.style.height==="")n.height=n.width/(e||2);else{const s=IL(n,"height");s!==void 0&&(n.height=s)}return n}const N5=ale?{passive:!0}:!1;function fce(n,e,t){n&&n.addEventListener(e,t,N5)}function dce(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,N5)}function pce(n,e){const t=uce[n.type]||n.type,{x:i,y:r}=up(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function eS(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function mce(n,e,t){const i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||eS(a.addedNodes,i),o=o&&!eS(a.removedNodes,i);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function gce(n,e,t){const i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||eS(a.removedNodes,i),o=o&&!eS(a.addedNodes,i);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const qv=new Map;let qL=0;function D5(){const n=window.devicePixelRatio;n!==qL&&(qL=n,qv.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function _ce(n,e){qv.size||window.addEventListener("resize",D5),qv.set(n,e)}function yce(n){qv.delete(n),qv.size||window.removeEventListener("resize",D5)}function vce(n,e,t){const i=n.canvas,r=i&&n2(i);if(!r)return;const s=c5((a,l)=>{const c=r.clientWidth;t(a,l),c<r.clientWidth&&t()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(r),_ce(n,s),o}function L1(n,e,t){t&&t.disconnect(),e==="resize"&&yce(n)}function xce(n,e,t){const i=n.canvas,r=c5(s=>{n.ctx!==null&&t(pce(s,n))},n);return fce(i,e,r),r}class bce extends L5{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(hce(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[mw])return!1;const i=t[mw].initial;["height","width"].forEach(s=>{const o=i[s];Bn(o)?t.removeAttribute(s):t.setAttribute(s,o)});const r=i.style||{};return Object.keys(r).forEach(s=>{t.style[s]=r[s]}),t.width=t.width,delete t[mw],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),o={attach:mce,detach:gce,resize:vce}[t]||xce;r[t]=o(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:L1,detach:L1,resize:L1}[t]||dce)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return ole(e,t,i,r)}isAttached(e){const t=e&&n2(e);return!!(t&&t.isConnected)}}function wce(n){return!t2()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?cce:bce}let Ah=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return s_(this.x)&&s_(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const r={};return e.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}};function Sce(n,e){const t=n.options.ticks,i=Tce(n),r=Math.min(t.maxTicksLimit||i,i),s=t.major.enabled?Ace(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>r)return Mce(e,c,s,o/r),c;const u=Ece(s,e,r);if(o>0){let d,m;const y=o>1?Math.round((l-a)/(o-1)):null;for(Mb(e,c,u,Bn(y)?0:a-y,a),d=0,m=o-1;d<m;d++)Mb(e,c,u,s[d],s[d+1]);return Mb(e,c,u,l,Bn(y)?e.length:l+y),c}return Mb(e,c,u),c}function Tce(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(i,r))}function Ece(n,e,t){const i=Cce(n),r=e.length/t;if(!i)return Math.max(r,1);const s=cae(i);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>r)return l}return Math.max(r,1)}function Ace(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function Mce(n,e,t,i){let r=0,s=t[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===s&&(e.push(n[o]),r++,s=t[r*i])}function Mb(n,e,t,i,r){const s=wn(i,0),o=Math.min(wn(r,n.length),n.length);let a=0,l,c,u;for(t=Math.ceil(t),r&&(l=r-i,t=l/Math.floor(l/t)),u=s;u<0;)a++,u=Math.round(s+a*t);for(c=Math.max(s,0);c<o;c++)c===u&&(e.push(n[c]),a++,u=Math.round(s+a*t))}function Cce(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const Pce=n=>n==="left"?"right":n==="right"?"left":n,ZL=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,KL=(n,e)=>Math.min(e||n,n);function JL(n,e){const t=[],i=n.length/e,r=n.length;let s=0;for(;s<r;s+=i)t.push(n[Math.floor(s)]);return t}function Rce(n,e,t){const i=n.ticks.length,r=Math.min(e,i-1),s=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(r),c;if(!(t&&(i===1?c=Math.max(l-s,o-l):e===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<s-a||l>o+a)))return l}function Ice(n,e){fi(n,t=>{const i=t.gc,r=i.length/2;let s;if(r>e){for(s=0;s<r;++s)delete t.data[i[s]];i.splice(0,r)}})}function yy(n){return n.drawTicks?n.tickLength:0}function QL(n,e){if(!n.display)return 0;const t=ns(n.font,e),i=_o(n.padding);return(ji(n.text)?n.text.length:1)*t.lineHeight+i.height}function kce(n,e){return dd(n,{scale:e,type:"scale"})}function Oce(n,e,t){return dd(n,{tick:t,index:e,type:"tick"})}function Lce(n,e,t){let i=qR(n);return(t&&e!=="right"||!t&&e==="right")&&(i=Pce(i)),i}function Nce(n,e,t,i){const{top:r,left:s,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:u}=l;let d=0,m,y,x;const T=o-r,S=a-s;if(n.isHorizontal()){if(y=ao(i,s,a),Wn(t)){const w=Object.keys(t)[0],P=t[w];x=u[w].getPixelForValue(P)+T-e}else t==="center"?x=(c.bottom+c.top)/2+T-e:x=ZL(n,t,e);m=a-s}else{if(Wn(t)){const w=Object.keys(t)[0],P=t[w];y=u[w].getPixelForValue(P)-S+e}else t==="center"?y=(c.left+c.right)/2-S+e:y=ZL(n,t,e);x=ao(i,o,r),d=t==="left"?-Cr:Cr}return{titleX:y,titleY:x,maxWidth:m,rotation:d}}class cm extends Ah{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:r}=this;return e=za(e,Number.POSITIVE_INFINITY),t=za(t,Number.NEGATIVE_INFINITY),i=za(i,Number.POSITIVE_INFINITY),r=za(r,Number.NEGATIVE_INFINITY),{min:za(e,i),max:za(t,r),minDefined:mr(e),maxDefined:mr(t)}}getMinMax(e){let{min:t,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:t,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(t=Math.min(t,o.min)),s||(i=Math.max(i,o.max));return t=s&&t>i?i:t,i=r&&t>i?t:i,{min:za(t,za(i,t)),max:za(i,za(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ii(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Uae(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?JL(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Sce(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ii(this.options.afterUpdate,[this])}beforeSetDimensions(){Ii(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ii(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ii(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ii(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i],s.label=Ii(t.callback,[s.value,i,e],this)}afterTickToLabelConversion(){Ii(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ii(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=KL(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,s=t.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!t.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),d=u.widest.width,m=u.highest.height,y=bs(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/i:y/(i-1),d+6>a&&(a=y/(i-(e.offset?.5:1)),l=this.maxHeight-yy(e.grid)-t.padding-QL(e.title,this.chart.options.font),c=Math.sqrt(d*d+m*m),o=GR(Math.min(Math.asin(bs((u.highest.height+6)/a,-1,1)),Math.asin(bs(l/c,-1,1))-Math.asin(bs(m/c,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Ii(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ii(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=QL(r,t.options.font);if(a?(e.width=this.maxWidth,e.height=yy(s)+l):(e.height=this.maxHeight,e.width=yy(s)+l),i.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:m}=this._getLabelSizes(),y=i.padding*2,x=ac(this.labelRotation),T=Math.cos(x),S=Math.sin(x);if(a){const w=i.mirror?0:S*d.width+T*m.height;e.height=Math.min(this.maxHeight,e.height+w+y)}else{const w=i.mirror?0:T*d.width+S*m.height;e.width=Math.min(this.maxWidth,e.width+w+y)}this._calculatePadding(c,u,S,T)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,r){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,y=0;l?c?(m=r*e.width,y=i*t.height):(m=i*e.height,y=r*t.width):s==="start"?y=t.width:s==="end"?m=e.width:s!=="inner"&&(m=e.width/2,y=t.width/2),this.paddingLeft=Math.max((m-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((y-d+o)*this.width/(this.width-d),0)}else{let u=t.height/2,d=e.height/2;s==="start"?(u=0,d=e.height):s==="end"&&(u=t.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ii(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)Bn(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=JL(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:r,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(t/KL(t,i));let c=0,u=0,d,m,y,x,T,S,w,P,M,I,k;for(d=0;d<t;d+=l){if(x=e[d].label,T=this._resolveTickFontOptions(d),r.font=S=T.string,w=s[S]=s[S]||{data:{},gc:[]},P=T.lineHeight,M=I=0,!Bn(x)&&!ji(x))M=Jw(r,w.data,w.gc,M,x),I=P;else if(ji(x))for(m=0,y=x.length;m<y;++m)k=x[m],!Bn(k)&&!ji(k)&&(M=Jw(r,w.data,w.gc,M,k),I+=P);o.push(M),a.push(I),c=Math.max(M,c),u=Math.max(I,u)}Ice(s,t);const D=o.indexOf(c),H=a.indexOf(u),W=z=>({width:o[z]||0,height:a[z]||0});return{first:W(0),last:W(t-1),widest:W(D),highest:W(H),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return dae(this._alignToPixels?Jd(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=Oce(this.getContext(),e,i))}return this.$context||(this.$context=kce(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=ac(this.labelRotation),i=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*i>a*r?a/i:l/r:l*r<a*i?l/i:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,l=s.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),m=yy(s),y=[],x=a.setContext(this.getContext()),T=x.display?x.width:0,S=T/2,w=function(ve){return Jd(i,ve,T)};let P,M,I,k,D,H,W,z,j,J,le,ge;if(o==="top")P=w(this.bottom),H=this.bottom-m,z=P-S,J=w(e.top)+S,ge=e.bottom;else if(o==="bottom")P=w(this.top),J=e.top,ge=w(e.bottom)-S,H=P+S,z=this.top+m;else if(o==="left")P=w(this.right),D=this.right-m,W=P-S,j=w(e.left)+S,le=e.right;else if(o==="right")P=w(this.left),j=e.left,le=w(e.right)-S,D=P+S,W=this.left+m;else if(t==="x"){if(o==="center")P=w((e.top+e.bottom)/2+.5);else if(Wn(o)){const ve=Object.keys(o)[0],me=o[ve];P=w(this.chart.scales[ve].getPixelForValue(me))}J=e.top,ge=e.bottom,H=P+S,z=H+m}else if(t==="y"){if(o==="center")P=w((e.left+e.right)/2);else if(Wn(o)){const ve=Object.keys(o)[0],me=o[ve];P=w(this.chart.scales[ve].getPixelForValue(me))}D=P-S,W=D-m,j=e.left,le=e.right}const te=wn(r.ticks.maxTicksLimit,d),de=Math.max(1,Math.ceil(d/te));for(M=0;M<d;M+=de){const ve=this.getContext(M),me=s.setContext(ve),q=a.setContext(ve),ie=me.lineWidth,X=me.color,Y=q.dash||[],ce=q.dashOffset,Me=me.tickWidth,Re=me.tickColor,Fe=me.tickBorderDash||[],Be=me.tickBorderDashOffset;I=Rce(this,M,l),I!==void 0&&(k=Jd(i,I,ie),c?D=W=j=le=k:H=z=J=ge=k,y.push({tx1:D,ty1:H,tx2:W,ty2:z,x1:j,y1:J,x2:le,y2:ge,width:ie,color:X,borderDash:Y,borderDashOffset:ce,tickWidth:Me,tickColor:Re,tickBorderDash:Fe,tickBorderDashOffset:Be}))}return this._ticksLength=d,this._borderValue=P,y}_computeLabelItems(e){const t=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=s,m=yy(i.grid),y=m+u,x=d?-u:y,T=-ac(this.labelRotation),S=[];let w,P,M,I,k,D,H,W,z,j,J,le,ge="middle";if(r==="top")D=this.bottom-x,H=this._getXAxisLabelAlignment();else if(r==="bottom")D=this.top+x,H=this._getXAxisLabelAlignment();else if(r==="left"){const de=this._getYAxisLabelAlignment(m);H=de.textAlign,k=de.x}else if(r==="right"){const de=this._getYAxisLabelAlignment(m);H=de.textAlign,k=de.x}else if(t==="x"){if(r==="center")D=(e.top+e.bottom)/2+y;else if(Wn(r)){const de=Object.keys(r)[0],ve=r[de];D=this.chart.scales[de].getPixelForValue(ve)+y}H=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")k=(e.left+e.right)/2-y;else if(Wn(r)){const de=Object.keys(r)[0],ve=r[de];k=this.chart.scales[de].getPixelForValue(ve)}H=this._getYAxisLabelAlignment(m).textAlign}t==="y"&&(l==="start"?ge="top":l==="end"&&(ge="bottom"));const te=this._getLabelSizes();for(w=0,P=a.length;w<P;++w){M=a[w],I=M.label;const de=s.setContext(this.getContext(w));W=this.getPixelForTick(w)+s.labelOffset,z=this._resolveTickFontOptions(w),j=z.lineHeight,J=ji(I)?I.length:1;const ve=J/2,me=de.color,q=de.textStrokeColor,ie=de.textStrokeWidth;let X=H;o?(k=W,H==="inner"&&(w===P-1?X=this.options.reverse?"left":"right":w===0?X=this.options.reverse?"right":"left":X="center"),r==="top"?c==="near"||T!==0?le=-J*j+j/2:c==="center"?le=-te.highest.height/2-ve*j+j:le=-te.highest.height+j/2:c==="near"||T!==0?le=j/2:c==="center"?le=te.highest.height/2-ve*j:le=te.highest.height-J*j,d&&(le*=-1),T!==0&&!de.showLabelBackdrop&&(k+=j/2*Math.sin(T))):(D=W,le=(1-J)*j/2);let Y;if(de.showLabelBackdrop){const ce=_o(de.backdropPadding),Me=te.heights[w],Re=te.widths[w];let Fe=le-ce.top,Be=0-ce.left;switch(ge){case"middle":Fe-=Me/2;break;case"bottom":Fe-=Me;break}switch(H){case"center":Be-=Re/2;break;case"right":Be-=Re;break;case"inner":w===P-1?Be-=Re:w>0&&(Be-=Re/2);break}Y={left:Be,top:Fe,width:Re+ce.width,height:Me+ce.height,color:de.backdropColor}}S.push({label:I,font:z,textOffset:le,options:{rotation:T,color:me,strokeColor:q,strokeWidth:ie,textAlign:X,textBaseline:ge,translation:[k,D],backdrop:Y}})}return S}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-ac(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,u;return t==="left"?r?(u=this.right+s,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u=this.left)):t==="right"?r?(u=this.left+s,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:r,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,r,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(s=>s.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(t.display)for(s=0,o=r.length;s<o;++s){const l=r[s];t.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,m;this.isHorizontal()?(c=Jd(e,this.left,o)-o/2,u=Jd(e,this.right,a)+a/2,d=m=l):(d=Jd(e,this.top,o)-o/2,m=Jd(e,this.bottom,a)+a/2,c=u=l),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(c,d),t.lineTo(u,m),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&PT(i,r);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Zp(i,c,0,u,l,a)}r&&RT(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:r}}=this;if(!i.display)return;const s=ns(i.font),o=_o(i.padding),a=i.align;let l=s.lineHeight/2;t==="bottom"||t==="center"||Wn(t)?(l+=o.bottom,ji(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:m}=Nce(this,l,t,a);Zp(e,i.text,0,0,s,{color:i.color,maxWidth:d,rotation:m,textAlign:Lce(a,t,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=wn(e.grid&&e.grid.z,-1),r=wn(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==cm.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,o;for(s=0,o=t.length;s<o;++s){const a=t[s];a[i]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return ns(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Cb{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;Uce(t)&&(i=this.register(t));const r=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,Dce(e,o,i),this.override&&$i.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in $i[r]&&(delete $i[r][i],this.override&&delete qp[i])}}function Dce(n,e,t){const i=$v(Object.create(null),[t?$i.get(t):{},$i.get(e),n.defaults]);$i.set(e,i),n.defaultRoutes&&Fce(e,n.defaultRoutes),n.descriptors&&$i.describe(e,n.descriptors)}function Fce(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),r=i.pop(),s=[n].concat(i).join("."),o=e[t].split("."),a=o.pop(),l=o.join(".");$i.route(s,r,l,a)})}function Uce(n){return"id"in n&&"defaults"in n}class Bce{constructor(){this.controllers=new Cb(pd,"datasets",!0),this.elements=new Cb(Ah,"elements"),this.plugins=new Cb(Object,"plugins"),this.scales=new Cb(cm,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):fi(r,o=>{const a=i||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,i){const r=XR(e);Ii(i["before"+r],[],i),t[e](i),Ii(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var jc=new Bce;class zce{constructor(){this._init=void 0}notify(e,t,i,r){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(s,e,t,i);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,i,r){r=r||{};for(const s of e){const o=s.plugin,a=o[i],l=[t,r,s.options];if(Ii(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){Bn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,r=wn(i.options&&i.options.plugins,{}),s=Vce(i);return r===!1&&!t?[]:Wce(e,s,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,r=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}}function Vce(n){const e={},t=[],i=Object.keys(jc.plugins.items);for(let s=0;s<i.length;s++)t.push(jc.getPlugin(i[s]));const r=n.plugins||[];for(let s=0;s<r.length;s++){const o=r[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function Hce(n,e){return!e&&n===!1?null:n===!0?{}:n}function Wce(n,{plugins:e,localIds:t},i,r){const s=[],o=n.getContext();for(const a of e){const l=a.id,c=Hce(i[l],r);c!==null&&s.push({plugin:a,options:jce(n.config,{plugin:a,local:t[l]},c,o)})}return s}function jce(n,{plugin:e,local:t},i,r){const s=n.pluginScopeKeys(e),o=n.getOptionScopes(i,s);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function mC(n,e){const t=$i.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function $ce(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Xce(n,e){return n===e?"_index_":"_value_"}function eN(n){if(n==="x"||n==="y"||n==="r")return n}function Gce(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function gC(n,...e){if(eN(n))return n;for(const t of e){const i=t.axis||Gce(t.position)||n.length>1&&eN(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function tN(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function Yce(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return tN(n,"x",t[0])||tN(n,"y",t[0])}return{}}function qce(n,e){const t=qp[n.type]||{scales:{}},i=e.scales||{},r=mC(n.type,e),s=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!Wn(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=gC(o,a,Yce(o,n),$i.scales[a.type]),c=Xce(l,r),u=t.scales||{};s[o]=Zy(Object.create(null),[{axis:l},a,u[l],u[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||mC(a,e),u=(qp[a]||{}).scales||{};Object.keys(u).forEach(d=>{const m=$ce(d,l),y=o[m+"AxisID"]||m;s[y]=s[y]||Object.create(null),Zy(s[y],[{axis:m},i[y],u[d]])})}),Object.keys(s).forEach(o=>{const a=s[o];Zy(a,[$i.scales[a.type],$i.scale])}),s}function F5(n){const e=n.options||(n.options={});e.plugins=wn(e.plugins,{}),e.scales=qce(n,e)}function U5(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Zce(n){return n=n||{},n.data=U5(n.data),F5(n),n}const nN=new Map,B5=new Set;function Pb(n,e){let t=nN.get(n);return t||(t=e(),nN.set(n,t),B5.add(t)),t}const vy=(n,e,t)=>{const i=ed(e,t);i!==void 0&&n.add(i)};class Kce{constructor(e){this._config=Zce(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=U5(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),F5(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Pb(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Pb(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Pb(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return Pb(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){const{options:r,type:s}=this,o=this._cachedScopes(e,i),a=o.get(t);if(a)return a;const l=new Set;t.forEach(u=>{e&&(l.add(e),u.forEach(d=>vy(l,e,d))),u.forEach(d=>vy(l,r,d)),u.forEach(d=>vy(l,qp[s]||{},d)),u.forEach(d=>vy(l,$i,d)),u.forEach(d=>vy(l,dC,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),B5.has(t)&&o.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,qp[t]||{},$i.datasets[t]||{},{type:t},$i,dC]}resolveNamedOptions(e,t,i,r=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=iN(this._resolverCache,e,r);let l=o;if(Qce(o,t)){s.$shared=!1,i=td(i)?i():i;const c=this.createResolver(e,i,a);l=o_(o,i,c)}for(const c of t)s[c]=l[c];return s}createResolver(e,t,i=[""],r){const{resolver:s}=iN(this._resolverCache,e,i);return Wn(t)?o_(s,t,void 0,r):s}}function iN(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const r=t.join();let s=i.get(r);return s||(s={resolver:JR(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},i.set(r,s)),s}const Jce=n=>Wn(n)&&Object.getOwnPropertyNames(n).some(e=>td(n[e]));function Qce(n,e){const{isScriptable:t,isIndexable:i}=m5(n);for(const r of e){const s=t(r),o=i(r),a=(o||s)&&n[r];if(s&&(td(a)||Jce(a))||o&&ji(a))return!0}return!1}var eue="4.5.1";const tue=["top","bottom","left","right","chartArea"];function rN(n,e){return n==="top"||n==="bottom"||tue.indexOf(n)===-1&&e==="x"}function sN(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function oN(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Ii(t&&t.onComplete,[n],e)}function nue(n){const e=n.chart,t=e.options.animation;Ii(t&&t.onProgress,[n],e)}function z5(n){return t2()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const gw={},aN=n=>{const e=z5(n);return Object.values(gw).filter(t=>t.canvas===e).pop()};function iue(n,e,t){const i=Object.keys(n);for(const r of i){const s=+r;if(s>=e){const o=n[r];delete n[r],(t>0||s>e)&&(n[s+t]=o)}}}function rue(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}let O_=class{static defaults=$i;static instances=gw;static overrides=qp;static registry=jc;static version=eue;static getChart=aN;static register(...e){jc.add(...e),lN()}static unregister(...e){jc.remove(...e),lN()}constructor(e,t){const i=this.config=new Kce(t),r=z5(e),s=aN(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||wce(r)),this.platform.updateConfig(i);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=eae(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new zce,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=_ae(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],gw[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}qu.listen(this,"complete",oN),qu.listen(this,"progress",nue),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:r,_aspectRatio:s}=this;return Bn(e)?t&&s?s:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return jc}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():RL(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ML(this.canvas,this.ctx),this}stop(){return qu.stop(this),this}resize(e,t){qu.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,RL(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Ii(i.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};fi(t,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,r=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const a=t[o],l=gC(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),fi(s,o=>{const a=o.options,l=a.id,c=gC(l,a),u=wn(a.type,o.dtype);(a.position===void 0||rN(a.position,c)!==rN(o.dposition))&&(a.position=o.dposition),r[l]=!0;let d=null;if(l in i&&i[l].type===u)d=i[l];else{const m=jc.getScale(u);d=new m({id:l,type:u,ctx:this.ctx,chart:this}),i[d.id]=d}d.init(a,e)}),fi(r,(o,a)=>{o||delete i[a]}),fi(i,o=>{po.configure(this,o,o.options),po.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((r,s)=>r.index-s.index),i>t){for(let r=t;r<i;++r)this._destroyDatasetMeta(r);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(sN("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,r)=>{t.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=t.length;i<r;i++){const s=t[i];let o=this.getDatasetMeta(i);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=s.indexAxis||mC(a,this.options),o.order=s.order||0,o.index=i,o.label=""+s.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const l=jc.getController(a),{datasetElementType:c,dataElementType:u}=$i.datasets[a];Object.assign(l,{dataElementType:jc.getElement(u),datasetElementType:c&&jc.getElement(c)}),o.controller=new l(this,i),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){fi(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),m=!r&&s.indexOf(d)===-1;d.buildOrUpdateElements(m),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),r||fi(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(sN("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){fi(this.scales,e=>{po.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!yL(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of t){const o=i==="_removeElements"?-s:s;iue(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),r=i(0);for(let s=1;s<t;s++)if(!yL(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;po.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],fi(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,td(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(qu.has(this)?this.attached&&!qu.running(this)&&qu.start(this):(this.draw(),oN({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let r,s;for(r=0,s=t.length;r<s;++r){const o=t[r];(!e||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},r=A5(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&PT(t,r),e.controller.draw(),r&&RT(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return lh(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,r){const s=tce.modes[t];return typeof s=="function"?s(this,e,i,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let r=i.filter(s=>s&&s._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=dd(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const r=i?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,r);Xv(t)?(s.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),o.update(s,{visible:i}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),qu.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ML(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete gw[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},r=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};fi(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),i("resize",s),i("detach",o)};o=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){fi(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},fi(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const r=i?"set":"remove";let s,o,a,l;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!qw(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const r=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=s(t,e),a=i?e:s(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:r=[],options:s}=this,o=t,a=this._getActiveElements(e,r,i,o),l=oae(e),c=rue(e,this._lastEvent,i,l);i&&(this._lastEvent=null,Ii(s.onHover,[e,a,this],this),l&&Ii(s.onClick,[e,a,this],this));const u=!qw(a,r);return(u||t)&&(this._active=a,this._updateHoverStyles(a,r,t)),this._lastEvent=c,u}_getActiveElements(e,t,i,r){if(e.type==="mouseout")return[];if(!i)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}};function lN(){return fi(O_.instances,n=>n._plugins.invalidate())}function sue(n,e,t){const{startAngle:i,x:r,y:s,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:c,borderJoinStyle:u}=l,d=Math.min(c/o,co(i-t));if(n.beginPath(),n.arc(r,s,o-c/2,i+d/2,t-d/2),a>0){const m=Math.min(c/a,co(i-t));n.arc(r,s,a+c/2,t-m/2,i+m/2,!0)}else{const m=Math.min(c/2,o*co(i-t));if(u==="round")n.arc(r,s,m,t-Jn/2,i+Jn/2,!0);else if(u==="bevel"){const y=2*m*m,x=-y*Math.cos(t+Jn/2)+r,T=-y*Math.sin(t+Jn/2)+s,S=y*Math.cos(i+Jn/2)+r,w=y*Math.sin(i+Jn/2)+s;n.lineTo(x,T),n.lineTo(S,w)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function oue(n,e,t){const{startAngle:i,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:l}=e;let c=r/a;n.beginPath(),n.arc(s,o,a,i-c,t+c),l>r?(c=r/l,n.arc(s,o,l,t+c,i-c,!0)):n.arc(s,o,r,t+Cr,i-Cr),n.closePath(),n.clip()}function aue(n){return KR(n,["outerStart","outerEnd","innerStart","innerEnd"])}function lue(n,e,t,i){const r=aue(n.options.borderRadius),s=(t-e)/2,o=Math.min(s,i*e/2),a=l=>{const c=(t-Math.min(s,l))*i/2;return bs(l,0,Math.min(s,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:bs(r.innerStart,0,o),innerEnd:bs(r.innerEnd,0,o)}}function cg(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function tS(n,e,t,i,r,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,d=Math.max(e.outerRadius+i+t-c,0),m=u>0?u+i+t+c:0;let y=0;const x=r-l;if(i){const de=u>0?u-i:0,ve=d>0?d-i:0,me=(de+ve)/2,q=me!==0?x*me/(me+i):x;y=(x-q)/2}const T=Math.max(.001,x*d-t/Jn)/d,S=(x-T)/2,w=l+S+y,P=r-S-y,{outerStart:M,outerEnd:I,innerStart:k,innerEnd:D}=lue(e,m,d,P-w),H=d-M,W=d-I,z=w+M/H,j=P-I/W,J=m+k,le=m+D,ge=w+k/J,te=P-D/le;if(n.beginPath(),s){const de=(z+j)/2;if(n.arc(o,a,d,z,de),n.arc(o,a,d,de,j),I>0){const ie=cg(W,j,o,a);n.arc(ie.x,ie.y,I,j,P+Cr)}const ve=cg(le,P,o,a);if(n.lineTo(ve.x,ve.y),D>0){const ie=cg(le,te,o,a);n.arc(ie.x,ie.y,D,P+Cr,te+Math.PI)}const me=(P-D/m+(w+k/m))/2;if(n.arc(o,a,m,P-D/m,me,!0),n.arc(o,a,m,me,w+k/m,!0),k>0){const ie=cg(J,ge,o,a);n.arc(ie.x,ie.y,k,ge+Math.PI,w-Cr)}const q=cg(H,w,o,a);if(n.lineTo(q.x,q.y),M>0){const ie=cg(H,z,o,a);n.arc(ie.x,ie.y,M,w-Cr,z)}}else{n.moveTo(o,a);const de=Math.cos(z)*d+o,ve=Math.sin(z)*d+a;n.lineTo(de,ve);const me=Math.cos(j)*d+o,q=Math.sin(j)*d+a;n.lineTo(me,q)}n.closePath()}function cue(n,e,t,i,r){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){tS(n,e,t,i,l,r);for(let c=0;c<s;++c)n.fill();isNaN(a)||(l=o+(a%Di||Di))}return tS(n,e,t,i,l,r),n.fill(),l}function uue(n,e,t,i,r){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:m,borderRadius:y}=l,x=l.borderAlign==="inner";if(!c)return;n.setLineDash(d||[]),n.lineDashOffset=m,x?(n.lineWidth=c*2,n.lineJoin=u||"round"):(n.lineWidth=c,n.lineJoin=u||"bevel");let T=e.endAngle;if(s){tS(n,e,t,i,T,r);for(let S=0;S<s;++S)n.stroke();isNaN(a)||(T=o+(a%Di||Di))}x&&oue(n,e,T),l.selfJoin&&T-o>=Jn&&y===0&&u!=="miter"&&sue(n,e,T),s||(tS(n,e,t,i,T,r),n.stroke())}class hue extends Ah{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.getProps(["x","y"],i),{angle:s,distance:o}=s5(r,{x:e,y:t}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),m=(this.options.spacing+this.options.borderWidth)/2,y=wn(d,l-a),x=Gv(s,a,l)&&a!==l,T=y>=Di||x,S=oh(o,c+m,u+m);return T&&S}getCenterPoint(e){const{x:t,y:i,startAngle:r,endAngle:s,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:l,spacing:c}=this.options,u=(r+s)/2,d=(o+a+c+l)/2;return{x:t+Math.cos(u)*d,y:i+Math.sin(u)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,r=(t.offset||0)/4,s=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Di?Math.floor(i/Di):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*r,Math.sin(a)*r);const l=1-Math.sin(Math.min(Jn,i||0)),c=r*l;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,cue(e,this,c,s,o),uue(e,this,c,s,o),e.restore()}}function V5(n,e,t=e){n.lineCap=wn(t.borderCapStyle,e.borderCapStyle),n.setLineDash(wn(t.borderDash,e.borderDash)),n.lineDashOffset=wn(t.borderDashOffset,e.borderDashOffset),n.lineJoin=wn(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=wn(t.borderWidth,e.borderWidth),n.strokeStyle=wn(t.borderColor,e.borderColor)}function fue(n,e,t){n.lineTo(t.x,t.y)}function due(n){return n.stepped?Pae:n.tension||n.cubicInterpolationMode==="monotone"?Rae:fue}function H5(n,e,t={}){const i=n.length,{start:r=0,end:s=i-1}=t,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:i,start:l,loop:e.loop,ilen:c<l&&!u?i+c-l:c-l}}function pue(n,e,t,i){const{points:r,options:s}=e,{count:o,start:a,loop:l,ilen:c}=H5(r,t,i),u=due(s);let{move:d=!0,reverse:m}=i||{},y,x,T;for(y=0;y<=c;++y)x=r[(a+(m?c-y:y))%o],!x.skip&&(d?(n.moveTo(x.x,x.y),d=!1):u(n,T,x,m,s.stepped),T=x);return l&&(x=r[(a+(m?c:0))%o],u(n,T,x,m,s.stepped)),!!l}function mue(n,e,t,i){const r=e.points,{count:s,start:o,ilen:a}=H5(r,t,i),{move:l=!0,reverse:c}=i||{};let u=0,d=0,m,y,x,T,S,w;const P=I=>(o+(c?a-I:I))%s,M=()=>{T!==S&&(n.lineTo(u,S),n.lineTo(u,T),n.lineTo(u,w))};for(l&&(y=r[P(0)],n.moveTo(y.x,y.y)),m=0;m<=a;++m){if(y=r[P(m)],y.skip)continue;const I=y.x,k=y.y,D=I|0;D===x?(k<T?T=k:k>S&&(S=k),u=(d*u+I)/++d):(M(),n.lineTo(I,k),x=D,d=0,T=S=k),w=k}M()}function _C(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?mue:pue}function gue(n){return n.stepped?lle:n.tension||n.cubicInterpolationMode==="monotone"?cle:hp}function _ue(n,e,t,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,i)&&r.closePath()),V5(n,e.options),n.stroke(r)}function yue(n,e,t,i){const{segments:r,options:s}=e,o=_C(e);for(const a of r)V5(n,s,a.style),n.beginPath(),o(n,e,a,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const vue=typeof Path2D=="function";function xue(n,e,t,i){vue&&!e.options.segment?_ue(n,e,t,i):yue(n,e,t,i)}class OT extends Ah{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;ele(this._points,i,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=mle(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,r=e[t],s=this.points,o=E5(this,{property:t,start:r,end:r});if(!o.length)return;const a=[],l=gue(i);let c,u;for(c=0,u=o.length;c<u;++c){const{start:d,end:m}=o[c],y=s[d],x=s[m];if(y===x){a.push(y);continue}const T=Math.abs((r-y[t])/(x[t]-y[t])),S=l(y,x,T,i.stepped);S[t]=e[t],a.push(S)}return a.length===1?a[0]:a}pathSegment(e,t,i){return _C(this)(e,this,t,i)}path(e,t,i){const r=this.segments,s=_C(this);let o=this._loop;t=t||0,i=i||this.points.length-t;for(const a of r)o&=s(e,this,a,{start:t,end:t+i-1});return!!o}draw(e,t,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),xue(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function cN(n,e,t,i){const r=n.options,{[t]:s}=n.getProps([t],i);return Math.abs(e-s)<r.radius+r.hitRadius}class bue extends Ah{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.options,{x:s,y:o}=this.getProps(["x","y"],i);return Math.pow(e-s,2)+Math.pow(t-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return cN(this,e,"x",t)}inYRange(e,t){return cN(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!lh(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,pC(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function W5(n,e){const{x:t,y:i,base:r,width:s,height:o}=n.getProps(["x","y","base","width","height"],e);let a,l,c,u,d;return n.horizontal?(d=o/2,a=Math.min(t,r),l=Math.max(t,r),c=i-d,u=i+d):(d=s/2,a=t-d,l=t+d,c=Math.min(i,r),u=Math.max(i,r)),{left:a,top:c,right:l,bottom:u}}function Uf(n,e,t,i){return n?0:bs(e,t,i)}function wue(n,e,t){const i=n.options.borderWidth,r=n.borderSkipped,s=p5(i);return{t:Uf(r.top,s.top,0,t),r:Uf(r.right,s.right,0,e),b:Uf(r.bottom,s.bottom,0,t),l:Uf(r.left,s.left,0,e)}}function Sue(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,s=Rp(r),o=Math.min(e,t),a=n.borderSkipped,l=i||Wn(r);return{topLeft:Uf(!l||a.top||a.left,s.topLeft,0,o),topRight:Uf(!l||a.top||a.right,s.topRight,0,o),bottomLeft:Uf(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:Uf(!l||a.bottom||a.right,s.bottomRight,0,o)}}function Tue(n){const e=W5(n),t=e.right-e.left,i=e.bottom-e.top,r=wue(n,t/2,i/2),s=Sue(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function N1(n,e,t,i){const r=e===null,s=t===null,a=n&&!(r&&s)&&W5(n,i);return a&&(r||oh(e,a.left,a.right))&&(s||oh(t,a.top,a.bottom))}function Eue(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Aue(n,e){n.rect(e.x,e.y,e.w,e.h)}function D1(n,e,t={}){const i=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-i,o=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+s,h:n.h+o,radius:n.radius}}class j5 extends Ah{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:o}=Tue(this),a=Eue(o.radius)?Yv:Aue;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,D1(o,t,s)),e.clip(),a(e,D1(s,-t,o)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),a(e,D1(s,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,i){return N1(this,e,t,i)}inXRange(e,t){return N1(this,e,null,t)}inYRange(e,t){return N1(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+r)/2:t,y:s?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}var Mue=Object.freeze({__proto__:null,ArcElement:hue,BarElement:j5,LineElement:OT,PointElement:bue});const yC=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],uN=yC.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function $5(n){return yC[n%yC.length]}function X5(n){return uN[n%uN.length]}function Cue(n,e){return n.borderColor=$5(e),n.backgroundColor=X5(e),++e}function Pue(n,e){return n.backgroundColor=n.data.map(()=>$5(e++)),e}function Rue(n,e){return n.backgroundColor=n.data.map(()=>X5(e++)),e}function Iue(n){let e=0;return(t,i)=>{const r=n.getDatasetMeta(i).controller;r instanceof i2?e=Pue(t,e):r instanceof I5?e=Rue(t,e):r&&(e=Cue(t,e))}}function hN(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function kue(n){return n&&(n.borderColor||n.backgroundColor)}function Oue(){return $i.borderColor!=="rgba(0,0,0,0.1)"||$i.backgroundColor!=="rgba(0,0,0,0.1)"}var Lue={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,t){if(!t.enabled)return;const{data:{datasets:i},options:r}=n.config,{elements:s}=r,o=hN(i)||kue(r)||s&&hN(s)||Oue();if(!t.forceOverride&&o)return;const a=Iue(n);i.forEach(a)}};function Nue(n,e,t,i,r){const s=r.samples||i;if(s>=t)return n.slice(e,e+t);const o=[],a=(t-2)/(s-2);let l=0;const c=e+t-1;let u=e,d,m,y,x,T;for(o[l++]=n[u],d=0;d<s-2;d++){let S=0,w=0,P;const M=Math.floor((d+1)*a)+1+e,I=Math.min(Math.floor((d+2)*a)+1,t)+e,k=I-M;for(P=M;P<I;P++)S+=n[P].x,w+=n[P].y;S/=k,w/=k;const D=Math.floor(d*a)+1+e,H=Math.min(Math.floor((d+1)*a)+1,t)+e,{x:W,y:z}=n[u];for(y=x=-1,P=D;P<H;P++)x=.5*Math.abs((W-S)*(n[P].y-z)-(W-n[P].x)*(w-z)),x>y&&(y=x,m=n[P],T=P);o[l++]=m,u=T}return o[l++]=n[c],o}function Due(n,e,t,i){let r=0,s=0,o,a,l,c,u,d,m,y,x,T;const S=[],w=e+t-1,P=n[e].x,I=n[w].x-P;for(o=e;o<e+t;++o){a=n[o],l=(a.x-P)/I*i,c=a.y;const k=l|0;if(k===u)c<x?(x=c,d=o):c>T&&(T=c,m=o),r=(s*r+a.x)/++s;else{const D=o-1;if(!Bn(d)&&!Bn(m)){const H=Math.min(d,m),W=Math.max(d,m);H!==y&&H!==D&&S.push({...n[H],x:r}),W!==y&&W!==D&&S.push({...n[W],x:r})}o>0&&D!==y&&S.push(n[D]),S.push(a),u=k,s=0,x=T=c,d=m=y=o}}return S}function G5(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function fN(n){n.data.datasets.forEach(e=>{G5(e)})}function Fue(n,e){const t=e.length;let i=0,r;const{iScale:s}=n,{min:o,max:a,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(i=bs(ah(e,s.axis,o).lo,0,t-1)),c?r=bs(ah(e,s.axis,a).hi+1,i,t)-i:r=t-i,{start:i,count:r}}var Uue={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){fN(n);return}const i=n.width;n.data.datasets.forEach((r,s)=>{const{_data:o,indexAxis:a}=r,l=n.getDatasetMeta(s),c=o||r.data;if(Ly([a,n.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=n.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||n.options.parsing)return;let{start:d,count:m}=Fue(l,c);const y=t.threshold||4*i;if(m<=y){G5(r);return}Bn(o)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(T){this._data=T}}));let x;switch(t.algorithm){case"lttb":x=Nue(c,d,m,i,t);break;case"min-max":x=Due(c,d,m,i);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}r._decimated=x})},destroy(n){fN(n)}};function Bue(n,e,t){const i=n.segments,r=n.points,s=e.points,o=[];for(const a of i){let{start:l,end:c}=a;c=LT(l,c,r);const u=vC(t,r[l],r[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const d=E5(e,u);for(const m of d){const y=vC(t,s[m.start],s[m.end],m.loop),x=T5(a,r,y);for(const T of x)o.push({source:T,target:m,start:{[t]:dN(u,y,"start",Math.max)},end:{[t]:dN(u,y,"end",Math.min)}})}}return o}function vC(n,e,t,i){if(i)return;let r=e[n],s=t[n];return n==="angle"&&(r=co(r),s=co(s)),{property:n,start:r,end:s}}function zue(n,e){const{x:t=null,y:i=null}=n||{},r=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=LT(o,a,r);const l=r[o],c=r[a];i!==null?(s.push({x:l.x,y:i}),s.push({x:c.x,y:i})):t!==null&&(s.push({x:t,y:l.y}),s.push({x:t,y:c.y}))}),s}function LT(n,e,t){for(;e>n;e--){const i=t[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function dN(n,e,t,i){return n&&e?i(n[t],e[t]):n?n[t]:e?e[t]:0}function Y5(n,e){let t=[],i=!1;return ji(n)?(i=!0,t=n):t=zue(n,e),t.length?new OT({points:t,options:{tension:0},_loop:i,_fullLoop:i}):null}function pN(n){return n&&n.fill!==!1}function Vue(n,e,t){let r=n[e].fill;const s=[e];let o;if(!t)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!mr(r))return r;if(o=n[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function Hue(n,e,t){const i=Xue(n);if(Wn(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return mr(r)&&Math.floor(r)===r?Wue(i[0],e,r,t):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function Wue(n,e,t,i){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=i?!1:t}function jue(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:Wn(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function $ue(n,e,t){let i;return n==="start"?i=t:n==="end"?i=e.options.reverse?e.min:e.max:Wn(n)?i=n.value:i=e.getBaseValue(),i}function Xue(n){const e=n.options,t=e.fill;let i=wn(t&&t.target,t);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function Gue(n){const{scale:e,index:t,line:i}=n,r=[],s=i.segments,o=i.points,a=Yue(e,t);a.push(Y5({x:null,y:e.bottom},i));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)que(r,o[u],a)}return new OT({points:r,options:{}})}function Yue(n,e){const t=[],i=n.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const s=i[r];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function que(n,e,t){const i=[];for(let r=0;r<t.length;r++){const s=t[r],{first:o,last:a,point:l}=Zue(s,e,"x");if(!(!l||o&&a)){if(o)i.unshift(l);else if(n.push(l),!a)break}}n.push(...i)}function Zue(n,e,t){const i=n.interpolate(e,t);if(!i)return{};const r=i[t],s=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],d=o[u.start][t],m=o[u.end][t];if(oh(r,d,m)){a=r===d,l=r===m;break}}return{first:a,last:l,point:i}}class q5{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,i){const{x:r,y:s,radius:o}=this;return t=t||{start:0,end:Di},e.arc(r,s,o,t.end,t.start,!0),!i.bounds}interpolate(e){const{x:t,y:i,radius:r}=this,s=e.angle;return{x:t+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function Kue(n){const{chart:e,fill:t,line:i}=n;if(mr(t))return Jue(e,t);if(t==="stack")return Gue(n);if(t==="shape")return!0;const r=Que(n);return r instanceof q5?r:Y5(r,i)}function Jue(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function Que(n){return(n.scale||{}).getPointPositionForValue?the(n):ehe(n)}function ehe(n){const{scale:e={},fill:t}=n,i=jue(t,e);if(mr(i)){const r=e.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function the(n){const{scale:e,fill:t}=n,i=e.options,r=e.getLabels().length,s=i.reverse?e.max:e.min,o=$ue(t,e,s),a=[];if(i.grid.circular){const l=e.getPointPositionForValue(0,s);return new q5({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(e.getPointPositionForValue(l,o));return a}function F1(n,e,t){const i=Kue(e),{chart:r,index:s,line:o,scale:a,axis:l}=e,c=o.options,u=c.fill,d=c.backgroundColor,{above:m=d,below:y=d}=u||{},x=r.getDatasetMeta(s),T=A5(r,x);i&&o.points.length&&(PT(n,t),nhe(n,{line:o,target:i,above:m,below:y,area:t,scale:a,axis:l,clip:T}),RT(n))}function nhe(n,e){const{line:t,target:i,above:r,below:s,area:o,scale:a,clip:l}=e,c=t._loop?"angle":e.axis;n.save();let u=s;s!==r&&(c==="x"?(mN(n,i,o.top),U1(n,{line:t,target:i,color:r,scale:a,property:c,clip:l}),n.restore(),n.save(),mN(n,i,o.bottom)):c==="y"&&(gN(n,i,o.left),U1(n,{line:t,target:i,color:s,scale:a,property:c,clip:l}),n.restore(),n.save(),gN(n,i,o.right),u=r)),U1(n,{line:t,target:i,color:u,scale:a,property:c,clip:l}),n.restore()}function mN(n,e,t){const{segments:i,points:r}=e;let s=!0,o=!1;n.beginPath();for(const a of i){const{start:l,end:c}=a,u=r[l],d=r[LT(l,c,r)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(u.x,t),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function gN(n,e,t){const{segments:i,points:r}=e;let s=!0,o=!1;n.beginPath();for(const a of i){const{start:l,end:c}=a,u=r[l],d=r[LT(l,c,r)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(t,u.y),n.lineTo(u.x,u.y)),o=!!e.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(t,d.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function U1(n,e){const{line:t,target:i,property:r,color:s,scale:o,clip:a}=e,l=Bue(t,i,r);for(const{source:c,target:u,start:d,end:m}of l){const{style:{backgroundColor:y=s}={}}=c,x=i!==!0;n.save(),n.fillStyle=y,ihe(n,o,a,x&&vC(r,d,m)),n.beginPath();const T=!!t.pathSegment(n,c);let S;if(x){T?n.closePath():_N(n,i,m,r);const w=!!i.pathSegment(n,u,{move:T,reverse:!0});S=T&&w,S||_N(n,i,d,r)}n.closePath(),n.fill(S?"evenodd":"nonzero"),n.restore()}}function ihe(n,e,t,i){const r=e.chart.chartArea,{property:s,start:o,end:a}=i||{};if(s==="x"||s==="y"){let l,c,u,d;s==="x"?(l=o,c=r.top,u=a,d=r.bottom):(l=r.left,c=o,u=r.right,d=a),n.beginPath(),t&&(l=Math.max(l,t.left),u=Math.min(u,t.right),c=Math.max(c,t.top),d=Math.min(d,t.bottom)),n.rect(l,c,u-l,d-c),n.clip()}}function _N(n,e,t,i){const r=e.interpolate(t,i);r&&n.lineTo(r.x,r.y)}var Z5={id:"filler",afterDatasetsUpdate(n,e,t){const i=(n.data.datasets||[]).length,r=[];let s,o,a,l;for(o=0;o<i;++o)s=n.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof OT&&(l={visible:n.isDatasetVisible(o),index:o,fill:Hue(a,o,i),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,r.push(l);for(o=0;o<i;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=Vue(r,o,t.propagate))},beforeDraw(n,e,t){const i=t.drawTime==="beforeDraw",r=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),i&&a.fill&&F1(n.ctx,a,s))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const s=i[r].$filler;pN(s)&&F1(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,e,t){const i=e.meta.$filler;!pN(i)||t.drawTime!=="beforeDatasetDraw"||F1(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const yN=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},rhe=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class vN extends Ah{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Ii(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=ns(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=yN(i,s);let c,u;t.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,r){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let d=e;s.textAlign="left",s.textBaseline="middle";let m=-1,y=-u;return this.legendItems.forEach((x,T)=>{const S=i+t/2+s.measureText(x.text).width;(T===0||c[c.length-1]+S+2*a>o)&&(d+=u,c[c.length-(T>0?0:1)]=0,y+=u,m++),l[T]={left:0,top:y,row:m,width:S,height:r},c[c.length-1]+=S+a}),d}_fitCols(e,t,i,r){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let d=a,m=0,y=0,x=0,T=0;return this.legendItems.forEach((S,w)=>{const{itemWidth:P,itemHeight:M}=she(i,t,s,S,r);w>0&&y+M+2*a>u&&(d+=m+a,c.push({width:m,height:y}),x+=m+a,T++,m=y=0),l[w]={left:x,top:y,col:T,width:P,height:M},m=Math.max(m,P),y+=M+a}),d+=m,c.push({width:m,height:y}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:r},rtl:s}}=this,o=$g(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=ao(i,this.left+r,this.right-this.lineWidths[a]);for(const c of t)a!==c.row&&(a=c.row,l=ao(i,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=ao(i,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of t)c.col!==a&&(a=c.col,l=ao(i,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;PT(e,this),this._draw(),RT(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:r}=this,{align:s,labels:o}=e,a=$i.color,l=$g(e.rtl,this.left,this.width),c=ns(o.font),{padding:u}=o,d=c.size,m=d/2;let y;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:x,boxHeight:T,itemHeight:S}=yN(o,d),w=function(D,H,W){if(isNaN(x)||x<=0||isNaN(T)||T<0)return;r.save();const z=wn(W.lineWidth,1);if(r.fillStyle=wn(W.fillStyle,a),r.lineCap=wn(W.lineCap,"butt"),r.lineDashOffset=wn(W.lineDashOffset,0),r.lineJoin=wn(W.lineJoin,"miter"),r.lineWidth=z,r.strokeStyle=wn(W.strokeStyle,a),r.setLineDash(wn(W.lineDash,[])),o.usePointStyle){const j={radius:T*Math.SQRT2/2,pointStyle:W.pointStyle,rotation:W.rotation,borderWidth:z},J=l.xPlus(D,x/2),le=H+m;d5(r,j,J,le,o.pointStyleWidth&&x)}else{const j=H+Math.max((d-T)/2,0),J=l.leftForLtr(D,x),le=Rp(W.borderRadius);r.beginPath(),Object.values(le).some(ge=>ge!==0)?Yv(r,{x:J,y:j,w:x,h:T,radius:le}):r.rect(J,j,x,T),r.fill(),z!==0&&r.stroke()}r.restore()},P=function(D,H,W){Zp(r,W.text,D,H+S/2,c,{strikethrough:W.hidden,textAlign:l.textAlign(W.textAlign)})},M=this.isHorizontal(),I=this._computeTitleHeight();M?y={x:ao(s,this.left+u,this.right-i[0]),y:this.top+u+I,line:0}:y={x:this.left+u,y:ao(s,this.top+I+u,this.bottom-t[0].height),line:0},b5(this.ctx,e.textDirection);const k=S+u;this.legendItems.forEach((D,H)=>{r.strokeStyle=D.fontColor,r.fillStyle=D.fontColor;const W=r.measureText(D.text).width,z=l.textAlign(D.textAlign||(D.textAlign=o.textAlign)),j=x+m+W;let J=y.x,le=y.y;l.setWidth(this.width),M?H>0&&J+j+u>this.right&&(le=y.y+=k,y.line++,J=y.x=ao(s,this.left+u,this.right-i[y.line])):H>0&&le+k>this.bottom&&(J=y.x=J+t[y.line].width+u,y.line++,le=y.y=ao(s,this.top+I+u,this.bottom-t[y.line].height));const ge=l.x(J);if(w(ge,le,D),J=yae(z,J+x+m,M?J+j:this.right,e.rtl),P(l.x(J),le,D),M)y.x+=j+u;else if(typeof D.text!="string"){const te=c.lineHeight;y.y+=K5(D,te)+u}else y.y+=k}),w5(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=ns(t.font),r=_o(t.padding);if(!t.display)return;const s=$g(e.rtl,this.left,this.width),o=this.ctx,a=t.position,l=i.size/2,c=r.top+l;let u,d=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),u=this.top+c,d=ao(e.align,d,this.right-m);else{const x=this.columnSizes.reduce((T,S)=>Math.max(T,S.height),0);u=c+ao(e.align,this.top,this.bottom-x-e.labels.padding-this._computeTitleHeight())}const y=ao(a,d,d+m);o.textAlign=s.textAlign(qR(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=i.string,Zp(o,t.text,y,u,i)}_computeTitleHeight(){const e=this.options.title,t=ns(e.font),i=_o(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,r,s;if(oh(e,this.left,this.right)&&oh(t,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],oh(e,r.left,r.left+r.width)&&oh(t,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!lhe(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,s=rhe(r,i);r&&!s&&Ii(t.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!s&&Ii(t.onHover,[e,i,this],this)}else i&&Ii(t.onClick,[e,i,this],this)}}function she(n,e,t,i,r){const s=ohe(i,n,e,t),o=ahe(r,i,e.lineHeight);return{itemWidth:s,itemHeight:o}}function ohe(n,e,t,i){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+i.measureText(r).width}function ahe(n,e,t){let i=n;return typeof e.text!="string"&&(i=K5(e,t)),i}function K5(n,e){const t=n.text?n.text.length:0;return e*t}function lhe(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var J5={id:"legend",_element:vN,start(n,e,t){const i=n.legend=new vN({ctx:n.ctx,options:t,chart:n});po.configure(n,i,t),po.addBox(n,i)},stop(n){po.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;po.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,r=t.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),u=_o(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:i||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class s2 extends Ah{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=ji(i.text)?i.text.length:1;this._padding=_o(i.padding);const s=r*ns(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:r,right:s,options:o}=this,a=o.align;let l=0,c,u,d;return this.isHorizontal()?(u=ao(a,i,s),d=t+e,c=s-i):(o.position==="left"?(u=i+e,d=ao(a,r,t),l=Jn*-.5):(u=s-e,d=ao(a,t,r),l=Jn*.5),c=r-t),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=ns(t.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);Zp(e,t.text,0,0,i,{color:t.color,maxWidth:l,rotation:c,textAlign:qR(t.align),textBaseline:"middle",translation:[o,a]})}}function che(n,e){const t=new s2({ctx:n.ctx,options:e,chart:n});po.configure(n,t,e),po.addBox(n,t),n.titleBlock=t}var Q5={id:"title",_element:s2,start(n,e,t){che(n,t)},stop(n){const e=n.titleBlock;po.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;po.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Rb=new WeakMap;var uhe={id:"subtitle",start(n,e,t){const i=new s2({ctx:n.ctx,options:t,chart:n});po.configure(n,i,t),po.addBox(n,i),Rb.set(n,i)},stop(n){po.removeBox(n,Rb.get(n)),Rb.delete(n)},beforeUpdate(n,e,t){const i=Rb.get(n);po.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Dy={average(n){if(!n.length)return!1;let e,t,i=new Set,r=0,s=0;for(e=0,t=n.length;e<t;++e){const a=n[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();i.add(l.x),r+=l.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((a,l)=>a+l)/i.size,y:r/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,r=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){const l=n[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=fC(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();t=l.x,i=l.y}return{x:t,y:i}}};function Wc(n,e){return e&&(ji(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Zu(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function hhe(n,e){const{element:t,datasetIndex:i,index:r}=e,s=n.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:n,label:o,parsed:s.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:t}}function xN(n,e){const t=n.chart.ctx,{body:i,footer:r,title:s}=n,{boxWidth:o,boxHeight:a}=e,l=ns(e.bodyFont),c=ns(e.titleFont),u=ns(e.footerFont),d=s.length,m=r.length,y=i.length,x=_o(e.padding);let T=x.height,S=0,w=i.reduce((I,k)=>I+k.before.length+k.lines.length+k.after.length,0);if(w+=n.beforeBody.length+n.afterBody.length,d&&(T+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),w){const I=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;T+=y*I+(w-y)*l.lineHeight+(w-1)*e.bodySpacing}m&&(T+=e.footerMarginTop+m*u.lineHeight+(m-1)*e.footerSpacing);let P=0;const M=function(I){S=Math.max(S,t.measureText(I).width+P)};return t.save(),t.font=c.string,fi(n.title,M),t.font=l.string,fi(n.beforeBody.concat(n.afterBody),M),P=e.displayColors?o+2+e.boxPadding:0,fi(i,I=>{fi(I.before,M),fi(I.lines,M),fi(I.after,M)}),P=0,t.font=u.string,fi(n.footer,M),t.restore(),S+=x.width,{width:S,height:T}}function fhe(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function dhe(n,e,t,i){const{x:r,width:s}=i,o=t.caretSize+t.caretPadding;if(n==="left"&&r+s+o>e.width||n==="right"&&r-s-o<0)return!0}function phe(n,e,t,i){const{x:r,width:s}=t,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return i==="center"?c=r<=(a+l)/2?"left":"right":r<=s/2?c="left":r>=o-s/2&&(c="right"),dhe(c,n,e,t)&&(c="center"),c}function bN(n,e,t){const i=t.yAlign||e.yAlign||fhe(n,t);return{xAlign:t.xAlign||e.xAlign||phe(n,e,t,i),yAlign:i}}function mhe(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function ghe(n,e,t){let{y:i,height:r}=n;return e==="top"?i+=t:e==="bottom"?i-=r+t:i-=r/2,i}function wN(n,e,t,i){const{caretSize:r,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:l}=t,c=r+s,{topLeft:u,topRight:d,bottomLeft:m,bottomRight:y}=Rp(o);let x=mhe(e,a);const T=ghe(e,l,c);return l==="center"?a==="left"?x+=c:a==="right"&&(x-=c):a==="left"?x-=Math.max(u,m)+r:a==="right"&&(x+=Math.max(d,y)+r),{x:bs(x,0,i.width-e.width),y:bs(T,0,i.height-e.height)}}function Ib(n,e,t){const i=_o(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function SN(n){return Wc([],Zu(n))}function _he(n,e,t){return dd(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function TN(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const eH={beforeTitle:Gu,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:Gu,beforeBody:Gu,beforeLabel:Gu,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return Bn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Gu,afterBody:Gu,beforeFooter:Gu,footer:Gu,afterFooter:Gu};function oa(n,e,t,i){const r=n[e].call(t,i);return typeof r>"u"?eH[e].call(t,i):r}class EN extends Ah{static positioners=Dy;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&t.options.animation&&i.animations,s=new M5(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=_he(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,r=oa(i,"beforeTitle",this,e),s=oa(i,"title",this,e),o=oa(i,"afterTitle",this,e);let a=[];return a=Wc(a,Zu(r)),a=Wc(a,Zu(s)),a=Wc(a,Zu(o)),a}getBeforeBody(e,t){return SN(oa(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,r=[];return fi(e,s=>{const o={before:[],lines:[],after:[]},a=TN(i,s);Wc(o.before,Zu(oa(a,"beforeLabel",this,s))),Wc(o.lines,oa(a,"label",this,s)),Wc(o.after,Zu(oa(a,"afterLabel",this,s))),r.push(o)}),r}getAfterBody(e,t){return SN(oa(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,r=oa(i,"beforeFooter",this,e),s=oa(i,"footer",this,e),o=oa(i,"afterFooter",this,e);let a=[];return a=Wc(a,Zu(r)),a=Wc(a,Zu(s)),a=Wc(a,Zu(o)),a}_createItems(e){const t=this._active,i=this.chart.data,r=[],s=[],o=[];let a=[],l,c;for(l=0,c=t.length;l<c;++l)a.push(hhe(this.chart,t[l]));return e.filter&&(a=a.filter((u,d,m)=>e.filter(u,d,m,i))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,i))),fi(a,u=>{const d=TN(e.callbacks,u);r.push(oa(d,"labelColor",this,u)),s.push(oa(d,"labelPointStyle",this,u)),o.push(oa(d,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const i=this.options.setContext(this.getContext()),r=this._active;let s,o=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const a=Dy[i.position].call(this,r,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const l=this._size=xN(this,i),c=Object.assign({},a,l),u=bN(this.chart,i,c),d=wN(i,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,r){const s=this.getCaretPosition(e,i,r);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,i){const{xAlign:r,yAlign:s}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Rp(a),{x:m,y}=e,{width:x,height:T}=t;let S,w,P,M,I,k;return s==="center"?(I=y+T/2,r==="left"?(S=m,w=S-o,M=I+o,k=I-o):(S=m+x,w=S+o,M=I-o,k=I+o),P=S):(r==="left"?w=m+Math.max(l,u)+o:r==="right"?w=m+x-Math.max(c,d)-o:w=this.caretX,s==="top"?(M=y,I=M-o,S=w-o,P=w+o):(M=y+T,I=M+o,S=w+o,P=w-o),k=M),{x1:S,x2:w,x3:P,y1:M,y2:I,y3:k}}drawTitle(e,t,i){const r=this.title,s=r.length;let o,a,l;if(s){const c=$g(i.rtl,this.x,this.width);for(e.x=Ib(this,i.titleAlign,i),t.textAlign=c.textAlign(i.titleAlign),t.textBaseline="middle",o=ns(i.titleFont),a=i.titleSpacing,t.fillStyle=i.titleColor,t.font=o.string,l=0;l<s;++l)t.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=i.titleMarginBottom-a)}}_drawColorBox(e,t,i,r,s){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:l,boxWidth:c}=s,u=ns(s.bodyFont),d=Ib(this,"left",s),m=r.x(d),y=l<u.lineHeight?(u.lineHeight-l)/2:0,x=t.y+y;if(s.usePointStyle){const T={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},S=r.leftForLtr(m,c)+c/2,w=x+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,pC(e,T,S,w),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,pC(e,T,S,w)}else{e.lineWidth=Wn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const T=r.leftForLtr(m,c),S=r.leftForLtr(r.xPlus(m,1),c-2),w=Rp(o.borderRadius);Object.values(w).some(P=>P!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,Yv(e,{x:T,y:x,w:c,h:l,radius:w}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Yv(e,{x:S,y:x+1,w:c-2,h:l-2,radius:w}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(T,x,c,l),e.strokeRect(T,x,c,l),e.fillStyle=o.backgroundColor,e.fillRect(S,x+1,c-2,l-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:r}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=i,d=ns(i.bodyFont);let m=d.lineHeight,y=0;const x=$g(i.rtl,this.x,this.width),T=function(W){t.fillText(W,x.x(e.x+y),e.y+m/2),e.y+=m+s},S=x.textAlign(o);let w,P,M,I,k,D,H;for(t.textAlign=o,t.textBaseline="middle",t.font=d.string,e.x=Ib(this,S,i),t.fillStyle=i.bodyColor,fi(this.beforeBody,T),y=a&&S!=="right"?o==="center"?c/2+u:c+2+u:0,I=0,D=r.length;I<D;++I){for(w=r[I],P=this.labelTextColors[I],t.fillStyle=P,fi(w.before,T),M=w.lines,a&&M.length&&(this._drawColorBox(t,e,I,x,i),m=Math.max(d.lineHeight,l)),k=0,H=M.length;k<H;++k)T(M[k]),m=d.lineHeight;fi(w.after,T)}y=0,m=d.lineHeight,fi(this.afterBody,T),e.y-=s}drawFooter(e,t,i){const r=this.footer,s=r.length;let o,a;if(s){const l=$g(i.rtl,this.x,this.width);for(e.x=Ib(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=l.textAlign(i.footerAlign),t.textBaseline="middle",o=ns(i.footerFont),t.fillStyle=i.footerColor,t.font=o.string,a=0;a<s;++a)t.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+i.footerSpacing}}drawBackground(e,t,i,r){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=i,{topLeft:d,topRight:m,bottomLeft:y,bottomRight:x}=Rp(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(a+d,l),o==="top"&&this.drawCaret(e,t,i,r),t.lineTo(a+c-m,l),t.quadraticCurveTo(a+c,l,a+c,l+m),o==="center"&&s==="right"&&this.drawCaret(e,t,i,r),t.lineTo(a+c,l+u-x),t.quadraticCurveTo(a+c,l+u,a+c-x,l+u),o==="bottom"&&this.drawCaret(e,t,i,r),t.lineTo(a+y,l+u),t.quadraticCurveTo(a,l+u,a,l+u-y),o==="center"&&s==="left"&&this.drawCaret(e,t,i,r),t.lineTo(a,l+d),t.quadraticCurveTo(a,l,a+d,l),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const o=Dy[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=xN(this,e),l=Object.assign({},o,this._size),c=bN(t,e,l),u=wN(e,l,c,t);(r._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=_o(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=i,this.drawBackground(s,e,r,t),b5(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),w5(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!qw(i,r),o=this._positionChanged(r,t);(s||o)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,i),a=this._positionChanged(o,e),l=t||!qw(o,s)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,i,r){const s=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,i);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:i,caretY:r,options:s}=this,o=Dy[s.position].call(this,e,t);return o!==!1&&(i!==o.x||r!==o.y)}}var tH={id:"tooltip",_element:EN,positioners:Dy,afterInit(n,e,t){t&&(n.tooltip=new EN({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:eH},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},yhe=Object.freeze({__proto__:null,Colors:Lue,Decimation:Uue,Filler:Z5,Legend:J5,SubTitle:uhe,Title:Q5,Tooltip:tH});const vhe=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function xhe(n,e,t,i){const r=n.indexOf(e);if(r===-1)return vhe(n,e,t,i);const s=n.lastIndexOf(e);return r!==s?t:r}const bhe=(n,e)=>n===null?null:bs(Math.round(n),0,e);function AN(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class nH extends cm{static id="category";static defaults={ticks:{callback:AN}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:r,label:s}of t)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Bn(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:xhe(i,e,wn(t,e),this._addedLabels),bhe(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=e;o<=t;o++)r.push({value:o});return r}getLabelForValue(e){return AN.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function whe(n,e){const t=[],{bounds:r,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:m}=n,y=s||1,x=u-1,{min:T,max:S}=e,w=!Bn(o),P=!Bn(a),M=!Bn(c),I=(S-T)/(d+1);let k=xL((S-T)/x/y)*y,D,H,W,z;if(k<1e-14&&!w&&!P)return[{value:T},{value:S}];z=Math.ceil(S/k)-Math.floor(T/k),z>x&&(k=xL(z*k/x/y)*y),Bn(l)||(D=Math.pow(10,l),k=Math.ceil(k*D)/D),r==="ticks"?(H=Math.floor(T/k)*k,W=Math.ceil(S/k)*k):(H=T,W=S),w&&P&&s&&hae((a-o)/s,k/1e3)?(z=Math.round(Math.min((a-o)/k,u)),k=(a-o)/z,H=o,W=a):M?(H=w?o:H,W=P?a:W,z=c-1,k=(W-H)/z):(z=(W-H)/k,Ky(z,Math.round(z),k/1e3)?z=Math.round(z):z=Math.ceil(z));const j=Math.max(bL(k),bL(H));D=Math.pow(10,Bn(l)?j:l),H=Math.round(H*D)/D,W=Math.round(W*D)/D;let J=0;for(w&&(m&&H!==o?(t.push({value:o}),H<o&&J++,Ky(Math.round((H+J*k)*D)/D,o,MN(o,I,n))&&J++):H<o&&J++);J<z;++J){const le=Math.round((H+J*k)*D)/D;if(P&&le>a)break;t.push({value:le})}return P&&m&&W!==a?t.length&&Ky(t[t.length-1].value,a,MN(a,I,n))?t[t.length-1].value=a:t.push({value:a}):(!P||W===a)&&t.push({value:W}),t}function MN(n,e,{horizontal:t,minRotation:i}){const r=ac(i),s=(t?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+n).length;return Math.min(e/s,o)}class nS extends cm{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Bn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const o=l=>r=t?r:l,a=l=>s=i?s:l;if(e){const l=iu(r),c=iu(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(r-l)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=whe(r,s);return e.bounds==="ticks"&&r5(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return I0(e,this.chart.options.locale,this.options.ticks.format)}}class iH extends nS{static id="linear";static defaults={ticks:{callback:CT.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=mr(e)?e:0,this.max=mr(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=ac(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Zv=n=>Math.floor(Df(n)),ep=(n,e)=>Math.pow(10,Zv(n)+e);function CN(n){return n/Math.pow(10,Zv(n))===1}function PN(n,e,t){const i=Math.pow(10,t),r=Math.floor(n/i);return Math.ceil(e/i)-r}function She(n,e){const t=e-n;let i=Zv(t);for(;PN(n,e,i)>10;)i++;for(;PN(n,e,i)<10;)i--;return Math.min(i,Zv(n))}function The(n,{min:e,max:t}){e=za(n.min,e);const i=[],r=Zv(e);let s=She(e,t),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=r>s?Math.pow(10,r):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,s)),m=za(n.min,Math.round((l+u+d*Math.pow(10,s))*o)/o);for(;m<t;)i.push({value:m,major:CN(m),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(s++,d=2,o=s>=0?1:o),m=Math.round((l+u+d*Math.pow(10,s))*o)/o;const y=za(n.max,m);return i.push({value:y,major:CN(y),significand:d}),i}class Ehe extends cm{static id="logarithmic";static defaults={ticks:{callback:CT.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=nS.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return mr(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=mr(e)?Math.max(0,e):null,this.max=mr(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!mr(this._userMin)&&(this.min=e===ep(this.min,0)?ep(this.min,-1):ep(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let i=this.min,r=this.max;const s=a=>i=e?i:a,o=a=>r=t?r:a;i===r&&(i<=0?(s(1),o(10)):(s(ep(i,-1)),o(ep(r,1)))),i<=0&&s(ep(r,-1)),r<=0&&o(ep(i,1)),this.min=i,this.max=r}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},i=The(t,this);return e.bounds==="ticks"&&r5(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":I0(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Df(e),this._valueRange=Df(this.max)-Df(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Df(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function xC(n){const e=n.ticks;if(e.display&&n.display){const t=_o(e.backdropPadding);return wn(e.font&&e.font.size,$i.font.size)+t.height}return 0}function Ahe(n,e,t){return t=ji(t)?t:[t],{w:Cae(n,e.string,t),h:t.length*e.lineHeight}}function RN(n,e,t,i,r){return n===i||n===r?{start:e-t/2,end:e+t/2}:n<i||n>r?{start:e-t,end:e}:{start:e,end:e+t}}function Mhe(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],r=[],s=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?Jn/s:0;for(let l=0;l<s;l++){const c=o.setContext(n.getPointLabelContext(l));r[l]=c.padding;const u=n.getPointPosition(l,n.drawingArea+r[l],a),d=ns(c.font),m=Ahe(n.ctx,d,n._pointLabels[l]);i[l]=m;const y=co(n.getIndexAngle(l)+a),x=Math.round(GR(y)),T=RN(x,u.x,m.w,0,180),S=RN(x,u.y,m.h,90,270);Che(t,e,y,T,S)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=Ihe(n,i,r)}function Che(n,e,t,i,r){const s=Math.abs(Math.sin(t)),o=Math.abs(Math.cos(t));let a=0,l=0;i.start<e.l?(a=(e.l-i.start)/s,n.l=Math.min(n.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/s,n.r=Math.max(n.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/o,n.t=Math.min(n.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/o,n.b=Math.max(n.b,e.b+l))}function Phe(n,e,t){const i=n.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=t,l=n.getPointPosition(e,i+r+o,s),c=Math.round(GR(co(l.angle+Cr))),u=Lhe(l.y,a.h,c),d=khe(c),m=Ohe(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:m,top:u,right:m+a.w,bottom:u+a.h}}function Rhe(n,e){if(!e)return!0;const{left:t,top:i,right:r,bottom:s}=n;return!(lh({x:t,y:i},e)||lh({x:t,y:s},e)||lh({x:r,y:i},e)||lh({x:r,y:s},e))}function Ihe(n,e,t){const i=[],r=n._pointLabels.length,s=n.options,{centerPointLabels:o,display:a}=s.pointLabels,l={extra:xC(s)/2,additionalAngle:o?Jn/r:0};let c;for(let u=0;u<r;u++){l.padding=t[u],l.size=e[u];const d=Phe(n,u,l);i.push(d),a==="auto"&&(d.visible=Rhe(d,c),d.visible&&(c=d))}return i}function khe(n){return n===0||n===180?"center":n<180?"left":"right"}function Ohe(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function Lhe(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function Nhe(n,e,t){const{left:i,top:r,right:s,bottom:o}=t,{backdropColor:a}=e;if(!Bn(a)){const l=Rp(e.borderRadius),c=_o(e.backdropPadding);n.fillStyle=a;const u=i-c.left,d=r-c.top,m=s-i+c.width,y=o-r+c.height;Object.values(l).some(x=>x!==0)?(n.beginPath(),Yv(n,{x:u,y:d,w:m,h:y,radius:l}),n.fill()):n.fillRect(u,d,m,y)}}function Dhe(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let r=e-1;r>=0;r--){const s=n._pointLabelItems[r];if(!s.visible)continue;const o=i.setContext(n.getPointLabelContext(r));Nhe(t,o,s);const a=ns(o.font),{x:l,y:c,textAlign:u}=s;Zp(t,n._pointLabels[r],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function rH(n,e,t,i){const{ctx:r}=n;if(t)r.arc(n.xCenter,n.yCenter,e,0,Di);else{let s=n.getPointPosition(0,e);r.moveTo(s.x,s.y);for(let o=1;o<i;o++)s=n.getPointPosition(o,e),r.lineTo(s.x,s.y)}}function Fhe(n,e,t,i,r){const s=n.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!i||!a||!l||t<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),rH(n,t,o,i),s.closePath(),s.stroke(),s.restore())}function Uhe(n,e,t){return dd(n,{label:t,index:e,type:"pointLabel"})}class Bhe extends nS{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:CT.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=_o(xC(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=mr(e)&&!isNaN(e)?e:0,this.max=mr(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/xC(this.options))}generateTickLabels(e){nS.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const r=Ii(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?Mhe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){const t=Di/(this._pointLabels.length||1),i=this.options.startAngle||0;return co(e*t+ac(i))}getDistanceFromCenterForValue(e){if(Bn(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(Bn(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return Uhe(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const r=this.getIndexAngle(e)-Cr+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:r,bottom:s}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),rH(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:r,border:s}=t,o=this._pointLabels.length;let a,l,c;if(t.pointLabels.display&&Dhe(this,o),r.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const m=this.getContext(d),y=r.setContext(m),x=s.setContext(m);Fhe(this,y,l,o,x)}}),i.display){for(e.save(),a=o-1;a>=0;a--){const u=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:m}=u;!m||!d||(e.lineWidth=m,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!t.reverse)return;const c=i.setContext(this.getContext(l)),u=ns(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const d=_o(c.backdropPadding);e.fillRect(-o/2-d.left,-s-u.size/2-d.top,o+d.width,u.size+d.height)}Zp(e,a.label,0,-s,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}const NT={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ha=Object.keys(NT);function IN(n,e){return n-e}function kN(n,e){if(Bn(e))return null;const t=n._adapter,{parser:i,round:r,isoWeekday:s}=n._parseOpts;let o=e;return typeof i=="function"&&(o=i(o)),mr(o)||(o=typeof i=="string"?t.parse(o,i):t.parse(o)),o===null?null:(r&&(o=r==="week"&&(s_(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,r)),+o)}function ON(n,e,t,i){const r=ha.length;for(let s=ha.indexOf(n);s<r-1;++s){const o=NT[ha[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=i)return ha[s]}return ha[r-1]}function zhe(n,e,t,i,r){for(let s=ha.length-1;s>=ha.indexOf(t);s--){const o=ha[s];if(NT[o].common&&n._adapter.diff(r,i,o)>=e-1)return o}return ha[t?ha.indexOf(t):0]}function Vhe(n){for(let e=ha.indexOf(n)+1,t=ha.length;e<t;++e)if(NT[ha[e]].common)return ha[e]}function LN(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:r}=YR(t,e),s=t[i]>=e?t[i]:t[r];n[s]=!0}}function Hhe(n,e,t,i){const r=n._adapter,s=+r.startOf(e[0].value,i),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,i))l=t[a],l>=0&&(e[l].major=!0);return e}function NN(n,e,t){const i=[],r={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,i.push({value:a,major:!1});return s===0||!t?i:Hhe(n,i,r,t)}class bC extends cm{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),r=this._adapter=new Zle._date(e.adapters.date);r.init(t),Zy(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:kN(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=mr(r)&&!isNaN(r)?r:+t.startOf(Date.now(),i),s=mr(s)&&!isNaN(s)?s:+t.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,o=this.max,a=mae(r,s,o);return this._unit=t.unit||(i.autoSkip?ON(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):zhe(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:Vhe(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),NN(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,r,s;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?i=s:i=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=bs(t,0,o),i=bs(i,0,o),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,r=this.options,s=r.time,o=s.unit||ON(s.minUnit,t,i,this._getLabelCapacity(t)),a=wn(r.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=s_(l)||l===!0,u={};let d=t,m,y;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":o),e.diff(i,t,o)>1e5*a)throw new Error(t+" and "+i+" are too far apart with stepSize of "+a+" "+o);const x=r.ticks.source==="data"&&this.getDataTimestamps();for(m=d,y=0;m<i;m=+e.add(m,a,o),y++)LN(u,m,x);return(m===i||r.bounds==="ticks"||y===1)&&LN(u,m,x),Object.keys(u).sort(IN).map(T=>+T)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,s=this._unit,o=t||r[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,i,r){const s=this.options,o=s.ticks.callback;if(o)return Ii(o,[e,t,i],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],m=i[t],y=c&&d&&m&&m.major;return this._adapter.format(e,r||(y?d:u))}generateTickLabels(e){let t,i,r;for(t=0,i=e.length;t<i;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,r=ac(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*o,h:i*o+a*s}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,r=i[t.unit]||i.millisecond,s=this._tickFormatFunction(e,0,NN(this,[e],this._majorUnit),r),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,i=r.length;t<i;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const r=this.getLabels();for(t=0,i=r.length;t<i;++t)e.push(kN(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return a5(e.sort(IN))}}function kb(n,e,t){let i=0,r=n.length-1,s,o,a,l;t?(e>=n[i].pos&&e<=n[r].pos&&({lo:i,hi:r}=ah(n,"pos",e)),{pos:s,time:a}=n[i],{pos:o,time:l}=n[r]):(e>=n[i].time&&e<=n[r].time&&({lo:i,hi:r}=ah(n,"time",e)),{time:s,pos:a}=n[i],{time:o,pos:l}=n[r]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class Whe extends bC{static id="timeseries";static defaults=bC.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=kb(t,this.min),this._tableRange=kb(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,r=[],s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=t&&c<=i&&r.push(c);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(kb(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return kb(this._table,i*this._tableRange+this._minPos,!0)}}var jhe=Object.freeze({__proto__:null,CategoryScale:nH,LinearScale:iH,LogarithmicScale:Ehe,RadialLinearScale:Bhe,TimeScale:bC,TimeSeriesScale:Whe});const $he=[qle,Mue,yhe,jhe],sH="label";function DN(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function Xhe(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function oH(n,e){n.labels=e}function aH(n,e,t=sH){const i=[];n.datasets=e.map(r=>{const s=n.datasets.find(o=>o[t]===r[t]);return!s||!r.data||i.includes(s)?{...r}:(i.push(s),Object.assign(s,r),s)})}function Ghe(n,e=sH){const t={labels:[],datasets:[]};return oH(t,n.labels),aH(t,n.datasets,e),t}function Yhe(n,e){const{height:t=150,width:i=300,redraw:r=!1,datasetIdKey:s,type:o,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:d,...m}=n,y=G.useRef(null),x=G.useRef(null),T=()=>{y.current&&(x.current=new O_(y.current,{type:o,data:Ghe(a,s),options:l&&{...l},plugins:c}),DN(e,x.current))},S=()=>{DN(e,null),x.current&&(x.current.destroy(),x.current=null)};return G.useEffect(()=>{!r&&x.current&&l&&Xhe(x.current,l)},[r,l]),G.useEffect(()=>{!r&&x.current&&oH(x.current.config.data,a.labels)},[r,a.labels]),G.useEffect(()=>{!r&&x.current&&a.datasets&&aH(x.current.config.data,a.datasets,s)},[r,a.datasets]),G.useEffect(()=>{x.current&&(r?(S(),setTimeout(T)):x.current.update(d))},[r,l,a.labels,a.datasets,d]),G.useEffect(()=>{x.current&&(S(),setTimeout(T))},[o]),G.useEffect(()=>(T(),()=>S()),[]),U.jsx("canvas",{ref:y,role:"img",height:t,width:i,...m,children:u})}const qhe=G.forwardRef(Yhe);function Zhe(n,e){return O_.register(e),G.forwardRef((t,i)=>U.jsx(qhe,{...t,ref:i,type:n}))}const FN=Zhe("bar",R5);O_.register(Q5,tH,J5,j5,nH,iH,Z5);function Khe(){const{isAuthenticated:n,isAdmin:e}=Sh(),[t,i]=G.useState({users:{total:0,active:0,admins:0,banned:0},flights:{total_views:0,by_user:[],top_routes:[]}}),[r,s]=G.useState(!0),[o,a]=G.useState(null);G.useEffect(()=>{console.log("Auth status:",n),console.log("Is admin:",e),n&&e&&l()},[n,e]);const l=async()=>{try{s(!0);const[d,m]=await Promise.all([is.get("/admin/metrics"),is.get("/users")]);console.log("Metrics Data:",d),i({users:{total:m.data.total||0,active:m.data.active||0,admins:m.data.admins||0,banned:m.data.banned||0},flights:d.data.flights||{total_views:0,by_user:[],top_routes:[]}}),s(!1)}catch(d){a("Failed to load admin data"),s(!1),console.error("Admin data error:",d)}};if(!n)return U.jsx("div",{className:"auth-message",children:"Please log in to view admin metrics."});if(r)return U.jsx("div",{className:"loading-message",children:"Loading metrics..."});if(o)return U.jsx("div",{className:"error-message",children:o});const c={labels:["Total","Active","Admins","Banned"],datasets:[{label:"Users",data:[t.users.total,t.users.active,t.users.admins,t.users.banned],backgroundColor:["rgba(54, 162, 235, 0.5)","rgba(75, 192, 192, 0.5)","rgba(255, 206, 86, 0.5)","rgba(255, 99, 132, 0.5)"],borderColor:["rgba(54, 162, 235, 1)","rgba(75, 192, 192, 1)","rgba(255, 206, 86, 1)","rgba(255, 99, 132, 1)"],borderWidth:1,fill:!1}]},u={labels:t.flights.top_routes.map(d=>`${d.from_airport_code}  ${d.to_airport_code}`),datasets:[{label:"Flight Views",data:t.flights.top_routes.map(d=>d.views),backgroundColor:"rgba(153, 102, 255, 0.5)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]};return U.jsxs("div",{className:"admin-metrics-container",children:[U.jsx("h1",{children:"Admin Dashboard"}),U.jsxs("div",{className:"summary-cards",children:[U.jsxs("div",{className:"card",children:[U.jsx("h3",{children:"Total Users"}),U.jsx("p",{children:t.users.total})]}),U.jsxs("div",{className:"card",children:[U.jsx("h3",{children:"Active Users"}),U.jsx("p",{children:t.users.active})]}),U.jsxs("div",{className:"card",children:[U.jsx("h3",{children:"Admin Users"}),U.jsx("p",{children:t.users.admins})]}),U.jsxs("div",{className:"card",children:[U.jsx("h3",{children:"Banned Users"}),U.jsx("p",{children:t.users.banned})]})]}),U.jsxs("div",{className:"chart-row",children:[U.jsxs("div",{className:"chart-container",children:[U.jsx("h3",{children:"User Statistics"}),U.jsx(FN,{data:c,options:{responsive:!0,plugins:{legend:{display:!1}}}})]}),U.jsxs("div",{className:"chart-container",children:[U.jsx("h3",{children:"Top Flight Routes"}),U.jsx(FN,{data:u,options:{indexAxis:"y",responsive:!0,plugins:{legend:{display:!1}}}})]})]}),U.jsxs("div",{className:"user-table",children:[U.jsx("h3",{children:"User Flight Activity"}),U.jsxs("table",{children:[U.jsx("thead",{children:U.jsxs("tr",{children:[U.jsx("th",{children:"User"}),U.jsx("th",{children:"Flight Views"})]})}),U.jsx("tbody",{children:t.flights.by_user.map((d,m)=>U.jsxs("tr",{children:[U.jsx("td",{children:d.name||"Anonymous"}),U.jsx("td",{children:d.total_views||0})]},m))})]})]})]})}function Jhe(){const{isAuthenticated:n}=Sh(),[e,t]=G.useState([]),[i,r]=G.useState(!0),[s,o]=G.useState(null);G.useEffect(()=>{n&&a()},[n]);const a=async()=>{try{const l=await is.get("/admin/saved-flights");console.log(l.data),t(l.data.saved_flights),r(!1)}catch(l){o("Failed to load flight views by user"),r(!1),console.error("Error fetching flight views by user:",l)}};return n?i?U.jsx("div",{className:"loading-message",children:"Loading flight views by user..."}):s?U.jsx("div",{className:"error-message",children:s}):U.jsxs("div",{className:"flight-views-container",children:[U.jsx("h3",{children:"Flight Views by User"}),U.jsxs("table",{children:[U.jsx("thead",{children:U.jsxs("tr",{children:[U.jsx("th",{children:"User ID"}),U.jsx("th",{children:"Flight ICAO"}),U.jsx("th",{children:"Flight Data"}),U.jsx("th",{children:"Saved At"})]})}),U.jsx("tbody",{children:e.length>0?e.map((l,c)=>{const u=JSON.parse(l.flight_data);return U.jsxs("tr",{children:[U.jsx("td",{children:l.user_id}),"  ",U.jsx("td",{children:l.flight_icao})," ",U.jsx("td",{children:u.callsign||"N/A"})," ",U.jsx("td",{children:new Date(l.saved_at).toLocaleString()})," "]},c)}):U.jsx("tr",{children:U.jsx("td",{colSpan:"4",children:"No data available"})})})]})]}):U.jsx("div",{className:"auth-message",children:"Please log in to view flight views by user."})}O_.register(...$he);function Qhe(){const{isAuthenticated:n}=Sh(),[e,t]=G.useState([]),[i,r]=G.useState([]),[s,o]=G.useState([]),[a,l]=G.useState([]),[c,u]=G.useState(!0),[d,m]=G.useState(null);bh();const y=ic.useRef(null),x=ic.useRef(null),T=ic.useRef(null),S=ic.useRef(null),w=ic.useRef(null),P=ic.useRef(null);G.useEffect(()=>{M()},[n]);const M=async()=>{try{const[I,k,D]=await Promise.all([is.get("/admin/system/cpu-usage"),is.get("/admin/system/memory-usage"),is.get("/admin/system/disk-usage")]),[H,W,z]=await Promise.all([I.data,k.data,D.data]),j=new Date().toLocaleTimeString();t(J=>[...J.slice(-19),j]),r(J=>[...J.slice(-19),H.cpu_usage]),o(J=>[...J.slice(-19),W.memory_usage]),l(J=>[...J.slice(-19),parseFloat(z.disk_usage)]),u(!1)}catch(I){m("Failed to load system metrics"),u(!1),console.error("Error fetching system metrics:",I)}};return G.useEffect(()=>{const I=(k,D,H,W)=>new O_(k,{type:"line",data:{labels:e,datasets:[{label:D,data:H,borderColor:W,tension:.2,fill:!0,backgroundColor:`${W}33`}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,max:100}}}});y.current&&!S.current&&(S.current=I(y.current,"CPU Usage (%)",i,"#ff6384")),x.current&&!w.current&&(w.current=I(x.current,"Memory Usage (%)",s,"#36a2eb")),T.current&&!P.current&&(P.current=I(T.current,"Disk Usage (%)",a,"#4bc0c0")),S.current&&(S.current.data.labels=e,S.current.data.datasets[0].data=i,S.current.update()),w.current&&(w.current.data.labels=e,w.current.data.datasets[0].data=s,w.current.update()),P.current&&(P.current.data.labels=e,P.current.data.datasets[0].data=a,P.current.update())},[e,i,s,a]),n?c?U.jsx("div",{className:"loading-message",children:"Loading system metrics..."}):d?U.jsx("div",{className:"error-message",children:d}):U.jsxs("div",{className:"system-metrics-dashboard",children:[U.jsx("h3",{children:"System Metrics Dashboard"}),U.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[U.jsxs("div",{className:"bg-white shadow-md rounded-2xl p-4",children:[U.jsx("h4",{className:"text-xl font-semibold mb-2",children:"CPU Usage"}),U.jsx("canvas",{ref:y})]}),U.jsxs("div",{className:"bg-white shadow-md rounded-2xl p-4",children:[U.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Memory Usage"}),U.jsx("canvas",{ref:x})]}),U.jsxs("div",{className:"bg-white shadow-md rounded-2xl p-4",children:[U.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Disk Usage"}),U.jsx("canvas",{ref:T})]})]})]}):U.jsx("div",{className:"auth-message",children:"Please log in to view system metrics."})}function efe(){return U.jsxs("div",{children:[U.jsx("h1",{children:"Admin Dashboard"}),U.jsx(Khe,{}),U.jsx(Jhe,{}),U.jsx(Qhe,{})]})}const UN=({children:n,adminOnly:e=!1})=>{const{isAuthenticated:t,isAdmin:i}=Sh();return console.log("isAuthenticated:",t),console.log("isAdmin:",i),t?e&&!i?U.jsx(KA,{to:"/"}):n:U.jsx(KA,{to:"/login"})},tfe=()=>{const[n,e]=G.useState([]),[t,i]=G.useState(!0),[r,s]=G.useState(null);return G.useEffect(()=>{fetch("https://opensky-network.org/api/states/all",{headers:{Authorization:"Basic "+btoa("an4s3crwt:Mentaybolita1")}}).then(l=>{if(!l.ok)throw new Error("Error al obtener datos de vuelos");return l.json()}).then(l=>{const c=(l.states||[]).filter(u=>u[1]).slice(0,50);e(c)}).catch(l=>s(l.message)).finally(()=>i(!1))},[]),t?U.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-6 bg-white/60 dark:bg-neutral-900/70 backdrop-blur-2xl rounded-3xl shadow-[0_0_40px_-15px_rgba(0,0,0,0.1)] transition-all duration-300 max-w-3xl mx-auto",children:[U.jsxs("div",{className:"relative w-7 h-7",children:[U.jsx("div",{className:"absolute inset-0 border-[1.5px] border-gray-300 dark:border-gray-700 rounded-full"}),U.jsx("div",{className:"absolute inset-0 border-[1.5px] border-gray-800 dark:border-white border-t-transparent rounded-full animate-spin [animation-duration:1.2s]"})]}),U.jsx("p",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400 tracking-wide",children:"Cargando vuelos activos..."})]}):r?U.jsxs("div",{className:"max-w-3xl mx-auto bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 p-6 rounded-3xl shadow-md text-center transition-all duration-300 backdrop-blur-xl",children:[U.jsx("p",{className:"font-medium",children:"Error cargando vuelos"}),U.jsx("p",{className:"text-sm opacity-80 mt-2",children:r})]}):n.length?U.jsxs("div",{className:"bg-white/60 dark:bg-neutral-900/70 backdrop-blur-2xl rounded-3xl shadow-[0_0_40px_-15px_rgba(0,0,0,0.1)] p-10 max-w-4xl mx-auto space-y-6 transition-all duration-300",children:[U.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-100 text-center tracking-tight mb-6",children:"Vuelos Activos"}),U.jsx("ul",{className:"space-y-3",children:n.map((o,a)=>U.jsxs("li",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between border border-gray-100 dark:border-neutral-700 bg-white/90 dark:bg-neutral-800/80 p-4 rounded-2xl shadow-sm hover:shadow-md hover:scale-[1.01] transition-all duration-300 cursor-default",children:[U.jsxs("div",{children:[U.jsx("strong",{className:"text-gray-800 dark:text-gray-100 tracking-tight",children:o[1].trim()}),U.jsx("span",{className:"block sm:inline text-gray-500 dark:text-gray-400 text-sm mt-1 sm:mt-0 sm:ml-2",children:o[2]||"Origen desconocido"})]}),U.jsxs("div",{className:"text-gray-500 dark:text-gray-400 text-sm mt-2 sm:mt-0",children:["Altitud: ",o[7]?`${o[7].toFixed(0)} m`:""]})]},a))}),U.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-t from-transparent via-white/20 dark:via-white/5 to-transparent animate-pulse-slow"})]}):U.jsx("div",{className:"max-w-3xl mx-auto text-center bg-white/60 dark:bg-neutral-900/70 backdrop-blur-2xl rounded-3xl shadow-[0_0_40px_-15px_rgba(0,0,0,0.1)] text-gray-500 dark:text-gray-400 py-12 px-6 transition-all duration-300",children:"No se encontraron vuelos activos"})},lH=G.createContext({});function nfe(n){const e=G.useRef(null);return e.current===null&&(e.current=n()),e.current}const o2=typeof window<"u",ife=o2?G.useLayoutEffect:G.useEffect,a2=G.createContext(null);function l2(n,e){n.indexOf(e)===-1&&n.push(e)}function c2(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const yh=(n,e,t)=>t>e?e:t<n?n:t;let u2=()=>{};const vh={},cH=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function uH(n){return typeof n=="object"&&n!==null}const hH=n=>/^0[^.\s]+$/u.test(n);function h2(n){let e;return()=>(e===void 0&&(e=n()),e)}const ml=n=>n,rfe=(n,e)=>t=>e(n(t)),k0=(...n)=>n.reduce(rfe),Kv=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i};class f2{constructor(){this.subscriptions=[]}add(e){return l2(this.subscriptions,e),()=>c2(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ru=n=>n*1e3,fl=n=>n/1e3;function fH(n,e){return e?n*(1e3/e):0}const dH=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,sfe=1e-7,ofe=12;function afe(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=dH(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>sfe&&++a<ofe);return o}function O0(n,e,t,i){if(n===e&&t===i)return ml;const r=s=>afe(s,0,1,n,t);return s=>s===0||s===1?s:dH(r(s),e,i)}const pH=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,mH=n=>e=>1-n(1-e),gH=O0(.33,1.53,.69,.99),d2=mH(gH),_H=pH(d2),yH=n=>(n*=2)<1?.5*d2(n):.5*(2-Math.pow(2,-10*(n-1))),p2=n=>1-Math.sin(Math.acos(n)),vH=mH(p2),xH=pH(p2),lfe=O0(.42,0,1,1),cfe=O0(0,0,.58,1),bH=O0(.42,0,.58,1),ufe=n=>Array.isArray(n)&&typeof n[0]!="number",wH=n=>Array.isArray(n)&&typeof n[0]=="number",hfe={linear:ml,easeIn:lfe,easeInOut:bH,easeOut:cfe,circIn:p2,circInOut:xH,circOut:vH,backIn:d2,backInOut:_H,backOut:gH,anticipate:yH},ffe=n=>typeof n=="string",BN=n=>{if(wH(n)){u2(n.length===4);const[e,t,i,r]=n;return O0(e,t,i,r)}else if(ffe(n))return hfe[n];return n},Ob=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function dfe(n,e){let t=new Set,i=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){o.has(u)&&(c.schedule(u),n()),u(a)}const c={schedule:(u,d=!1,m=!1)=>{const x=m&&r?t:i;return d&&o.add(u),x.has(u)||x.add(u),u},cancel:u=>{i.delete(u),o.delete(u)},process:u=>{if(a=u,r){s=!0;return}r=!0,[t,i]=[i,t],t.forEach(l),t.clear(),r=!1,s&&(s=!1,c.process(u))}};return c}const pfe=40;function SH(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Ob.reduce((M,I)=>(M[I]=dfe(s),M),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:m,render:y,postRender:x}=o,T=()=>{const M=vh.useManualTiming?r.timestamp:performance.now();t=!1,vh.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(M-r.timestamp,pfe),1)),r.timestamp=M,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),d.process(r),m.process(r),y.process(r),x.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(T))},S=()=>{t=!0,i=!0,r.isProcessing||n(T)};return{schedule:Ob.reduce((M,I)=>{const k=o[I];return M[I]=(D,H=!1,W=!1)=>(t||S(),k.schedule(D,H,W)),M},{}),cancel:M=>{for(let I=0;I<Ob.length;I++)o[Ob[I]].cancel(M)},state:r,steps:o}}const{schedule:Xi,cancel:nd,state:Ws,steps:B1}=SH(typeof requestAnimationFrame<"u"?requestAnimationFrame:ml,!0);let _w;function mfe(){_w=void 0}const fa={now:()=>(_w===void 0&&fa.set(Ws.isProcessing||vh.useManualTiming?Ws.timestamp:performance.now()),_w),set:n=>{_w=n,queueMicrotask(mfe)}},TH=n=>e=>typeof e=="string"&&e.startsWith(n),m2=TH("--"),gfe=TH("var(--"),g2=n=>gfe(n)?_fe.test(n.split("/*")[0].trim()):!1,_fe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,L_={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Jv={...L_,transform:n=>yh(0,1,n)},Lb={...L_,default:1},ev=n=>Math.round(n*1e5)/1e5,_2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function yfe(n){return n==null}const vfe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,y2=(n,e)=>t=>!!(typeof t=="string"&&vfe.test(t)&&t.startsWith(n)||e&&!yfe(t)&&Object.prototype.hasOwnProperty.call(t,e)),EH=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(_2);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},xfe=n=>yh(0,255,n),z1={...L_,transform:n=>Math.round(xfe(n))},xp={test:y2("rgb","red"),parse:EH("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+z1.transform(n)+", "+z1.transform(e)+", "+z1.transform(t)+", "+ev(Jv.transform(i))+")"};function bfe(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const wC={test:y2("#"),parse:bfe,transform:xp.transform},L0=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Ef=L0("deg"),su=L0("%"),dn=L0("px"),wfe=L0("vh"),Sfe=L0("vw"),zN={...su,parse:n=>su.parse(n)/100,transform:n=>su.transform(n*100)},Mg={test:y2("hsl","hue"),parse:EH("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+su.transform(ev(e))+", "+su.transform(ev(t))+", "+ev(Jv.transform(i))+")"},jr={test:n=>xp.test(n)||wC.test(n)||Mg.test(n),parse:n=>xp.test(n)?xp.parse(n):Mg.test(n)?Mg.parse(n):wC.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?xp.transform(n):Mg.transform(n),getAnimatableNone:n=>{const e=jr.parse(n);return e.alpha=0,jr.transform(e)}},Tfe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Efe(n){return isNaN(n)&&typeof n=="string"&&(n.match(_2)?.length||0)+(n.match(Tfe)?.length||0)>0}const AH="number",MH="color",Afe="var",Mfe="var(",VN="${}",Cfe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Qv(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(Cfe,l=>(jr.test(l)?(i.color.push(s),r.push(MH),t.push(jr.parse(l))):l.startsWith(Mfe)?(i.var.push(s),r.push(Afe),t.push(l)):(i.number.push(s),r.push(AH),t.push(parseFloat(l))),++s,VN)).split(VN);return{values:t,split:a,indexes:i,types:r}}function CH(n){return Qv(n).values}function PH(n){const{split:e,types:t}=Qv(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===AH?s+=ev(r[o]):a===MH?s+=jr.transform(r[o]):s+=r[o]}return s}}const Pfe=n=>typeof n=="number"?0:jr.test(n)?jr.getAnimatableNone(n):n;function Rfe(n){const e=CH(n);return PH(n)(e.map(Pfe))}const id={test:Efe,parse:CH,createTransformer:PH,getAnimatableNone:Rfe};function V1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Ife({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;r=V1(l,a,n+1/3),s=V1(l,a,n),o=V1(l,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function iS(n,e){return t=>t>0?e:n}const ir=(n,e,t)=>n+(e-n)*t,H1=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},kfe=[wC,xp,Mg],Ofe=n=>kfe.find(e=>e.test(n));function HN(n){const e=Ofe(n);if(!e)return!1;let t=e.parse(n);return e===Mg&&(t=Ife(t)),t}const WN=(n,e)=>{const t=HN(n),i=HN(e);if(!t||!i)return iS(n,e);const r={...t};return s=>(r.red=H1(t.red,i.red,s),r.green=H1(t.green,i.green,s),r.blue=H1(t.blue,i.blue,s),r.alpha=ir(t.alpha,i.alpha,s),xp.transform(r))},SC=new Set(["none","hidden"]);function Lfe(n,e){return SC.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Nfe(n,e){return t=>ir(n,e,t)}function v2(n){return typeof n=="number"?Nfe:typeof n=="string"?g2(n)?iS:jr.test(n)?WN:Ufe:Array.isArray(n)?RH:typeof n=="object"?jr.test(n)?WN:Dfe:iS}function RH(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>v2(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function Dfe(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=v2(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function Ffe(n,e){const t=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const s=e.types[r],o=n.indexes[s][i[s]],a=n.values[o]??0;t[r]=a,i[s]++}return t}const Ufe=(n,e)=>{const t=id.createTransformer(e),i=Qv(n),r=Qv(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?SC.has(n)&&!r.values.length||SC.has(e)&&!i.values.length?Lfe(n,e):k0(RH(Ffe(i,r),r.values),t):iS(n,e)};function IH(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?ir(n,e,t):v2(n)(n,e)}const Bfe=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>Xi.update(e,t),stop:()=>nd(e),now:()=>Ws.isProcessing?Ws.timestamp:fa.now()}},kH=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=Math.round(n(s/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},rS=2e4;function x2(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<rS;)e+=t,i=n.next(e);return e>=rS?1/0:e}function zfe(n,e=100,t){const i=t({...n,keyframes:[0,e]}),r=Math.min(x2(i),rS);return{type:"keyframes",ease:s=>i.next(r*s).value/e,duration:fl(r)}}const Vfe=5;function OH(n,e,t){const i=Math.max(e-Vfe,0);return fH(t-n(i),e-i)}const hr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},W1=.001;function Hfe({duration:n=hr.duration,bounce:e=hr.bounce,velocity:t=hr.velocity,mass:i=hr.mass}){let r,s,o=1-e;o=yh(hr.minDamping,hr.maxDamping,o),n=yh(hr.minDuration,hr.maxDuration,fl(n)),o<1?(r=c=>{const u=c*o,d=u*n,m=u-t,y=TC(c,o),x=Math.exp(-d);return W1-m/y*x},s=c=>{const d=c*o*n,m=d*t+t,y=Math.pow(o,2)*Math.pow(c,2)*n,x=Math.exp(-d),T=TC(Math.pow(c,2),o);return(-r(c)+W1>0?-1:1)*((m-y)*x)/T}):(r=c=>{const u=Math.exp(-c*n),d=(c-t)*n+1;return-W1+u*d},s=c=>{const u=Math.exp(-c*n),d=(t-c)*(n*n);return u*d});const a=5/n,l=jfe(r,s,a);if(n=ru(n),isNaN(l))return{stiffness:hr.stiffness,damping:hr.damping,duration:n};{const c=Math.pow(l,2)*i;return{stiffness:c,damping:o*2*Math.sqrt(i*c),duration:n}}}const Wfe=12;function jfe(n,e,t){let i=t;for(let r=1;r<Wfe;r++)i=i-n(i)/e(i);return i}function TC(n,e){return n*Math.sqrt(1-e*e)}const $fe=["duration","bounce"],Xfe=["stiffness","damping","mass"];function jN(n,e){return e.some(t=>n[t]!==void 0)}function Gfe(n){let e={velocity:hr.velocity,stiffness:hr.stiffness,damping:hr.damping,mass:hr.mass,isResolvedFromDuration:!1,...n};if(!jN(n,Xfe)&&jN(n,$fe))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*yh(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:hr.mass,stiffness:r,damping:s}}else{const t=Hfe(n);e={...e,...t,mass:hr.mass},e.isResolvedFromDuration=!0}return e}function sS(n=hr.visualDuration,e=hr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:m,isResolvedFromDuration:y}=Gfe({...t,velocity:-fl(t.velocity||0)}),x=m||0,T=c/(2*Math.sqrt(l*u)),S=o-s,w=fl(Math.sqrt(l/u)),P=Math.abs(S)<5;i||(i=P?hr.restSpeed.granular:hr.restSpeed.default),r||(r=P?hr.restDelta.granular:hr.restDelta.default);let M;if(T<1){const k=TC(w,T);M=D=>{const H=Math.exp(-T*w*D);return o-H*((x+T*w*S)/k*Math.sin(k*D)+S*Math.cos(k*D))}}else if(T===1)M=k=>o-Math.exp(-w*k)*(S+(x+w*S)*k);else{const k=w*Math.sqrt(T*T-1);M=D=>{const H=Math.exp(-T*w*D),W=Math.min(k*D,300);return o-H*((x+T*w*S)*Math.sinh(W)+k*S*Math.cosh(W))/k}}const I={calculatedDuration:y&&d||null,next:k=>{const D=M(k);if(y)a.done=k>=d;else{let H=k===0?x:0;T<1&&(H=k===0?ru(x):OH(M,k,D));const W=Math.abs(H)<=i,z=Math.abs(o-D)<=r;a.done=W&&z}return a.value=a.done?o:D,a},toString:()=>{const k=Math.min(x2(I),rS),D=kH(H=>I.next(k*H).value,k,30);return k+"ms "+D},toTransition:()=>{}};return I}sS.applyToOptions=n=>{const e=zfe(n,100,sS);return n.ease=e.ease,n.duration=ru(e.duration),n.type="keyframes",n};function EC({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=n[0],m={done:!1,value:d},y=W=>a!==void 0&&W<a||l!==void 0&&W>l,x=W=>a===void 0?l:l===void 0||Math.abs(a-W)<Math.abs(l-W)?a:l;let T=t*e;const S=d+T,w=o===void 0?S:o(S);w!==S&&(T=w-d);const P=W=>-T*Math.exp(-W/i),M=W=>w+P(W),I=W=>{const z=P(W),j=M(W);m.done=Math.abs(z)<=c,m.value=m.done?w:j};let k,D;const H=W=>{y(m.value)&&(k=W,D=sS({keyframes:[m.value,x(m.value)],velocity:OH(M,W,m.value),damping:r,stiffness:s,restDelta:c,restSpeed:u}))};return H(0),{calculatedDuration:null,next:W=>{let z=!1;return!D&&k===void 0&&(z=!0,I(W),H(W)),k!==void 0&&W>=k?D.next(W-k):(!z&&I(W),m)}}}function Yfe(n,e,t){const i=[],r=t||vh.mix||IH,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const l=Array.isArray(e)?e[o]||ml:e;a=k0(l,a)}i.push(a)}return i}function qfe(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(u2(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Yfe(e,i,r),l=a.length,c=u=>{if(o&&u<n[0])return e[0];let d=0;if(l>1)for(;d<n.length-2&&!(u<n[d+1]);d++);const m=Kv(n[d],n[d+1],u);return a[d](m)};return t?u=>c(yh(n[0],n[s-1],u)):c}function Zfe(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=Kv(0,e,i);n.push(ir(t,1,r))}}function Kfe(n){const e=[0];return Zfe(e,n.length-1),e}function Jfe(n,e){return n.map(t=>t*e)}function Qfe(n,e){return n.map(()=>e||bH).splice(0,n.length-1)}function tv({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=ufe(i)?i.map(BN):BN(i),s={done:!1,value:e[0]},o=Jfe(t&&t.length===e.length?t:Kfe(e),n),a=qfe(o,e,{ease:Array.isArray(r)?r:Qfe(e,r)});return{calculatedDuration:n,next:l=>(s.value=a(l),s.done=l>=n,s)}}const ede=n=>n!==null;function b2(n,{repeat:e,repeatType:t="loop"},i,r=1){const s=n.filter(ede),a=r<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!a||i===void 0?s[a]:i}const tde={decay:EC,inertia:EC,tween:tv,keyframes:tv,spring:sS};function LH(n){typeof n.type=="string"&&(n.type=tde[n.type])}class w2{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const nde=n=>n/100;class S2 extends w2{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==fa.now()&&this.tick(fa.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;LH(e);const{type:t=tv,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=e;let{keyframes:a}=e;const l=t||tv;l!==tv&&typeof a[0]!="number"&&(this.mixKeyframes=k0(nde,IH(a[0],a[1])),a=[0,100]);const c=l({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=x2(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=c}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return i.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:m,repeatDelay:y,type:x,onUpdate:T,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const w=this.currentTime-c*(this.playbackSpeed>=0?1:-1),P=this.playbackSpeed>=0?w<0:w>r;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let M=this.currentTime,I=i;if(d){const W=Math.min(this.currentTime,r)/a;let z=Math.floor(W),j=W%1;!j&&W>=1&&(j=1),j===1&&z--,z=Math.min(z,d+1),!!(z%2)&&(m==="reverse"?(j=1-j,y&&(j-=y/a)):m==="mirror"&&(I=o)),M=yh(0,1,j)*a}const k=P?{done:!1,value:u[0]}:I.next(M);s&&(k.value=s(k.value));let{done:D}=k;!P&&l!==null&&(D=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const H=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&D);return H&&x!==EC&&(k.value=b2(u,this.options,S,this.speed)),T&&T(k.value),H&&this.finish(),k}then(e,t){return this.finished.then(e,t)}get duration(){return fl(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+fl(e)}get time(){return fl(this.currentTime)}set time(e){e=ru(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(fa.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=fl(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=Bfe,startTime:t}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=t??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(fa.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function ide(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const bp=n=>n*180/Math.PI,AC=n=>{const e=bp(Math.atan2(n[1],n[0]));return MC(e)},rde={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:AC,rotateZ:AC,skewX:n=>bp(Math.atan(n[1])),skewY:n=>bp(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},MC=n=>(n=n%360,n<0&&(n+=360),n),$N=AC,XN=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),GN=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),sde={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:XN,scaleY:GN,scale:n=>(XN(n)+GN(n))/2,rotateX:n=>MC(bp(Math.atan2(n[6],n[5]))),rotateY:n=>MC(bp(Math.atan2(-n[2],n[0]))),rotateZ:$N,rotate:$N,skewX:n=>bp(Math.atan(n[4])),skewY:n=>bp(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function CC(n){return n.includes("scale")?1:0}function PC(n,e){if(!n||n==="none")return CC(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(t)i=sde,r=t;else{const a=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=rde,r=a}if(!r)return CC(e);const s=i[e],o=r[1].split(",").map(ade);return typeof s=="function"?s(o):o[s]}const ode=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return PC(t,e)};function ade(n){return parseFloat(n.trim())}const N_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],D_=new Set(N_),YN=n=>n===L_||n===dn,lde=new Set(["x","y","z"]),cde=N_.filter(n=>!lde.has(n));function ude(n){const e=[];return cde.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const kp={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>PC(e,"x"),y:(n,{transform:e})=>PC(e,"y")};kp.translateX=kp.x;kp.translateY=kp.y;const Op=new Set;let RC=!1,IC=!1,kC=!1;function NH(){if(IC){const n=Array.from(Op).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=ude(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{i.getValue(s)?.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}IC=!1,RC=!1,Op.forEach(n=>n.complete(kC)),Op.clear()}function DH(){Op.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(IC=!0)})}function hde(){kC=!0,DH(),NH(),kC=!1}class T2{constructor(e,t,i,r,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Op.add(this),RC||(RC=!0,Xi.read(DH),Xi.resolveKeyframes(NH))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;if(e[0]===null){const s=r?.get(),o=e[e.length-1];if(s!==void 0)e[0]=s;else if(i&&t){const a=i.readValue(t,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),r&&s===void 0&&r.set(e[0])}ide(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Op.delete(this)}cancel(){this.state==="scheduled"&&(Op.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const fde=n=>n.startsWith("--");function dde(n,e,t){fde(e)?n.style.setProperty(e,t):n.style[e]=t}const pde=h2(()=>window.ScrollTimeline!==void 0),mde={};function gde(n,e){const t=h2(n);return()=>mde[e]??t()}const FH=gde(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Fy=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,qN={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Fy([0,.65,.55,1]),circOut:Fy([.55,0,1,.45]),backIn:Fy([.31,.01,.66,-.59]),backOut:Fy([.33,1.53,.69,.99])};function UH(n,e){if(n)return typeof n=="function"?FH()?kH(n,e):"ease-out":wH(n)?Fy(n):Array.isArray(n)?n.map(t=>UH(t,e)||qN.easeOut):qN[n]}function _de(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[e]:t};l&&(u.offset=l);const d=UH(a,r);Array.isArray(d)&&(u.easing=d);const m={delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return c&&(m.pseudoElement=c),n.animate(u,m)}function BH(n){return typeof n=="function"&&"applyToOptions"in n}function yde({type:n,...e}){return BH(n)&&FH()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class vde extends w2{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:i,keyframes:r,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=e,u2(typeof e.type!="string");const c=yde(e);this.animation=_de(t,i,r,c,s),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=b2(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):dde(t,i,u),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return fl(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+fl(e)}get time(){return fl(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ru(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&pde()?(this.animation.timeline=e,ml):t(this)}}const zH={anticipate:yH,backInOut:_H,circInOut:xH};function xde(n){return n in zH}function bde(n){typeof n.ease=="string"&&xde(n.ease)&&(n.ease=zH[n.ease])}const ZN=10;class wde extends vde{constructor(e){bde(e),LH(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:i,onComplete:r,element:s,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new S2({...o,autoplay:!1}),l=ru(this.finishedTime??this.time);t.setWithVelocity(a.sample(l-ZN).value,a.sample(l).value,ZN),a.stop()}}const KN=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(id.test(n)||n==="0")&&!n.startsWith("url("));function Sde(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Tde(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=KN(r,e),a=KN(s,e);return!o||!a?!1:Sde(n)||(t==="spring"||BH(t))&&i}function OC(n){n.duration=0,n.type="keyframes"}const Ede=new Set(["opacity","clipPath","filter","transform"]),Ade=h2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Mde(n){const{motionValue:e,name:t,repeatDelay:i,repeatType:r,damping:s,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return Ade()&&t&&Ede.has(t)&&(t!=="transform"||!c)&&!l&&!i&&r!=="mirror"&&s!==0&&o!=="inertia"}const Cde=40;class Pde extends w2{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:l,motionValue:c,element:u,...d}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=fa.now();const m={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,name:l,motionValue:c,element:u,...d},y=u?.KeyframeResolver||T2;this.keyframeResolver=new y(a,(x,T,S)=>this.onKeyframesResolved(x,T,m,!S),l,c,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,i,r){this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:l,isHandoff:c,onUpdate:u}=i;this.resolvedAt=fa.now(),Tde(e,s,o,a)||((vh.instantAnimations||!l)&&u?.(b2(e,i,t)),e[0]=e[e.length-1],OC(i),i.repeat=0);const m={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Cde?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...i,keyframes:e},y=!c&&Mde(m)?new wde({...m,element:m.motionValue.owner.current}):new S2(m);y.finished.then(()=>this.notifyFinished()).catch(ml),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),hde()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const Rde=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Ide(n){const e=Rde.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function VH(n,e,t=1){const[i,r]=Ide(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return cH(o)?parseFloat(o):o}return g2(r)?VH(r,e,t+1):r}function E2(n,e){return n?.[e]??n?.default??n}const HH=new Set(["width","height","top","left","right","bottom",...N_]),kde={test:n=>n==="auto",parse:n=>n},WH=n=>e=>e.test(n),jH=[L_,dn,su,Ef,Sfe,wfe,kde],JN=n=>jH.find(WH(n));function Ode(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||hH(n):!0}const Lde=new Set(["brightness","contrast","saturate","opacity"]);function Nde(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(_2)||[];if(!i)return n;const r=t.replace(i,"");let s=Lde.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const Dde=/\b([a-z-]*)\(.*?\)/gu,LC={...id,getAnimatableNone:n=>{const e=n.match(Dde);return e?e.map(Nde).join(" "):n}},QN={...L_,transform:Math.round},Fde={rotate:Ef,rotateX:Ef,rotateY:Ef,rotateZ:Ef,scale:Lb,scaleX:Lb,scaleY:Lb,scaleZ:Lb,skew:Ef,skewX:Ef,skewY:Ef,distance:dn,translateX:dn,translateY:dn,translateZ:dn,x:dn,y:dn,z:dn,perspective:dn,transformPerspective:dn,opacity:Jv,originX:zN,originY:zN,originZ:dn},A2={borderWidth:dn,borderTopWidth:dn,borderRightWidth:dn,borderBottomWidth:dn,borderLeftWidth:dn,borderRadius:dn,radius:dn,borderTopLeftRadius:dn,borderTopRightRadius:dn,borderBottomRightRadius:dn,borderBottomLeftRadius:dn,width:dn,maxWidth:dn,height:dn,maxHeight:dn,top:dn,right:dn,bottom:dn,left:dn,padding:dn,paddingTop:dn,paddingRight:dn,paddingBottom:dn,paddingLeft:dn,margin:dn,marginTop:dn,marginRight:dn,marginBottom:dn,marginLeft:dn,backgroundPositionX:dn,backgroundPositionY:dn,...Fde,zIndex:QN,fillOpacity:Jv,strokeOpacity:Jv,numOctaves:QN},Ude={...A2,color:jr,backgroundColor:jr,outlineColor:jr,fill:jr,stroke:jr,borderColor:jr,borderTopColor:jr,borderRightColor:jr,borderBottomColor:jr,borderLeftColor:jr,filter:LC,WebkitFilter:LC},$H=n=>Ude[n];function XH(n,e){let t=$H(n);return t!==LC&&(t=id),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Bde=new Set(["auto","none","0"]);function zde(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!Bde.has(s)&&Qv(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=XH(t,r)}class Vde extends T2{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),g2(c))){const u=VH(c,t.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!HH.has(i)||e.length!==2)return;const[r,s]=e,o=JN(r),a=JN(s);if(o!==a)if(YN(o)&&YN(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else kp[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)(e[r]===null||Ode(e[r]))&&i.push(r);i.length&&zde(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=kp[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=kp[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([a,l])=>{e.getValue(a).set(l)}),this.resolveNoneKeyframes()}}function Hde(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let i=document;const r=t?.[n]??i.querySelectorAll(n);return r?Array.from(r):[]}return Array.from(n)}const GH=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function Wde(n){return uH(n)&&"offsetHeight"in n}const eD=30,jde=n=>!isNaN(parseFloat(n));class $de{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const r=fa.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=fa.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=jde(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new f2);const i=this.events[e].add(t);return e==="change"?()=>{i(),Xi.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=fa.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>eD)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,eD);return fH(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function l_(n,e){return new $de(n,e)}const{schedule:M2}=SH(queueMicrotask,!1),tc={x:!1,y:!1};function YH(){return tc.x||tc.y}function Xde(n){return n==="x"||n==="y"?tc[n]?null:(tc[n]=!0,()=>{tc[n]=!1}):tc.x||tc.y?null:(tc.x=tc.y=!0,()=>{tc.x=tc.y=!1})}function qH(n,e){const t=Hde(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function tD(n){return!(n.pointerType==="touch"||YH())}function Gde(n,e,t={}){const[i,r,s]=qH(n,t),o=a=>{if(!tD(a))return;const{target:l}=a,c=e(l,a);if(typeof c!="function"||!l)return;const u=d=>{tD(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,r)};return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const ZH=(n,e)=>e?n===e?!0:ZH(n,e.parentElement):!1,C2=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Yde=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function qde(n){return Yde.has(n.tagName)||n.tabIndex!==-1}const yw=new WeakSet;function nD(n){return e=>{e.key==="Enter"&&n(e)}}function j1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Zde=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=nD(()=>{if(yw.has(t))return;j1(t,"down");const r=nD(()=>{j1(t,"up")}),s=()=>j1(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function iD(n){return C2(n)&&!YH()}function Kde(n,e,t={}){const[i,r,s]=qH(n,t),o=a=>{const l=a.currentTarget;if(!iD(a))return;yw.add(l);const c=e(l,a),u=(y,x)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",m),yw.has(l)&&yw.delete(l),iD(y)&&typeof c=="function"&&c(y,{success:x})},d=y=>{u(y,l===window||l===document||t.useGlobalTarget||ZH(l,y.target))},m=y=>{u(y,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),Wde(a)&&(a.addEventListener("focus",c=>Zde(c,r)),!qde(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function KH(n){return uH(n)&&"ownerSVGElement"in n}function Jde(n){return KH(n)&&n.tagName==="svg"}const mo=n=>!!(n&&n.getVelocity),Qde=[...jH,jr,id],epe=n=>Qde.find(WH(n)),JH=G.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function tpe(n=!0){const e=G.useContext(a2);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=G.useId();G.useEffect(()=>{if(n)return r(s)},[n]);const o=G.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const QH=G.createContext({strict:!1}),rD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},c_={};for(const n in rD)c_[n]={isEnabled:e=>rD[n].some(t=>!!e[t])};function npe(n){for(const e in n)c_[e]={...c_[e],...n[e]}}const ipe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function oS(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||ipe.has(n)}let e8=n=>!oS(n);function rpe(n){typeof n=="function"&&(e8=e=>e.startsWith("on")?!oS(e):n(e))}try{rpe(require("@emotion/is-prop-valid").default)}catch{}function spe(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(e8(r)||t===!0&&oS(r)||!e&&!oS(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}const DT=G.createContext({});function FT(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function e0(n){return typeof n=="string"||Array.isArray(n)}const P2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],R2=["initial",...P2];function UT(n){return FT(n.animate)||R2.some(e=>e0(n[e]))}function t8(n){return!!(UT(n)||n.variants)}function ope(n,e){if(UT(n)){const{initial:t,animate:i}=n;return{initial:t===!1||e0(t)?t:void 0,animate:e0(i)?i:void 0}}return n.inherit!==!1?e:{}}function ape(n){const{initial:e,animate:t}=ope(n,G.useContext(DT));return G.useMemo(()=>({initial:e,animate:t}),[sD(e),sD(t)])}function sD(n){return Array.isArray(n)?n.join(" "):n}const t0={};function lpe(n){for(const e in n)t0[e]=n[e],m2(e)&&(t0[e].isCSSVariable=!0)}function n8(n,{layout:e,layoutId:t}){return D_.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!t0[n]||n==="opacity")}const cpe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},upe=N_.length;function hpe(n,e,t){let i="",r=!0;for(let s=0;s<upe;s++){const o=N_[s],a=n[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||t){const c=GH(a,A2[o]);if(!l){r=!1;const u=cpe[o]||o;i+=`${u}(${c}) `}t&&(e[o]=c)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function I2(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const l in e){const c=e[l];if(D_.has(l)){o=!0;continue}else if(m2(l)){r[l]=c;continue}else{const u=GH(c,A2[l]);l.startsWith("origin")?(a=!0,s[l]=u):i[l]=u}}if(e.transform||(o||t?i.transform=hpe(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;i.transformOrigin=`${l} ${c} ${u}`}}const k2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function i8(n,e,t){for(const i in e)!mo(e[i])&&!n8(i,t)&&(n[i]=e[i])}function fpe({transformTemplate:n},e){return G.useMemo(()=>{const t=k2();return I2(t,e,n),Object.assign({},t.vars,t.style)},[e])}function dpe(n,e){const t=n.style||{},i={};return i8(i,t,n),Object.assign(i,fpe(n,e)),i}function ppe(n,e){const t={},i=dpe(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}const mpe={offset:"stroke-dashoffset",array:"stroke-dasharray"},gpe={offset:"strokeDashoffset",array:"strokeDasharray"};function _pe(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?mpe:gpe;n[s.offset]=dn.transform(-i);const o=dn.transform(e),a=dn.transform(t);n[s.array]=`${o} ${a}`}function r8(n,{attrX:e,attrY:t,attrScale:i,pathLength:r,pathSpacing:s=1,pathOffset:o=0,...a},l,c,u){if(I2(n,a,c),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:d,style:m}=n;d.transform&&(m.transform=d.transform,delete d.transform),(m.transform||d.transformOrigin)&&(m.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),m.transform&&(m.transformBox=u?.transformBox??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),t!==void 0&&(d.y=t),i!==void 0&&(d.scale=i),r!==void 0&&_pe(d,r,s,o,!1)}const s8=()=>({...k2(),attrs:{}}),o8=n=>typeof n=="string"&&n.toLowerCase()==="svg";function ype(n,e,t,i){const r=G.useMemo(()=>{const s=s8();return r8(s,e,o8(i),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};i8(s,n.style,n),r.style={...s,...r.style}}return r}const vpe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function O2(n){return typeof n!="string"||n.includes("-")?!1:!!(vpe.indexOf(n)>-1||/[A-Z]/u.test(n))}function xpe(n,e,t,{latestValues:i},r,s=!1){const a=(O2(n)?ype:ppe)(e,i,r,n),l=spe(e,typeof n=="string",s),c=n!==G.Fragment?{...l,...a,ref:t}:{},{children:u}=e,d=G.useMemo(()=>mo(u)?u.get():u,[u]);return G.createElement(n,{...c,children:d})}function oD(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function L2(n,e,t,i){if(typeof e=="function"){const[r,s]=oD(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=oD(i);e=e(t!==void 0?t:n.custom,r,s)}return e}function vw(n){return mo(n)?n.get():n}function bpe({scrapeMotionValuesFromProps:n,createRenderState:e},t,i,r){return{latestValues:wpe(t,i,r,n),renderState:e()}}function wpe(n,e,t,i){const r={},s=i(n,{});for(const m in s)r[m]=vw(s[m]);let{initial:o,animate:a}=n;const l=UT(n),c=t8(n);e&&c&&!l&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=t?t.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!FT(d)){const m=Array.isArray(d)?d:[d];for(let y=0;y<m.length;y++){const x=L2(n,m[y]);if(x){const{transitionEnd:T,transition:S,...w}=x;for(const P in w){let M=w[P];if(Array.isArray(M)){const I=u?M.length-1:0;M=M[I]}M!==null&&(r[P]=M)}for(const P in T)r[P]=T[P]}}}return r}const a8=n=>(e,t)=>{const i=G.useContext(DT),r=G.useContext(a2),s=()=>bpe(n,e,i,r);return t?s():nfe(s)};function N2(n,e,t){const{style:i}=n,r={};for(const s in i)(mo(i[s])||e.style&&mo(e.style[s])||n8(s,n)||t?.getValue(s)?.liveStyle!==void 0)&&(r[s]=i[s]);return r}const Spe=a8({scrapeMotionValuesFromProps:N2,createRenderState:k2});function l8(n,e,t){const i=N2(n,e,t);for(const r in n)if(mo(n[r])||mo(e[r])){const s=N_.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}const Tpe=a8({scrapeMotionValuesFromProps:l8,createRenderState:s8}),Epe=Symbol.for("motionComponentSymbol");function Cg(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Ape(n,e,t){return G.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Cg(t)&&(t.current=i))},[e])}const D2=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Mpe="framerAppearId",c8="data-"+D2(Mpe),u8=G.createContext({});function Cpe(n,e,t,i,r){const{visualElement:s}=G.useContext(DT),o=G.useContext(QH),a=G.useContext(a2),l=G.useContext(JH).reducedMotion,c=G.useRef(null);i=i||o.renderer,!c.current&&i&&(c.current=i(n,{visualState:e,parent:s,props:t,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=G.useContext(u8);u&&!u.projection&&r&&(u.type==="html"||u.type==="svg")&&Ppe(c.current,t,r,d);const m=G.useRef(!1);G.useInsertionEffect(()=>{u&&m.current&&u.update(t,a)});const y=t[c8],x=G.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return ife(()=>{u&&(m.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),x.current&&u.animationState&&u.animationState.animateChanges())}),G.useEffect(()=>{u&&(!x.current&&u.animationState&&u.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),x.current=!1),u.enteringChildren=void 0)}),u}function Ppe(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:h8(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Cg(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:l,layoutRoot:c})}function h8(n){if(n)return n.options.allowProjection!==!1?n.projection:h8(n.parent)}function $1(n,{forwardMotionProps:e=!1}={},t,i){t&&npe(t);const r=O2(n)?Tpe:Spe;function s(a,l){let c;const u={...G.useContext(JH),...a,layoutId:Rpe(a)},{isStatic:d}=u,m=ape(a),y=r(a,d);if(!d&&o2){Ipe();const x=kpe(u);c=x.MeasureLayout,m.visualElement=Cpe(n,y,u,i,x.ProjectionNode)}return U.jsxs(DT.Provider,{value:m,children:[c&&m.visualElement?U.jsx(c,{visualElement:m.visualElement,...u}):null,xpe(n,a,Ape(y,m.visualElement,l),y,d,e)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=G.forwardRef(s);return o[Epe]=n,o}function Rpe({layoutId:n}){const e=G.useContext(lH).id;return e&&n!==void 0?e+"-"+n:n}function Ipe(n,e){G.useContext(QH).strict}function kpe(n){const{drag:e,layout:t}=c_;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function Ope(n,e){if(typeof Proxy>"u")return $1;const t=new Map,i=(s,o)=>$1(s,o,n,e),r=(s,o)=>i(s,o);return new Proxy(r,{get:(s,o)=>o==="create"?i:(t.has(o)||t.set(o,$1(o,void 0,n,e)),t.get(o))})}function f8({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function Lpe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Npe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function X1(n){return n===void 0||n===1}function NC({scale:n,scaleX:e,scaleY:t}){return!X1(n)||!X1(e)||!X1(t)}function fp(n){return NC(n)||d8(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function d8(n){return aD(n.x)||aD(n.y)}function aD(n){return n&&n!=="0%"}function aS(n,e,t){const i=n-t,r=e*i;return t+r}function lD(n,e,t,i,r){return r!==void 0&&(n=aS(n,r,i)),aS(n,t,i)+e}function DC(n,e=0,t=1,i,r){n.min=lD(n.min,e,t,i,r),n.max=lD(n.max,e,t,i,r)}function p8(n,{x:e,y:t}){DC(n.x,e.translate,e.scale,e.originPoint),DC(n.y,t.translate,t.scale,t.originPoint)}const cD=.999999999999,uD=1.0000000000001;function Dpe(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Rg(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,p8(n,o)),i&&fp(s.latestValues)&&Rg(n,s.latestValues))}e.x<uD&&e.x>cD&&(e.x=1),e.y<uD&&e.y>cD&&(e.y=1)}function Pg(n,e){n.min=n.min+e,n.max=n.max+e}function hD(n,e,t,i,r=.5){const s=ir(n.min,n.max,r);DC(n,e,t,s,i)}function Rg(n,e){hD(n.x,e.x,e.scaleX,e.scale,e.originX),hD(n.y,e.y,e.scaleY,e.scale,e.originY)}function m8(n,e){return f8(Npe(n.getBoundingClientRect(),e))}function Fpe(n,e,t){const i=m8(n,t),{scroll:r}=e;return r&&(Pg(i.x,r.offset.x),Pg(i.y,r.offset.y)),i}const fD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ig=()=>({x:fD(),y:fD()}),dD=()=>({min:0,max:0}),Er=()=>({x:dD(),y:dD()}),FC={current:null},g8={current:!1};function Upe(){if(g8.current=!0,!!o2)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>FC.current=n.matches;n.addEventListener("change",e),e()}else FC.current=!1}const Bpe=new WeakMap;function zpe(n,e,t){for(const i in e){const r=e[i],s=t[i];if(mo(r))n.addValue(i,r);else if(mo(s))n.addValue(i,l_(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,l_(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const pD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Vpe{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=T2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=fa.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Xi.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=UT(t),this.isVariantNode=t8(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in d){const y=d[m];l[m]!==void 0&&mo(y)&&y.set(l[m])}}mount(e){this.current=e,Bpe.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),g8.current||Upe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:FC.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),nd(this.notifyUpdate),nd(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=D_.has(e);i&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Xi.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in c_){const t=c_[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Er()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<pD.length;i++){const r=pD[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=zpe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=l_(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(cH(i)||hH(i))?i=parseFloat(i):!epe(i)&&id.test(t)&&(i=XH(e,t)),this.setBaseTarget(e,mo(i)?i.get():i)),mo(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let i;if(typeof t=="string"||typeof t=="object"){const s=L2(this.props,t,this.presenceContext?.custom);s&&(i=s[e])}if(t&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!mo(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new f2),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){M2.render(this.render)}}class _8 extends Vpe{constructor(){super(...arguments),this.KeyframeResolver=Vde}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;mo(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function y8(n,{style:e,vars:t},i,r){const s=n.style;let o;for(o in e)s[o]=e[o];r?.applyProjectionStyles(s,i);for(o in t)s.setProperty(o,t[o])}function Hpe(n){return window.getComputedStyle(n)}class Wpe extends _8{constructor(){super(...arguments),this.type="html",this.renderInstance=y8}readValueFromInstance(e,t){if(D_.has(t))return this.projection?.isProjecting?CC(t):ode(e,t);{const i=Hpe(e),r=(m2(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return m8(e,t)}build(e,t,i){I2(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return N2(e,t,i)}}const v8=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jpe(n,e,t,i){y8(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(v8.has(r)?r:D2(r),e.attrs[r])}class $pe extends _8{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Er}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(D_.has(t)){const i=$H(t);return i&&i.default||0}return t=v8.has(t)?t:D2(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return l8(e,t,i)}build(e,t,i){r8(e,t,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,t,i,r){jpe(e,t,i,r)}mount(e){this.isSVGTag=o8(e.tagName),super.mount(e)}}const Xpe=(n,e)=>O2(n)?new $pe(e):new Wpe(e,{allowProjection:n!==G.Fragment});function Xg(n,e,t){const i=n.getProps();return L2(i,e,t!==void 0?t:i.custom,n)}const UC=n=>Array.isArray(n);function Gpe(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,l_(t))}function Ype(n){return UC(n)?n[n.length-1]||0:n}function qpe(n,e){const t=Xg(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=Ype(s[o]);Gpe(n,o,a)}}function Zpe(n){return!!(mo(n)&&n.add)}function BC(n,e){const t=n.getValue("willChange");if(Zpe(t))return t.add(e);if(!t&&vh.WillChange){const i=new vh.WillChange("auto");n.addValue("willChange",i),i.add(e)}}function x8(n){return n.props[c8]}const Kpe=n=>n!==null;function Jpe(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(Kpe),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return r[s]}const Qpe={type:"spring",stiffness:500,damping:25,restSpeed:10},eme=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),tme={type:"keyframes",duration:.8},nme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ime=(n,{keyframes:e})=>e.length>2?tme:D_.has(n)?n.startsWith("scale")?eme(e[1]):Qpe:nme;function rme({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const F2=(n,e,t,i={},r,s)=>o=>{const a=E2(i,n)||{},l=a.delay||i.delay||0;let{elapsed:c=0}=i;c=c-ru(l);const u={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};rme(a)||Object.assign(u,ime(n,u)),u.duration&&(u.duration=ru(u.duration)),u.repeatDelay&&(u.repeatDelay=ru(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(OC(u),u.delay===0&&(d=!0)),(vh.instantAnimations||vh.skipAnimations)&&(d=!0,OC(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&e.get()!==void 0){const m=Jpe(u.keyframes,a);if(m!==void 0){Xi.update(()=>{u.onUpdate(m),u.onComplete()});return}}return a.isSync?new S2(u):new Pde(u)};function sme({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function b8(n,e,{delay:t=0,transitionOverride:i,type:r}={}){let{transition:s=n.getDefaultTransition(),transitionEnd:o,...a}=e;i&&(s=i);const l=[],c=r&&n.animationState&&n.animationState.getState()[r];for(const u in a){const d=n.getValue(u,n.latestValues[u]??null),m=a[u];if(m===void 0||c&&sme(c,u))continue;const y={delay:t,...E2(s||{},u)},x=d.get();if(x!==void 0&&!d.isAnimating&&!Array.isArray(m)&&m===x&&!y.velocity)continue;let T=!1;if(window.MotionHandoffAnimation){const w=x8(n);if(w){const P=window.MotionHandoffAnimation(w,u,Xi);P!==null&&(y.startTime=P,T=!0)}}BC(n,u),d.start(F2(u,d,m,n.shouldReduceMotion&&HH.has(u)?{type:!1}:y,n,T));const S=d.animation;S&&l.push(S)}return o&&Promise.all(l).then(()=>{Xi.update(()=>{o&&qpe(n,o)})}),l}function w8(n,e,t,i=0,r=1){const s=Array.from(n).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),o=n.size,a=(o-1)*i;return typeof t=="function"?t(s,o):r===1?s*i:a-s*i}function zC(n,e,t={}){const i=Xg(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:r=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(r=t.transitionOverride);const s=i?()=>Promise.all(b8(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:d}=r;return ome(n,e,l,c,u,d,t)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>c())}else return Promise.all([s(),o(t.delay)])}function ome(n,e,t=0,i=0,r=0,s=1,o){const a=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),a.push(zC(l,e,{...o,delay:t+(typeof i=="function"?0:i)+w8(n.variantChildren,l,i,r,s)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function ame(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>zC(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=zC(n,e,t);else{const r=typeof e=="function"?Xg(n,e,t.custom):e;i=Promise.all(b8(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}function S8(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}const lme=R2.length;function T8(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?T8(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<lme;t++){const i=R2[t],r=n.props[i];(e0(r)||r===!1)&&(e[i]=r)}return e}const cme=[...P2].reverse(),ume=P2.length;function hme(n){return e=>Promise.all(e.map(({animation:t,options:i})=>ame(n,t,i)))}function fme(n){let e=hme(n),t=mD(),i=!0;const r=l=>(c,u)=>{const d=Xg(n,u,l==="exit"?n.presenceContext?.custom:void 0);if(d){const{transition:m,transitionEnd:y,...x}=d;c={...c,...x,...y}}return c};function s(l){e=l(n)}function o(l){const{props:c}=n,u=T8(n.parent)||{},d=[],m=new Set;let y={},x=1/0;for(let S=0;S<ume;S++){const w=cme[S],P=t[w],M=c[w]!==void 0?c[w]:u[w],I=e0(M),k=w===l?P.isActive:null;k===!1&&(x=S);let D=M===u[w]&&M!==c[w]&&I;if(D&&i&&n.manuallyAnimateOnMount&&(D=!1),P.protectedKeys={...y},!P.isActive&&k===null||!M&&!P.prevProp||FT(M)||typeof M=="boolean")continue;const H=dme(P.prevProp,M);let W=H||w===l&&P.isActive&&!D&&I||S>x&&I,z=!1;const j=Array.isArray(M)?M:[M];let J=j.reduce(r(w),{});k===!1&&(J={});const{prevResolvedValues:le={}}=P,ge={...le,...J},te=me=>{W=!0,m.has(me)&&(z=!0,m.delete(me)),P.needsAnimating[me]=!0;const q=n.getValue(me);q&&(q.liveStyle=!1)};for(const me in ge){const q=J[me],ie=le[me];if(y.hasOwnProperty(me))continue;let X=!1;UC(q)&&UC(ie)?X=!S8(q,ie):X=q!==ie,X?q!=null?te(me):m.add(me):q!==void 0&&m.has(me)?te(me):P.protectedKeys[me]=!0}P.prevProp=M,P.prevResolvedValues=J,P.isActive&&(y={...y,...J}),i&&n.blockInitialAnimation&&(W=!1);const de=D&&H;W&&(!de||z)&&d.push(...j.map(me=>{const q={type:w};if(typeof me=="string"&&i&&!de&&n.manuallyAnimateOnMount&&n.parent){const{parent:ie}=n,X=Xg(ie,me);if(ie.enteringChildren&&X){const{delayChildren:Y}=X.transition||{};q.delay=w8(ie.enteringChildren,n,Y)}}return{animation:me,options:q}}))}if(m.size){const S={};if(typeof c.initial!="boolean"){const w=Xg(n,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(S.transition=w.transition)}m.forEach(w=>{const P=n.getBaseTarget(w),M=n.getValue(w);M&&(M.liveStyle=!0),S[w]=P??null}),d.push({animation:S})}let T=!!d.length;return i&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(T=!1),i=!1,T?e(d):Promise.resolve()}function a(l,c){if(t[l].isActive===c)return Promise.resolve();n.variantChildren?.forEach(d=>d.animationState?.setActive(l,c)),t[l].isActive=c;const u=o(l);for(const d in t)t[d].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=mD()}}}function dme(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!S8(e,n):!1}function tp(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function mD(){return{animate:tp(!0),whileInView:tp(),whileHover:tp(),whileTap:tp(),whileDrag:tp(),whileFocus:tp(),exit:tp()}}class md{constructor(e){this.isMounted=!1,this.node=e}update(){}}class pme extends md{constructor(e){super(e),e.animationState||(e.animationState=fme(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();FT(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let mme=0;class gme extends md{constructor(){super(...arguments),this.id=mme++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const _me={animation:{Feature:pme},exit:{Feature:gme}};function n0(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function N0(n){return{point:{x:n.pageX,y:n.pageY}}}const yme=n=>e=>C2(e)&&n(e,N0(e));function nv(n,e,t,i){return n0(n,e,yme(t),i)}const E8=1e-4,vme=1-E8,xme=1+E8,A8=.01,bme=0-A8,wme=0+A8;function Fo(n){return n.max-n.min}function Sme(n,e,t){return Math.abs(n-e)<=t}function gD(n,e,t,i=.5){n.origin=i,n.originPoint=ir(e.min,e.max,n.origin),n.scale=Fo(t)/Fo(e),n.translate=ir(t.min,t.max,n.origin)-n.originPoint,(n.scale>=vme&&n.scale<=xme||isNaN(n.scale))&&(n.scale=1),(n.translate>=bme&&n.translate<=wme||isNaN(n.translate))&&(n.translate=0)}function iv(n,e,t,i){gD(n.x,e.x,t.x,i?i.originX:void 0),gD(n.y,e.y,t.y,i?i.originY:void 0)}function _D(n,e,t){n.min=t.min+e.min,n.max=n.min+Fo(e)}function Tme(n,e,t){_D(n.x,e.x,t.x),_D(n.y,e.y,t.y)}function yD(n,e,t){n.min=e.min-t.min,n.max=n.min+Fo(e)}function rv(n,e,t){yD(n.x,e.x,t.x),yD(n.y,e.y,t.y)}function hl(n){return[n("x"),n("y")]}const M8=({current:n})=>n?n.ownerDocument.defaultView:null,vD=(n,e)=>Math.abs(n-e);function Eme(n,e){const t=vD(n.x,e.x),i=vD(n.y,e.y);return Math.sqrt(t**2+i**2)}class C8{constructor(e,t,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Y1(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=Eme(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!x)return;const{point:T}=m,{timestamp:S}=Ws;this.history.push({...T,timestamp:S});const{onStart:w,onMove:P}=this.handlers;y||(w&&w(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=G1(y,this.transformPagePoint),Xi.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:x,onSessionEnd:T,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Y1(m.type==="pointercancel"?this.lastMoveEventInfo:G1(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(m,w),T&&T(m,w)},!C2(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const a=N0(e),l=G1(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=Ws;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=t;d&&d(e,Y1(l,this.history)),this.removeListeners=k0(nv(this.contextWindow,"pointermove",this.handlePointerMove),nv(this.contextWindow,"pointerup",this.handlePointerUp),nv(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),nd(this.updatePoint)}}function G1(n,e){return e?{point:e(n.point)}:n}function xD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Y1({point:n},e){return{point:n,delta:xD(n,P8(e)),offset:xD(n,Ame(e)),velocity:Mme(e,.1)}}function Ame(n){return n[0]}function P8(n){return n[n.length-1]}function Mme(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=P8(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>ru(e)));)t--;if(!i)return{x:0,y:0};const s=fl(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Cme(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?ir(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?ir(t,n,i.max):Math.min(n,t)),n}function bD(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Pme(n,{top:e,left:t,bottom:i,right:r}){return{x:bD(n.x,t,r),y:bD(n.y,e,i)}}function wD(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function Rme(n,e){return{x:wD(n.x,e.x),y:wD(n.y,e.y)}}function Ime(n,e){let t=.5;const i=Fo(n),r=Fo(e);return r>i?t=Kv(e.min,e.max-i,n.min):i>r&&(t=Kv(n.min,n.max-r,e.min)),yh(0,1,t)}function kme(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const VC=.35;function Ome(n=VC){return n===!1?n=0:n===!0&&(n=VC),{x:SD(n,"left","right"),y:SD(n,"top","bottom")}}function SD(n,e,t){return{min:TD(n,e),max:TD(n,t)}}function TD(n,e){return typeof n=="number"?n:n[e]||0}const Lme=new WeakMap;class Nme{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Er(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(N0(d).point)},o=(d,m)=>{const{drag:y,dragPropagation:x,onDragStart:T}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Xde(y),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),hl(w=>{let P=this.getAxisMotionValue(w).get()||0;if(su.test(P)){const{projection:M}=this.visualElement;if(M&&M.layout){const I=M.layout.layoutBox[w];I&&(P=Fo(I)*(parseFloat(P)/100))}}this.originPoint[w]=P}),T&&Xi.postRender(()=>T(d,m)),BC(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},a=(d,m)=>{this.latestPointerEvent=d,this.latestPanInfo=m;const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:T,onDrag:S}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:w}=m;if(x&&this.currentDirection===null){this.currentDirection=Dme(w),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",m.point,w),this.updateAxis("y",m.point,w),this.visualElement.render(),S&&S(d,m)},l=(d,m)=>{this.latestPointerEvent=d,this.latestPanInfo=m,this.stop(d,m),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>hl(d=>this.getAnimationState(d)==="paused"&&this.getAxisMotionValue(d).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new C8(e,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:M8(this.visualElement)})}stop(e,t){const i=e||this.latestPointerEvent,r=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&Xi.postRender(()=>a(i,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Nb(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=Cme(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;e&&Cg(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=Pme(i.layoutBox,e):this.constraints=!1,this.elastic=Ome(t),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&hl(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=kme(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Cg(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Fpe(i,r.root,this.visualElement.getTransformPagePoint());let o=Rme(r.layout.layoutBox,s);if(t){const a=t(Lpe(o));this.hasMutatedConstraints=!!a,a&&(o=f8(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=hl(u=>{if(!Nb(u,t,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const m=r?200:1e6,y=r?40:1e7,x={type:"inertia",velocity:i?e[u]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,x)});return Promise.all(c).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return BC(this.visualElement,e),i.start(F2(e,i,0,t,this.visualElement,!1))}stopAnimation(){hl(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){hl(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){hl(t=>{const{drag:i}=this.getProps();if(!Nb(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-ir(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Cg(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};hl(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=Ime({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),hl(o=>{if(!Nb(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(ir(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;Lme.set(this.visualElement,this);const e=this.visualElement.current,t=nv(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Cg(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Xi.read(i);const o=n0(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(hl(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=VC,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Nb(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Dme(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Fme extends md{constructor(e){super(e),this.removeGroupControls=ml,this.removeListeners=ml,this.controls=new Nme(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ml}unmount(){this.removeGroupControls(),this.removeListeners()}}const ED=n=>(e,t)=>{n&&Xi.postRender(()=>n(e,t))};class Ume extends md{constructor(){super(...arguments),this.removePointerDownListener=ml}onPointerDown(e){this.session=new C8(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:M8(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:ED(e),onStart:ED(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Xi.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=nv(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const xw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function AD(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const xy={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(dn.test(n))n=parseFloat(n);else return n;const t=AD(n,e.target.x),i=AD(n,e.target.y);return`${t}% ${i}%`}},Bme={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=id.parse(n);if(r.length>5)return i;const s=id.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,l=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=ir(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),s(r)}};let q1=!1;class zme extends G.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;lpe(Vme),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),q1&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),xw.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,{projection:o}=i;return o&&(o.isPresent=s,q1=!0,r||e.layoutDependency!==t||t===void 0||e.isPresent!==s?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Xi.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),M2.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;q1=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function R8(n){const[e,t]=tpe(),i=G.useContext(lH);return U.jsx(zme,{...n,layoutGroup:i,switchLayoutGroup:G.useContext(u8),isPresent:e,safeToRemove:t})}const Vme={borderRadius:{...xy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:xy,borderTopRightRadius:xy,borderBottomLeftRadius:xy,borderBottomRightRadius:xy,boxShadow:Bme};function Hme(n,e,t){const i=mo(n)?n:l_(n);return i.start(F2("",i,e,t)),i.animation}const Wme=(n,e)=>n.depth-e.depth;class jme{constructor(){this.children=[],this.isDirty=!1}add(e){l2(this.children,e),this.isDirty=!0}remove(e){c2(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Wme),this.isDirty=!1,this.children.forEach(e)}}function $me(n,e){const t=fa.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(nd(i),n(s-e))};return Xi.setup(i,!0),()=>nd(i)}const I8=["TopLeft","TopRight","BottomLeft","BottomRight"],Xme=I8.length,MD=n=>typeof n=="string"?parseFloat(n):n,CD=n=>typeof n=="number"||dn.test(n);function Gme(n,e,t,i,r,s){r?(n.opacity=ir(0,t.opacity??1,Yme(i)),n.opacityExit=ir(e.opacity??1,0,qme(i))):s&&(n.opacity=ir(e.opacity??1,t.opacity??1,i));for(let o=0;o<Xme;o++){const a=`border${I8[o]}Radius`;let l=PD(e,a),c=PD(t,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||CD(l)===CD(c)?(n[a]=Math.max(ir(MD(l),MD(c),i),0),(su.test(c)||su.test(l))&&(n[a]+="%")):n[a]=c}(e.rotate||t.rotate)&&(n.rotate=ir(e.rotate||0,t.rotate||0,i))}function PD(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Yme=k8(0,.5,vH),qme=k8(.5,.95,ml);function k8(n,e,t){return i=>i<n?0:i>e?1:t(Kv(n,e,i))}function RD(n,e){n.min=e.min,n.max=e.max}function ul(n,e){RD(n.x,e.x),RD(n.y,e.y)}function ID(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function kD(n,e,t,i,r){return n-=e,n=aS(n,1/t,i),r!==void 0&&(n=aS(n,1/r,i)),n}function Zme(n,e=0,t=1,i=.5,r,s=n,o=n){if(su.test(e)&&(e=parseFloat(e),e=ir(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=ir(s.min,s.max,i);n===s&&(a-=e),n.min=kD(n.min,e,t,a,r),n.max=kD(n.max,e,t,a,r)}function OD(n,e,[t,i,r],s,o){Zme(n,e[t],e[i],e[r],e.scale,s,o)}const Kme=["x","scaleX","originX"],Jme=["y","scaleY","originY"];function LD(n,e,t,i){OD(n.x,e,Kme,t?t.x:void 0,i?i.x:void 0),OD(n.y,e,Jme,t?t.y:void 0,i?i.y:void 0)}function ND(n){return n.translate===0&&n.scale===1}function O8(n){return ND(n.x)&&ND(n.y)}function DD(n,e){return n.min===e.min&&n.max===e.max}function Qme(n,e){return DD(n.x,e.x)&&DD(n.y,e.y)}function FD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function L8(n,e){return FD(n.x,e.x)&&FD(n.y,e.y)}function UD(n){return Fo(n.x)/Fo(n.y)}function BD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class ege{constructor(){this.members=[]}add(e){l2(this.members,e),e.scheduleRender()}remove(e){if(c2(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tge(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:m,skewX:y,skewY:x}=t;c&&(i=`perspective(${c}px) ${i}`),u&&(i+=`rotate(${u}deg) `),d&&(i+=`rotateX(${d}deg) `),m&&(i+=`rotateY(${m}deg) `),y&&(i+=`skewX(${y}deg) `),x&&(i+=`skewY(${x}deg) `)}const a=n.x.scale*e.x,l=n.y.scale*e.y;return(a!==1||l!==1)&&(i+=`scale(${a}, ${l})`),i||"none"}const Z1=["","X","Y","Z"],nge=1e3;let ige=0;function K1(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function N8(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=x8(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Xi,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&N8(i)}function D8({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=ige++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(oge),this.nodes.forEach(uge),this.nodes.forEach(hge),this.nodes.forEach(age)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new jme)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new f2),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=KH(o)&&!Jde(o),this.instance=o;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),n){let u,d=0;const m=()=>this.root.updateBlockedByResize=!1;Xi.read(()=>{d=window.innerWidth}),n(o,()=>{const y=window.innerWidth;y!==d&&(d=y,this.root.updateBlockedByResize=!0,u&&u(),u=$me(m,250),xw.hasAnimatedSinceResize&&(xw.hasAnimatedSinceResize=!1,this.nodes.forEach(HD)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:m,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||c.getDefaultTransition()||gge,{onLayoutAnimationStart:T,onLayoutAnimationComplete:S}=c.getProps(),w=!this.targetLayout||!L8(this.targetLayout,y),P=!d&&m;if(this.options.layoutRoot||this.resumeFrom||P||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const M={...E2(x,"layout"),onPlay:T,onComplete:S};(c.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M),this.setAnimationOrigin(u,P)}else d||HD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),nd(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fge),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&N8(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(zD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(VD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(cge),this.nodes.forEach(rge),this.nodes.forEach(sge)):this.nodes.forEach(VD),this.clearAllSnapshots();const a=fa.now();Ws.delta=yh(0,1e3/60,a-Ws.timestamp),Ws.timestamp=a,Ws.isProcessing=!0,B1.update.process(Ws),B1.preRender.process(Ws),B1.render.process(Ws),Ws.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,M2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(lge),this.sharedNodes.forEach(dge)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Xi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Xi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Fo(this.snapshot.measuredBox.x)&&!Fo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Er(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!O8(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&this.instance&&(a||fp(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),_ge(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Er();const a=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(yge))){const{scroll:c}=this.root;c&&(Pg(a.x,c.offset.x),Pg(a.y,c.offset.y))}return a}removeElementScroll(o){const a=Er();if(ul(a,o),this.scroll?.wasRoot)return a;for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:d}=c;c!==this.root&&u&&d.layoutScroll&&(u.wasRoot&&ul(a,o),Pg(a.x,u.offset.x),Pg(a.y,u.offset.y))}return a}applyTransform(o,a=!1){const l=Er();ul(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Rg(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),fp(u.latestValues)&&Rg(l,u.latestValues)}return fp(this.latestValues)&&Rg(l,this.latestValues),l}removeTransform(o){const a=Er();ul(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!fp(c.latestValues))continue;NC(c.latestValues)&&c.updateSnapshot();const u=Er(),d=c.measurePageBox();ul(u,d),LD(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return fp(this.latestValues)&&LD(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ws.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Ws.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Er(),this.relativeTargetOrigin=Er(),rv(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),ul(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Er(),this.targetWithTransforms=Er()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Tme(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ul(this.target,this.layout.layoutBox),p8(this.target,this.targetDelta)):ul(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Er(),this.relativeTargetOrigin=Er(),rv(this.relativeTargetOrigin,this.target,m.target),ul(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||NC(this.parent.latestValues)||d8(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ws.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;ul(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,m=this.treeScale.y;Dpe(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Er());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ID(this.prevProjectionDelta.x,this.projectionDelta.x),ID(this.prevProjectionDelta.y,this.projectionDelta.y)),iv(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==m||!BD(this.projectionDelta.x,this.prevProjectionDelta.x)||!BD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ig(),this.projectionDelta=Ig(),this.projectionDeltaWithTransform=Ig()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Ig();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=Er(),y=l?l.source:void 0,x=this.layout?this.layout.source:void 0,T=y!==x,S=this.getStack(),w=!S||S.members.length<=1,P=!!(T&&!w&&this.options.crossfade===!0&&!this.path.some(mge));this.animationProgress=0;let M;this.mixTargetDelta=I=>{const k=I/1e3;WD(d.x,o.x,k),WD(d.y,o.y,k),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(rv(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),pge(this.relativeTarget,this.relativeTargetOrigin,m,k),M&&Qme(this.relativeTarget,M)&&(this.isProjectionDirty=!1),M||(M=Er()),ul(M,this.relativeTarget)),T&&(this.animationValues=u,Gme(u,c,this.latestValues,k,P,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(nd(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Xi.update(()=>{xw.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=l_(0)),this.currentAnimation=Hme(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(nge),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&F8(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Er();const d=Fo(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const m=Fo(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+m}ul(a,l),Rg(a,u),iv(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new ege),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&K1("z",o,c,this.animationValues);for(let u=0;u<Z1.length;u++)K1(`rotate${Z1[u]}`,o,c,this.animationValues),K1(`skew${Z1[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=vw(a?.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=vw(a?.pointerEvents)||""),this.hasProjected&&!fp(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let d=tge(this.projectionDeltaWithTransform,this.treeScale,u);l&&(d=l(u,d)),o.transform=d;const{x:m,y}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${y.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const x in t0){if(u[x]===void 0)continue;const{correct:T,applyTo:S,isCSSVariable:w}=t0[x],P=d==="none"?u[x]:T(u[x],c);if(S){const M=S.length;for(let I=0;I<M;I++)o[S[I]]=P}else w?this.options.visualElement.renderState.vars[x]=P:o[x]=P}this.options.layoutId&&(o.pointerEvents=c===this?vw(a?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(zD),this.root.sharedNodes.clear()}}}function rge(n){n.updateLayout()}function sge(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:i}=n.layout,{animationType:r}=n.options,s=e.source!==n.layout.source;r==="size"?hl(u=>{const d=s?e.measuredBox[u]:e.layoutBox[u],m=Fo(d);d.min=t[u].min,d.max=d.min+m}):F8(r,e.layoutBox,t)&&hl(u=>{const d=s?e.measuredBox[u]:e.layoutBox[u],m=Fo(t[u]);d.max=d.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[u].max=n.relativeTarget[u].min+m)});const o=Ig();iv(o,t,e.layoutBox);const a=Ig();s?iv(a,n.applyTransform(i,!0),e.measuredBox):iv(a,t,e.layoutBox);const l=!O8(o);let c=!1;if(!n.resumeFrom){const u=n.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:m}=u;if(d&&m){const y=Er();rv(y,e.layoutBox,d.layoutBox);const x=Er();rv(x,t,m.layoutBox),L8(y,x)||(c=!0),u.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=y,n.relativeParent=u)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:a,layoutDelta:o,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function oge(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function age(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function lge(n){n.clearSnapshot()}function zD(n){n.clearMeasurements()}function VD(n){n.isLayoutDirty=!1}function cge(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function HD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function uge(n){n.resolveTargetDelta()}function hge(n){n.calcProjection()}function fge(n){n.resetSkewAndRotation()}function dge(n){n.removeLeadSnapshot()}function WD(n,e,t){n.translate=ir(e.translate,0,t),n.scale=ir(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function jD(n,e,t,i){n.min=ir(e.min,t.min,i),n.max=ir(e.max,t.max,i)}function pge(n,e,t,i){jD(n.x,e.x,t.x,i),jD(n.y,e.y,t.y,i)}function mge(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const gge={duration:.45,ease:[.4,0,.1,1]},$D=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),XD=$D("applewebkit/")&&!$D("chrome/")?Math.round:ml;function GD(n){n.min=XD(n.min),n.max=XD(n.max)}function _ge(n){GD(n.x),GD(n.y)}function F8(n,e,t){return n==="position"||n==="preserve-aspect"&&!Sme(UD(e),UD(t),.2)}function yge(n){return n!==n.root&&n.scroll?.wasRoot}const vge=D8({attachResizeListener:(n,e)=>n0(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),J1={current:void 0},U8=D8({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!J1.current){const n=new vge({});n.mount(window),n.setOptions({layoutScroll:!0}),J1.current=n}return J1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),xge={pan:{Feature:Ume},drag:{Feature:Fme,ProjectionNode:U8,MeasureLayout:R8}};function YD(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Xi.postRender(()=>s(e,N0(e)))}class bge extends md{mount(){const{current:e}=this.node;e&&(this.unmount=Gde(e,(t,i)=>(YD(this.node,i,"Start"),r=>YD(this.node,r,"End"))))}unmount(){}}class wge extends md{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=k0(n0(this.node.current,"focus",()=>this.onFocus()),n0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function qD(n,e,t){const{props:i}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Xi.postRender(()=>s(e,N0(e)))}class Sge extends md{mount(){const{current:e}=this.node;e&&(this.unmount=Kde(e,(t,i)=>(qD(this.node,i,"Start"),(r,{success:s})=>qD(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const HC=new WeakMap,Q1=new WeakMap,Tge=n=>{const e=HC.get(n.target);e&&e(n)},Ege=n=>{n.forEach(Tge)};function Age({root:n,...e}){const t=n||document;Q1.has(t)||Q1.set(t,{});const i=Q1.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(Ege,{root:n,...e})),i[r]}function Mge(n,e,t){const i=Age(e);return HC.set(n,t),i.observe(n),()=>{HC.delete(n),i.unobserve(n)}}const Cge={some:0,all:1};class Pge extends md{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:Cge[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),m=c?u:d;m&&m(l)};return Mge(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Rge(e,t))&&this.startObserver()}unmount(){}}function Rge({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const Ige={inView:{Feature:Pge},tap:{Feature:Sge},focus:{Feature:wge},hover:{Feature:bge}},kge={layout:{ProjectionNode:U8,MeasureLayout:R8}},Oge={..._me,...Ige,...xge,...kge},Do=Ope(Oge,Xpe);var eA={exports:{}},vf={};var ZD;function Lge(){return ZD||(ZD=1,vf.ConcurrentRoot=1,vf.ContinuousEventPriority=4,vf.DefaultEventPriority=16,vf.DiscreteEventPriority=1,vf.IdleEventPriority=536870912,vf.LegacyRoot=0),vf}var KD;function Nge(){return KD||(KD=1,eA.exports=Lge()),eA.exports}var kg=Nge();function Dge(n){let e;const t=new Set,i=(c,u)=>{const d=typeof c=="function"?c(e):c;if(d!==e){const m=e;e=u?d:Object.assign({},e,d),t.forEach(y=>y(e,m))}},r=()=>e,s=(c,u=r,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let m=u(e);function y(){const x=u(e);if(!d(m,x)){const T=m;c(m=x,T)}}return t.add(y),()=>t.delete(y)},l={setState:i,getState:r,subscribe:(c,u,d)=>u||d?s(c,u,d):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=n(i,r,l),l}const Fge=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),JD=Fge?G.useEffect:G.useLayoutEffect;function Uge(n){const e=typeof n=="function"?Dge(n):n,t=(i=e.getState,r=Object.is)=>{const[,s]=G.useReducer(S=>S+1,0),o=e.getState(),a=G.useRef(o),l=G.useRef(i),c=G.useRef(r),u=G.useRef(!1),d=G.useRef();d.current===void 0&&(d.current=i(o));let m,y=!1;(a.current!==o||l.current!==i||c.current!==r||u.current)&&(m=i(o),y=!r(d.current,m)),JD(()=>{y&&(d.current=m),a.current=o,l.current=i,c.current=r,u.current=!1});const x=G.useRef(o);JD(()=>{const S=()=>{try{const P=e.getState(),M=l.current(P);c.current(d.current,M)||(a.current=P,d.current=M,s())}catch{u.current=!0,s()}},w=e.subscribe(S);return e.getState()!==x.current&&S(),w},[]);const T=y?m:d.current;return G.useDebugValue(T),T};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[t,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},t}var tA={exports:{}},nA={exports:{}},iA={};var QD;function Bge(){return QD||(QD=1,(function(n){function e(q,ie){var X=q.length;q.push(ie);e:for(;0<X;){var Y=X-1>>>1,ce=q[Y];if(0<r(ce,ie))q[Y]=ie,q[X]=ce,X=Y;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var ie=q[0],X=q.pop();if(X!==ie){q[0]=X;e:for(var Y=0,ce=q.length,Me=ce>>>1;Y<Me;){var Re=2*(Y+1)-1,Fe=q[Re],Be=Re+1,at=q[Be];if(0>r(Fe,X))Be<ce&&0>r(at,Fe)?(q[Y]=at,q[Be]=X,Y=Be):(q[Y]=Fe,q[Re]=X,Y=Re);else if(Be<ce&&0>r(at,X))q[Y]=at,q[Be]=X,Y=Be;else break e}}return ie}function r(q,ie){var X=q.sortIndex-ie.sortIndex;return X!==0?X:q.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,m=3,y=!1,x=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(q){for(var ie=t(c);ie!==null;){if(ie.callback===null)i(c);else if(ie.startTime<=q)i(c),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=t(c)}}function I(q){if(T=!1,M(q),!x)if(t(l)!==null)x=!0,ve(k);else{var ie=t(c);ie!==null&&me(I,ie.startTime-q)}}function k(q,ie){x=!1,T&&(T=!1,w(W),W=-1),y=!0;var X=m;try{for(M(ie),d=t(l);d!==null&&(!(d.expirationTime>ie)||q&&!J());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,m=d.priorityLevel;var ce=Y(d.expirationTime<=ie);ie=n.unstable_now(),typeof ce=="function"?d.callback=ce:d===t(l)&&i(l),M(ie)}else i(l);d=t(l)}if(d!==null)var Me=!0;else{var Re=t(c);Re!==null&&me(I,Re.startTime-ie),Me=!1}return Me}finally{d=null,m=X,y=!1}}var D=!1,H=null,W=-1,z=5,j=-1;function J(){return!(n.unstable_now()-j<z)}function le(){if(H!==null){var q=n.unstable_now();j=q;var ie=!0;try{ie=H(!0,q)}finally{ie?ge():(D=!1,H=null)}}else D=!1}var ge;if(typeof P=="function")ge=function(){P(le)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,de=te.port2;te.port1.onmessage=le,ge=function(){de.postMessage(null)}}else ge=function(){S(le,0)};function ve(q){H=q,D||(D=!0,ge())}function me(q,ie){W=S(function(){q(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){x||y||(x=!0,ve(k))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var ie=3;break;default:ie=m}var X=m;m=ie;try{return q()}finally{m=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,ie){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var X=m;m=q;try{return ie()}finally{m=X}},n.unstable_scheduleCallback=function(q,ie,X){var Y=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Y+X:Y):X=Y,q){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=X+ce,q={id:u++,callback:ie,priorityLevel:q,startTime:X,expirationTime:ce,sortIndex:-1},X>Y?(q.sortIndex=X,e(c,q),t(l)===null&&q===t(c)&&(T?(w(W),W=-1):T=!0,me(I,X-Y))):(q.sortIndex=ce,e(l,q),x||y||(x=!0,ve(k))),q},n.unstable_shouldYield=J,n.unstable_wrapCallback=function(q){var ie=m;return function(){var X=m;m=ie;try{return q.apply(this,arguments)}finally{m=X}}}})(iA)),iA}var eF;function zge(){return eF||(eF=1,nA.exports=Bge()),nA.exports}var rA,tF;function Vge(){return tF||(tF=1,rA=function(e){var t={},i=l0(),r=zge(),s=Object.assign;function o(g){for(var _="https://reactjs.org/docs/error-decoder.html?invariant="+g,A=1;A<arguments.length;A++)_+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+g+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),x=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),I=Symbol.for("react.offscreen"),k=Symbol.iterator;function D(g){return g===null||typeof g!="object"?null:(g=k&&g[k]||g["@@iterator"],typeof g=="function"?g:null)}function H(g){if(g==null)return null;if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case u:return"Fragment";case c:return"Portal";case m:return"Profiler";case d:return"StrictMode";case S:return"Suspense";case w:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case x:return(g.displayName||"Context")+".Consumer";case y:return(g._context.displayName||"Context")+".Provider";case T:var _=g.render;return g=g.displayName,g||(g=_.displayName||_.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case P:return _=g.displayName||null,_!==null?_:H(g.type)||"Memo";case M:_=g._payload,g=g._init;try{return H(g(_))}catch{}}return null}function W(g){var _=g.type;switch(g.tag){case 24:return"Cache";case 9:return(_.displayName||"Context")+".Consumer";case 10:return(_._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=_.render,g=g.displayName||g.name||"",_.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return _;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(_);case 8:return _===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _}return null}function z(g){var _=g,A=g;if(g.alternate)for(;_.return;)_=_.return;else{g=_;do _=g,(_.flags&4098)!==0&&(A=_.return),g=_.return;while(g)}return _.tag===3?A:null}function j(g){if(z(g)!==g)throw Error(o(188))}function J(g){var _=g.alternate;if(!_){if(_=z(g),_===null)throw Error(o(188));return _!==g?null:g}for(var A=g,R=_;;){var F=A.return;if(F===null)break;var $=F.alternate;if($===null){if(R=F.return,R!==null){A=R;continue}break}if(F.child===$.child){for($=F.child;$;){if($===A)return j(F),g;if($===R)return j(F),_;$=$.sibling}throw Error(o(188))}if(A.return!==R.return)A=F,R=$;else{for(var oe=!1,we=F.child;we;){if(we===A){oe=!0,A=F,R=$;break}if(we===R){oe=!0,R=F,A=$;break}we=we.sibling}if(!oe){for(we=$.child;we;){if(we===A){oe=!0,A=$,R=F;break}if(we===R){oe=!0,R=$,A=F;break}we=we.sibling}if(!oe)throw Error(o(189))}}if(A.alternate!==R)throw Error(o(190))}if(A.tag!==3)throw Error(o(188));return A.stateNode.current===A?g:_}function le(g){return g=J(g),g!==null?ge(g):null}function ge(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){var _=ge(g);if(_!==null)return _;g=g.sibling}return null}function te(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){if(g.tag!==4){var _=te(g);if(_!==null)return _}g=g.sibling}return null}var de=Array.isArray,ve=e.getPublicInstance,me=e.getRootHostContext,q=e.getChildHostContext,ie=e.prepareForCommit,X=e.resetAfterCommit,Y=e.createInstance,ce=e.appendInitialChild,Me=e.finalizeInitialChildren,Re=e.prepareUpdate,Fe=e.shouldSetTextContent,Be=e.createTextInstance,at=e.scheduleTimeout,pt=e.cancelTimeout,Ft=e.noTimeout,yn=e.isPrimaryRenderer,Rt=e.supportsMutation,he=e.supportsPersistence,nt=e.supportsHydration,Ye=e.getInstanceFromNode,lt=e.preparePortalMount,Ke=e.getCurrentEventPriority,Ut=e.detachDeletedInstance,bt=e.supportsMicrotasks,Ct=e.scheduleMicrotask,Zt=e.supportsTestSelectors,ln=e.findFiberRoot,Xn=e.getBoundingRect,ae=e.getTextContent,Q=e.isHiddenSubtree,Ne=e.matchAccessibilityRole,ct=e.setFocusIfFocusable,et=e.setupIntersectionObserver,ot=e.appendChild,Bt=e.appendChildToContainer,dt=e.commitTextUpdate,vt=e.commitMount,nn=e.commitUpdate,Mn=e.insertBefore,ht=e.insertInContainerBefore,Ln=e.removeChild,pe=e.removeChildFromContainer,$e=e.resetTextContent,it=e.hideInstance,tt=e.hideTextInstance,jt=e.unhideInstance,ye=e.unhideTextInstance,mt=e.clearContainer,gt=e.cloneInstance,Ge=e.createContainerChildSet,ut=e.appendChildToContainerChildSet,Vt=e.finalizeContainerChildren,vn=e.replaceContainerChildren,jn=e.cloneHiddenInstance,pi=e.cloneHiddenTextInstance,Cn=e.canHydrateInstance,qi=e.canHydrateTextInstance,Rr=e.canHydrateSuspenseInstance,du=e.isSuspenseInstancePending,rr=e.isSuspenseInstanceFallback,Lt=e.registerSuspenseInstanceRetry,$s=e.getNextHydratableSibling,ga=e.getFirstHydratableChild,pu=e.getFirstHydratableChildWithinContainer,mu=e.getFirstHydratableChildWithinSuspenseInstance,gu=e.hydrateInstance,Vo=e.hydrateTextInstance,_a=e.hydrateSuspenseInstance,ne=e.getNextHydratableInstanceAfterSuspenseInstance,Pe=e.commitHydratedContainer,ze=e.commitHydratedSuspenseInstance,He=e.clearSuspenseBoundary,je=e.clearSuspenseBoundaryFromContainer,Et=e.shouldDeleteUnhydratedTailInstances,Yt=e.didNotMatchHydratedContainerTextInstance,Jt=e.didNotMatchHydratedTextInstance,Mt;function fn(g){if(Mt===void 0)try{throw Error()}catch(A){var _=A.stack.trim().match(/\n( *(at )?)/);Mt=_&&_[1]||""}return`
`+Mt+g}var rn=!1;function un(g,_){if(!g||rn)return"";rn=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_)if(_=function(){throw Error()},Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(_t){var R=_t}Reflect.construct(g,[],_)}else{try{_.call()}catch(_t){R=_t}g.call(_.prototype)}else{try{throw Error()}catch(_t){R=_t}g()}}catch(_t){if(_t&&R&&typeof _t.stack=="string"){for(var F=_t.stack.split(`
`),$=R.stack.split(`
`),oe=F.length-1,we=$.length-1;1<=oe&&0<=we&&F[oe]!==$[we];)we--;for(;1<=oe&&0<=we;oe--,we--)if(F[oe]!==$[we]){if(oe!==1||we!==1)do if(oe--,we--,0>we||F[oe]!==$[we]){var Xe=`
`+F[oe].replace(" at new "," at ");return g.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",g.displayName)),Xe}while(1<=oe&&0<=we);break}}}finally{rn=!1,Error.prepareStackTrace=A}return(g=g?g.displayName||g.name:"")?fn(g):""}var ri=Object.prototype.hasOwnProperty,Zi=[],Gn=-1;function Mi(g){return{current:g}}function $t(g){0>Gn||(g.current=Zi[Gn],Zi[Gn]=null,Gn--)}function It(g,_){Gn++,Zi[Gn]=g.current,g.current=_}var Qt={},Wt=Mi(Qt),ai=Mi(!1),Xr=Qt;function Fi(g,_){var A=g.type.contextTypes;if(!A)return Qt;var R=g.stateNode;if(R&&R.__reactInternalMemoizedUnmaskedChildContext===_)return R.__reactInternalMemoizedMaskedChildContext;var F={},$;for($ in A)F[$]=_[$];return R&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=_,g.__reactInternalMemoizedMaskedChildContext=F),F}function bi(g){return g=g.childContextTypes,g!=null}function Dt(){$t(ai),$t(Wt)}function Fn(g,_,A){if(Wt.current!==Qt)throw Error(o(168));It(Wt,_),It(ai,A)}function Ga(g,_,A){var R=g.stateNode;if(_=_.childContextTypes,typeof R.getChildContext!="function")return A;R=R.getChildContext();for(var F in R)if(!(F in _))throw Error(o(108,W(g)||"Unknown",F));return s({},A,R)}function ki(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Qt,Xr=Wt.current,It(Wt,g),It(ai,ai.current),!0}function Ki(g,_,A){var R=g.stateNode;if(!R)throw Error(o(169));A?(g=Ga(g,_,Xr),R.__reactInternalMemoizedMergedChildContext=g,$t(ai),$t(Wt),It(Wt,g)):$t(ai),It(ai,A)}var os=Math.clz32?Math.clz32:Ui,ya=Math.log,vo=Math.LN2;function Ui(g){return g>>>=0,g===0?32:31-(ya(g)/vo|0)|0}var Xs=64,In=4194304;function Ho(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return g&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function wl(g,_){var A=g.pendingLanes;if(A===0)return 0;var R=0,F=g.suspendedLanes,$=g.pingedLanes,oe=A&268435455;if(oe!==0){var we=oe&~F;we!==0?R=Ho(we):($&=oe,$!==0&&(R=Ho($)))}else oe=A&~F,oe!==0?R=Ho(oe):$!==0&&(R=Ho($));if(R===0)return 0;if(_!==0&&_!==R&&(_&F)===0&&(F=R&-R,$=_&-_,F>=$||F===16&&($&4194240)!==0))return _;if((R&4)!==0&&(R|=A&16),_=g.entangledLanes,_!==0)for(g=g.entanglements,_&=R;0<_;)A=31-os(_),F=1<<A,R|=g[A],_&=~F;return R}function Sl(g,_){switch(g){case 1:case 2:case 4:return _+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mh(g,_){for(var A=g.suspendedLanes,R=g.pingedLanes,F=g.expirationTimes,$=g.pendingLanes;0<$;){var oe=31-os($),we=1<<oe,Xe=F[oe];Xe===-1?((we&A)===0||(we&R)!==0)&&(F[oe]=Sl(we,_)):Xe<=_&&(g.expiredLanes|=we),$&=~we}}function _c(g){return g=g.pendingLanes&-1073741825,g!==0?g:g&1073741824?1073741824:0}function Tl(g){for(var _=[],A=0;31>A;A++)_.push(g);return _}function va(g,_,A){g.pendingLanes|=_,_!==536870912&&(g.suspendedLanes=0,g.pingedLanes=0),g=g.eventTimes,_=31-os(_),g[_]=A}function yc(g,_){var A=g.pendingLanes&~_;g.pendingLanes=_,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=_,g.mutableReadLanes&=_,g.entangledLanes&=_,_=g.entanglements;var R=g.eventTimes;for(g=g.expirationTimes;0<A;){var F=31-os(A),$=1<<F;_[F]=0,R[F]=-1,g[F]=-1,A&=~$}}function ws(g,_){var A=g.entangledLanes|=_;for(g=g.entanglements;A;){var R=31-os(A),F=1<<R;F&_|g[R]&_&&(g[R]|=_),A&=~F}}var xn=0;function xo(g){return g&=-g,1<g?4<g?(g&268435455)!==0?16:536870912:4:1}var El=r.unstable_scheduleCallback,cn=r.unstable_cancelCallback,_r=r.unstable_shouldYield,si=r.unstable_requestPaint,Bi=r.unstable_now,xa=r.unstable_ImmediatePriority,gd=r.unstable_UserBlockingPriority,vc=r.unstable_NormalPriority,Wo=r.unstable_IdlePriority,Al=null,as=null;function Oi(g){if(as&&typeof as.onCommitFiberRoot=="function")try{as.onCommitFiberRoot(Al,g,void 0,(g.current.flags&128)===128)}catch{}}function bo(g,_){return g===_&&(g!==0||1/g===1/_)||g!==g&&_!==_}var Ir=typeof Object.is=="function"?Object.is:bo,Ss=null,Ch=!1,Ph=!1;function xc(g){Ss===null?Ss=[g]:Ss.push(g)}function Rh(g){Ch=!0,xc(g)}function Ts(){if(!Ph&&Ss!==null){Ph=!0;var g=0,_=xn;try{var A=Ss;for(xn=1;g<A.length;g++){var R=A[g];do R=R(!0);while(R!==null)}Ss=null,Ch=!1}catch(F){throw Ss!==null&&(Ss=Ss.slice(g+1)),El(xa,Ts),F}finally{xn=_,Ph=!1}}return null}var Nn=a.ReactCurrentBatchConfig;function wo(g,_){if(Ir(g,_))return!0;if(typeof g!="object"||g===null||typeof _!="object"||_===null)return!1;var A=Object.keys(g),R=Object.keys(_);if(A.length!==R.length)return!1;for(R=0;R<A.length;R++){var F=A[R];if(!ri.call(_,F)||!Ir(g[F],_[F]))return!1}return!0}function Es(g){switch(g.tag){case 5:return fn(g.type);case 16:return fn("Lazy");case 13:return fn("Suspense");case 19:return fn("SuspenseList");case 0:case 2:case 15:return g=un(g.type,!1),g;case 11:return g=un(g.type.render,!1),g;case 1:return g=un(g.type,!0),g;default:return""}}function sr(g,_){if(g&&g.defaultProps){_=s({},_),g=g.defaultProps;for(var A in g)_[A]===void 0&&(_[A]=g[A]);return _}return _}var bc=Mi(null),Ml=null,So=null,Ih=null;function kr(){Ih=So=Ml=null}function Cl(g,_,A){yn?(It(bc,_._currentValue),_._currentValue=A):(It(bc,_._currentValue2),_._currentValue2=A)}function _u(g){var _=bc.current;$t(bc),yn?g._currentValue=_:g._currentValue2=_}function ba(g,_,A){for(;g!==null;){var R=g.alternate;if((g.childLanes&_)!==_?(g.childLanes|=_,R!==null&&(R.childLanes|=_)):R!==null&&(R.childLanes&_)!==_&&(R.childLanes|=_),g===A)break;g=g.return}}function wc(g,_){Ml=g,Ih=So=null,g=g.dependencies,g!==null&&g.firstContext!==null&&((g.lanes&_)!==0&&(Lr=!0),g.firstContext=null)}function wi(g){var _=yn?g._currentValue:g._currentValue2;if(Ih!==g)if(g={context:g,memoizedValue:_,next:null},So===null){if(Ml===null)throw Error(o(308));So=g,Ml.dependencies={lanes:0,firstContext:g}}else So=So.next=g;return _}var Gs=null,As=!1;function Ms(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kh(g,_){g=g.updateQueue,_.updateQueue===g&&(_.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function jo(g,_){return{eventTime:g,lane:_,tag:0,payload:null,callback:null,next:null}}function $o(g,_){var A=g.updateQueue;A!==null&&(A=A.shared,Li!==null&&(g.mode&1)!==0&&(En&2)===0?(g=A.interleaved,g===null?(_.next=_,Gs===null?Gs=[A]:Gs.push(A)):(_.next=g.next,g.next=_),A.interleaved=_):(g=A.pending,g===null?_.next=_:(_.next=g.next,g.next=_),A.pending=_))}function Oh(g,_,A){if(_=_.updateQueue,_!==null&&(_=_.shared,(A&4194240)!==0)){var R=_.lanes;R&=g.pendingLanes,A|=R,_.lanes=A,ws(g,A)}}function yu(g,_){var A=g.updateQueue,R=g.alternate;if(R!==null&&(R=R.updateQueue,A===R)){var F=null,$=null;if(A=A.firstBaseUpdate,A!==null){do{var oe={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};$===null?F=$=oe:$=$.next=oe,A=A.next}while(A!==null);$===null?F=$=_:$=$.next=_}else F=$=_;A={baseState:R.baseState,firstBaseUpdate:F,lastBaseUpdate:$,shared:R.shared,effects:R.effects},g.updateQueue=A;return}g=A.lastBaseUpdate,g===null?A.firstBaseUpdate=_:g.next=_,A.lastBaseUpdate=_}function vu(g,_,A,R){var F=g.updateQueue;As=!1;var $=F.firstBaseUpdate,oe=F.lastBaseUpdate,we=F.shared.pending;if(we!==null){F.shared.pending=null;var Xe=we,_t=Xe.next;Xe.next=null,oe===null?$=_t:oe.next=_t,oe=Xe;var Nt=g.alternate;Nt!==null&&(Nt=Nt.updateQueue,we=Nt.lastBaseUpdate,we!==oe&&(we===null?Nt.firstBaseUpdate=_t:we.next=_t,Nt.lastBaseUpdate=Xe))}if($!==null){var _n=F.baseState;oe=0,Nt=_t=Xe=null,we=$;do{var tn=we.lane,ui=we.eventTime;if((R&tn)===tn){Nt!==null&&(Nt=Nt.next={eventTime:ui,lane:0,tag:we.tag,payload:we.payload,callback:we.callback,next:null});e:{var Pt=g,Zn=we;switch(tn=_,ui=A,Zn.tag){case 1:if(Pt=Zn.payload,typeof Pt=="function"){_n=Pt.call(ui,_n,tn);break e}_n=Pt;break e;case 3:Pt.flags=Pt.flags&-65537|128;case 0:if(Pt=Zn.payload,tn=typeof Pt=="function"?Pt.call(ui,_n,tn):Pt,tn==null)break e;_n=s({},_n,tn);break e;case 2:As=!0}}we.callback!==null&&we.lane!==0&&(g.flags|=64,tn=F.effects,tn===null?F.effects=[we]:tn.push(we))}else ui={eventTime:ui,lane:tn,tag:we.tag,payload:we.payload,callback:we.callback,next:null},Nt===null?(_t=Nt=ui,Xe=_n):Nt=Nt.next=ui,oe|=tn;if(we=we.next,we===null){if(we=F.shared.pending,we===null)break;tn=we,we=tn.next,tn.next=null,F.lastBaseUpdate=tn,F.shared.pending=null}}while(!0);if(Nt===null&&(Xe=_n),F.baseState=Xe,F.firstBaseUpdate=_t,F.lastBaseUpdate=Nt,_=F.shared.interleaved,_!==null){F=_;do oe|=F.lane,F=F.next;while(F!==_)}else $===null&&(F.shared.lanes=0);Nu|=oe,g.lanes=oe,g.memoizedState=_n}}function pm(g,_,A){if(g=_.effects,_.effects=null,g!==null)for(_=0;_<g.length;_++){var R=g[_],F=R.callback;if(F!==null){if(R.callback=null,R=A,typeof F!="function")throw Error(o(191,F));F.call(R)}}}var mm=new i.Component().refs;function xu(g,_,A,R){_=g.memoizedState,A=A(R,_),A=A==null?_:s({},_,A),g.memoizedState=A,g.lanes===0&&(g.updateQueue.baseState=A)}var Lh={isMounted:function(g){return(g=g._reactInternals)?z(g)===g:!1},enqueueSetState:function(g,_,A){g=g._reactInternals;var R=Fr(),F=rl(g),$=jo(R,F);$.payload=_,A!=null&&($.callback=A),$o(g,$),_=eo(g,F,R),_!==null&&Oh(_,g,F)},enqueueReplaceState:function(g,_,A){g=g._reactInternals;var R=Fr(),F=rl(g),$=jo(R,F);$.tag=1,$.payload=_,A!=null&&($.callback=A),$o(g,$),_=eo(g,F,R),_!==null&&Oh(_,g,F)},enqueueForceUpdate:function(g,_){g=g._reactInternals;var A=Fr(),R=rl(g),F=jo(A,R);F.tag=2,_!=null&&(F.callback=_),$o(g,F),_=eo(g,R,A),_!==null&&Oh(_,g,R)}};function Nh(g,_,A,R,F,$,oe){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(R,$,oe):_.prototype&&_.prototype.isPureReactComponent?!wo(A,R)||!wo(F,$):!0}function _d(g,_,A){var R=!1,F=Qt,$=_.contextType;return typeof $=="object"&&$!==null?$=wi($):(F=bi(_)?Xr:Wt.current,R=_.contextTypes,$=(R=R!=null)?Fi(g,F):Qt),_=new _(A,$),g.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Lh,g.stateNode=_,_._reactInternals=g,R&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=F,g.__reactInternalMemoizedMaskedChildContext=$),_}function bu(g,_,A,R){g=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(A,R),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(A,R),_.state!==g&&Lh.enqueueReplaceState(_,_.state,null)}function wa(g,_,A,R){var F=g.stateNode;F.props=A,F.state=g.memoizedState,F.refs=mm,Ms(g);var $=_.contextType;typeof $=="object"&&$!==null?F.context=wi($):($=bi(_)?Xr:Wt.current,F.context=Fi(g,$)),F.state=g.memoizedState,$=_.getDerivedStateFromProps,typeof $=="function"&&(xu(g,_,$,A),F.state=g.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(_=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),_!==F.state&&Lh.enqueueReplaceState(F,F.state,null),vu(g,A,F,R),F.state=g.memoizedState),typeof F.componentDidMount=="function"&&(g.flags|=4194308)}var Sc=[],Ys=0,Gr=null,wu=0,Cs=[],Ps=0,Sa=null,To=1,Ta="";function Pl(g,_){Sc[Ys++]=wu,Sc[Ys++]=Gr,Gr=g,wu=_}function yd(g,_,A){Cs[Ps++]=To,Cs[Ps++]=Ta,Cs[Ps++]=Sa,Sa=g;var R=To;g=Ta;var F=32-os(R)-1;R&=~(1<<F),A+=1;var $=32-os(_)+F;if(30<$){var oe=F-F%5;$=(R&(1<<oe)-1).toString(32),R>>=oe,F-=oe,To=1<<32-os(_)+F|A<<F|R,Ta=$+g}else To=1<<$|A<<F|R,Ta=g}function vd(g){g.return!==null&&(Pl(g,1),yd(g,1,0))}function Rs(g){for(;g===Gr;)Gr=Sc[--Ys],Sc[Ys]=null,wu=Sc[--Ys],Sc[Ys]=null;for(;g===Sa;)Sa=Cs[--Ps],Cs[Ps]=null,Ta=Cs[--Ps],Cs[Ps]=null,To=Cs[--Ps],Cs[Ps]=null}var zi=null,yr=null,zn=!1,Tc=!1,vr=null;function xd(g,_){var A=Po(5,null,null,0);A.elementType="DELETED",A.stateNode=_,A.return=g,_=g.deletions,_===null?(g.deletions=[A],g.flags|=16):_.push(A)}function Rl(g,_){switch(g.tag){case 5:return _=Cn(_,g.type,g.pendingProps),_!==null?(g.stateNode=_,zi=g,yr=ga(_),!0):!1;case 6:return _=qi(_,g.pendingProps),_!==null?(g.stateNode=_,zi=g,yr=null,!0):!1;case 13:if(_=Rr(_),_!==null){var A=Sa!==null?{id:To,overflow:Ta}:null;return g.memoizedState={dehydrated:_,treeContext:A,retryLane:1073741824},A=Po(18,null,null,0),A.stateNode=_,A.return=g,g.child=A,zi=g,yr=null,!0}return!1;default:return!1}}function Su(g){return(g.mode&1)!==0&&(g.flags&128)===0}function Eo(g){if(zn){var _=yr;if(_){var A=_;if(!Rl(g,_)){if(Su(g))throw Error(o(418));_=$s(A);var R=zi;_&&Rl(g,_)?xd(R,A):(g.flags=g.flags&-4097|2,zn=!1,zi=g)}}else{if(Su(g))throw Error(o(418));g.flags=g.flags&-4097|2,zn=!1,zi=g}}}function gm(g){for(g=g.return;g!==null&&g.tag!==5&&g.tag!==3&&g.tag!==13;)g=g.return;zi=g}function qs(g){if(!nt||g!==zi)return!1;if(!zn)return gm(g),zn=!0,!1;if(g.tag!==3&&(g.tag!==5||Et(g.type)&&!Fe(g.type,g.memoizedProps))){var _=yr;if(_){if(Su(g)){for(g=yr;g;)g=$s(g);throw Error(o(418))}for(;_;)xd(g,_),_=$s(_)}}if(gm(g),g.tag===13){if(!nt)throw Error(o(316));if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));yr=ne(g)}else yr=zi?$s(g.stateNode):null;return!0}function Ea(){nt&&(yr=zi=null,Tc=zn=!1)}function Dh(g){vr===null?vr=[g]:vr.push(g)}function Ya(g,_,A){if(g=A.ref,g!==null&&typeof g!="function"&&typeof g!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(o(309));var R=A.stateNode}if(!R)throw Error(o(147,g));var F=R,$=""+g;return _!==null&&_.ref!==null&&typeof _.ref=="function"&&_.ref._stringRef===$?_.ref:(_=function(oe){var we=F.refs;we===mm&&(we=F.refs={}),oe===null?delete we[$]:we[$]=oe},_._stringRef=$,_)}if(typeof g!="string")throw Error(o(284));if(!A._owner)throw Error(o(290,g))}return g}function qa(g,_){throw g=Object.prototype.toString.call(_),Error(o(31,g==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":g))}function ls(g){var _=g._init;return _(g._payload)}function _m(g){function _(Le,Ee){if(g){var We=Le.deletions;We===null?(Le.deletions=[Ee],Le.flags|=16):We.push(Ee)}}function A(Le,Ee){if(!g)return null;for(;Ee!==null;)_(Le,Ee),Ee=Ee.sibling;return null}function R(Le,Ee){for(Le=new Map;Ee!==null;)Ee.key!==null?Le.set(Ee.key,Ee):Le.set(Ee.index,Ee),Ee=Ee.sibling;return Le}function F(Le,Ee){return Le=Xl(Le,Ee),Le.index=0,Le.sibling=null,Le}function $(Le,Ee,We){return Le.index=We,g?(We=Le.alternate,We!==null?(We=We.index,We<Ee?(Le.flags|=2,Ee):We):(Le.flags|=2,Ee)):(Le.flags|=1048576,Ee)}function oe(Le){return g&&Le.alternate===null&&(Le.flags|=2),Le}function we(Le,Ee,We,At){return Ee===null||Ee.tag!==6?(Ee=Nm(We,Le.mode,At),Ee.return=Le,Ee):(Ee=F(Ee,We),Ee.return=Le,Ee)}function Xe(Le,Ee,We,At){var Xt=We.type;return Xt===u?Nt(Le,Ee,We.props.children,At,We.key):Ee!==null&&(Ee.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===M&&ls(Xt)===Ee.type)?(At=F(Ee,We.props),At.ref=Ya(Le,Ee,We),At.return=Le,At):(At=Dd(We.type,We.key,We.props,null,Le.mode,At),At.ref=Ya(Le,Ee,We),At.return=Le,At)}function _t(Le,Ee,We,At){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==We.containerInfo||Ee.stateNode.implementation!==We.implementation?(Ee=Dm(We,Le.mode,At),Ee.return=Le,Ee):(Ee=F(Ee,We.children||[]),Ee.return=Le,Ee)}function Nt(Le,Ee,We,At,Xt){return Ee===null||Ee.tag!==7?(Ee=Uc(We,Le.mode,At,Xt),Ee.return=Le,Ee):(Ee=F(Ee,We),Ee.return=Le,Ee)}function _n(Le,Ee,We){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Ee=Nm(""+Ee,Le.mode,We),Ee.return=Le,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case l:return We=Dd(Ee.type,Ee.key,Ee.props,null,Le.mode,We),We.ref=Ya(Le,null,Ee),We.return=Le,We;case c:return Ee=Dm(Ee,Le.mode,We),Ee.return=Le,Ee;case M:var At=Ee._init;return _n(Le,At(Ee._payload),We)}if(de(Ee)||D(Ee))return Ee=Uc(Ee,Le.mode,We,null),Ee.return=Le,Ee;qa(Le,Ee)}return null}function tn(Le,Ee,We,At){var Xt=Ee!==null?Ee.key:null;if(typeof We=="string"&&We!==""||typeof We=="number")return Xt!==null?null:we(Le,Ee,""+We,At);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case l:return We.key===Xt?Xe(Le,Ee,We,At):null;case c:return We.key===Xt?_t(Le,Ee,We,At):null;case M:return Xt=We._init,tn(Le,Ee,Xt(We._payload),At)}if(de(We)||D(We))return Xt!==null?null:Nt(Le,Ee,We,At,null);qa(Le,We)}return null}function ui(Le,Ee,We,At,Xt){if(typeof At=="string"&&At!==""||typeof At=="number")return Le=Le.get(We)||null,we(Ee,Le,""+At,Xt);if(typeof At=="object"&&At!==null){switch(At.$$typeof){case l:return Le=Le.get(At.key===null?We:At.key)||null,Xe(Ee,Le,At,Xt);case c:return Le=Le.get(At.key===null?We:At.key)||null,_t(Ee,Le,At,Xt);case M:var Sn=At._init;return ui(Le,Ee,We,Sn(At._payload),Xt)}if(de(At)||D(At))return Le=Le.get(We)||null,Nt(Ee,Le,At,Xt,null);qa(Ee,At)}return null}function Pt(Le,Ee,We,At){for(var Xt=null,Sn=null,mn=Ee,$n=Ee=0,wr=null;mn!==null&&$n<We.length;$n++){mn.index>$n?(wr=mn,mn=null):wr=mn.sibling;var Hn=tn(Le,mn,We[$n],At);if(Hn===null){mn===null&&(mn=wr);break}g&&mn&&Hn.alternate===null&&_(Le,mn),Ee=$(Hn,Ee,$n),Sn===null?Xt=Hn:Sn.sibling=Hn,Sn=Hn,mn=wr}if($n===We.length)return A(Le,mn),zn&&Pl(Le,$n),Xt;if(mn===null){for(;$n<We.length;$n++)mn=_n(Le,We[$n],At),mn!==null&&(Ee=$(mn,Ee,$n),Sn===null?Xt=mn:Sn.sibling=mn,Sn=mn);return zn&&Pl(Le,$n),Xt}for(mn=R(Le,mn);$n<We.length;$n++)wr=ui(mn,Le,$n,We[$n],At),wr!==null&&(g&&wr.alternate!==null&&mn.delete(wr.key===null?$n:wr.key),Ee=$(wr,Ee,$n),Sn===null?Xt=wr:Sn.sibling=wr,Sn=wr);return g&&mn.forEach(function(sl){return _(Le,sl)}),zn&&Pl(Le,$n),Xt}function Zn(Le,Ee,We,At){var Xt=D(We);if(typeof Xt!="function")throw Error(o(150));if(We=Xt.call(We),We==null)throw Error(o(151));for(var Sn=Xt=null,mn=Ee,$n=Ee=0,wr=null,Hn=We.next();mn!==null&&!Hn.done;$n++,Hn=We.next()){mn.index>$n?(wr=mn,mn=null):wr=mn.sibling;var sl=tn(Le,mn,Hn.value,At);if(sl===null){mn===null&&(mn=wr);break}g&&mn&&sl.alternate===null&&_(Le,mn),Ee=$(sl,Ee,$n),Sn===null?Xt=sl:Sn.sibling=sl,Sn=sl,mn=wr}if(Hn.done)return A(Le,mn),zn&&Pl(Le,$n),Xt;if(mn===null){for(;!Hn.done;$n++,Hn=We.next())Hn=_n(Le,Hn.value,At),Hn!==null&&(Ee=$(Hn,Ee,$n),Sn===null?Xt=Hn:Sn.sibling=Hn,Sn=Hn);return zn&&Pl(Le,$n),Xt}for(mn=R(Le,mn);!Hn.done;$n++,Hn=We.next())Hn=ui(mn,Le,$n,Hn.value,At),Hn!==null&&(g&&Hn.alternate!==null&&mn.delete(Hn.key===null?$n:Hn.key),Ee=$(Hn,Ee,$n),Sn===null?Xt=Hn:Sn.sibling=Hn,Sn=Hn);return g&&mn.forEach(function(rx){return _(Le,rx)}),zn&&Pl(Le,$n),Xt}function Ro(Le,Ee,We,At){if(typeof We=="object"&&We!==null&&We.type===u&&We.key===null&&(We=We.props.children),typeof We=="object"&&We!==null){switch(We.$$typeof){case l:e:{for(var Xt=We.key,Sn=Ee;Sn!==null;){if(Sn.key===Xt){if(Xt=We.type,Xt===u){if(Sn.tag===7){A(Le,Sn.sibling),Ee=F(Sn,We.props.children),Ee.return=Le,Le=Ee;break e}}else if(Sn.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===M&&ls(Xt)===Sn.type){A(Le,Sn.sibling),Ee=F(Sn,We.props),Ee.ref=Ya(Le,Sn,We),Ee.return=Le,Le=Ee;break e}A(Le,Sn);break}else _(Le,Sn);Sn=Sn.sibling}We.type===u?(Ee=Uc(We.props.children,Le.mode,At,We.key),Ee.return=Le,Le=Ee):(At=Dd(We.type,We.key,We.props,null,Le.mode,At),At.ref=Ya(Le,Ee,We),At.return=Le,Le=At)}return oe(Le);case c:e:{for(Sn=We.key;Ee!==null;){if(Ee.key===Sn)if(Ee.tag===4&&Ee.stateNode.containerInfo===We.containerInfo&&Ee.stateNode.implementation===We.implementation){A(Le,Ee.sibling),Ee=F(Ee,We.children||[]),Ee.return=Le,Le=Ee;break e}else{A(Le,Ee);break}else _(Le,Ee);Ee=Ee.sibling}Ee=Dm(We,Le.mode,At),Ee.return=Le,Le=Ee}return oe(Le);case M:return Sn=We._init,Ro(Le,Ee,Sn(We._payload),At)}if(de(We))return Pt(Le,Ee,We,At);if(D(We))return Zn(Le,Ee,We,At);qa(Le,We)}return typeof We=="string"&&We!==""||typeof We=="number"?(We=""+We,Ee!==null&&Ee.tag===6?(A(Le,Ee.sibling),Ee=F(Ee,We),Ee.return=Le,Le=Ee):(A(Le,Ee),Ee=Nm(We,Le.mode,At),Ee.return=Le,Le=Ee),oe(Le)):A(Le,Ee)}return Ro}var cs=_m(!0),ym=_m(!1),us={},xr=Mi(us),Za=Mi(us),Aa=Mi(us);function hs(g){if(g===us)throw Error(o(174));return g}function Ec(g,_){It(Aa,_),It(Za,g),It(xr,us),g=me(_),$t(xr),It(xr,g)}function Ma(){$t(xr),$t(Za),$t(Aa)}function Il(g){var _=hs(Aa.current),A=hs(xr.current);_=q(A,g.type,_),A!==_&&(It(Za,g),It(xr,_))}function Ac(g){Za.current===g&&($t(xr),$t(Za))}var li=Mi(0);function Tu(g){for(var _=g;_!==null;){if(_.tag===13){var A=_.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||du(A)||rr(A)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===g)break;for(;_.sibling===null;){if(_.return===null||_.return===g)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var Is=[];function Xo(){for(var g=0;g<Is.length;g++){var _=Is[g];yn?_._workInProgressVersionPrimary=null:_._workInProgressVersionSecondary=null}Is.length=0}var Eu=a.ReactCurrentDispatcher,fs=a.ReactCurrentBatchConfig,kl=0,mi=null,or=null,ei=null,Ol=!1,Go=!1,Yo=0,Au=0;function Ji(){throw Error(o(321))}function Fh(g,_){if(_===null)return!1;for(var A=0;A<_.length&&A<g.length;A++)if(!Ir(g[A],_[A]))return!1;return!0}function qo(g,_,A,R,F,$){if(kl=$,mi=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,Eu.current=g===null||g.memoizedState===null?en:bn,g=A(R,F),Go){$=0;do{if(Go=!1,Yo=0,25<=$)throw Error(o(301));$+=1,ei=or=null,_.updateQueue=null,Eu.current=br,g=A(R,F)}while(Go)}if(Eu.current=wt,_=or!==null&&or.next!==null,kl=0,ei=or=mi=null,Ol=!1,_)throw Error(o(300));return g}function Ka(){var g=Yo!==0;return Yo=0,g}function Or(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ei===null?mi.memoizedState=ei=g:ei=ei.next=g,ei}function Zs(){if(or===null){var g=mi.alternate;g=g!==null?g.memoizedState:null}else g=or.next;var _=ei===null?mi.memoizedState:ei.next;if(_!==null)ei=_,or=g;else{if(g===null)throw Error(o(310));or=g,g={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},ei===null?mi.memoizedState=ei=g:ei=ei.next=g}return ei}function Ao(g,_){return typeof _=="function"?_(g):_}function Mu(g){var _=Zs(),A=_.queue;if(A===null)throw Error(o(311));A.lastRenderedReducer=g;var R=or,F=R.baseQueue,$=A.pending;if($!==null){if(F!==null){var oe=F.next;F.next=$.next,$.next=oe}R.baseQueue=F=$,A.pending=null}if(F!==null){$=F.next,R=R.baseState;var we=oe=null,Xe=null,_t=$;do{var Nt=_t.lane;if((kl&Nt)===Nt)Xe!==null&&(Xe=Xe.next={lane:0,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),R=_t.hasEagerState?_t.eagerState:g(R,_t.action);else{var _n={lane:Nt,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null};Xe===null?(we=Xe=_n,oe=R):Xe=Xe.next=_n,mi.lanes|=Nt,Nu|=Nt}_t=_t.next}while(_t!==null&&_t!==$);Xe===null?oe=R:Xe.next=we,Ir(R,_.memoizedState)||(Lr=!0),_.memoizedState=R,_.baseState=oe,_.baseQueue=Xe,A.lastRenderedState=R}if(g=A.interleaved,g!==null){F=g;do $=F.lane,mi.lanes|=$,Nu|=$,F=F.next;while(F!==g)}else F===null&&(A.lanes=0);return[_.memoizedState,A.dispatch]}function ks(g){var _=Zs(),A=_.queue;if(A===null)throw Error(o(311));A.lastRenderedReducer=g;var R=A.dispatch,F=A.pending,$=_.memoizedState;if(F!==null){A.pending=null;var oe=F=F.next;do $=g($,oe.action),oe=oe.next;while(oe!==F);Ir($,_.memoizedState)||(Lr=!0),_.memoizedState=$,_.baseQueue===null&&(_.baseState=$),A.lastRenderedState=$}return[$,R]}function Uh(){}function Bh(g,_){var A=mi,R=Zs(),F=_(),$=!Ir(R.memoizedState,F);if($&&(R.memoizedState=F,Lr=!0),R=R.queue,Nl(Ks.bind(null,A,R,g),[g]),R.getSnapshot!==_||$||ei!==null&&ei.memoizedState.tag&1){if(A.flags|=2048,Cc(9,bd.bind(null,A,R,F,_),void 0,null),Li===null)throw Error(o(349));(kl&30)!==0||Ll(A,_,F)}return F}function Ll(g,_,A){g.flags|=16384,g={getSnapshot:_,value:A},_=mi.updateQueue,_===null?(_={lastEffect:null,stores:null},mi.updateQueue=_,_.stores=[g]):(A=_.stores,A===null?_.stores=[g]:A.push(g))}function bd(g,_,A,R){_.value=A,_.getSnapshot=R,Ja(_)&&eo(g,1,-1)}function Ks(g,_,A){return A(function(){Ja(_)&&eo(g,1,-1)})}function Ja(g){var _=g.getSnapshot;g=g.value;try{var A=_();return!Ir(g,A)}catch{return!0}}function Mc(g){var _=Or();return typeof g=="function"&&(g=g()),_.memoizedState=_.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:g},_.queue=g,g=g.dispatch=K.bind(null,mi,g),[_.memoizedState,g]}function Cc(g,_,A,R){return g={tag:g,create:_,destroy:A,deps:R,next:null},_=mi.updateQueue,_===null?(_={lastEffect:null,stores:null},mi.updateQueue=_,_.lastEffect=g.next=g):(A=_.lastEffect,A===null?_.lastEffect=g.next=g:(R=A.next,A.next=g,g.next=R,_.lastEffect=g)),g}function vm(){return Zs().memoizedState}function Ca(g,_,A,R){var F=Or();mi.flags|=g,F.memoizedState=Cc(1|_,A,void 0,R===void 0?null:R)}function Cu(g,_,A,R){var F=Zs();R=R===void 0?null:R;var $=void 0;if(or!==null){var oe=or.memoizedState;if($=oe.destroy,R!==null&&Fh(R,oe.deps)){F.memoizedState=Cc(_,A,$,R);return}}mi.flags|=g,F.memoizedState=Cc(1|_,A,$,R)}function Pu(g,_){return Ca(8390656,8,g,_)}function Nl(g,_){return Cu(2048,8,g,_)}function ti(g,_){return Cu(4,2,g,_)}function zh(g,_){return Cu(4,4,g,_)}function Pc(g,_){if(typeof _=="function")return g=g(),_(g),function(){_(null)};if(_!=null)return g=g(),_.current=g,function(){_.current=null}}function Dl(g,_,A){return A=A!=null?A.concat([g]):null,Cu(4,4,Pc.bind(null,_,g),A)}function Vh(){}function f(g,_){var A=Zs();_=_===void 0?null:_;var R=A.memoizedState;return R!==null&&_!==null&&Fh(_,R[1])?R[0]:(A.memoizedState=[g,_],g)}function v(g,_){var A=Zs();_=_===void 0?null:_;var R=A.memoizedState;return R!==null&&_!==null&&Fh(_,R[1])?R[0]:(g=g(),A.memoizedState=[g,_],g)}function E(g,_){var A=xn;xn=A!==0&&4>A?A:4,g(!0);var R=fs.transition;fs.transition={};try{g(!1),_()}finally{xn=A,fs.transition=R}}function O(){return Zs().memoizedState}function V(g,_,A){var R=rl(g);A={lane:R,action:A,hasEagerState:!1,eagerState:null,next:null},fe(g)?Ce(_,A):(De(g,_,A),A=Fr(),g=eo(g,R,A),g!==null&&Je(g,_,R))}function K(g,_,A){var R=rl(g),F={lane:R,action:A,hasEagerState:!1,eagerState:null,next:null};if(fe(g))Ce(_,F);else{De(g,_,F);var $=g.alternate;if(g.lanes===0&&($===null||$.lanes===0)&&($=_.lastRenderedReducer,$!==null))try{var oe=_.lastRenderedState,we=$(oe,A);if(F.hasEagerState=!0,F.eagerState=we,Ir(we,oe))return}catch{}finally{}A=Fr(),g=eo(g,R,A),g!==null&&Je(g,_,R)}}function fe(g){var _=g.alternate;return g===mi||_!==null&&_===mi}function Ce(g,_){Go=Ol=!0;var A=g.pending;A===null?_.next=_:(_.next=A.next,A.next=_),g.pending=_}function De(g,_,A){Li!==null&&(g.mode&1)!==0&&(En&2)===0?(g=_.interleaved,g===null?(A.next=A,Gs===null?Gs=[_]:Gs.push(_)):(A.next=g.next,g.next=A),_.interleaved=A):(g=_.pending,g===null?A.next=A:(A.next=g.next,g.next=A),_.pending=A)}function Je(g,_,A){if((A&4194240)!==0){var R=_.lanes;R&=g.pendingLanes,A|=R,_.lanes=A,ws(g,A)}}var wt={readContext:wi,useCallback:Ji,useContext:Ji,useEffect:Ji,useImperativeHandle:Ji,useInsertionEffect:Ji,useLayoutEffect:Ji,useMemo:Ji,useReducer:Ji,useRef:Ji,useState:Ji,useDebugValue:Ji,useDeferredValue:Ji,useTransition:Ji,useMutableSource:Ji,useSyncExternalStore:Ji,useId:Ji,unstable_isNewReconciler:!1},en={readContext:wi,useCallback:function(g,_){return Or().memoizedState=[g,_===void 0?null:_],g},useContext:wi,useEffect:Pu,useImperativeHandle:function(g,_,A){return A=A!=null?A.concat([g]):null,Ca(4194308,4,Pc.bind(null,_,g),A)},useLayoutEffect:function(g,_){return Ca(4194308,4,g,_)},useInsertionEffect:function(g,_){return Ca(4,2,g,_)},useMemo:function(g,_){var A=Or();return _=_===void 0?null:_,g=g(),A.memoizedState=[g,_],g},useReducer:function(g,_,A){var R=Or();return _=A!==void 0?A(_):_,R.memoizedState=R.baseState=_,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:_},R.queue=g,g=g.dispatch=V.bind(null,mi,g),[R.memoizedState,g]},useRef:function(g){var _=Or();return g={current:g},_.memoizedState=g},useState:Mc,useDebugValue:Vh,useDeferredValue:function(g){var _=Mc(g),A=_[0],R=_[1];return Pu(function(){var F=fs.transition;fs.transition={};try{R(g)}finally{fs.transition=F}},[g]),A},useTransition:function(){var g=Mc(!1),_=g[0];return g=E.bind(null,g[1]),Or().memoizedState=g,[_,g]},useMutableSource:function(){},useSyncExternalStore:function(g,_,A){var R=mi,F=Or();if(zn){if(A===void 0)throw Error(o(407));A=A()}else{if(A=_(),Li===null)throw Error(o(349));(kl&30)!==0||Ll(R,_,A)}F.memoizedState=A;var $={value:A,getSnapshot:_};return F.queue=$,Pu(Ks.bind(null,R,$,g),[g]),R.flags|=2048,Cc(9,bd.bind(null,R,$,A,_),void 0,null),A},useId:function(){var g=Or(),_=Li.identifierPrefix;if(zn){var A=Ta,R=To;A=(R&~(1<<32-os(R)-1)).toString(32)+A,_=":"+_+"R"+A,A=Yo++,0<A&&(_+="H"+A.toString(32)),_+=":"}else A=Au++,_=":"+_+"r"+A.toString(32)+":";return g.memoizedState=_},unstable_isNewReconciler:!1},bn={readContext:wi,useCallback:f,useContext:wi,useEffect:Nl,useImperativeHandle:Dl,useInsertionEffect:ti,useLayoutEffect:zh,useMemo:v,useReducer:Mu,useRef:vm,useState:function(){return Mu(Ao)},useDebugValue:Vh,useDeferredValue:function(g){var _=Mu(Ao),A=_[0],R=_[1];return Nl(function(){var F=fs.transition;fs.transition={};try{R(g)}finally{fs.transition=F}},[g]),A},useTransition:function(){var g=Mu(Ao)[0],_=Zs().memoizedState;return[g,_]},useMutableSource:Uh,useSyncExternalStore:Bh,useId:O,unstable_isNewReconciler:!1},br={readContext:wi,useCallback:f,useContext:wi,useEffect:Nl,useImperativeHandle:Dl,useInsertionEffect:ti,useLayoutEffect:zh,useMemo:v,useReducer:ks,useRef:vm,useState:function(){return ks(Ao)},useDebugValue:Vh,useDeferredValue:function(g){var _=ks(Ao),A=_[0],R=_[1];return Nl(function(){var F=fs.transition;fs.transition={};try{R(g)}finally{fs.transition=F}},[g]),A},useTransition:function(){var g=ks(Ao)[0],_=Zs().memoizedState;return[g,_]},useMutableSource:Uh,useSyncExternalStore:Bh,useId:O,unstable_isNewReconciler:!1};function Vi(g,_){try{var A="",R=_;do A+=Es(R),R=R.return;while(R);var F=A}catch($){F=`
Error generating stack: `+$.message+`
`+$.stack}return{value:g,source:_,stack:F}}function Yr(g,_){try{console.error(_.value)}catch(A){setTimeout(function(){throw A})}}var ds=typeof WeakMap=="function"?WeakMap:Map;function Fl(g,_,A){A=jo(-1,A),A.tag=3,A.payload={element:null};var R=_.value;return A.callback=function(){Oc||(Oc=!0,ea=R),Yr(g,_)},A}function Hh(g,_,A){A=jo(-1,A),A.tag=3;var R=g.type.getDerivedStateFromError;if(typeof R=="function"){var F=_.value;A.payload=function(){return R(F)},A.callback=function(){Yr(g,_)}}var $=g.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(A.callback=function(){Yr(g,_),typeof R!="function"&&(ta===null?ta=new Set([this]):ta.add(this));var oe=_.stack;this.componentDidCatch(_.value,{componentStack:oe!==null?oe:""})}),A}function Pa(g,_,A){var R=g.pingCache;if(R===null){R=g.pingCache=new ds;var F=new Set;R.set(_,F)}else F=R.get(_),F===void 0&&(F=new Set,R.set(_,F));F.has(A)||(F.add(A),g=q0.bind(null,g,_,A),_.then(g,g))}function wd(g){do{var _;if((_=g.tag===13)&&(_=g.memoizedState,_=_!==null?_.dehydrated!==null:!0),_)return g;g=g.return}while(g!==null);return null}function Qa(g,_,A,R,F){return(g.mode&1)===0?(g===_?g.flags|=65536:(g.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(_=jo(-1,1),_.tag=2,$o(A,_))),A.lanes|=1),g):(g.flags|=65536,g.lanes=F,g)}function Qi(g){g.flags|=4}function Ul(g,_){if(g!==null&&g.child===_.child)return!0;if((_.flags&16)!==0)return!1;for(g=_.child;g!==null;){if((g.flags&12854)!==0||(g.subtreeFlags&12854)!==0)return!1;g=g.sibling}return!0}var Vn,Zo,Wh,jh;if(Rt)Vn=function(g,_){for(var A=_.child;A!==null;){if(A.tag===5||A.tag===6)ce(g,A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===_)break;for(;A.sibling===null;){if(A.return===null||A.return===_)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},Zo=function(){},Wh=function(g,_,A,R,F){if(g=g.memoizedProps,g!==R){var $=_.stateNode,oe=hs(xr.current);A=Re($,A,g,R,F,oe),(_.updateQueue=A)&&Qi(_)}},jh=function(g,_,A,R){A!==R&&Qi(_)};else if(he){Vn=function(g,_,A,R){for(var F=_.child;F!==null;){if(F.tag===5){var $=F.stateNode;A&&R&&($=jn($,F.type,F.memoizedProps,F)),ce(g,$)}else if(F.tag===6)$=F.stateNode,A&&R&&($=pi($,F.memoizedProps,F)),ce(g,$);else if(F.tag!==4){if(F.tag===22&&F.memoizedState!==null)$=F.child,$!==null&&($.return=F),Vn(g,F,!0,!0);else if(F.child!==null){F.child.return=F,F=F.child;continue}}if(F===_)break;for(;F.sibling===null;){if(F.return===null||F.return===_)return;F=F.return}F.sibling.return=F.return,F=F.sibling}};var el=function(g,_,A,R){for(var F=_.child;F!==null;){if(F.tag===5){var $=F.stateNode;A&&R&&($=jn($,F.type,F.memoizedProps,F)),ut(g,$)}else if(F.tag===6)$=F.stateNode,A&&R&&($=pi($,F.memoizedProps,F)),ut(g,$);else if(F.tag!==4){if(F.tag===22&&F.memoizedState!==null)$=F.child,$!==null&&($.return=F),el(g,F,!0,!0);else if(F.child!==null){F.child.return=F,F=F.child;continue}}if(F===_)break;for(;F.sibling===null;){if(F.return===null||F.return===_)return;F=F.return}F.sibling.return=F.return,F=F.sibling}};Zo=function(g,_){var A=_.stateNode;if(!Ul(g,_)){g=A.containerInfo;var R=Ge(g);el(R,_,!1,!1),A.pendingChildren=R,Qi(_),Vt(g,R)}},Wh=function(g,_,A,R,F){var $=g.stateNode,oe=g.memoizedProps;if((g=Ul(g,_))&&oe===R)_.stateNode=$;else{var we=_.stateNode,Xe=hs(xr.current),_t=null;oe!==R&&(_t=Re(we,A,oe,R,F,Xe)),g&&_t===null?_.stateNode=$:($=gt($,_t,A,oe,R,_,g,we),Me($,A,R,F,Xe)&&Qi(_),_.stateNode=$,g?Qi(_):Vn($,_,!1,!1))}},jh=function(g,_,A,R){A!==R?(g=hs(Aa.current),A=hs(xr.current),_.stateNode=Be(R,g,A,_),Qi(_)):_.stateNode=g.stateNode}}else Zo=function(){},Wh=function(){},jh=function(){};function Mo(g,_){if(!zn)switch(g.tailMode){case"hidden":_=g.tail;for(var A=null;_!==null;)_.alternate!==null&&(A=_),_=_.sibling;A===null?g.tail=null:A.sibling=null;break;case"collapsed":A=g.tail;for(var R=null;A!==null;)A.alternate!==null&&(R=A),A=A.sibling;R===null?_||g.tail===null?g.tail=null:g.tail.sibling=null:R.sibling=null}}function Ci(g){var _=g.alternate!==null&&g.alternate.child===g.child,A=0,R=0;if(_)for(var F=g.child;F!==null;)A|=F.lanes|F.childLanes,R|=F.subtreeFlags&14680064,R|=F.flags&14680064,F.return=g,F=F.sibling;else for(F=g.child;F!==null;)A|=F.lanes|F.childLanes,R|=F.subtreeFlags,R|=F.flags,F.return=g,F=F.sibling;return g.subtreeFlags|=R,g.childLanes=A,_}function $h(g,_,A){var R=_.pendingProps;switch(Rs(_),_.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ci(_),null;case 1:return bi(_.type)&&Dt(),Ci(_),null;case 3:return R=_.stateNode,Ma(),$t(ai),$t(Wt),Xo(),R.pendingContext&&(R.context=R.pendingContext,R.pendingContext=null),(g===null||g.child===null)&&(qs(_)?Qi(_):g===null||g.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,vr!==null&&(tr(vr),vr=null))),Zo(g,_),Ci(_),null;case 5:Ac(_),A=hs(Aa.current);var F=_.type;if(g!==null&&_.stateNode!=null)Wh(g,_,F,R,A),g.ref!==_.ref&&(_.flags|=512,_.flags|=2097152);else{if(!R){if(_.stateNode===null)throw Error(o(166));return Ci(_),null}if(g=hs(xr.current),qs(_)){if(!nt)throw Error(o(175));g=gu(_.stateNode,_.type,_.memoizedProps,A,g,_,!Tc),_.updateQueue=g,g!==null&&Qi(_)}else{var $=Y(F,R,A,g,_);Vn($,_,!1,!1),_.stateNode=$,Me($,F,R,A,g)&&Qi(_)}_.ref!==null&&(_.flags|=512,_.flags|=2097152)}return Ci(_),null;case 6:if(g&&_.stateNode!=null)jh(g,_,g.memoizedProps,R);else{if(typeof R!="string"&&_.stateNode===null)throw Error(o(166));if(g=hs(Aa.current),A=hs(xr.current),qs(_)){if(!nt)throw Error(o(176));if(g=_.stateNode,R=_.memoizedProps,(A=Vo(g,R,_,!Tc))&&(F=zi,F!==null))switch($=(F.mode&1)!==0,F.tag){case 3:Yt(F.stateNode.containerInfo,g,R,$);break;case 5:Jt(F.type,F.memoizedProps,F.stateNode,g,R,$)}A&&Qi(_)}else _.stateNode=Be(R,g,A,_)}return Ci(_),null;case 13:if($t(li),R=_.memoizedState,zn&&yr!==null&&(_.mode&1)!==0&&(_.flags&128)===0){for(g=yr;g;)g=$s(g);return Ea(),_.flags|=98560,_}if(R!==null&&R.dehydrated!==null){if(R=qs(_),g===null){if(!R)throw Error(o(318));if(!nt)throw Error(o(344));if(g=_.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));_a(g,_)}else Ea(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;return Ci(_),null}return vr!==null&&(tr(vr),vr=null),(_.flags&128)!==0?(_.lanes=A,_):(R=R!==null,A=!1,g===null?qs(_):A=g.memoizedState!==null,R&&!A&&(_.child.flags|=8192,(_.mode&1)!==0&&(g===null||(li.current&1)!==0?ar===0&&(ar=3):Id())),_.updateQueue!==null&&(_.flags|=4),Ci(_),null);case 4:return Ma(),Zo(g,_),g===null&&lt(_.stateNode.containerInfo),Ci(_),null;case 10:return _u(_.type._context),Ci(_),null;case 17:return bi(_.type)&&Dt(),Ci(_),null;case 19:if($t(li),F=_.memoizedState,F===null)return Ci(_),null;if(R=(_.flags&128)!==0,$=F.rendering,$===null)if(R)Mo(F,!1);else{if(ar!==0||g!==null&&(g.flags&128)!==0)for(g=_.child;g!==null;){if($=Tu(g),$!==null){for(_.flags|=128,Mo(F,!1),g=$.updateQueue,g!==null&&(_.updateQueue=g,_.flags|=4),_.subtreeFlags=0,g=A,R=_.child;R!==null;)A=R,F=g,A.flags&=14680066,$=A.alternate,$===null?(A.childLanes=0,A.lanes=F,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=$.childLanes,A.lanes=$.lanes,A.child=$.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=$.memoizedProps,A.memoizedState=$.memoizedState,A.updateQueue=$.updateQueue,A.type=$.type,F=$.dependencies,A.dependencies=F===null?null:{lanes:F.lanes,firstContext:F.firstContext}),R=R.sibling;return It(li,li.current&1|2),_.child}g=g.sibling}F.tail!==null&&Bi()>kc&&(_.flags|=128,R=!0,Mo(F,!1),_.lanes=4194304)}else{if(!R)if(g=Tu($),g!==null){if(_.flags|=128,R=!0,g=g.updateQueue,g!==null&&(_.updateQueue=g,_.flags|=4),Mo(F,!0),F.tail===null&&F.tailMode==="hidden"&&!$.alternate&&!zn)return Ci(_),null}else 2*Bi()-F.renderingStartTime>kc&&A!==1073741824&&(_.flags|=128,R=!0,Mo(F,!1),_.lanes=4194304);F.isBackwards?($.sibling=_.child,_.child=$):(g=F.last,g!==null?g.sibling=$:_.child=$,F.last=$)}return F.tail!==null?(_=F.tail,F.rendering=_,F.tail=_.sibling,F.renderingStartTime=Bi(),_.sibling=null,g=li.current,It(li,R?g&1|2:g&1),_):(Ci(_),null);case 22:case 23:return X_(),R=_.memoizedState!==null,g!==null&&g.memoizedState!==null!==R&&(_.flags|=8192),R&&(_.mode&1)!==0?(Fs&1073741824)!==0&&(Ci(_),Rt&&_.subtreeFlags&6&&(_.flags|=8192)):Ci(_),null;case 24:return null;case 25:return null}throw Error(o(156,_.tag))}var U_=a.ReactCurrentOwner,Lr=!1;function Hi(g,_,A,R){_.child=g===null?ym(_,null,A,R):cs(_,g.child,A,R)}function gi(g,_,A,R,F){A=A.render;var $=_.ref;return wc(_,F),R=qo(g,_,A,R,$,F),A=Ka(),g!==null&&!Lr?(_.updateQueue=g.updateQueue,_.flags&=-2053,g.lanes&=~F,Js(g,_,F)):(zn&&A&&vd(_),_.flags|=1,Hi(g,_,R,F),_.child)}function ci(g,_,A,R,F){if(g===null){var $=A.type;return typeof $=="function"&&!Nd($)&&$.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(_.tag=15,_.type=$,Bl(g,_,$,R,F)):(g=Dd(A.type,null,R,_,_.mode,F),g.ref=_.ref,g.return=_,_.child=g)}if($=g.child,(g.lanes&F)===0){var oe=$.memoizedProps;if(A=A.compare,A=A!==null?A:wo,A(oe,R)&&g.ref===_.ref)return Js(g,_,F)}return _.flags|=1,g=Xl($,R),g.ref=_.ref,g.return=_,_.child=g}function Bl(g,_,A,R,F){if(g!==null&&wo(g.memoizedProps,R)&&g.ref===_.ref)if(Lr=!1,(g.lanes&F)!==0)(g.flags&131072)!==0&&(Lr=!0);else return _.lanes=g.lanes,Js(g,_,F);return zl(g,_,A,R,F)}function qr(g,_,A){var R=_.pendingProps,F=R.children,$=g!==null?g.memoizedState:null;if(R.mode==="hidden")if((_.mode&1)===0)_.memoizedState={baseLanes:0,cachePool:null},It($l,Fs),Fs|=A;else if((A&1073741824)!==0)_.memoizedState={baseLanes:0,cachePool:null},R=$!==null?$.baseLanes:A,It($l,Fs),Fs|=R;else return g=$!==null?$.baseLanes|A:A,_.lanes=_.childLanes=1073741824,_.memoizedState={baseLanes:g,cachePool:null},_.updateQueue=null,It($l,Fs),Fs|=g,null;else $!==null?(R=$.baseLanes|A,_.memoizedState=null):R=A,It($l,Fs),Fs|=R;return Hi(g,_,F,A),_.child}function Os(g,_){var A=_.ref;(g===null&&A!==null||g!==null&&g.ref!==A)&&(_.flags|=512,_.flags|=2097152)}function zl(g,_,A,R,F){var $=bi(A)?Xr:Wt.current;return $=Fi(_,$),wc(_,F),A=qo(g,_,A,R,$,F),R=Ka(),g!==null&&!Lr?(_.updateQueue=g.updateQueue,_.flags&=-2053,g.lanes&=~F,Js(g,_,F)):(zn&&R&&vd(_),_.flags|=1,Hi(g,_,A,F),_.child)}function Ru(g,_,A,R,F){if(bi(A)){var $=!0;ki(_)}else $=!1;if(wc(_,F),_.stateNode===null)g!==null&&(g.alternate=null,_.alternate=null,_.flags|=2),_d(_,A,R),wa(_,A,R,F),R=!0;else if(g===null){var oe=_.stateNode,we=_.memoizedProps;oe.props=we;var Xe=oe.context,_t=A.contextType;typeof _t=="object"&&_t!==null?_t=wi(_t):(_t=bi(A)?Xr:Wt.current,_t=Fi(_,_t));var Nt=A.getDerivedStateFromProps,_n=typeof Nt=="function"||typeof oe.getSnapshotBeforeUpdate=="function";_n||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(we!==R||Xe!==_t)&&bu(_,oe,R,_t),As=!1;var tn=_.memoizedState;oe.state=tn,vu(_,R,oe,F),Xe=_.memoizedState,we!==R||tn!==Xe||ai.current||As?(typeof Nt=="function"&&(xu(_,A,Nt,R),Xe=_.memoizedState),(we=As||Nh(_,A,we,R,tn,Xe,_t))?(_n||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount()),typeof oe.componentDidMount=="function"&&(_.flags|=4194308)):(typeof oe.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=R,_.memoizedState=Xe),oe.props=R,oe.state=Xe,oe.context=_t,R=we):(typeof oe.componentDidMount=="function"&&(_.flags|=4194308),R=!1)}else{oe=_.stateNode,kh(g,_),we=_.memoizedProps,_t=_.type===_.elementType?we:sr(_.type,we),oe.props=_t,_n=_.pendingProps,tn=oe.context,Xe=A.contextType,typeof Xe=="object"&&Xe!==null?Xe=wi(Xe):(Xe=bi(A)?Xr:Wt.current,Xe=Fi(_,Xe));var ui=A.getDerivedStateFromProps;(Nt=typeof ui=="function"||typeof oe.getSnapshotBeforeUpdate=="function")||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(we!==_n||tn!==Xe)&&bu(_,oe,R,Xe),As=!1,tn=_.memoizedState,oe.state=tn,vu(_,R,oe,F);var Pt=_.memoizedState;we!==_n||tn!==Pt||ai.current||As?(typeof ui=="function"&&(xu(_,A,ui,R),Pt=_.memoizedState),(_t=As||Nh(_,A,_t,R,tn,Pt,Xe)||!1)?(Nt||typeof oe.UNSAFE_componentWillUpdate!="function"&&typeof oe.componentWillUpdate!="function"||(typeof oe.componentWillUpdate=="function"&&oe.componentWillUpdate(R,Pt,Xe),typeof oe.UNSAFE_componentWillUpdate=="function"&&oe.UNSAFE_componentWillUpdate(R,Pt,Xe)),typeof oe.componentDidUpdate=="function"&&(_.flags|=4),typeof oe.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof oe.componentDidUpdate!="function"||we===g.memoizedProps&&tn===g.memoizedState||(_.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||we===g.memoizedProps&&tn===g.memoizedState||(_.flags|=1024),_.memoizedProps=R,_.memoizedState=Pt),oe.props=R,oe.state=Pt,oe.context=Xe,R=_t):(typeof oe.componentDidUpdate!="function"||we===g.memoizedProps&&tn===g.memoizedState||(_.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||we===g.memoizedProps&&tn===g.memoizedState||(_.flags|=1024),R=!1)}return ps(g,_,A,R,$,F)}function ps(g,_,A,R,F,$){Os(g,_);var oe=(_.flags&128)!==0;if(!R&&!oe)return F&&Ki(_,A,!1),Js(g,_,$);R=_.stateNode,U_.current=_;var we=oe&&typeof A.getDerivedStateFromError!="function"?null:R.render();return _.flags|=1,g!==null&&oe?(_.child=cs(_,g.child,null,$),_.child=cs(_,null,we,$)):Hi(g,_,we,$),_.memoizedState=R.state,F&&Ki(_,A,!0),_.child}function Sd(g){var _=g.stateNode;_.pendingContext?Fn(g,_.pendingContext,_.pendingContext!==_.context):_.context&&Fn(g,_.context,!1),Ec(g,_.containerInfo)}function B_(g,_,A,R,F){return Ea(),Dh(F),_.flags|=256,Hi(g,_,A,R),_.child}var Td={dehydrated:null,treeContext:null,retryLane:0};function Iu(g){return{baseLanes:g,cachePool:null}}function z_(g,_,A){var R=_.pendingProps,F=li.current,$=!1,oe=(_.flags&128)!==0,we;if((we=oe)||(we=g!==null&&g.memoizedState===null?!1:(F&2)!==0),we?($=!0,_.flags&=-129):(g===null||g.memoizedState!==null)&&(F|=1),It(li,F&1),g===null)return Eo(_),g=_.memoizedState,g!==null&&(g=g.dehydrated,g!==null)?((_.mode&1)===0?_.lanes=1:rr(g)?_.lanes=8:_.lanes=1073741824,null):(F=R.children,g=R.fallback,$?(R=_.mode,$=_.child,F={mode:"hidden",children:F},(R&1)===0&&$!==null?($.childLanes=0,$.pendingProps=F):$=rf(F,R,0,null),g=Uc(g,R,A,null),$.return=_,g.return=_,$.sibling=g,_.child=$,_.child.memoizedState=Iu(A),_.memoizedState=Td,g):Ra(_,F));if(F=g.memoizedState,F!==null){if(we=F.dehydrated,we!==null){if(oe)return _.flags&256?(_.flags&=-257,Ad(g,_,A,Error(o(422)))):_.memoizedState!==null?(_.child=g.child,_.flags|=128,null):($=R.fallback,F=_.mode,R=rf({mode:"visible",children:R.children},F,0,null),$=Uc($,F,A,null),$.flags|=2,R.return=_,$.return=_,R.sibling=$,_.child=R,(_.mode&1)!==0&&cs(_,g.child,null,A),_.child.memoizedState=Iu(A),_.memoizedState=Td,$);if((_.mode&1)===0)_=Ad(g,_,A,null);else if(rr(we))_=Ad(g,_,A,Error(o(419)));else if(R=(A&g.childLanes)!==0,Lr||R){if(R=Li,R!==null){switch(A&-A){case 4:$=2;break;case 16:$=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:$=32;break;case 536870912:$=268435456;break;default:$=0}R=($&(R.suspendedLanes|A))!==0?0:$,R!==0&&R!==F.retryLane&&(F.retryLane=R,eo(g,R,-1))}Id(),_=Ad(g,_,A,Error(o(421)))}else du(we)?(_.flags|=128,_.child=g.child,_=Z0.bind(null,g),Lt(we,_),_=null):(A=F.treeContext,nt&&(yr=mu(we),zi=_,zn=!0,vr=null,Tc=!1,A!==null&&(Cs[Ps++]=To,Cs[Ps++]=Ta,Cs[Ps++]=Sa,To=A.id,Ta=A.overflow,Sa=_)),_=Ra(_,_.pendingProps.children),_.flags|=4096);return _}return $?(R=xm(g,_,R.children,R.fallback,A),$=_.child,F=g.child.memoizedState,$.memoizedState=F===null?Iu(A):{baseLanes:F.baseLanes|A,cachePool:null},$.childLanes=g.childLanes&~A,_.memoizedState=Td,R):(A=Ed(g,_,R.children,A),_.memoizedState=null,A)}return $?(R=xm(g,_,R.children,R.fallback,A),$=_.child,F=g.child.memoizedState,$.memoizedState=F===null?Iu(A):{baseLanes:F.baseLanes|A,cachePool:null},$.childLanes=g.childLanes&~A,_.memoizedState=Td,R):(A=Ed(g,_,R.children,A),_.memoizedState=null,A)}function Ra(g,_){return _=rf({mode:"visible",children:_},g.mode,0,null),_.return=g,g.child=_}function Ed(g,_,A,R){var F=g.child;return g=F.sibling,A=Xl(F,{mode:"visible",children:A}),(_.mode&1)===0&&(A.lanes=R),A.return=_,A.sibling=null,g!==null&&(R=_.deletions,R===null?(_.deletions=[g],_.flags|=16):R.push(g)),_.child=A}function xm(g,_,A,R,F){var $=_.mode;g=g.child;var oe=g.sibling,we={mode:"hidden",children:A};return($&1)===0&&_.child!==g?(A=_.child,A.childLanes=0,A.pendingProps=we,_.deletions=null):(A=Xl(g,we),A.subtreeFlags=g.subtreeFlags&14680064),oe!==null?R=Xl(oe,R):(R=Uc(R,$,F,null),R.flags|=2),R.return=_,A.return=_,A.sibling=R,_.child=A,R}function Ad(g,_,A,R){return R!==null&&Dh(R),cs(_,g.child,null,A),g=Ra(_,_.pendingProps.children),g.flags|=2,_.memoizedState=null,g}function X0(g,_,A){g.lanes|=_;var R=g.alternate;R!==null&&(R.lanes|=_),ba(g.return,_,A)}function tl(g,_,A,R,F){var $=g.memoizedState;$===null?g.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:R,tail:A,tailMode:F}:($.isBackwards=_,$.rendering=null,$.renderingStartTime=0,$.last=R,$.tail=A,$.tailMode=F)}function ku(g,_,A){var R=_.pendingProps,F=R.revealOrder,$=R.tail;if(Hi(g,_,R.children,A),R=li.current,(R&2)!==0)R=R&1|2,_.flags|=128;else{if(g!==null&&(g.flags&128)!==0)e:for(g=_.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&X0(g,A,_);else if(g.tag===19)X0(g,A,_);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===_)break e;for(;g.sibling===null;){if(g.return===null||g.return===_)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}R&=1}if(It(li,R),(_.mode&1)===0)_.memoizedState=null;else switch(F){case"forwards":for(A=_.child,F=null;A!==null;)g=A.alternate,g!==null&&Tu(g)===null&&(F=A),A=A.sibling;A=F,A===null?(F=_.child,_.child=null):(F=A.sibling,A.sibling=null),tl(_,!1,F,A,$);break;case"backwards":for(A=null,F=_.child,_.child=null;F!==null;){if(g=F.alternate,g!==null&&Tu(g)===null){_.child=F;break}g=F.sibling,F.sibling=A,A=F,F=g}tl(_,!0,A,null,$);break;case"together":tl(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function Js(g,_,A){if(g!==null&&(_.dependencies=g.dependencies),Nu|=_.lanes,(A&_.childLanes)===0)return null;if(g!==null&&_.child!==g.child)throw Error(o(153));if(_.child!==null){for(g=_.child,A=Xl(g,g.pendingProps),_.child=A,A.return=_;g.sibling!==null;)g=g.sibling,A=A.sibling=Xl(g,g.pendingProps),A.return=_;A.sibling=null}return _.child}function bm(g,_,A){switch(_.tag){case 3:Sd(_),Ea();break;case 5:Il(_);break;case 1:bi(_.type)&&ki(_);break;case 4:Ec(_,_.stateNode.containerInfo);break;case 10:Cl(_,_.type._context,_.memoizedProps.value);break;case 13:var R=_.memoizedState;if(R!==null)return R.dehydrated!==null?(It(li,li.current&1),_.flags|=128,null):(A&_.child.childLanes)!==0?z_(g,_,A):(It(li,li.current&1),g=Js(g,_,A),g!==null?g.sibling:null);It(li,li.current&1);break;case 19:if(R=(A&_.childLanes)!==0,(g.flags&128)!==0){if(R)return ku(g,_,A);_.flags|=128}var F=_.memoizedState;if(F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),It(li,li.current),R)break;return null;case 22:case 23:return _.lanes=0,qr(g,_,A)}return Js(g,_,A)}function wm(g,_){switch(Rs(_),_.tag){case 1:return bi(_.type)&&Dt(),g=_.flags,g&65536?(_.flags=g&-65537|128,_):null;case 3:return Ma(),$t(ai),$t(Wt),Xo(),g=_.flags,(g&65536)!==0&&(g&128)===0?(_.flags=g&-65537|128,_):null;case 5:return Ac(_),null;case 13:if($t(li),g=_.memoizedState,g!==null&&g.dehydrated!==null){if(_.alternate===null)throw Error(o(340));Ea()}return g=_.flags,g&65536?(_.flags=g&-65537|128,_):null;case 19:return $t(li),null;case 4:return Ma(),null;case 10:return _u(_.type._context),null;case 22:case 23:return X_(),null;case 24:return null;default:return null}}var Ls=!1,Nr=!1,Ou=typeof WeakSet=="function"?WeakSet:Set,xt=null;function Ko(g,_){var A=g.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(R){Bs(g,_,R)}else A.current=null}function Vl(g,_,A){try{A()}catch(R){Bs(g,_,R)}}var V_=!1;function H_(g,_){for(ie(g.containerInfo),xt=_;xt!==null;)if(g=xt,_=g.child,(g.subtreeFlags&1028)!==0&&_!==null)_.return=g,xt=_;else for(;xt!==null;){g=xt;try{var A=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var R=A.memoizedProps,F=A.memoizedState,$=g.stateNode,oe=$.getSnapshotBeforeUpdate(g.elementType===g.type?R:sr(g.type,R),F);$.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:Rt&&mt(g.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(we){Bs(g,g.return,we)}if(_=g.sibling,_!==null){_.return=g.return,xt=_;break}xt=g.return}return A=V_,V_=!1,A}function Hl(g,_,A){var R=_.updateQueue;if(R=R!==null?R.lastEffect:null,R!==null){var F=R=R.next;do{if((F.tag&g)===g){var $=F.destroy;F.destroy=void 0,$!==void 0&&Vl(_,A,$)}F=F.next}while(F!==R)}}function Zr(g,_){if(_=_.updateQueue,_=_!==null?_.lastEffect:null,_!==null){var A=_=_.next;do{if((A.tag&g)===g){var R=A.create;A.destroy=R()}A=A.next}while(A!==_)}}function Ns(g){var _=g.ref;if(_!==null){var A=g.stateNode;switch(g.tag){case 5:g=ve(A);break;default:g=A}typeof _=="function"?_(g):_.current=g}}function Si(g,_,A){if(as&&typeof as.onCommitFiberUnmount=="function")try{as.onCommitFiberUnmount(Al,_)}catch{}switch(_.tag){case 0:case 11:case 14:case 15:if(g=_.updateQueue,g!==null&&(g=g.lastEffect,g!==null)){var R=g=g.next;do{var F=R,$=F.destroy;F=F.tag,$!==void 0&&((F&2)!==0||(F&4)!==0)&&Vl(_,A,$),R=R.next}while(R!==g)}break;case 1:if(Ko(_,A),g=_.stateNode,typeof g.componentWillUnmount=="function")try{g.props=_.memoizedProps,g.state=_.memoizedState,g.componentWillUnmount()}catch(oe){Bs(_,A,oe)}break;case 5:Ko(_,A);break;case 4:Rt?$_(g,_,A):he&&he&&(_=_.stateNode.containerInfo,A=Ge(_),vn(_,A))}}function Jo(g,_,A){for(var R=_;;)if(Si(g,R,A),R.child===null||Rt&&R.tag===4){if(R===_)break;for(;R.sibling===null;){if(R.return===null||R.return===_)return;R=R.return}R.sibling.return=R.return,R=R.sibling}else R.child.return=R,R=R.child}function W_(g){var _=g.alternate;_!==null&&(g.alternate=null,W_(_)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(_=g.stateNode,_!==null&&Ut(_)),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function j_(g){return g.tag===5||g.tag===3||g.tag===4}function Sm(g){e:for(;;){for(;g.sibling===null;){if(g.return===null||j_(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.flags&2||g.child===null||g.tag===4)continue e;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function Tm(g){if(Rt){e:{for(var _=g.return;_!==null;){if(j_(_))break e;_=_.return}throw Error(o(160))}var A=_;switch(A.tag){case 5:_=A.stateNode,A.flags&32&&($e(_),A.flags&=-33),A=Sm(g),Xh(g,A,_);break;case 3:case 4:_=A.stateNode.containerInfo,A=Sm(g),Em(g,A,_);break;default:throw Error(o(161))}}}function Em(g,_,A){var R=g.tag;if(R===5||R===6)g=g.stateNode,_?ht(A,g,_):Bt(A,g);else if(R!==4&&(g=g.child,g!==null))for(Em(g,_,A),g=g.sibling;g!==null;)Em(g,_,A),g=g.sibling}function Xh(g,_,A){var R=g.tag;if(R===5||R===6)g=g.stateNode,_?Mn(A,g,_):ot(A,g);else if(R!==4&&(g=g.child,g!==null))for(Xh(g,_,A),g=g.sibling;g!==null;)Xh(g,_,A),g=g.sibling}function $_(g,_,A){for(var R=_,F=!1,$,oe;;){if(!F){F=R.return;e:for(;;){if(F===null)throw Error(o(160));switch($=F.stateNode,F.tag){case 5:oe=!1;break e;case 3:$=$.containerInfo,oe=!0;break e;case 4:$=$.containerInfo,oe=!0;break e}F=F.return}F=!0}if(R.tag===5||R.tag===6)Jo(g,R,A),oe?pe($,R.stateNode):Ln($,R.stateNode);else if(R.tag===18)oe?je($,R.stateNode):He($,R.stateNode);else if(R.tag===4){if(R.child!==null){$=R.stateNode.containerInfo,oe=!0,R.child.return=R,R=R.child;continue}}else if(Si(g,R,A),R.child!==null){R.child.return=R,R=R.child;continue}if(R===_)break;for(;R.sibling===null;){if(R.return===null||R.return===_)return;R=R.return,R.tag===4&&(F=!1)}R.sibling.return=R.return,R=R.sibling}}function Rc(g,_){if(Rt){switch(_.tag){case 0:case 11:case 14:case 15:Hl(3,_,_.return),Zr(3,_),Hl(5,_,_.return);return;case 1:return;case 5:var A=_.stateNode;if(A!=null){var R=_.memoizedProps;g=g!==null?g.memoizedProps:R;var F=_.type,$=_.updateQueue;_.updateQueue=null,$!==null&&nn(A,$,F,g,R,_)}return;case 6:if(_.stateNode===null)throw Error(o(162));A=_.memoizedProps,dt(_.stateNode,g!==null?g.memoizedProps:A,A);return;case 3:nt&&g!==null&&g.memoizedState.isDehydrated&&Pe(_.stateNode.containerInfo);return;case 12:return;case 13:Gh(_);return;case 19:Gh(_);return;case 17:return}throw Error(o(163))}switch(_.tag){case 0:case 11:case 14:case 15:Hl(3,_,_.return),Zr(3,_),Hl(5,_,_.return);return;case 12:return;case 13:Gh(_);return;case 19:Gh(_);return;case 3:nt&&g!==null&&g.memoizedState.isDehydrated&&Pe(_.stateNode.containerInfo);break;case 22:case 23:return}e:if(he){switch(_.tag){case 1:case 5:case 6:break e;case 3:case 4:_=_.stateNode,vn(_.containerInfo,_.pendingChildren);break e}throw Error(o(163))}}function Gh(g){var _=g.updateQueue;if(_!==null){g.updateQueue=null;var A=g.stateNode;A===null&&(A=g.stateNode=new Ou),_.forEach(function(R){var F=Od.bind(null,g,R);A.has(R)||(A.add(R),R.then(F,F))})}}function ZT(g,_){for(xt=_;xt!==null;){_=xt;var A=_.deletions;if(A!==null)for(var R=0;R<A.length;R++){var F=A[R];try{var $=g;Rt?$_($,F,_):Jo($,F,_);var oe=F.alternate;oe!==null&&(oe.return=null),F.return=null}catch(Xt){Bs(F,_,Xt)}}if(A=_.child,(_.subtreeFlags&12854)!==0&&A!==null)A.return=_,xt=A;else for(;xt!==null;){_=xt;try{var we=_.flags;if(we&32&&Rt&&$e(_.stateNode),we&512){var Xe=_.alternate;if(Xe!==null){var _t=Xe.ref;_t!==null&&(typeof _t=="function"?_t(null):_t.current=null)}}if(we&8192)switch(_.tag){case 13:if(_.memoizedState!==null){var Nt=_.alternate;(Nt===null||Nt.memoizedState===null)&&(Cm=Bi())}break;case 22:var _n=_.memoizedState!==null,tn=_.alternate,ui=tn!==null&&tn.memoizedState!==null;if(A=_,Rt){e:if(R=A,F=_n,$=null,Rt)for(var Pt=R;;){if(Pt.tag===5){if($===null){$=Pt;var Zn=Pt.stateNode;F?it(Zn):jt(Pt.stateNode,Pt.memoizedProps)}}else if(Pt.tag===6){if($===null){var Ro=Pt.stateNode;F?tt(Ro):ye(Ro,Pt.memoizedProps)}}else if((Pt.tag!==22&&Pt.tag!==23||Pt.memoizedState===null||Pt===R)&&Pt.child!==null){Pt.child.return=Pt,Pt=Pt.child;continue}if(Pt===R)break;for(;Pt.sibling===null;){if(Pt.return===null||Pt.return===R)break e;$===Pt&&($=null),Pt=Pt.return}$===Pt&&($=null),Pt.sibling.return=Pt.return,Pt=Pt.sibling}}if(_n&&!ui&&(A.mode&1)!==0){xt=A;for(var Le=A.child;Le!==null;){for(A=xt=Le;xt!==null;){R=xt;var Ee=R.child;switch(R.tag){case 0:case 11:case 14:case 15:Hl(4,R,R.return);break;case 1:Ko(R,R.return);var We=R.stateNode;if(typeof We.componentWillUnmount=="function"){var At=R.return;try{We.props=R.memoizedProps,We.state=R.memoizedState,We.componentWillUnmount()}catch(Xt){Bs(R,At,Xt)}}break;case 5:Ko(R,R.return);break;case 22:if(R.memoizedState!==null){Lu(A);continue}}Ee!==null?(Ee.return=R,xt=Ee):Lu(A)}Le=Le.sibling}}}switch(we&4102){case 2:Tm(_),_.flags&=-3;break;case 6:Tm(_),_.flags&=-3,Rc(_.alternate,_);break;case 4096:_.flags&=-4097;break;case 4100:_.flags&=-4097,Rc(_.alternate,_);break;case 4:Rc(_.alternate,_)}}catch(Xt){Bs(_,_.return,Xt)}if(A=_.sibling,A!==null){A.return=_.return,xt=A;break}xt=_.return}}}function Ia(g,_,A){xt=g,Md(g)}function Md(g,_,A){for(var R=(g.mode&1)!==0;xt!==null;){var F=xt,$=F.child;if(F.tag===22&&R){var oe=F.memoizedState!==null||Ls;if(!oe){var we=F.alternate,Xe=we!==null&&we.memoizedState!==null||Nr;we=Ls;var _t=Nr;if(Ls=oe,(Nr=Xe)&&!_t)for(xt=F;xt!==null;)oe=xt,Xe=oe.child,oe.tag===22&&oe.memoizedState!==null?Am(F):Xe!==null?(Xe.return=oe,xt=Xe):Am(F);for(;$!==null;)xt=$,Md($),$=$.sibling;xt=F,Ls=we,Nr=_t}Cd(g)}else(F.subtreeFlags&8772)!==0&&$!==null?($.return=F,xt=$):Cd(g)}}function Cd(g){for(;xt!==null;){var _=xt;if((_.flags&8772)!==0){var A=_.alternate;try{if((_.flags&8772)!==0)switch(_.tag){case 0:case 11:case 15:Nr||Zr(5,_);break;case 1:var R=_.stateNode;if(_.flags&4&&!Nr)if(A===null)R.componentDidMount();else{var F=_.elementType===_.type?A.memoizedProps:sr(_.type,A.memoizedProps);R.componentDidUpdate(F,A.memoizedState,R.__reactInternalSnapshotBeforeUpdate)}var $=_.updateQueue;$!==null&&pm(_,$,R);break;case 3:var oe=_.updateQueue;if(oe!==null){if(A=null,_.child!==null)switch(_.child.tag){case 5:A=ve(_.child.stateNode);break;case 1:A=_.child.stateNode}pm(_,oe,A)}break;case 5:var we=_.stateNode;A===null&&_.flags&4&&vt(we,_.type,_.memoizedProps,_);break;case 6:break;case 4:break;case 12:break;case 13:if(nt&&_.memoizedState===null){var Xe=_.alternate;if(Xe!==null){var _t=Xe.memoizedState;if(_t!==null){var Nt=_t.dehydrated;Nt!==null&&ze(Nt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Nr||_.flags&512&&Ns(_)}catch(_n){Bs(_,_.return,_n)}}if(_===g){xt=null;break}if(A=_.sibling,A!==null){A.return=_.return,xt=A;break}xt=_.return}}function Lu(g){for(;xt!==null;){var _=xt;if(_===g){xt=null;break}var A=_.sibling;if(A!==null){A.return=_.return,xt=A;break}xt=_.return}}function Am(g){for(;xt!==null;){var _=xt;try{switch(_.tag){case 0:case 11:case 15:var A=_.return;try{Zr(4,_)}catch(Xe){Bs(_,A,Xe)}break;case 1:var R=_.stateNode;if(typeof R.componentDidMount=="function"){var F=_.return;try{R.componentDidMount()}catch(Xe){Bs(_,F,Xe)}}var $=_.return;try{Ns(_)}catch(Xe){Bs(_,$,Xe)}break;case 5:var oe=_.return;try{Ns(_)}catch(Xe){Bs(_,oe,Xe)}}}catch(Xe){Bs(_,_.return,Xe)}if(_===g){xt=null;break}var we=_.sibling;if(we!==null){we.return=_.return,xt=we;break}xt=_.return}}var Yh=0,qh=1,Zh=2,Wl=3,Ds=4;if(typeof Symbol=="function"&&Symbol.for){var ka=Symbol.for;Yh=ka("selector.component"),qh=ka("selector.has_pseudo_class"),Zh=ka("selector.role"),Wl=ka("selector.test_id"),Ds=ka("selector.text")}function Pd(g){var _=Ye(g);if(_!=null){if(typeof _.memoizedProps["data-testname"]!="string")throw Error(o(364));return _}if(g=ln(g),g===null)throw Error(o(362));return g.stateNode.current}function Mm(g,_){switch(_.$$typeof){case Yh:if(g.type===_.value)return!0;break;case qh:e:{_=_.value,g=[g,0];for(var A=0;A<g.length;){var R=g[A++],F=g[A++],$=_[F];if(R.tag!==5||!Q(R)){for(;$!=null&&Mm(R,$);)F++,$=_[F];if(F===_.length){_=!0;break e}else for(R=R.child;R!==null;)g.push(R,F),R=R.sibling}}_=!1}return _;case Zh:if(g.tag===5&&Ne(g.stateNode,_.value))return!0;break;case Ds:if((g.tag===5||g.tag===6)&&(g=ae(g),g!==null&&0<=g.indexOf(_.value)))return!0;break;case Wl:if(g.tag===5&&(g=g.memoizedProps["data-testname"],typeof g=="string"&&g.toLowerCase()===_.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Oa(g){switch(g.$$typeof){case Yh:return"<"+(H(g.value)||"Unknown")+">";case qh:return":has("+(Oa(g)||"")+")";case Zh:return'[role="'+g.value+'"]';case Ds:return'"'+g.value+'"';case Wl:return'[data-testname="'+g.value+'"]';default:throw Error(o(365))}}function jl(g,_){var A=[];g=[g,0];for(var R=0;R<g.length;){var F=g[R++],$=g[R++],oe=_[$];if(F.tag!==5||!Q(F)){for(;oe!=null&&Mm(F,oe);)$++,oe=_[$];if($===_.length)A.push(F);else for(F=F.child;F!==null;)g.push(F,$),F=F.sibling}}return A}function Rd(g,_){if(!Zt)throw Error(o(363));g=Pd(g),g=jl(g,_),_=[],g=Array.from(g);for(var A=0;A<g.length;){var R=g[A++];if(R.tag===5)Q(R)||_.push(R.stateNode);else for(R=R.child;R!==null;)g.push(R),R=R.sibling}return _}var G0=Math.ceil,Qo=a.ReactCurrentDispatcher,nl=a.ReactCurrentOwner,Pi=a.ReactCurrentBatchConfig,En=0,Li=null,er=null,Dr=0,Fs=0,$l=Mi(0),ar=0,Kh=null,Nu=0,Jh=0,Du=0,Ic=null,Us=null,Cm=0,kc=1/0;function Fu(){kc=Bi()+500}var Oc=!1,ea=null,ta=null,Lc=!1,Qs=null,Qh=0,il=0,Pm=null,ef=-1,_i=0;function Fr(){return(En&6)!==0?Bi():ef!==-1?ef:ef=Bi()}function rl(g){return(g.mode&1)===0?1:(En&2)!==0&&Dr!==0?Dr&-Dr:Nn.transition!==null?(_i===0&&(g=Xs,Xs<<=1,(Xs&4194240)===0&&(Xs=64),_i=g),_i):(g=xn,g!==0?g:Ke())}function eo(g,_,A){if(50<il)throw il=0,Pm=null,Error(o(185));var R=Uu(g,_);return R===null?null:(va(R,_,A),((En&2)===0||R!==Li)&&(R===Li&&((En&2)===0&&(Jh|=_),ar===4&&La(R,Dr)),ms(R,A),_===1&&En===0&&(g.mode&1)===0&&(Fu(),Ch&&Ts())),R)}function Uu(g,_){g.lanes|=_;var A=g.alternate;for(A!==null&&(A.lanes|=_),A=g,g=g.return;g!==null;)g.childLanes|=_,A=g.alternate,A!==null&&(A.childLanes|=_),A=g,g=g.return;return A.tag===3?A.stateNode:null}function ms(g,_){var A=g.callbackNode;Mh(g,_);var R=wl(g,g===Li?Dr:0);if(R===0)A!==null&&cn(A),g.callbackNode=null,g.callbackPriority=0;else if(_=R&-R,g.callbackPriority!==_){if(A!=null&&cn(A),_===1)g.tag===0?Rh(tf.bind(null,g)):xc(tf.bind(null,g)),bt?Ct(function(){En===0&&Ts()}):El(xa,Ts),A=null;else{switch(xo(R)){case 1:A=xa;break;case 4:A=gd;break;case 16:A=vc;break;case 536870912:A=Wo;break;default:A=vc}A=Ld(A,Nc.bind(null,g))}g.callbackPriority=_,g.callbackNode=A}}function Nc(g,_){if(ef=-1,_i=0,(En&6)!==0)throw Error(o(327));var A=g.callbackNode;if(Fc()&&g.callbackNode!==A)return null;var R=wl(g,g===Li?Dr:0);if(R===0)return null;if((R&30)!==0||(R&g.expiredLanes)!==0||_)_=Co(g,R);else{_=R;var F=En;En|=2;var $=Im();(Li!==g||Dr!==_)&&(Fu(),Wi(g,_));do try{kd();break}catch(we){Rm(g,we)}while(!0);kr(),Qo.current=$,En=F,er!==null?_=0:(Li=null,Dr=0,_=ar)}if(_!==0){if(_===2&&(F=_c(g),F!==0&&(R=F,_=Ti(g,F))),_===1)throw A=Kh,Wi(g,0),La(g,R),ms(g,Bi()),A;if(_===6)La(g,R);else{if(F=g.current.alternate,(R&30)===0&&!Ur(F)&&(_=Co(g,R),_===2&&($=_c(g),$!==0&&(R=$,_=Ti(g,$))),_===1))throw A=Kh,Wi(g,0),La(g,R),ms(g,Bi()),A;switch(g.finishedWork=F,g.finishedLanes=R,_){case 0:case 1:throw Error(o(345));case 2:Dc(g,Us);break;case 3:if(La(g,R),(R&130023424)===R&&(_=Cm+500-Bi(),10<_)){if(wl(g,0)!==0)break;if(F=g.suspendedLanes,(F&R)!==R){Fr(),g.pingedLanes|=g.suspendedLanes&F;break}g.timeoutHandle=at(Dc.bind(null,g,Us),_);break}Dc(g,Us);break;case 4:if(La(g,R),(R&4194240)===R)break;for(_=g.eventTimes,F=-1;0<R;){var oe=31-os(R);$=1<<oe,oe=_[oe],oe>F&&(F=oe),R&=~$}if(R=F,R=Bi()-R,R=(120>R?120:480>R?480:1080>R?1080:1920>R?1920:3e3>R?3e3:4320>R?4320:1960*G0(R/1960))-R,10<R){g.timeoutHandle=at(Dc.bind(null,g,Us),R);break}Dc(g,Us);break;case 5:Dc(g,Us);break;default:throw Error(o(329))}}}return ms(g,Bi()),g.callbackNode===A?Nc.bind(null,g):null}function Ti(g,_){var A=Ic;return g.current.memoizedState.isDehydrated&&(Wi(g,_).flags|=256),g=Co(g,_),g!==2&&(_=Us,Us=A,_!==null&&tr(_)),g}function tr(g){Us===null?Us=g:Us.push.apply(Us,g)}function Ur(g){for(var _=g;;){if(_.flags&16384){var A=_.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var R=0;R<A.length;R++){var F=A[R],$=F.getSnapshot;F=F.value;try{if(!Ir($(),F))return!1}catch{return!1}}}if(A=_.child,_.subtreeFlags&16384&&A!==null)A.return=_,_=A;else{if(_===g)break;for(;_.sibling===null;){if(_.return===null||_.return===g)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function La(g,_){for(_&=~Du,_&=~Jh,g.suspendedLanes|=_,g.pingedLanes&=~_,g=g.expirationTimes;0<_;){var A=31-os(_),R=1<<A;g[A]=-1,_&=~R}}function tf(g){if((En&6)!==0)throw Error(o(327));Fc();var _=wl(g,0);if((_&1)===0)return ms(g,Bi()),null;var A=Co(g,_);if(g.tag!==0&&A===2){var R=_c(g);R!==0&&(_=R,A=Ti(g,R))}if(A===1)throw A=Kh,Wi(g,0),La(g,_),ms(g,Bi()),A;if(A===6)throw Error(o(345));return g.finishedWork=g.current.alternate,g.finishedLanes=_,Dc(g,Us),ms(g,Bi()),null}function nf(g){Qs!==null&&Qs.tag===0&&(En&6)===0&&Fc();var _=En;En|=1;var A=Pi.transition,R=xn;try{if(Pi.transition=null,xn=1,g)return g()}finally{xn=R,Pi.transition=A,En=_,(En&6)===0&&Ts()}}function X_(){Fs=$l.current,$t($l)}function Wi(g,_){g.finishedWork=null,g.finishedLanes=0;var A=g.timeoutHandle;if(A!==Ft&&(g.timeoutHandle=Ft,pt(A)),er!==null)for(A=er.return;A!==null;){var R=A;switch(Rs(R),R.tag){case 1:R=R.type.childContextTypes,R!=null&&Dt();break;case 3:Ma(),$t(ai),$t(Wt),Xo();break;case 5:Ac(R);break;case 4:Ma();break;case 13:$t(li);break;case 19:$t(li);break;case 10:_u(R.type._context);break;case 22:case 23:X_()}A=A.return}if(Li=g,er=g=Xl(g.current,null),Dr=Fs=_,ar=0,Kh=null,Du=Jh=Nu=0,Us=Ic=null,Gs!==null){for(_=0;_<Gs.length;_++)if(A=Gs[_],R=A.interleaved,R!==null){A.interleaved=null;var F=R.next,$=A.pending;if($!==null){var oe=$.next;$.next=F,R.next=oe}A.pending=R}Gs=null}return g}function Rm(g,_){do{var A=er;try{if(kr(),Eu.current=wt,Ol){for(var R=mi.memoizedState;R!==null;){var F=R.queue;F!==null&&(F.pending=null),R=R.next}Ol=!1}if(kl=0,ei=or=mi=null,Go=!1,Yo=0,nl.current=null,A===null||A.return===null){ar=1,Kh=_,er=null;break}e:{var $=g,oe=A.return,we=A,Xe=_;if(_=Dr,we.flags|=32768,Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var _t=Xe,Nt=we,_n=Nt.tag;if((Nt.mode&1)===0&&(_n===0||_n===11||_n===15)){var tn=Nt.alternate;tn?(Nt.updateQueue=tn.updateQueue,Nt.memoizedState=tn.memoizedState,Nt.lanes=tn.lanes):(Nt.updateQueue=null,Nt.memoizedState=null)}var ui=wd(oe);if(ui!==null){ui.flags&=-257,Qa(ui,oe,we,$,_),ui.mode&1&&Pa($,_t,_),_=ui,Xe=_t;var Pt=_.updateQueue;if(Pt===null){var Zn=new Set;Zn.add(Xe),_.updateQueue=Zn}else Pt.add(Xe);break e}else{if((_&1)===0){Pa($,_t,_),Id();break e}Xe=Error(o(426))}}else if(zn&&we.mode&1){var Ro=wd(oe);if(Ro!==null){(Ro.flags&65536)===0&&(Ro.flags|=256),Qa(Ro,oe,we,$,_),Dh(Xe);break e}}$=Xe,ar!==4&&(ar=2),Ic===null?Ic=[$]:Ic.push($),Xe=Vi(Xe,we),we=oe;do{switch(we.tag){case 3:we.flags|=65536,_&=-_,we.lanes|=_;var Le=Fl(we,Xe,_);yu(we,Le);break e;case 1:$=Xe;var Ee=we.type,We=we.stateNode;if((we.flags&128)===0&&(typeof Ee.getDerivedStateFromError=="function"||We!==null&&typeof We.componentDidCatch=="function"&&(ta===null||!ta.has(We)))){we.flags|=65536,_&=-_,we.lanes|=_;var At=Hh(we,$,_);yu(we,At);break e}}we=we.return}while(we!==null)}Om(A)}catch(Xt){_=Xt,er===A&&A!==null&&(er=A=A.return);continue}break}while(!0)}function Im(){var g=Qo.current;return Qo.current=wt,g===null?wt:g}function Id(){(ar===0||ar===3||ar===2)&&(ar=4),Li===null||(Nu&268435455)===0&&(Jh&268435455)===0||La(Li,Dr)}function Co(g,_){var A=En;En|=2;var R=Im();Li===g&&Dr===_||Wi(g,_);do try{na();break}catch(F){Rm(g,F)}while(!0);if(kr(),En=A,Qo.current=R,er!==null)throw Error(o(261));return Li=null,Dr=0,ar}function na(){for(;er!==null;)km(er)}function kd(){for(;er!==null&&!_r();)km(er)}function km(g){var _=q_(g.alternate,g,Fs);g.memoizedProps=g.pendingProps,_===null?Om(g):er=_,nl.current=null}function Om(g){var _=g;do{var A=_.alternate;if(g=_.return,(_.flags&32768)===0){if(A=$h(A,_,Fs),A!==null){er=A;return}}else{if(A=wm(A,_),A!==null){A.flags&=32767,er=A;return}if(g!==null)g.flags|=32768,g.subtreeFlags=0,g.deletions=null;else{ar=6,er=null;return}}if(_=_.sibling,_!==null){er=_;return}er=_=g}while(_!==null);ar===0&&(ar=5)}function Dc(g,_){var A=xn,R=Pi.transition;try{Pi.transition=null,xn=1,Y0(g,_,A)}finally{Pi.transition=R,xn=A}return null}function Y0(g,_,A){do Fc();while(Qs!==null);if((En&6)!==0)throw Error(o(327));var R=g.finishedWork,F=g.finishedLanes;if(R===null)return null;if(g.finishedWork=null,g.finishedLanes=0,R===g.current)throw Error(o(177));g.callbackNode=null,g.callbackPriority=0;var $=R.lanes|R.childLanes;if(yc(g,$),g===Li&&(er=Li=null,Dr=0),(R.subtreeFlags&2064)===0&&(R.flags&2064)===0||Lc||(Lc=!0,Ld(vc,function(){return Fc(),null})),$=(R.flags&15990)!==0,(R.subtreeFlags&15990)!==0||$){$=Pi.transition,Pi.transition=null;var oe=xn;xn=1;var we=En;En|=4,nl.current=null,H_(g,R),ZT(g,R),X(g.containerInfo),g.current=R,Ia(R),si(),En=we,xn=oe,Pi.transition=$}else g.current=R;if(Lc&&(Lc=!1,Qs=g,Qh=F),$=g.pendingLanes,$===0&&(ta=null),Oi(R.stateNode),ms(g,Bi()),_!==null)for(A=g.onRecoverableError,R=0;R<_.length;R++)A(_[R]);if(Oc)throw Oc=!1,g=ea,ea=null,g;return(Qh&1)!==0&&g.tag!==0&&Fc(),$=g.pendingLanes,($&1)!==0?g===Pm?il++:(il=0,Pm=g):il=0,Ts(),null}function Fc(){if(Qs!==null){var g=xo(Qh),_=Pi.transition,A=xn;try{if(Pi.transition=null,xn=16>g?16:g,Qs===null)var R=!1;else{if(g=Qs,Qs=null,Qh=0,(En&6)!==0)throw Error(o(331));var F=En;for(En|=4,xt=g.current;xt!==null;){var $=xt,oe=$.child;if((xt.flags&16)!==0){var we=$.deletions;if(we!==null){for(var Xe=0;Xe<we.length;Xe++){var _t=we[Xe];for(xt=_t;xt!==null;){var Nt=xt;switch(Nt.tag){case 0:case 11:case 15:Hl(8,Nt,$)}var _n=Nt.child;if(_n!==null)_n.return=Nt,xt=_n;else for(;xt!==null;){Nt=xt;var tn=Nt.sibling,ui=Nt.return;if(W_(Nt),Nt===_t){xt=null;break}if(tn!==null){tn.return=ui,xt=tn;break}xt=ui}}}var Pt=$.alternate;if(Pt!==null){var Zn=Pt.child;if(Zn!==null){Pt.child=null;do{var Ro=Zn.sibling;Zn.sibling=null,Zn=Ro}while(Zn!==null)}}xt=$}}if(($.subtreeFlags&2064)!==0&&oe!==null)oe.return=$,xt=oe;else e:for(;xt!==null;){if($=xt,($.flags&2048)!==0)switch($.tag){case 0:case 11:case 15:Hl(9,$,$.return)}var Le=$.sibling;if(Le!==null){Le.return=$.return,xt=Le;break e}xt=$.return}}var Ee=g.current;for(xt=Ee;xt!==null;){oe=xt;var We=oe.child;if((oe.subtreeFlags&2064)!==0&&We!==null)We.return=oe,xt=We;else e:for(oe=Ee;xt!==null;){if(we=xt,(we.flags&2048)!==0)try{switch(we.tag){case 0:case 11:case 15:Zr(9,we)}}catch(Xt){Bs(we,we.return,Xt)}if(we===oe){xt=null;break e}var At=we.sibling;if(At!==null){At.return=we.return,xt=At;break e}xt=we.return}}if(En=F,Ts(),as&&typeof as.onPostCommitFiberRoot=="function")try{as.onPostCommitFiberRoot(Al,g)}catch{}R=!0}return R}finally{xn=A,Pi.transition=_}}return!1}function G_(g,_,A){_=Vi(A,_),_=Fl(g,_,1),$o(g,_),_=Fr(),g=Uu(g,1),g!==null&&(va(g,1,_),ms(g,_))}function Bs(g,_,A){if(g.tag===3)G_(g,g,A);else for(;_!==null;){if(_.tag===3){G_(_,g,A);break}else if(_.tag===1){var R=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(ta===null||!ta.has(R))){g=Vi(A,g),g=Hh(_,g,1),$o(_,g),g=Fr(),_=Uu(_,1),_!==null&&(va(_,1,g),ms(_,g));break}}_=_.return}}function q0(g,_,A){var R=g.pingCache;R!==null&&R.delete(_),_=Fr(),g.pingedLanes|=g.suspendedLanes&A,Li===g&&(Dr&A)===A&&(ar===4||ar===3&&(Dr&130023424)===Dr&&500>Bi()-Cm?Wi(g,0):Du|=A),ms(g,_)}function Y_(g,_){_===0&&((g.mode&1)===0?_=1:(_=In,In<<=1,(In&130023424)===0&&(In=4194304)));var A=Fr();g=Uu(g,_),g!==null&&(va(g,_,A),ms(g,A))}function Z0(g){var _=g.memoizedState,A=0;_!==null&&(A=_.retryLane),Y_(g,A)}function Od(g,_){var A=0;switch(g.tag){case 13:var R=g.stateNode,F=g.memoizedState;F!==null&&(A=F.retryLane);break;case 19:R=g.stateNode;break;default:throw Error(o(314))}R!==null&&R.delete(_),Y_(g,A)}var q_;q_=function(g,_,A){if(g!==null)if(g.memoizedProps!==_.pendingProps||ai.current)Lr=!0;else{if((g.lanes&A)===0&&(_.flags&128)===0)return Lr=!1,bm(g,_,A);Lr=(g.flags&131072)!==0}else Lr=!1,zn&&(_.flags&1048576)!==0&&yd(_,wu,_.index);switch(_.lanes=0,_.tag){case 2:var R=_.type;g!==null&&(g.alternate=null,_.alternate=null,_.flags|=2),g=_.pendingProps;var F=Fi(_,Wt.current);wc(_,A),F=qo(null,_,R,g,F,A);var $=Ka();return _.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(_.tag=1,_.memoizedState=null,_.updateQueue=null,bi(R)?($=!0,ki(_)):$=!1,_.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,Ms(_),F.updater=Lh,_.stateNode=F,F._reactInternals=_,wa(_,R,g,A),_=ps(null,_,R,!0,$,A)):(_.tag=0,zn&&$&&vd(_),Hi(null,_,F,A),_=_.child),_;case 16:R=_.elementType;e:{switch(g!==null&&(g.alternate=null,_.alternate=null,_.flags|=2),g=_.pendingProps,F=R._init,R=F(R._payload),_.type=R,F=_.tag=K0(R),g=sr(R,g),F){case 0:_=zl(null,_,R,g,A);break e;case 1:_=Ru(null,_,R,g,A);break e;case 11:_=gi(null,_,R,g,A);break e;case 14:_=ci(null,_,R,sr(R.type,g),A);break e}throw Error(o(306,R,""))}return _;case 0:return R=_.type,F=_.pendingProps,F=_.elementType===R?F:sr(R,F),zl(g,_,R,F,A);case 1:return R=_.type,F=_.pendingProps,F=_.elementType===R?F:sr(R,F),Ru(g,_,R,F,A);case 3:e:{if(Sd(_),g===null)throw Error(o(387));R=_.pendingProps,$=_.memoizedState,F=$.element,kh(g,_),vu(_,R,null,A);var oe=_.memoizedState;if(R=oe.element,nt&&$.isDehydrated)if($={element:R,isDehydrated:!1,cache:oe.cache,transitions:oe.transitions},_.updateQueue.baseState=$,_.memoizedState=$,_.flags&256){F=Error(o(423)),_=B_(g,_,R,A,F);break e}else if(R!==F){F=Error(o(424)),_=B_(g,_,R,A,F);break e}else for(nt&&(yr=pu(_.stateNode.containerInfo),zi=_,zn=!0,vr=null,Tc=!1),A=ym(_,null,R,A),_.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(Ea(),R===F){_=Js(g,_,A);break e}Hi(g,_,R,A)}_=_.child}return _;case 5:return Il(_),g===null&&Eo(_),R=_.type,F=_.pendingProps,$=g!==null?g.memoizedProps:null,oe=F.children,Fe(R,F)?oe=null:$!==null&&Fe(R,$)&&(_.flags|=32),Os(g,_),Hi(g,_,oe,A),_.child;case 6:return g===null&&Eo(_),null;case 13:return z_(g,_,A);case 4:return Ec(_,_.stateNode.containerInfo),R=_.pendingProps,g===null?_.child=cs(_,null,R,A):Hi(g,_,R,A),_.child;case 11:return R=_.type,F=_.pendingProps,F=_.elementType===R?F:sr(R,F),gi(g,_,R,F,A);case 7:return Hi(g,_,_.pendingProps,A),_.child;case 8:return Hi(g,_,_.pendingProps.children,A),_.child;case 12:return Hi(g,_,_.pendingProps.children,A),_.child;case 10:e:{if(R=_.type._context,F=_.pendingProps,$=_.memoizedProps,oe=F.value,Cl(_,R,oe),$!==null)if(Ir($.value,oe)){if($.children===F.children&&!ai.current){_=Js(g,_,A);break e}}else for($=_.child,$!==null&&($.return=_);$!==null;){var we=$.dependencies;if(we!==null){oe=$.child;for(var Xe=we.firstContext;Xe!==null;){if(Xe.context===R){if($.tag===1){Xe=jo(-1,A&-A),Xe.tag=2;var _t=$.updateQueue;if(_t!==null){_t=_t.shared;var Nt=_t.pending;Nt===null?Xe.next=Xe:(Xe.next=Nt.next,Nt.next=Xe),_t.pending=Xe}}$.lanes|=A,Xe=$.alternate,Xe!==null&&(Xe.lanes|=A),ba($.return,A,_),we.lanes|=A;break}Xe=Xe.next}}else if($.tag===10)oe=$.type===_.type?null:$.child;else if($.tag===18){if(oe=$.return,oe===null)throw Error(o(341));oe.lanes|=A,we=oe.alternate,we!==null&&(we.lanes|=A),ba(oe,A,_),oe=$.sibling}else oe=$.child;if(oe!==null)oe.return=$;else for(oe=$;oe!==null;){if(oe===_){oe=null;break}if($=oe.sibling,$!==null){$.return=oe.return,oe=$;break}oe=oe.return}$=oe}Hi(g,_,F.children,A),_=_.child}return _;case 9:return F=_.type,R=_.pendingProps.children,wc(_,A),F=wi(F),R=R(F),_.flags|=1,Hi(g,_,R,A),_.child;case 14:return R=_.type,F=sr(R,_.pendingProps),F=sr(R.type,F),ci(g,_,R,F,A);case 15:return Bl(g,_,_.type,_.pendingProps,A);case 17:return R=_.type,F=_.pendingProps,F=_.elementType===R?F:sr(R,F),g!==null&&(g.alternate=null,_.alternate=null,_.flags|=2),_.tag=1,bi(R)?(g=!0,ki(_)):g=!1,wc(_,A),_d(_,R,F),wa(_,R,F,A),ps(null,_,R,!0,g,A);case 19:return ku(g,_,A);case 22:return qr(g,_,A)}throw Error(o(156,_.tag))};function Ld(g,_){return El(g,_)}function Lm(g,_,A,R){this.tag=g,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Po(g,_,A,R){return new Lm(g,_,A,R)}function Nd(g){return g=g.prototype,!(!g||!g.isReactComponent)}function K0(g){if(typeof g=="function")return Nd(g)?1:0;if(g!=null){if(g=g.$$typeof,g===T)return 11;if(g===P)return 14}return 2}function Xl(g,_){var A=g.alternate;return A===null?(A=Po(g.tag,_,g.key,g.mode),A.elementType=g.elementType,A.type=g.type,A.stateNode=g.stateNode,A.alternate=g,g.alternate=A):(A.pendingProps=_,A.type=g.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=g.flags&14680064,A.childLanes=g.childLanes,A.lanes=g.lanes,A.child=g.child,A.memoizedProps=g.memoizedProps,A.memoizedState=g.memoizedState,A.updateQueue=g.updateQueue,_=g.dependencies,A.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},A.sibling=g.sibling,A.index=g.index,A.ref=g.ref,A}function Dd(g,_,A,R,F,$){var oe=2;if(R=g,typeof g=="function")Nd(g)&&(oe=1);else if(typeof g=="string")oe=5;else e:switch(g){case u:return Uc(A.children,F,$,_);case d:oe=8,F|=8;break;case m:return g=Po(12,A,_,F|2),g.elementType=m,g.lanes=$,g;case S:return g=Po(13,A,_,F),g.elementType=S,g.lanes=$,g;case w:return g=Po(19,A,_,F),g.elementType=w,g.lanes=$,g;case I:return rf(A,F,$,_);default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case y:oe=10;break e;case x:oe=9;break e;case T:oe=11;break e;case P:oe=14;break e;case M:oe=16,R=null;break e}throw Error(o(130,g==null?g:typeof g,""))}return _=Po(oe,A,_,F),_.elementType=g,_.type=R,_.lanes=$,_}function Uc(g,_,A,R){return g=Po(7,g,R,_),g.lanes=A,g}function rf(g,_,A,R){return g=Po(22,g,R,_),g.elementType=I,g.lanes=A,g.stateNode={},g}function Nm(g,_,A){return g=Po(6,g,null,_),g.lanes=A,g}function Dm(g,_,A){return _=Po(4,g.children!==null?g.children:[],g.key,_),_.lanes=A,_.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},_}function J0(g,_,A,R,F){this.tag=_,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ft,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tl(0),this.expirationTimes=Tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tl(0),this.identifierPrefix=R,this.onRecoverableError=F,nt&&(this.mutableSourceEagerHydrationData=null)}function Q0(g,_,A,R,F,$,oe,we,Xe){return g=new J0(g,_,A,we,Xe),_===1?(_=1,$===!0&&(_|=8)):_=0,$=Po(3,null,null,_),g.current=$,$.stateNode=g,$.memoizedState={element:R,isDehydrated:A,cache:null,transitions:null},Ms($),g}function Z_(g){if(!g)return Qt;g=g._reactInternals;e:{if(z(g)!==g||g.tag!==1)throw Error(o(170));var _=g;do{switch(_.tag){case 3:_=_.stateNode.context;break e;case 1:if(bi(_.type)){_=_.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_=_.return}while(_!==null);throw Error(o(171))}if(g.tag===1){var A=g.type;if(bi(A))return Ga(g,A,_)}return _}function ex(g){var _=g._reactInternals;if(_===void 0)throw typeof g.render=="function"?Error(o(188)):(g=Object.keys(g).join(","),Error(o(268,g)));return g=le(_),g===null?null:g.stateNode}function tx(g,_){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var A=g.retryLane;g.retryLane=A!==0&&A<_?A:_}}function Fm(g,_){tx(g,_),(g=g.alternate)&&tx(g,_)}function nx(g){return g=le(g),g===null?null:g.stateNode}function ix(){return null}return t.attemptContinuousHydration=function(g){if(g.tag===13){var _=Fr();eo(g,134217728,_),Fm(g,134217728)}},t.attemptHydrationAtCurrentPriority=function(g){if(g.tag===13){var _=Fr(),A=rl(g);eo(g,A,_),Fm(g,A)}},t.attemptSynchronousHydration=function(g){switch(g.tag){case 3:var _=g.stateNode;if(_.current.memoizedState.isDehydrated){var A=Ho(_.pendingLanes);A!==0&&(ws(_,A|1),ms(_,Bi()),(En&6)===0&&(Fu(),Ts()))}break;case 13:var R=Fr();nf(function(){return eo(g,1,R)}),Fm(g,1)}},t.batchedUpdates=function(g,_){var A=En;En|=1;try{return g(_)}finally{En=A,En===0&&(Fu(),Ch&&Ts())}},t.createComponentSelector=function(g){return{$$typeof:Yh,value:g}},t.createContainer=function(g,_,A,R,F,$,oe){return Q0(g,_,!1,null,A,R,F,$,oe)},t.createHasPseudoClassSelector=function(g){return{$$typeof:qh,value:g}},t.createHydrationContainer=function(g,_,A,R,F,$,oe,we,Xe){return g=Q0(A,R,!0,g,F,$,oe,we,Xe),g.context=Z_(null),A=g.current,R=Fr(),F=rl(A),$=jo(R,F),$.callback=_??null,$o(A,$),g.current.lanes=F,va(g,F,R),ms(g,R),g},t.createPortal=function(g,_,A){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:R==null?null:""+R,children:g,containerInfo:_,implementation:A}},t.createRoleSelector=function(g){return{$$typeof:Zh,value:g}},t.createTestNameSelector=function(g){return{$$typeof:Wl,value:g}},t.createTextSelector=function(g){return{$$typeof:Ds,value:g}},t.deferredUpdates=function(g){var _=xn,A=Pi.transition;try{return Pi.transition=null,xn=16,g()}finally{xn=_,Pi.transition=A}},t.discreteUpdates=function(g,_,A,R,F){var $=xn,oe=Pi.transition;try{return Pi.transition=null,xn=1,g(_,A,R,F)}finally{xn=$,Pi.transition=oe,En===0&&Fu()}},t.findAllNodes=Rd,t.findBoundingRects=function(g,_){if(!Zt)throw Error(o(363));_=Rd(g,_),g=[];for(var A=0;A<_.length;A++)g.push(Xn(_[A]));for(_=g.length-1;0<_;_--){A=g[_];for(var R=A.x,F=R+A.width,$=A.y,oe=$+A.height,we=_-1;0<=we;we--)if(_!==we){var Xe=g[we],_t=Xe.x,Nt=_t+Xe.width,_n=Xe.y,tn=_n+Xe.height;if(R>=_t&&$>=_n&&F<=Nt&&oe<=tn){g.splice(_,1);break}else if(R!==_t||A.width!==Xe.width||tn<$||_n>oe){if(!($!==_n||A.height!==Xe.height||Nt<R||_t>F)){_t>R&&(Xe.width+=_t-R,Xe.x=R),Nt<F&&(Xe.width=F-_t),g.splice(_,1);break}}else{_n>$&&(Xe.height+=_n-$,Xe.y=$),tn<oe&&(Xe.height=oe-_n),g.splice(_,1);break}}}return g},t.findHostInstance=ex,t.findHostInstanceWithNoPortals=function(g){return g=J(g),g=g!==null?te(g):null,g===null?null:g.stateNode},t.findHostInstanceWithWarning=function(g){return ex(g)},t.flushControlled=function(g){var _=En;En|=1;var A=Pi.transition,R=xn;try{Pi.transition=null,xn=1,g()}finally{xn=R,Pi.transition=A,En=_,En===0&&(Fu(),Ts())}},t.flushPassiveEffects=Fc,t.flushSync=nf,t.focusWithin=function(g,_){if(!Zt)throw Error(o(363));for(g=Pd(g),_=jl(g,_),_=Array.from(_),g=0;g<_.length;){var A=_[g++];if(!Q(A)){if(A.tag===5&&ct(A.stateNode))return!0;for(A=A.child;A!==null;)_.push(A),A=A.sibling}}return!1},t.getCurrentUpdatePriority=function(){return xn},t.getFindAllNodesFailureDescription=function(g,_){if(!Zt)throw Error(o(363));var A=0,R=[];g=[Pd(g),0];for(var F=0;F<g.length;){var $=g[F++],oe=g[F++],we=_[oe];if(($.tag!==5||!Q($))&&(Mm($,we)&&(R.push(Oa(we)),oe++,oe>A&&(A=oe)),oe<_.length))for($=$.child;$!==null;)g.push($,oe),$=$.sibling}if(A<_.length){for(g=[];A<_.length;A++)g.push(Oa(_[A]));return`findAllNodes was able to match part of the selector:
  `+(R.join(" > ")+`

No matching component was found for:
  `)+g.join(" > ")}return null},t.getPublicRootInstance=function(g){if(g=g.current,!g.child)return null;switch(g.child.tag){case 5:return ve(g.child.stateNode);default:return g.child.stateNode}},t.injectIntoDevTools=function(g){if(g={bundleType:g.bundleType,version:g.version,rendererPackageName:g.rendererPackageName,rendererConfig:g.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:nx,findFiberByHostInstance:g.findFiberByHostInstance||ix,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")g=!1;else{var _=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(_.isDisabled||!_.supportsFiber)g=!0;else{try{Al=_.inject(g),as=_}catch{}g=!!_.checkDCE}}return g},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(g,_,A,R){if(!Zt)throw Error(o(363));g=Rd(g,_);var F=et(g,A,R).disconnect;return{disconnect:function(){F()}}},t.registerMutableSourceForHydration=function(g,_){var A=_._getVersion;A=A(_._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[_,A]:g.mutableSourceEagerHydrationData.push(_,A)},t.runWithPriority=function(g,_){var A=xn;try{return xn=g,_()}finally{xn=A}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(g,_,A,R){var F=_.current,$=Fr(),oe=rl(F);return A=Z_(A),_.context===null?_.context=A:_.pendingContext=A,_=jo($,oe),_.payload={element:g},R=R===void 0?null:R,R!==null&&(_.callback=R),$o(F,_),g=eo(F,oe,$),g!==null&&Oh(g,F,oe),oe},t}),rA}var nF;function Hge(){return nF||(nF=1,tA.exports=Vge()),tA.exports}var Wge=Hge();const jge=AP(Wge);var sA={exports:{}},oA={};var iF;function $ge(){return iF||(iF=1,(function(n){function e(q,ie){var X=q.length;q.push(ie);e:for(;0<X;){var Y=X-1>>>1,ce=q[Y];if(0<r(ce,ie))q[Y]=ie,q[X]=ce,X=Y;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var ie=q[0],X=q.pop();if(X!==ie){q[0]=X;e:for(var Y=0,ce=q.length,Me=ce>>>1;Y<Me;){var Re=2*(Y+1)-1,Fe=q[Re],Be=Re+1,at=q[Be];if(0>r(Fe,X))Be<ce&&0>r(at,Fe)?(q[Y]=at,q[Be]=X,Y=Be):(q[Y]=Fe,q[Re]=X,Y=Re);else if(Be<ce&&0>r(at,X))q[Y]=at,q[Be]=X,Y=Be;else break e}}return ie}function r(q,ie){var X=q.sortIndex-ie.sortIndex;return X!==0?X:q.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,m=3,y=!1,x=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(q){for(var ie=t(c);ie!==null;){if(ie.callback===null)i(c);else if(ie.startTime<=q)i(c),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=t(c)}}function I(q){if(T=!1,M(q),!x)if(t(l)!==null)x=!0,ve(k);else{var ie=t(c);ie!==null&&me(I,ie.startTime-q)}}function k(q,ie){x=!1,T&&(T=!1,w(W),W=-1),y=!0;var X=m;try{for(M(ie),d=t(l);d!==null&&(!(d.expirationTime>ie)||q&&!J());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,m=d.priorityLevel;var ce=Y(d.expirationTime<=ie);ie=n.unstable_now(),typeof ce=="function"?d.callback=ce:d===t(l)&&i(l),M(ie)}else i(l);d=t(l)}if(d!==null)var Me=!0;else{var Re=t(c);Re!==null&&me(I,Re.startTime-ie),Me=!1}return Me}finally{d=null,m=X,y=!1}}var D=!1,H=null,W=-1,z=5,j=-1;function J(){return!(n.unstable_now()-j<z)}function le(){if(H!==null){var q=n.unstable_now();j=q;var ie=!0;try{ie=H(!0,q)}finally{ie?ge():(D=!1,H=null)}}else D=!1}var ge;if(typeof P=="function")ge=function(){P(le)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,de=te.port2;te.port1.onmessage=le,ge=function(){de.postMessage(null)}}else ge=function(){S(le,0)};function ve(q){H=q,D||(D=!0,ge())}function me(q,ie){W=S(function(){q(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){x||y||(x=!0,ve(k))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var ie=3;break;default:ie=m}var X=m;m=ie;try{return q()}finally{m=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,ie){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var X=m;m=q;try{return ie()}finally{m=X}},n.unstable_scheduleCallback=function(q,ie,X){var Y=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Y+X:Y):X=Y,q){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=X+ce,q={id:u++,callback:ie,priorityLevel:q,startTime:X,expirationTime:ce,sortIndex:-1},X>Y?(q.sortIndex=X,e(c,q),t(l)===null&&q===t(c)&&(T?(w(W),W=-1):T=!0,me(I,X-Y))):(q.sortIndex=ce,e(l,q),x||y||(x=!0,ve(k))),q},n.unstable_shouldYield=J,n.unstable_wrapCallback=function(q){var ie=m;return function(){var X=m;m=ie;try{return q.apply(this,arguments)}finally{m=X}}}})(oA)),oA}var rF;function Xge(){return rF||(rF=1,sA.exports=$ge()),sA.exports}var sF=Xge();const U2={},Gge=n=>void Object.assign(U2,n);function Yge(n,e){function t(u,{args:d=[],attach:m,...y},x){let T=`${u[0].toUpperCase()}${u.slice(1)}`,S;if(u==="primitive"){if(y.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const w=y.object;S=yg(w,{type:u,root:x,attach:m,primitive:!0})}else{const w=U2[T];if(!w)throw new Error(`R3F: ${T} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");S=yg(new w(...d),{type:u,root:x,attach:m,memoizedProps:{args:d}})}return S.__r3f.attach===void 0&&(S.isBufferGeometry?S.__r3f.attach="geometry":S.isMaterial&&(S.__r3f.attach="material")),T!=="inject"&&cA(S,y),S}function i(u,d){let m=!1;if(d){var y,x;(y=d.__r3f)!=null&&y.attach?lA(u,d,d.__r3f.attach):d.isObject3D&&u.isObject3D&&(u.add(d),m=!0),m||(x=u.__r3f)==null||x.objects.push(d),d.__r3f||yg(d,{}),d.__r3f.parent=u,jC(d),vg(d)}}function r(u,d,m){let y=!1;if(d){var x,T;if((x=d.__r3f)!=null&&x.attach)lA(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){d.parent=u,d.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:d});const S=u.children.filter(P=>P!==d),w=S.indexOf(m);u.children=[...S.slice(0,w),d,...S.slice(w)],y=!0}y||(T=u.__r3f)==null||T.objects.push(d),d.__r3f||yg(d,{}),d.__r3f.parent=u,jC(d),vg(d)}}function s(u,d,m=!1){u&&[...u].forEach(y=>o(d,y,m))}function o(u,d,m){if(d){var y,x,T;if(d.__r3f&&(d.__r3f.parent=null),(y=u.__r3f)!=null&&y.objects&&(u.__r3f.objects=u.__r3f.objects.filter(I=>I!==d)),(x=d.__r3f)!=null&&x.attach)uF(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){var S;u.remove(d),(S=d.__r3f)!=null&&S.root&&t_e(bw(d),d)}const P=(T=d.__r3f)==null?void 0:T.primitive,M=!P&&(m===void 0?d.dispose!==null:m);if(!P){var w;s((w=d.__r3f)==null?void 0:w.objects,d,M),s(d.children,d,M)}if(delete d.__r3f,M&&d.dispose&&d.type!=="Scene"){const I=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?sF.unstable_scheduleCallback(sF.unstable_IdlePriority,I):I()}vg(u)}}function a(u,d,m,y){var x;const T=(x=u.__r3f)==null?void 0:x.parent;if(!T)return;const S=t(d,m,u.__r3f.root);if(u.children){for(const w of u.children)w.__r3f&&i(S,w);u.children=u.children.filter(w=>!w.__r3f)}u.__r3f.objects.forEach(w=>i(S,w)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(T,u),S.parent&&(S.__r3f.autoRemovedBeforeAppend=!0),i(T,S),S.raycast&&S.__r3f.eventCount&&bw(S).getState().internal.interaction.push(S),[y,y.alternate].forEach(w=>{w!==null&&(w.stateNode=S,w.ref&&(typeof w.ref=="function"?w.ref(S):w.ref.current=S))})}const l=()=>{};return{reconciler:jge({createInstance:t,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,d)=>{if(!d)return;const m=u.getState().scene;m.__r3f&&(m.__r3f.root=u,i(m,d))},removeChildFromContainer:(u,d)=>{d&&o(u.getState().scene,d)},insertInContainerBefore:(u,d,m)=>{if(!d||!m)return;const y=u.getState().scene;y.__r3f&&r(y,d,m)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var d;return!!((d=u?.__r3f)!=null?d:{}).handlers},prepareUpdate(u,d,m,y){var x;if(((x=u?.__r3f)!=null?x:{}).primitive&&y.object&&y.object!==u)return[!0];{const{args:S=[],children:w,...P}=y,{args:M=[],children:I,...k}=m;if(!Array.isArray(S))throw new Error("R3F: the args prop must be an array!");if(S.some((H,W)=>H!==M[W]))return[!0];const D=$8(u,P,k,!0);return D.changes.length?[!1,D]:null}},commitUpdate(u,[d,m],y,x,T,S){d?a(u,y,T,S):cA(u,m)},commitMount(u,d,m,y){var x;const T=(x=u.__r3f)!=null?x:{};u.raycast&&T.handlers&&T.eventCount&&bw(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>yg(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var d;const{attach:m,parent:y}=(d=u.__r3f)!=null?d:{};m&&y&&uF(y,u,m),u.isObject3D&&(u.visible=!1),vg(u)},unhideInstance(u,d){var m;const{attach:y,parent:x}=(m=u.__r3f)!=null?m:{};y&&x&&lA(x,u,y),(u.isObject3D&&d.visible==null||d.visible)&&(u.visible=!0),vg(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():kg.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Ni.fun(performance.now)?performance.now:Ni.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Ni.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Ni.fun(clearTimeout)?clearTimeout:void 0}),applyProps:cA}}var oF,aF;const aA=n=>"colorSpace"in n||"outputColorSpace"in n,B8=()=>{var n;return(n=U2.ColorManagement)!=null?n:null},z8=n=>n&&n.isOrthographicCamera,qge=n=>n&&n.hasOwnProperty("current"),D0=typeof window<"u"&&((oF=window.document)!=null&&oF.createElement||((aF=window.navigator)==null?void 0:aF.product)==="ReactNative")?G.useLayoutEffect:G.useEffect;function V8(n){const e=G.useRef(n);return D0(()=>void(e.current=n),[n]),e}function Zge({set:n}){return D0(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}let H8=class extends G.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}};H8.getDerivedStateFromError=()=>({error:!0});const W8="__default",lF=new Map,Kge=n=>n&&!!n.memoized&&!!n.changes;function j8(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const by=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function bw(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Ni={obj:n=>n===Object(n)&&!Ni.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Ni.str(n)||Ni.num(n)||Ni.boo(n))return n===e;const s=Ni.obj(n);if(s&&i==="reference")return n===e;const o=Ni.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&i==="shallow"){for(a in r?e:n)if(!Ni.equ(n[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:n)if(n[a]!==e[a])return!1;if(Ni.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function Jge(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function yg(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function WC(n,e){let t=n;if(e.includes("-")){const i=e.split("-"),r=i.pop();return t=i.reduce((s,o)=>s[o],n),{target:t,key:r}}else return{target:t,key:e}}const cF=/-\d+$/;function lA(n,e,t){if(Ni.str(t)){if(cF.test(t)){const s=t.replace(cF,""),{target:o,key:a}=WC(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=WC(n,t);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=t(n,e)}function uF(n,e,t){var i,r;if(Ni.str(t)){const{target:s,key:o}=WC(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(n,e);(r=e.__r3f)==null||delete r.previousAttach}function $8(n,{children:e,key:t,ref:i,...r},{children:s,key:o,ref:a,...l}={},c=!1){const u=n.__r3f,d=Object.entries(r),m=[];if(c){const x=Object.keys(l);for(let T=0;T<x.length;T++)r.hasOwnProperty(x[T])||d.unshift([x[T],W8+"remove"])}d.forEach(([x,T])=>{var S;if((S=n.__r3f)!=null&&S.primitive&&x==="object"||Ni.equ(T,l[x]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(x))return m.push([x,T,!0,[]]);let w=[];x.includes("-")&&(w=x.split("-")),m.push([x,T,!1,w]);for(const P in r){const M=r[P];P.startsWith(`${x}-`)&&m.push([P,M,!1,P.split("-")])}});const y={...r};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(y.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(y.attach=u.memoizedProps.attach),{memoized:y,changes:m}}function cA(n,e){var t;const i=n.__r3f,r=i?.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=Kge(e)?e:$8(n,e),l=i?.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let m=0;m<a.length;m++){let[y,x,T,S]=a[m];if(aA(n)){const I="srgb",k="srgb-linear";y==="encoding"?(y="colorSpace",x=x===3001?I:k):y==="outputEncoding"&&(y="outputColorSpace",x=x===3001?I:k)}let w=n,P=w[y];if(S.length&&(P=S.reduce((M,I)=>M[I],n),!(P&&P.set))){const[M,...I]=S.reverse();w=I.reverse().reduce((k,D)=>k[D],n),y=M}if(x===W8+"remove")if(w.constructor){let M=lF.get(w.constructor);M||(M=new w.constructor,lF.set(w.constructor,M)),x=M[y]}else x=0;if(T&&i)x?i.handlers[y]=x:delete i.handlers[y],i.eventCount=Object.keys(i.handlers).length;else if(P&&P.set&&(P.copy||P instanceof Cp)){if(Array.isArray(x))P.fromArray?P.fromArray(x):P.set(...x);else if(P.copy&&x&&x.constructor&&P.constructor===x.constructor)P.copy(x);else if(x!==void 0){var c;const M=(c=P)==null?void 0:c.isColor;!M&&P.setScalar?P.setScalar(x):P instanceof Cp&&x instanceof Cp?P.mask=x.mask:P.set(x),!B8()&&s&&!s.linear&&M&&P.convertSRGBToLinear()}}else{var u;if(w[y]=x,(u=w[y])!=null&&u.isTexture&&w[y].format===ca&&w[y].type===tu&&s){const M=w[y];aA(M)&&aA(s.gl)?M.colorSpace=s.gl.outputColorSpace:M.encoding=s.gl.outputEncoding}}vg(n)}if(i&&i.parent&&n.raycast&&l!==i.eventCount){const m=bw(n).getState().internal,y=m.interaction.indexOf(n);y>-1&&m.interaction.splice(y,1),i.eventCount&&m.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&jC(n),n}function vg(n){var e,t;const i=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();i&&i.internal.frames===0&&i.invalidate()}function jC(n){n.onUpdate==null||n.onUpdate(n)}function Qge(n,e){n.manual||(z8(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function Db(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function e_e(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return kg.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return kg.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return kg.ContinuousEventPriority;default:return kg.DefaultEventPriority}}function X8(n,e,t,i){const r=t.get(e);r&&(t.delete(e),t.size===0&&(n.delete(i),r.target.releasePointerCapture(i)))}function t_e(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{X8(t.capturedMap,e,i,r)})}function n_e(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+u]}))}function i(l,c){const u=n.getState(),d=new Set,m=[],y=c?c(u.internal.interaction):u.internal.interaction;for(let w=0;w<y.length;w++){const P=by(y[w]);P&&(P.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function x(w){const P=by(w);if(!P||!P.events.enabled||P.raycaster.camera===null)return[];if(P.raycaster.camera===void 0){var M;P.events.compute==null||P.events.compute(l,P,(M=P.previousRoot)==null?void 0:M.getState()),P.raycaster.camera===void 0&&(P.raycaster.camera=null)}return P.raycaster.camera?P.raycaster.intersectObject(w,!0):[]}let T=y.flatMap(x).sort((w,P)=>{const M=by(w.object),I=by(P.object);return!M||!I?w.distance-P.distance:I.events.priority-M.events.priority||w.distance-P.distance}).filter(w=>{const P=Db(w);return d.has(P)?!1:(d.add(P),!0)});u.events.filter&&(T=u.events.filter(T,u));for(const w of T){let P=w.object;for(;P;){var S;(S=P.__r3f)!=null&&S.eventCount&&m.push({...w,eventObject:P}),P=P.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let w of u.internal.capturedMap.get(l.pointerId).values())d.has(Db(w.intersection))||m.push(w.intersection);return m}function r(l,c,u,d){const m=n.getState();if(l.length){const y={stopped:!1};for(const x of l){const T=by(x.object)||m,{raycaster:S,pointer:w,camera:P,internal:M}=T,I=new re(w.x,w.y,0).unproject(P),k=j=>{var J,le;return(J=(le=M.capturedMap.get(j))==null?void 0:le.has(x.eventObject))!=null?J:!1},D=j=>{const J={intersection:x,target:c.target};M.capturedMap.has(j)?M.capturedMap.get(j).set(x.eventObject,J):M.capturedMap.set(j,new Map([[x.eventObject,J]])),c.target.setPointerCapture(j)},H=j=>{const J=M.capturedMap.get(j);J&&X8(M.capturedMap,x.eventObject,J,j)};let W={};for(let j in c){let J=c[j];typeof J!="function"&&(W[j]=J)}let z={...x,...W,pointer:w,intersections:l,stopped:y.stopped,delta:u,unprojectedPoint:I,ray:S.ray,camera:P,stopPropagation(){const j="pointerId"in c&&M.capturedMap.get(c.pointerId);if((!j||j.has(x.eventObject))&&(z.stopped=y.stopped=!0,M.hovered.size&&Array.from(M.hovered.values()).find(J=>J.eventObject===x.eventObject))){const J=l.slice(0,l.indexOf(x));s([...J,x])}},target:{hasPointerCapture:k,setPointerCapture:D,releasePointerCapture:H},currentTarget:{hasPointerCapture:k,setPointerCapture:D,releasePointerCapture:H},nativeEvent:c};if(d(z),y.stopped===!0)break}}return l}function s(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){const m=u.eventObject.__r3f,y=m?.handlers;if(c.hovered.delete(Db(u)),m!=null&&m.eventCount){const x={...u,intersections:l};y.onPointerOut==null||y.onPointerOut(x),y.onPointerLeave==null||y.onPointerLeave(x)}}}function o(l,c){for(let u=0;u<c.length;u++){const d=c[u].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:d,internal:m}=n.getState();m.lastEvent.current=u;const y=l==="onPointerMove",x=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",S=i(u,y?t:void 0),w=x?e(u):0;l==="onPointerDown"&&(m.initialClick=[u.offsetX,u.offsetY],m.initialHits=S.map(M=>M.eventObject)),x&&!S.length&&w<=2&&(o(u,m.interaction),d&&d(u)),y&&s(S);function P(M){const I=M.eventObject,k=I.__r3f,D=k?.handlers;if(k!=null&&k.eventCount)if(y){if(D.onPointerOver||D.onPointerEnter||D.onPointerOut||D.onPointerLeave){const H=Db(M),W=m.hovered.get(H);W?W.stopped&&M.stopPropagation():(m.hovered.set(H,M),D.onPointerOver==null||D.onPointerOver(M),D.onPointerEnter==null||D.onPointerEnter(M))}D.onPointerMove==null||D.onPointerMove(M)}else{const H=D[l];H?(!x||m.initialHits.includes(I))&&(o(u,m.interaction.filter(W=>!m.initialHits.includes(W))),H(M)):x&&m.initialHits.includes(I)&&o(u,m.interaction.filter(W=>!m.initialHits.includes(W)))}}r(S,u,w,P)}}return{handlePointer:a}}const G8=n=>!!(n!=null&&n.render),Y8=G.createContext(null),i_e=(n,e)=>{const t=Uge((a,l)=>{const c=new re,u=new re,d=new re;function m(w=l().camera,P=u,M=l().size){const{width:I,height:k,top:D,left:H}=M,W=I/k;P.isVector3?d.copy(P):d.set(...P);const z=w.getWorldPosition(c).distanceTo(d);if(z8(w))return{width:I/w.zoom,height:k/w.zoom,top:D,left:H,factor:1,distance:z,aspect:W};{const j=w.fov*Math.PI/180,J=2*Math.tan(j/2)*z,le=J*(I/k);return{width:le,height:J,top:D,left:H,factor:I/le,distance:z,aspect:W}}}let y;const x=w=>a(P=>({performance:{...P.performance,current:w}})),T=new qe;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(w=1)=>n(l(),w),advance:(w,P)=>e(w,P,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new LR,pointer:T,mouse:T,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const w=l();y&&clearTimeout(y),w.performance.current!==w.performance.min&&x(w.performance.min),y=setTimeout(()=>x(l().performance.max),w.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:m},setEvents:w=>a(P=>({...P,events:{...P.events,...w}})),setSize:(w,P,M,I,k)=>{const D=l().camera,H={width:w,height:P,top:I||0,left:k||0,updateStyle:M};a(W=>({size:H,viewport:{...W.viewport,...m(D,u,H)}}))},setDpr:w=>a(P=>{const M=j8(w);return{viewport:{...P.viewport,dpr:M,initialDpr:P.viewport.initialDpr||M}}}),setFrameloop:(w="always")=>{const P=l().clock;P.stop(),P.elapsedTime=0,w!=="never"&&(P.start(),P.elapsedTime=0),a(()=>({frameloop:w}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:G.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(w,P,M)=>{const I=l().internal;return I.priority=I.priority+(P>0?1:0),I.subscribers.push({ref:w,priority:P,store:M}),I.subscribers=I.subscribers.sort((k,D)=>k.priority-D.priority),()=>{const k=l().internal;k!=null&&k.subscribers&&(k.priority=k.priority-(P>0?1:0),k.subscribers=k.subscribers.filter(D=>D.ref!==w))}}}}}),i=t.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:d}=t.getState();if(l.width!==r.width||l.height!==r.height||c.dpr!==s){var m;r=l,s=c.dpr,Qge(a,l),u.setPixelRatio(c.dpr);const y=(m=l.updateStyle)!=null?m:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,y)}a!==o&&(o=a,d(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let Fb,r_e=new Set,s_e=new Set,o_e=new Set;function uA(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function wy(n,e){switch(n){case"before":return uA(r_e,e);case"after":return uA(s_e,e);case"tail":return uA(o_e,e)}}let hA,fA;function dA(n,e,t){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),hA=e.internal.subscribers,Fb=0;Fb<hA.length;Fb++)fA=hA[Fb],fA.ref.current(fA.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function a_e(n){let e=!1,t=!1,i,r,s;function o(c){r=requestAnimationFrame(o),e=!0,i=0,wy("before",c),t=!0;for(const d of n.values()){var u;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(i+=dA(c,s))}if(t=!1,wy("after",c),i===0)return wy("tail",c),e=!1,cancelAnimationFrame(r)}function a(c,u=1){var d;if(!c)return n.forEach(m=>a(m.store.getState(),u));(d=c.gl.xr)!=null&&d.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):t?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,u=!0,d,m){if(u&&wy("before",c),d)dA(c,d,m);else for(const y of n.values())dA(c,y.store.getState());u&&wy("after",c)}return{loop:o,invalidate:a,advance:l}}function q8(){const n=G.useContext(Y8);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function xf(n=t=>t,e){return q8()(n,e)}function l_e(n,e=0){const t=q8(),i=t.getState().internal.subscribe,r=V8(n);return D0(()=>i(r,e,t),[e,i,t]),null}const u_=new Map,{invalidate:hF,advance:fF}=a_e(u_),{reconciler:lS,applyProps:ug}=Yge(u_,e_e),hg={objects:"shallow",strict:!1},c_e=(n,e)=>{const t=typeof n=="function"?n(e):n;return G8(t)?t:new tT({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function u_e(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:s,left:o,updateStyle:a=t}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:i,height:r,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function h_e(n){const e=u_.get(n),t=e?.fiber,i=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||i_e(hF,fF),o=t||lS.createContainer(s,kg.ConcurrentRoot,null,!1,null,"",r,null);e||u_.set(n,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:d,size:m,scene:y,events:x,onCreated:T,shadows:S=!1,linear:w=!1,flat:P=!1,legacy:M=!1,orthographic:I=!1,frameloop:k="always",dpr:D=[1,2],performance:H,raycaster:W,camera:z,onPointerMissed:j}=u,J=s.getState(),le=J.gl;J.gl||J.set({gl:le=c_e(d,n)});let ge=J.raycaster;ge||J.set({raycaster:ge=new UR});const{params:te,...de}=W||{};if(Ni.equ(de,ge,hg)||ug(ge,{...de}),Ni.equ(te,ge.params,hg)||ug(ge,{params:{...ge.params,...te}}),!J.camera||J.camera===c&&!Ni.equ(c,z,hg)){c=z;const X=z instanceof E0,Y=X?z:I?new Yf(0,0,0,0,.1,1e3):new pr(75,0,.1,1e3);X||(Y.position.z=5,z&&(ug(Y,z),("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(Y.manual=!0,Y.updateProjectionMatrix())),!J.camera&&!(z!=null&&z.rotation)&&Y.lookAt(0,0,0)),J.set({camera:Y}),ge.camera=Y}if(!J.scene){let X;y!=null&&y.isScene?X=y:(X=new rT,y&&ug(X,y)),J.set({scene:yg(X)})}if(!J.xr){var ve;const X=(Me,Re)=>{const Fe=s.getState();Fe.frameloop!=="never"&&fF(Me,!0,Fe,Re)},Y=()=>{const Me=s.getState();Me.gl.xr.enabled=Me.gl.xr.isPresenting,Me.gl.xr.setAnimationLoop(Me.gl.xr.isPresenting?X:null),Me.gl.xr.isPresenting||hF(Me)},ce={connect(){const Me=s.getState().gl;Me.xr.addEventListener("sessionstart",Y),Me.xr.addEventListener("sessionend",Y)},disconnect(){const Me=s.getState().gl;Me.xr.removeEventListener("sessionstart",Y),Me.xr.removeEventListener("sessionend",Y)}};typeof((ve=le.xr)==null?void 0:ve.addEventListener)=="function"&&ce.connect(),J.set({xr:ce})}if(le.shadowMap){const X=le.shadowMap.enabled,Y=le.shadowMap.type;if(le.shadowMap.enabled=!!S,Ni.boo(S))le.shadowMap.type=jy;else if(Ni.str(S)){var me;const ce={basic:Cz,percentage:GS,soft:jy,variance:nc};le.shadowMap.type=(me=ce[S])!=null?me:jy}else Ni.obj(S)&&Object.assign(le.shadowMap,S);(X!==le.shadowMap.enabled||Y!==le.shadowMap.type)&&(le.shadowMap.needsUpdate=!0)}const q=B8();q&&("enabled"in q?q.enabled=!M:"legacyMode"in q&&(q.legacyMode=M)),l||ug(le,{outputEncoding:w?3e3:3001,toneMapping:P?eu:QP}),J.legacy!==M&&J.set(()=>({legacy:M})),J.linear!==w&&J.set(()=>({linear:w})),J.flat!==P&&J.set(()=>({flat:P})),d&&!Ni.fun(d)&&!G8(d)&&!Ni.equ(d,le,hg)&&ug(le,d),x&&!J.events.handlers&&J.set({events:x(s)});const ie=u_e(n,m);return Ni.equ(ie,J.size,hg)||J.setSize(ie.width,ie.height,ie.updateStyle,ie.top,ie.left),D&&J.viewport.dpr!==j8(D)&&J.setDpr(D),J.frameloop!==k&&J.setFrameloop(k),J.onPointerMissed||J.set({onPointerMissed:j}),H&&!Ni.equ(H,J.performance,hg)&&J.set(X=>({performance:{...X.performance,...H}})),a=T,l=!0,this},render(u){return l||this.configure(),lS.updateContainer(U.jsx(f_e,{store:s,children:u,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){Z8(n)}}}function f_e({store:n,children:e,onCreated:t,rootElement:i}){return D0(()=>{const r=n.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),n.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),U.jsx(Y8.Provider,{value:n,children:e})}function Z8(n,e){const t=u_.get(n),i=t?.fiber;if(i){const r=t?.store.getState();r&&(r.internal.active=!1),lS.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),Jge(r),u_.delete(n)}catch{}},500)})}}lS.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:G.version});const pA={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function d_e(n){const{handlePointer:e}=n_e(n);return{priority:1,enabled:!0,compute(t,i,r){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(pA).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:r}=n.getState();(t=r.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var i;const{set:r,events:s}=n.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:t}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,c]=pA[o];t.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=pA[s];i.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function dF(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function p_e({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=G.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=G.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,u=G.useRef(!1);G.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,m,y]=G.useMemo(()=>{const w=()=>{if(!a.current.element)return;const{left:P,top:M,width:I,height:k,bottom:D,right:H,x:W,y:z}=a.current.element.getBoundingClientRect(),j={left:P,top:M,width:I,height:k,bottom:D,right:H,x:W,y:z};a.current.element instanceof HTMLElement&&i&&(j.height=a.current.element.offsetHeight,j.width=a.current.element.offsetWidth),Object.freeze(j),u.current&&!y_e(a.current.lastBounds,j)&&o(a.current.lastBounds=j)};return[w,c?dF(w,c):w,l?dF(w,l):w]},[o,i,l,c]);function x(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(w=>w.removeEventListener("scroll",y,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function T(){a.current.element&&(a.current.resizeObserver=new r(y),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(w=>w.addEventListener("scroll",y,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{y()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const S=w=>{!w||w===a.current.element||(x(),a.current.element=w,a.current.scrollContainers=K8(w),T())};return g_e(y,!!e),m_e(m),G.useEffect(()=>{x(),T()},[e,y,m]),G.useEffect(()=>x,[]),[S,s,d]}function m_e(n){G.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function g_e(n,e){G.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function K8(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:r}=window.getComputedStyle(n);return[t,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...K8(n.parentElement)]}const __e=["x","y","top","bottom","left","right","width","height"],y_e=(n,e)=>__e.every(t=>n[t]===e[t]);var v_e=Object.defineProperty,x_e=Object.defineProperties,b_e=Object.getOwnPropertyDescriptors,pF=Object.getOwnPropertySymbols,w_e=Object.prototype.hasOwnProperty,S_e=Object.prototype.propertyIsEnumerable,mF=(n,e,t)=>e in n?v_e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,gF=(n,e)=>{for(var t in e||(e={}))w_e.call(e,t)&&mF(n,t,e[t]);if(pF)for(var t of pF(e))S_e.call(e,t)&&mF(n,t,e[t]);return n},T_e=(n,e)=>x_e(n,b_e(e)),_F,yF;typeof window<"u"&&((_F=window.document)!=null&&_F.createElement||((yF=window.navigator)==null?void 0:yF.product)==="ReactNative")?G.useLayoutEffect:G.useEffect;function J8(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=n.child;for(;i;){const r=J8(i,e,t);if(r)return r;i=i.sibling}}function Q8(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const vF=console.error;console.error=function(){const n=[...arguments].join("");if(n?.startsWith("Warning:")&&n.includes("useContext")){console.error=vF;return}return vF.apply(this,arguments)};const B2=Q8(G.createContext(null));class eW extends G.Component{render(){return G.createElement(B2.Provider,{value:this._reactInternals},this.props.children)}}function E_e(){const n=G.useContext(B2);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=G.useId();return G.useMemo(()=>{for(const i of[n,n?.alternate]){if(!i)continue;const r=J8(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[n,e])}function A_e(){const n=E_e(),[e]=G.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const r=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;r&&r!==B2&&!e.has(r)&&e.set(r,G.useContext(Q8(r)))}t=t.return}return e}function M_e(){const n=A_e();return G.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>G.createElement(e,null,G.createElement(t.Provider,T_e(gF({},i),{value:n.get(t)}))),e=>G.createElement(eW,gF({},e))),[n])}const C_e=G.forwardRef(function({children:e,fallback:t,resize:i,style:r,gl:s,events:o=d_e,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:d,legacy:m,orthographic:y,frameloop:x,dpr:T,performance:S,raycaster:w,camera:P,scene:M,onPointerMissed:I,onCreated:k,...D},H){G.useMemo(()=>Gge($re),[]);const W=M_e(),[z,j]=p_e({scroll:!0,debounce:{scroll:50,resize:0},...i}),J=G.useRef(null),le=G.useRef(null);G.useImperativeHandle(H,()=>J.current);const ge=V8(I),[te,de]=G.useState(!1),[ve,me]=G.useState(!1);if(te)throw te;if(ve)throw ve;const q=G.useRef(null);D0(()=>{const X=J.current;j.width>0&&j.height>0&&X&&(q.current||(q.current=h_e(X)),q.current.configure({gl:s,events:o,shadows:c,linear:u,flat:d,legacy:m,orthographic:y,frameloop:x,dpr:T,performance:S,raycaster:w,camera:P,scene:M,size:j,onPointerMissed:(...Y)=>ge.current==null?void 0:ge.current(...Y),onCreated:Y=>{Y.events.connect==null||Y.events.connect(a?qge(a)?a.current:a:le.current),l&&Y.setEvents({compute:(ce,Me)=>{const Re=ce[l+"X"],Fe=ce[l+"Y"];Me.pointer.set(Re/Me.size.width*2-1,-(Fe/Me.size.height)*2+1),Me.raycaster.setFromCamera(Me.pointer,Me.camera)}}),k?.(Y)}}),q.current.render(U.jsx(W,{children:U.jsx(H8,{set:me,children:U.jsx(G.Suspense,{fallback:U.jsx(Zge,{set:de}),children:e??null})})})))}),G.useEffect(()=>{const X=J.current;if(X)return()=>Z8(X)},[]);const ie=a?"none":"auto";return U.jsx("div",{ref:le,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ie,...r},...D,children:U.jsx("div",{ref:z,style:{width:"100%",height:"100%"},children:U.jsx("canvas",{ref:J,style:{display:"block"},children:t})})})}),P_e=G.forwardRef(function(e,t){return U.jsx(eW,{children:U.jsx(C_e,{...e,ref:t})})});function cS(){return cS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},cS.apply(null,arguments)}var R_e=Object.defineProperty,I_e=(n,e,t)=>e in n?R_e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,k_e=(n,e,t)=>(I_e(n,e+"",t),t);class O_e{constructor(){k_e(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var L_e=Object.defineProperty,N_e=(n,e,t)=>e in n?L_e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,an=(n,e,t)=>(N_e(n,typeof e!="symbol"?e+"":e,t),t);const Ub=new sm,xF=new Xc,D_e=Math.cos(70*(Math.PI/180)),bF=(n,e)=>(n%e+e)%e;let F_e=class extends O_e{constructor(e,t){super(),an(this,"object"),an(this,"domElement"),an(this,"enabled",!0),an(this,"target",new re),an(this,"minDistance",0),an(this,"maxDistance",1/0),an(this,"minZoom",0),an(this,"maxZoom",1/0),an(this,"minPolarAngle",0),an(this,"maxPolarAngle",Math.PI),an(this,"minAzimuthAngle",-1/0),an(this,"maxAzimuthAngle",1/0),an(this,"enableDamping",!1),an(this,"dampingFactor",.05),an(this,"enableZoom",!0),an(this,"zoomSpeed",1),an(this,"enableRotate",!0),an(this,"rotateSpeed",1),an(this,"enablePan",!0),an(this,"panSpeed",1),an(this,"screenSpacePanning",!0),an(this,"keyPanSpeed",7),an(this,"zoomToCursor",!1),an(this,"autoRotate",!1),an(this,"autoRotateSpeed",2),an(this,"reverseOrbit",!1),an(this,"reverseHorizontalOrbit",!1),an(this,"reverseVerticalOrbit",!1),an(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),an(this,"mouseButtons",{LEFT:sp.ROTATE,MIDDLE:sp.DOLLY,RIGHT:sp.PAN}),an(this,"touches",{ONE:op.ROTATE,TWO:op.DOLLY_PAN}),an(this,"target0"),an(this,"position0"),an(this,"zoom0"),an(this,"_domElementKeyEvents",null),an(this,"getPolarAngle"),an(this,"getAzimuthalAngle"),an(this,"setPolarAngle"),an(this,"setAzimuthalAngle"),an(this,"getDistance"),an(this,"getZoomScale"),an(this,"listenToKeyEvents"),an(this,"stopListenToKeyEvents"),an(this,"saveState"),an(this,"reset"),an(this,"update"),an(this,"connect"),an(this,"dispose"),an(this,"dollyIn"),an(this,"dollyOut"),an(this,"getScale"),an(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=pe=>{let $e=bF(pe,2*Math.PI),it=u.phi;it<0&&(it+=2*Math.PI),$e<0&&($e+=2*Math.PI);let tt=Math.abs($e-it);2*Math.PI-tt<tt&&($e<it?$e+=2*Math.PI:it+=2*Math.PI),d.phi=$e-it,i.update()},this.setAzimuthalAngle=pe=>{let $e=bF(pe,2*Math.PI),it=u.theta;it<0&&(it+=2*Math.PI),$e<0&&($e+=2*Math.PI);let tt=Math.abs($e-it);2*Math.PI-tt<tt&&($e<it?$e+=2*Math.PI:it+=2*Math.PI),d.theta=$e-it,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=pe=>{pe.addEventListener("keydown",ot),this._domElementKeyEvents=pe},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ot),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const pe=new re,$e=new re(0,1,0),it=new go().setFromUnitVectors(e.up,$e),tt=it.clone().invert(),jt=new re,ye=new go,mt=2*Math.PI;return function(){const Ge=i.object.position;it.setFromUnitVectors(e.up,$e),tt.copy(it).invert(),pe.copy(Ge).sub(i.target),pe.applyQuaternion(it),u.setFromVector3(pe),i.autoRotate&&l===a.NONE&&te(le()),i.enableDamping?(u.theta+=d.theta*i.dampingFactor,u.phi+=d.phi*i.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let ut=i.minAzimuthAngle,Vt=i.maxAzimuthAngle;isFinite(ut)&&isFinite(Vt)&&(ut<-Math.PI?ut+=mt:ut>Math.PI&&(ut-=mt),Vt<-Math.PI?Vt+=mt:Vt>Math.PI&&(Vt-=mt),ut<=Vt?u.theta=Math.max(ut,Math.min(Vt,u.theta)):u.theta=u.theta>(ut+Vt)/2?Math.max(ut,u.theta):Math.min(Vt,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(y,i.dampingFactor):i.target.add(y),i.zoomToCursor&&z||i.object.isOrthographicCamera?u.radius=Me(u.radius):u.radius=Me(u.radius*m),pe.setFromSpherical(u),pe.applyQuaternion(tt),Ge.copy(i.target).add(pe),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,y.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),y.set(0,0,0));let vn=!1;if(i.zoomToCursor&&z){let jn=null;if(i.object instanceof pr&&i.object.isPerspectiveCamera){const pi=pe.length();jn=Me(pi*m);const Cn=pi-jn;i.object.position.addScaledVector(H,Cn),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const pi=new re(W.x,W.y,0);pi.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix(),vn=!0;const Cn=new re(W.x,W.y,0);Cn.unproject(i.object),i.object.position.sub(Cn).add(pi),i.object.updateMatrixWorld(),jn=pe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;jn!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(jn).add(i.object.position):(Ub.origin.copy(i.object.position),Ub.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Ub.direction))<D_e?e.lookAt(i.target):(xF.setFromNormalAndCoplanarPoint(i.object.up,i.target),Ub.intersectPlane(xF,i.target))))}else i.object instanceof Yf&&i.object.isOrthographicCamera&&(vn=m!==1,vn&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix()));return m=1,z=!1,vn||jt.distanceToSquared(i.object.position)>c||8*(1-ye.dot(i.object.quaternion))>c?(i.dispatchEvent(r),jt.copy(i.object.position),ye.copy(i.object.quaternion),vn=!1,!0):!1}})(),this.connect=pe=>{i.domElement=pe,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",vt),i.domElement.addEventListener("pointerdown",Xn),i.domElement.addEventListener("pointercancel",Q),i.domElement.addEventListener("wheel",et)},this.dispose=()=>{var pe,$e,it,tt,jt,ye;i.domElement&&(i.domElement.style.touchAction="auto"),(pe=i.domElement)==null||pe.removeEventListener("contextmenu",vt),($e=i.domElement)==null||$e.removeEventListener("pointerdown",Xn),(it=i.domElement)==null||it.removeEventListener("pointercancel",Q),(tt=i.domElement)==null||tt.removeEventListener("wheel",et),(jt=i.domElement)==null||jt.ownerDocument.removeEventListener("pointermove",ae),(ye=i.domElement)==null||ye.ownerDocument.removeEventListener("pointerup",Q),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",ot)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new rC,d=new rC;let m=1;const y=new re,x=new qe,T=new qe,S=new qe,w=new qe,P=new qe,M=new qe,I=new qe,k=new qe,D=new qe,H=new re,W=new qe;let z=!1;const j=[],J={};function le(){return 2*Math.PI/60/60*i.autoRotateSpeed}function ge(){return Math.pow(.95,i.zoomSpeed)}function te(pe){i.reverseOrbit||i.reverseHorizontalOrbit?d.theta+=pe:d.theta-=pe}function de(pe){i.reverseOrbit||i.reverseVerticalOrbit?d.phi+=pe:d.phi-=pe}const ve=(()=>{const pe=new re;return function(it,tt){pe.setFromMatrixColumn(tt,0),pe.multiplyScalar(-it),y.add(pe)}})(),me=(()=>{const pe=new re;return function(it,tt){i.screenSpacePanning===!0?pe.setFromMatrixColumn(tt,1):(pe.setFromMatrixColumn(tt,0),pe.crossVectors(i.object.up,pe)),pe.multiplyScalar(it),y.add(pe)}})(),q=(()=>{const pe=new re;return function(it,tt){const jt=i.domElement;if(jt&&i.object instanceof pr&&i.object.isPerspectiveCamera){const ye=i.object.position;pe.copy(ye).sub(i.target);let mt=pe.length();mt*=Math.tan(i.object.fov/2*Math.PI/180),ve(2*it*mt/jt.clientHeight,i.object.matrix),me(2*tt*mt/jt.clientHeight,i.object.matrix)}else jt&&i.object instanceof Yf&&i.object.isOrthographicCamera?(ve(it*(i.object.right-i.object.left)/i.object.zoom/jt.clientWidth,i.object.matrix),me(tt*(i.object.top-i.object.bottom)/i.object.zoom/jt.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function ie(pe){i.object instanceof pr&&i.object.isPerspectiveCamera||i.object instanceof Yf&&i.object.isOrthographicCamera?m=pe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(pe){ie(m/pe)}function Y(pe){ie(m*pe)}function ce(pe){if(!i.zoomToCursor||!i.domElement)return;z=!0;const $e=i.domElement.getBoundingClientRect(),it=pe.clientX-$e.left,tt=pe.clientY-$e.top,jt=$e.width,ye=$e.height;W.x=it/jt*2-1,W.y=-(tt/ye)*2+1,H.set(W.x,W.y,1).unproject(i.object).sub(i.object.position).normalize()}function Me(pe){return Math.max(i.minDistance,Math.min(i.maxDistance,pe))}function Re(pe){x.set(pe.clientX,pe.clientY)}function Fe(pe){ce(pe),I.set(pe.clientX,pe.clientY)}function Be(pe){w.set(pe.clientX,pe.clientY)}function at(pe){T.set(pe.clientX,pe.clientY),S.subVectors(T,x).multiplyScalar(i.rotateSpeed);const $e=i.domElement;$e&&(te(2*Math.PI*S.x/$e.clientHeight),de(2*Math.PI*S.y/$e.clientHeight)),x.copy(T),i.update()}function pt(pe){k.set(pe.clientX,pe.clientY),D.subVectors(k,I),D.y>0?X(ge()):D.y<0&&Y(ge()),I.copy(k),i.update()}function Ft(pe){P.set(pe.clientX,pe.clientY),M.subVectors(P,w).multiplyScalar(i.panSpeed),q(M.x,M.y),w.copy(P),i.update()}function yn(pe){ce(pe),pe.deltaY<0?Y(ge()):pe.deltaY>0&&X(ge()),i.update()}function Rt(pe){let $e=!1;switch(pe.code){case i.keys.UP:q(0,i.keyPanSpeed),$e=!0;break;case i.keys.BOTTOM:q(0,-i.keyPanSpeed),$e=!0;break;case i.keys.LEFT:q(i.keyPanSpeed,0),$e=!0;break;case i.keys.RIGHT:q(-i.keyPanSpeed,0),$e=!0;break}$e&&(pe.preventDefault(),i.update())}function he(){if(j.length==1)x.set(j[0].pageX,j[0].pageY);else{const pe=.5*(j[0].pageX+j[1].pageX),$e=.5*(j[0].pageY+j[1].pageY);x.set(pe,$e)}}function nt(){if(j.length==1)w.set(j[0].pageX,j[0].pageY);else{const pe=.5*(j[0].pageX+j[1].pageX),$e=.5*(j[0].pageY+j[1].pageY);w.set(pe,$e)}}function Ye(){const pe=j[0].pageX-j[1].pageX,$e=j[0].pageY-j[1].pageY,it=Math.sqrt(pe*pe+$e*$e);I.set(0,it)}function lt(){i.enableZoom&&Ye(),i.enablePan&&nt()}function Ke(){i.enableZoom&&Ye(),i.enableRotate&&he()}function Ut(pe){if(j.length==1)T.set(pe.pageX,pe.pageY);else{const it=Ln(pe),tt=.5*(pe.pageX+it.x),jt=.5*(pe.pageY+it.y);T.set(tt,jt)}S.subVectors(T,x).multiplyScalar(i.rotateSpeed);const $e=i.domElement;$e&&(te(2*Math.PI*S.x/$e.clientHeight),de(2*Math.PI*S.y/$e.clientHeight)),x.copy(T)}function bt(pe){if(j.length==1)P.set(pe.pageX,pe.pageY);else{const $e=Ln(pe),it=.5*(pe.pageX+$e.x),tt=.5*(pe.pageY+$e.y);P.set(it,tt)}M.subVectors(P,w).multiplyScalar(i.panSpeed),q(M.x,M.y),w.copy(P)}function Ct(pe){const $e=Ln(pe),it=pe.pageX-$e.x,tt=pe.pageY-$e.y,jt=Math.sqrt(it*it+tt*tt);k.set(0,jt),D.set(0,Math.pow(k.y/I.y,i.zoomSpeed)),X(D.y),I.copy(k)}function Zt(pe){i.enableZoom&&Ct(pe),i.enablePan&&bt(pe)}function ln(pe){i.enableZoom&&Ct(pe),i.enableRotate&&Ut(pe)}function Xn(pe){var $e,it;i.enabled!==!1&&(j.length===0&&(($e=i.domElement)==null||$e.ownerDocument.addEventListener("pointermove",ae),(it=i.domElement)==null||it.ownerDocument.addEventListener("pointerup",Q)),nn(pe),pe.pointerType==="touch"?Bt(pe):Ne(pe))}function ae(pe){i.enabled!==!1&&(pe.pointerType==="touch"?dt(pe):ct(pe))}function Q(pe){var $e,it,tt;Mn(pe),j.length===0&&(($e=i.domElement)==null||$e.releasePointerCapture(pe.pointerId),(it=i.domElement)==null||it.ownerDocument.removeEventListener("pointermove",ae),(tt=i.domElement)==null||tt.ownerDocument.removeEventListener("pointerup",Q)),i.dispatchEvent(o),l=a.NONE}function Ne(pe){let $e;switch(pe.button){case 0:$e=i.mouseButtons.LEFT;break;case 1:$e=i.mouseButtons.MIDDLE;break;case 2:$e=i.mouseButtons.RIGHT;break;default:$e=-1}switch($e){case sp.DOLLY:if(i.enableZoom===!1)return;Fe(pe),l=a.DOLLY;break;case sp.ROTATE:if(pe.ctrlKey||pe.metaKey||pe.shiftKey){if(i.enablePan===!1)return;Be(pe),l=a.PAN}else{if(i.enableRotate===!1)return;Re(pe),l=a.ROTATE}break;case sp.PAN:if(pe.ctrlKey||pe.metaKey||pe.shiftKey){if(i.enableRotate===!1)return;Re(pe),l=a.ROTATE}else{if(i.enablePan===!1)return;Be(pe),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function ct(pe){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;at(pe);break;case a.DOLLY:if(i.enableZoom===!1)return;pt(pe);break;case a.PAN:if(i.enablePan===!1)return;Ft(pe);break}}function et(pe){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(pe.preventDefault(),i.dispatchEvent(s),yn(pe),i.dispatchEvent(o))}function ot(pe){i.enabled===!1||i.enablePan===!1||Rt(pe)}function Bt(pe){switch(ht(pe),j.length){case 1:switch(i.touches.ONE){case op.ROTATE:if(i.enableRotate===!1)return;he(),l=a.TOUCH_ROTATE;break;case op.PAN:if(i.enablePan===!1)return;nt(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case op.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;lt(),l=a.TOUCH_DOLLY_PAN;break;case op.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Ke(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function dt(pe){switch(ht(pe),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;Ut(pe),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;bt(pe),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Zt(pe),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ln(pe),i.update();break;default:l=a.NONE}}function vt(pe){i.enabled!==!1&&pe.preventDefault()}function nn(pe){j.push(pe)}function Mn(pe){delete J[pe.pointerId];for(let $e=0;$e<j.length;$e++)if(j[$e].pointerId==pe.pointerId){j.splice($e,1);return}}function ht(pe){let $e=J[pe.pointerId];$e===void 0&&($e=new qe,J[pe.pointerId]=$e),$e.set(pe.pageX,pe.pageY)}function Ln(pe){const $e=pe.pointerId===j[0].pointerId?j[1]:j[0];return J[$e.pointerId]}this.dollyIn=(pe=ge())=>{Y(pe),i.update()},this.dollyOut=(pe=ge())=>{X(pe),i.update()},this.getScale=()=>m,this.setScale=pe=>{ie(pe),i.update()},this.getZoomScale=()=>ge(),t!==void 0&&this.connect(t),this.update()}};const U_e=G.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:i,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{const d=xf(D=>D.invalidate),m=xf(D=>D.camera),y=xf(D=>D.gl),x=xf(D=>D.events),T=xf(D=>D.setEvents),S=xf(D=>D.set),w=xf(D=>D.get),P=xf(D=>D.performance),M=e||m,I=i||x.connected||y.domElement,k=G.useMemo(()=>new F_e(M),[M]);return l_e(()=>{k.enabled&&k.update()},-1),G.useEffect(()=>(s&&k.connect(s===!0?I:s),k.connect(I),()=>void k.dispose()),[s,I,t,k,d]),G.useEffect(()=>{const D=z=>{d(),t&&P.regress(),o&&o(z)},H=z=>{a&&a(z)},W=z=>{l&&l(z)};return k.addEventListener("change",D),k.addEventListener("start",H),k.addEventListener("end",W),()=>{k.removeEventListener("start",H),k.removeEventListener("end",W),k.removeEventListener("change",D)}},[o,a,l,k,d,T]),G.useEffect(()=>{if(n){const D=w().controls;return S({controls:k}),()=>S({controls:D})}},[n,k]),G.createElement("primitive",cS({ref:u,object:k,enableDamping:r},c))}),B_e="modulepreload",z_e=function(n){return"/"+n},wF={},$C=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=l(t.map(c=>{if(c=z_e(c),c in wF)return;wF[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":B_e,u||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),u)return new Promise((y,x)=>{m.addEventListener("load",y),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function V_e(n,e){const t=n+"Geometry";return G.forwardRef(({args:i,children:r,...s},o)=>{const a=G.useRef(null);return G.useImperativeHandle(o,()=>a.current),G.useLayoutEffect(()=>void e?.(a.current)),G.createElement("mesh",cS({ref:a},s),G.createElement(t,{attach:"geometry",args:i}),r)})}const H_e=V_e("sphere"),xg={IBE:{name:"Iberia",color:"#E83323"},RYR:{name:"Ryanair",color:"#003882"},VLG:{name:"Vueling",color:"#FFCC00"},DLH:{name:"Lufthansa",color:"#001A5E"},AFR:{name:"Air France",color:"#00205B"},BAW:{name:"British Airways",color:"#00306E"},KLM:{name:"KLM",color:"#00A1E4"},EZY:{name:"easyJet",color:"#FF6600"},UAE:{name:"Emirates",color:"#D82C1F"},AAL:{name:"American Airlines",color:"#0078D2"},DAL:{name:"Delta",color:"#A8001F"},UAL:{name:"United",color:"#005DAA"},SWR:{name:"Swiss",color:"#E2051E"},QTR:{name:"Qatar Airways",color:"#5C0D32"},THY:{name:"Turkish Airlines",color:"#C00C0C"},DEFAULT:{name:n=>n,color:"#9CA3AF"}},tW=500;function W_e({positions:n=[]}){const e=G.useRef(),t=G.useMemo(()=>new I_(.005,8,8),[]),i=G.useMemo(()=>new Eh,[]),r=G.useCallback((o,a,l=1)=>{const c=(90-o)*(Math.PI/180),u=(a+180)*(Math.PI/180),d=-l*Math.sin(c)*Math.cos(u),m=l*Math.cos(c),y=l*Math.sin(c)*Math.sin(u);return[d,m,y]},[]),s=Array.isArray(n)?n:[];return U.jsxs(U.Fragment,{children:[U.jsx("ambientLight",{intensity:.75}),U.jsx("directionalLight",{position:[5,3,5],intensity:1.5}),U.jsx(H_e,{ref:e,args:[1,32,32],children:U.jsx("meshStandardMaterial",{color:"#222",roughness:.5})}),s.slice(0,tW).map((o,a)=>{const[l,c,u]=r(o.lat??0,o.lon??0,1.005),d=i.clone();return d.color=new Ot(o.color||xg.DEFAULT.color),d.transparent=!0,d.opacity=.95,U.jsx("mesh",{position:[l,c,u],geometry:t,material:d},o.icao24??a)})]})}function j_e({data:n}){if(!Array.isArray(n)||n.length===0)return null;const e=Math.max(...n.map(s=>s.flights)),t=20,i={initial:{filter:"brightness(1)",scaleY:1},hover:{filter:"brightness(1.15)",scaleY:1.03,transition:{type:"spring",stiffness:400,damping:10}}},r={initial:{opacity:0,y:5,scale:.95},hover:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:500,damping:30}}};return U.jsx("div",{className:"w-full h-full flex items-end gap-1 px-6 pb-2",children:n.map((s,o)=>{const a=e>0?s.flights/e*(100-t/3):0;return U.jsxs(Do.div,{className:"flex flex-col items-center flex-1 h-full pt-4 relative",initial:"initial",whileHover:"hover",children:[U.jsx(Do.div,{className:"absolute bottom-full mb-3 w-max max-w-xs p-3 rounded-xl bg-white/70 backdrop-blur-md shadow-lg border border-white/40 z-10 pointer-events-none",variants:r,children:U.jsxs("div",{className:"text-black",children:[U.jsx("strong",{className:"font-semibold text-xs block",children:s.name}),U.jsxs("span",{className:"text-xs text-neutral-700",children:["Total: ",s.flights," vuelos"]})]})}),U.jsx("div",{className:"relative w-full h-full flex items-end",children:U.jsx(Do.div,{className:"w-full bg-neutral-800 rounded-t-sm shadow-md origin-bottom",variants:i,initial:{height:"0%"},animate:{height:`${a}%`},transition:{type:"spring",stiffness:300,damping:50,delay:o*.05}})}),U.jsx("span",{className:"text-[10px] text-neutral-600 mt-2 text-center max-w-full truncate overflow-hidden",children:s.name})]},s.name||o)})})}function $_e({data:n}){if(!Array.isArray(n)||n.length===0)return null;const e=Math.max(...n.map(s=>s.flights)),t=20,i={initial:{filter:"brightness(1)",scaleY:1},hover:{filter:"brightness(1.15)",scaleY:1.03,transition:{type:"spring",stiffness:400,damping:10}}},r={initial:{opacity:0,y:5,scale:.95},hover:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:500,damping:30}}};return U.jsxs("div",{className:"w-full h-full flex flex-col justify-between p-2",children:[U.jsxs("div",{className:"flex justify-center items-center gap-4 text-xs text-neutral-600 mb-2",children:[U.jsxs("div",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-3 h-3 bg-neutral-800 rounded-full"})," En Vuelo"]}),U.jsxs("div",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-3 h-3 bg-neutral-400 rounded-full"})," En Tierra"]})]}),U.jsx("div",{className:"flex-grow flex items-end gap-1 px-6 pb-2",children:n.map((s,o)=>{const a=e>0?s.onGround/e*(100-t/3):0,l=e>0?s.inAir/e*(100-t/(300/100)):0;return U.jsxs(Do.div,{className:"flex flex-col items-center flex-1 h-full pt-4 relative",initial:"initial",whileHover:"hover",children:[U.jsx(Do.div,{className:"absolute bottom-full mb-3 w-max max-w-xs p-3 rounded-xl bg-white/70 backdrop-blur-md shadow-lg border border-white/40 z-10 pointer-events-none",variants:r,children:U.jsxs("div",{className:"text-black",children:[U.jsx("strong",{className:"font-semibold text-xs block",children:s.name}),U.jsxs("span",{className:"text-xs text-neutral-700 block",children:["En Vuelo: ",s.inAir]}),U.jsxs("span",{className:"text-xs text-neutral-700 block",children:["En Tierra: ",s.onGround]})]})}),U.jsxs("div",{className:"relative w-full h-full flex flex-col justify-end",children:[U.jsx(Do.div,{className:"w-full bg-neutral-800 rounded-t-sm shadow-sm origin-bottom",variants:i,initial:{height:"0%"},animate:{height:`${l}%`},transition:{type:"spring",stiffness:300,damping:50,delay:o*.05}}),U.jsx(Do.div,{className:"w-full bg-neutral-400 shadow-sm origin-bottom",variants:i,initial:{height:"0%"},animate:{height:`${a}%`},transition:{type:"spring",stiffness:300,damping:50,delay:o*.05}})]}),U.jsx("span",{className:"text-[10px] text-neutral-600 mt-2 text-center max-w-full truncate overflow-hidden",children:s.name})]},s.name||o)})})]})}function X_e({data:n}){if(!Array.isArray(n)||n.length===0)return null;const e=Math.max(...n.map(s=>s.avgAltitude)),t=20,i={initial:{filter:"brightness(1)",scaleY:1},hover:{filter:"brightness(1.15)",scaleY:1.03,transition:{type:"spring",stiffness:400,damping:10}}},r={initial:{opacity:0,y:5,scale:.95},hover:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:500,damping:30}}};return U.jsx("div",{className:"w-full h-full flex items-end gap-1 px-6 pb-2",children:n.map((s,o)=>{const a=e>0?s.avgAltitude/e*(100-t/3):0;return U.jsxs(Do.div,{className:"flex flex-col items-center flex-1 h-full pt-4 relative",initial:"initial",whileHover:"hover",children:[U.jsx(Do.div,{className:"absolute bottom-full mb-3 w-max max-w-xs p-3 rounded-xl bg-white/70 backdrop-blur-md shadow-lg border border-white/40 z-10 pointer-events-none",variants:r,children:U.jsxs("div",{className:"text-black",children:[U.jsx("strong",{className:"font-semibold text-xs block",children:s.name}),U.jsxs("span",{className:"text-xs text-neutral-700",children:["Altitud media: ",s.avgAltitude.toLocaleString("es-ES")," m"]})]})}),U.jsx("div",{className:"relative w-full h-full flex items-end",children:U.jsx(Do.div,{className:"w-full bg-neutral-800 rounded-t-sm shadow-md origin-bottom",variants:i,initial:{height:"0%"},animate:{height:`${a}%`},transition:{type:"spring",stiffness:300,damping:50,delay:o*.05}})}),U.jsx("span",{className:"text-[10px] text-neutral-600 mt-2 text-center max-w-full truncate overflow-hidden",children:s.name})]},s.name||o)})})}function G_e({data:n}){if(!Array.isArray(n)||n.length===0)return null;const e=20,t={initial:{filter:"brightness(1)",scaleY:1},hover:{filter:"brightness(1.15)",scaleY:1.03,transition:{type:"spring",stiffness:400,damping:10}}},i={initial:{opacity:0,y:5,scale:.95},hover:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:500,damping:30}}};return U.jsxs("div",{className:"w-full h-full flex flex-col justify-between p-2",children:[U.jsxs("div",{className:"flex justify-center items-center gap-3 text-xs text-neutral-600 mb-2",children:[U.jsxs("div",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-3 h-3 bg-neutral-800 rounded-full"})," Crucero"]}),U.jsxs("div",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-3 h-3 bg-neutral-600 rounded-full"})," Ascenso"]}),U.jsxs("div",{className:"flex items-center gap-1",children:[U.jsx("span",{className:"w-3 h-3 bg-neutral-400 rounded-full"})," Descenso"]})]}),U.jsx("div",{className:"flex-grow flex items-end gap-1 px-6 pb-2",children:n.map((r,s)=>{const o=r.cruise+r.ascending+r.descending,a=o>0?r.cruise/o*(100-e/(300/100)):0,l=o>0?r.ascending/o*(100-e/(300/100)):0,c=o>0?r.descending/o*(100-e/(300/100)):0;return U.jsxs(Do.div,{className:"flex flex-col items-center flex-1 h-full pt-4 relative",initial:"initial",whileHover:"hover",children:[U.jsx(Do.div,{className:"absolute bottom-full mb-3 w-max max-w-xs p-3 rounded-xl bg-white/70 backdrop-blur-md shadow-lg border border-white/40 z-10 pointer-events-none",variants:i,children:U.jsxs("div",{className:"text-black",children:[U.jsx("strong",{className:"font-semibold text-xs block",children:r.name}),U.jsxs("span",{className:"text-xs text-neutral-700 block",children:["Crucero: ",r.cruise]}),U.jsxs("span",{className:"text-xs text-neutral-700 block",children:["Ascenso: ",r.ascending]}),U.jsxs("span",{className:"text-xs text-neutral-700 block",children:["Descenso: ",r.descending]})]})}),U.jsxs("div",{className:"relative w-full h-full flex flex-col justify-end",children:[U.jsx(Do.div,{className:"w-full bg-neutral-800 rounded-t-sm shadow-sm origin-bottom",variants:t,initial:{height:"0%"},animate:{height:`${a}%`},transition:{type:"spring",stiffness:300,damping:50,delay:s*.05}}),U.jsx(Do.div,{className:"w-full bg-neutral-600 shadow-sm origin-bottom",variants:t,initial:{height:"0%"},animate:{height:`${l}%`},transition:{type:"spring",stiffness:300,damping:50,delay:s*.05}}),U.jsx(Do.div,{className:"w-full bg-neutral-400 shadow-sm origin-bottom",variants:t,initial:{height:"0%"},animate:{height:`${c}%`},transition:{type:"spring",stiffness:300,damping:50,delay:s*.05}})]}),U.jsx("span",{className:"text-[10px] text-neutral-600 mt-2 text-center max-w-full truncate overflow-hidden",children:r.name})]},r.name||s)})})]})}function Y_e(){const[n,e]=G.useState([]),[t,i]=G.useState([]),[r,s]=G.useState({total:0,top:"",topCount:0}),[o,a]=G.useState(!0),[l,c]=G.useState(null),[u,d]=G.useState(null),m="an4s3crwt",y="Mentaybolita1",x=G.useCallback(async()=>{a(!0),d(null);try{const T=btoa(`${m}:${y}`),S=await fetch("https://opensky-network.org/api/states/all",{headers:{Authorization:`Basic ${T}`}});if(!S.ok)throw new Error("La respuesta de la red no fue exitosa");const w=await S.json();if(!w||!Array.isArray(w.states))throw new Error("No se recibieron datos de vuelos.");const P={},M=[];for(const D of w.states){if(!D)continue;const H=D[1],W=!!D[8],z=(H||"").slice(0,3).toUpperCase();if(z)if(P[z]||(P[z]={total:0,onGround:0,inAir:0,altTotal:0,altCount:0,ascending:0,descending:0,cruise:0}),P[z].total++,W)P[z].onGround++;else{P[z].inAir++;const j=D[7],J=D[11];j!=null&&(P[z].altTotal+=j,P[z].altCount++),J!=null?J>1?P[z].ascending++:J<-1?P[z].descending++:P[z].cruise++:P[z].cruise++}if(M.length<tW&&D[5]!=null&&D[6]!=null&&!W){const j=xg[z]||xg.DEFAULT;M.push({icao24:D[0],callsign:H||"N/A",originCountry:D[2],lon:D[5],lat:D[6],velocity:Math.round((D[9]||0)*3.6),color:j.color||xg.DEFAULT.color})}}const k=Object.entries(P||{}).sort((D,H)=>H[1].total-D[1].total).slice(0,10).map(([D,H])=>{const W=xg[D]||xg.DEFAULT;return{prefix:D,name:typeof W.name=="function"?W.name(D):W.name,flights:H.total,onGround:H.onGround,inAir:H.inAir,avgAltitude:H.altCount>0?Math.round(H.altTotal/H.altCount):0,ascending:H.ascending,descending:H.descending,cruise:H.cruise}});e(k),i(M),s({total:Array.isArray(w.states)?w.states.length:0,top:k[0]?.name||"",topCount:k[0]?.flights||0}),c(new Date)}catch(T){console.error("Error fetching OpenSky data:",T),d(`Error: ${T?.message||String(T)}`)}finally{a(!1)}},[]);return G.useEffect(()=>{x();const T=setInterval(x,3e5);return()=>clearInterval(T)},[x]),U.jsx("div",{className:"min-h-screen bg-gradient-to-b from-neutral-100 to-neutral-300 text-black font-[Inter] flex flex-col items-center p-10",children:U.jsxs("div",{className:"max-w-[1300px] w-full flex flex-col gap-8",children:[U.jsxs("header",{className:"flex items-center justify-between",children:[U.jsx("h1",{className:"text-4xl font-semibold tracking-tight drop-shadow-sm",children:"Trfico Areo Global"}),U.jsx("button",{onClick:x,disabled:o,className:"px-4 py-2 rounded-2xl bg-white/30 backdrop-blur-xl border border-white/40 shadow-lg text-sm font-semibold hover:bg-white/50 transition disabled:opacity-50",children:o?"Actualizando...":"Actualizar"})]}),U.jsxs("div",{className:"text-sm text-neutral-600",children:["ltima actualizacin: ",l?l.toLocaleTimeString():"..."]}),u&&U.jsx("div",{className:"p-4 rounded-xl bg-red-100 text-red-800 border border-red-300",children:u}),o&&!n.length?U.jsx("p",{className:"text-center text-neutral-500 py-16",children:"Cargando datos..."}):U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[{label:"Vuelos activos",value:r.total},{label:"Aerolnea ms activa",value:r.top},{label:"Vuelos de esa aerolnea",value:r.topCount}].map((T,S)=>U.jsxs("div",{className:"rounded-3xl p-6 bg-white/40 backdrop-blur-2xl border border-white/50 shadow-xl",children:[U.jsx("p",{className:"text-sm text-neutral-600",children:T.label}),U.jsx("p",{className:"text-3xl font-bold mt-2",children:T.value})]},S))}),U.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[U.jsxs("div",{className:"rounded-3xl p-6 bg-white/40 backdrop-blur-2xl border border-white/50 shadow-xl h-[380px] flex flex-col",children:[U.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Top 10 Aerolneas (Total)"}),U.jsx("div",{className:"h-[300px] flex-grow",children:U.jsx(j_e,{data:n})})]}),U.jsxs("div",{className:"rounded-3xl p-6 bg-white/40 backdrop-blur-2xl border border-white/50 shadow-xl h-[380px] flex flex-col",children:[U.jsx("h3",{className:"text-lg font-semibold mb-2 text-center",children:"Actividad de Flota (Top 10)"}),U.jsx("div",{className:"h-[300px] flex-grow",children:U.jsx($_e,{data:n})})]})]}),U.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[U.jsxs("div",{className:"rounded-3xl p-6 bg-white/40 backdrop-blur-2xl border border-white/50 shadow-xl h-[380px] flex flex-col",children:[U.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"Perfil de Vuelo (Altitud Media)"}),U.jsx("div",{className:"h-[300px] flex-grow",children:U.jsx(X_e,{data:n})})]}),U.jsxs("div",{className:"rounded-3xl p-6 bg-white/40 backdrop-blur-2xl border border-white/50 shadow-xl h-[380px] flex flex-col",children:[U.jsx("h3",{className:"text-lg font-semibold mb-2 text-center",children:"Fases de Vuelo (Flota en Aire)"}),U.jsx("div",{className:"h-[300px] flex-grow",children:U.jsx(G_e,{data:n})})]})]}),U.jsxs("div",{className:"rounded-3xl p-6 bg-white/40 backdrop-blur-2xl border border-white/50 shadow-xl h-[550px]",children:[U.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Mapa de Trfico Areo (Vuelos en Aire)"}),U.jsx("div",{className:"h-[480px] rounded-xl overflow-hidden",children:U.jsxs(P_e,{camera:{position:[0,0,2.5],fov:75},children:[U.jsx(W_e,{positions:t}),U.jsx(U_e,{enableZoom:!0,enablePan:!1})]})})]})]})]})})}function q_e(){const[n,e]=G.useState([]),[t,i]=G.useState(!1),[r,s]=G.useState(null),[o,a]=G.useState(0),[l,c]=G.useState(!0),u=G.useRef(),d=bh(),m="an4s3crwt",y="Mentaybolita1",x=new Headers;x.set("Authorization","Basic "+btoa(m+":"+y));const T=G.useCallback(async()=>{if(l){i(!0),s(null);try{const w=await fetch("https://opensky-network.org/api/states/all",{headers:x});if(!w.ok)throw new Error(`OpenSky API error ${w.status}`);const P=await w.json();if(!P||!Array.isArray(P.states))throw new Error("Datos no vlidos o vacos de OpenSky");const M=Array.from(new Set(P.states.map(D=>D?.[1]).filter(Boolean))).slice(o,o+20);if(!M.length){c(!1),i(!1);return}const k=(await Promise.all(M.map(async D=>{try{const H=await fetch(`https://hexdb.io/callsign-route-iata?callsign=${D}`);if(!H.ok)return null;const W=await H.text(),[z,j]=W.split("-").map(ge=>ge?.trim());if(!z)return null;const J=await fetch(`https://hexdb.io/api/v1/airport/iata/${z}`);if(!J.ok)return null;const le=await J.json();return{callsign:D,name:le.airport||z,country:le.region_name||"Unknown",countryCode:le.country_code||"US",departure:z,arrival:j||""}}catch{return null}}))).filter(Boolean);e(D=>[...D,...k]),k.length<20&&c(!1)}catch(w){console.error(" Error en fetchData:",w),s(w.message)}finally{i(!1)}}},[o,l]),S=G.useCallback(w=>{t||(u.current&&u.current.disconnect(),u.current=new IntersectionObserver(P=>{P[0].isIntersecting&&a(M=>M+20)}),w&&u.current.observe(w))},[t]);return G.useEffect(()=>{T()},[T]),U.jsxs("div",{className:"relative",children:[U.jsx("div",{className:"mb-8 text-center",children:U.jsx("h2",{className:"text-2xl font-medium text-gray-900 dark:text-gray-100 tracking-tight select-none",children:"Aeropuertos Activos"})}),r&&U.jsxs("div",{className:"bg-red-50/70 dark:bg-red-900/30 border border-red-200/40 dark:border-red-800/40 text-red-700 dark:text-red-300 p-4 rounded-2xl mb-6 text-center backdrop-blur-md",children:[U.jsx("p",{children:r}),U.jsx("button",{onClick:()=>{s(null),T()},className:"mt-3 px-5 py-2 bg-red-100/60 dark:bg-red-800/40 hover:bg-red-200/80 dark:hover:bg-red-700/60 rounded-xl transition-all text-sm font-medium text-gray-700 dark:text-gray-200",children:"Reintentar"})]}),U.jsxs("div",{className:"space-y-3",children:[n.map((w,P)=>U.jsxs("div",{ref:P===n.length-1?S:null,onClick:()=>d(`/airport/${w.departure}`),className:"group flex items-center gap-4 p-4 bg-white/50 dark:bg-white/5 border border-gray-200/40 dark:border-white/10 rounded-2xl hover:bg-white/70 dark:hover:bg-white/10 hover:scale-[1.01] transition-all duration-300 cursor-pointer backdrop-blur-lg",children:[U.jsx("div",{className:"w-10 h-6 flex items-center justify-center",children:U.jsx("img",{src:`https://flagcdn.com/w40/${w.countryCode?.toLowerCase()}.png`,alt:w.country,className:"rounded shadow-sm opacity-80 group-hover:opacity-100 transition-all",onError:M=>M.target.style.display="none"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"text-gray-900 dark:text-white font-medium text-lg leading-tight",children:w.callsign}),U.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[w.name,"  ",w.country]}),U.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1 tracking-wide",children:[w.departure,"  ",w.arrival]})]})]},`${w.callsign}-${w.departure}`)),t&&U.jsxs("div",{className:"flex flex-col items-center justify-center py-10",children:[U.jsx("div",{className:"w-6 h-6 border border-gray-300 dark:border-gray-700 border-t-gray-900 dark:border-t-white rounded-full animate-spin"}),U.jsx("p",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400 tracking-wide",children:"Cargando aeropuertos..."})]}),!t&&!n.length&&!r&&U.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-10 text-sm",children:"No se encontraron aeropuertos"}),!l&&!t&&n.length>0&&U.jsx("p",{className:"text-center text-gray-400 dark:text-gray-500 text-sm pt-6 tracking-tight",children:"Fin de la lista"})]})]})}function Z_e(){return U.jsxs("div",{className:"access-denied",children:[U.jsx("h1",{children:"Access Denied"}),U.jsx("p",{children:"You do not have permission to view this page."})]})}class bf extends G.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught:",e,t)}handleReset=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?U.jsxs("div",{className:"error-boundary",children:[U.jsx("h2",{children:"Something went wrong"}),U.jsx("p",{children:this.state.error?.toString()}),U.jsx("button",{onClick:this.handleReset,children:"Try again"})]}):this.props.children}}function uS(n,e){if(!n)throw new Error(e||"loader assertion failed.")}const z2=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),SF=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);SF&&parseFloat(SF[1]);const TF=globalThis,EF=globalThis.process||{},K_e=globalThis.navigator||{};function nW(n){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const t=typeof navigator<"u"&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}function um(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||nW()}function J_e(n){return um()?nW()?"Electron":(K_e.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const iW="4.1.0";function Q_e(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class eye{constructor(e,t,i="sessionStorage"){this.storage=Q_e(i),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function tye(n){let e;return n<10?e=`${n.toFixed(2)}ms`:n<100?e=`${n.toFixed(1)}ms`:n<1e3?e=`${n.toFixed(0)}ms`:e=`${(n/1e3).toFixed(2)}s`,e}function nye(n,e=8){const t=Math.max(e-n.length,0);return`${" ".repeat(t)}${n}`}var hS;(function(n){n[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(hS||(hS={}));const iye=10;function AF(n){return typeof n!="string"?n:(n=n.toUpperCase(),hS[n]||hS.WHITE)}function rye(n,e,t){return!um&&typeof n=="string"&&(e&&(n=`\x1B[${AF(e)}m${n}\x1B[39m`),t&&(n=`\x1B[${AF(t)+iye}m${n}\x1B[49m`)),n}function sye(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t),r=n;for(const s of i){const o=r[s];typeof o=="function"&&(e.find(a=>s===a)||(r[s]=o.bind(n)))}}function V2(n,e){if(!n)throw new Error("Assertion failed")}function fg(){let n;if(um()&&TF.performance)n=TF?.performance?.now?.();else if("hrtime"in EF){const e=EF?.hrtime?.();n=e[0]*1e3+e[1]/1e6}else n=Date.now();return n}const dg={debug:um()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},oye={enabled:!0,level:0};function pg(){}const MF={},CF={once:!0};class F0{constructor({id:e}={id:""}){this.VERSION=iW,this._startTs=fg(),this._deltaTs=fg(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new eye(`__probe-${this.id}__`,oye),this.timeStamp(`${this.id} started`),sye(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((fg()-this._startTs).toPrecision(10))}getDelta(){return Number((fg()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,dg.warn,arguments,CF)}error(e){return this._getLogFunction(0,e,dg.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,dg.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,dg.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,dg.debug||dg.info,arguments,CF)}table(e,t,i){return t?this._getLogFunction(e,t,console.table||pg,i&&[i],{tag:lye(t)}):pg}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||pg)}group(e,t,i={collapsed:!1}){const r=PF({logLevel:e,message:t,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t,i={}){return this.group(e,t,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||pg)}withGroup(e,t,i){this.group(e,t)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=rW(e)}_getLogFunction(e,t,i,r,s){if(this._shouldLog(e)){s=PF({logLevel:e,message:t,args:r,opts:s}),i=i||s.method,V2(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=fg();const o=s.tag||s.message;if(s.once&&o)if(!MF[o])MF[o]=fg();else return pg;return t=aye(this.id,s.message,s),i.bind(console,t,...s.args)}return pg}}F0.VERSION=iW;function rW(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return V2(Number.isFinite(e)&&e>=0),e}function PF(n){const{logLevel:e,message:t}=n;n.logLevel=rW(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e);break}typeof n.message=="function"&&(n.message=n.message());const r=typeof n.message;return V2(r==="string"||r==="object"),Object.assign(n,{args:i},n.opts)}function aye(n,e,t){if(typeof e=="string"){const i=t.time?nye(tye(t.total)):"";e=t.time?`${n}: ${i}  ${e}`:`${n}: ${e}`,e=rye(e,t.color,t.background)}return e}function lye(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}const mA="4.3.3",cye=mA[0]>="0"&&mA[0]<="9"?`v${mA}`:"";function uye(){const n=new F0({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=n,globalThis.loaders.version=cye,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=n,n}const hye=uye();function fye(n,e){return sW(n||{},e)}function sW(n,e,t=0){if(t>3)return e;const i={...n};for(const[r,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?i[r]=sW(i[r]||{},e[r],t+1):i[r]=e[r];return i}const dye="latest";function pye(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const mye=pye();function rd(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}const Lp=typeof process!="object"||String(process)!=="[object process]"||process.browser,gye=typeof window<"u"&&typeof window.orientation<"u",RF=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);RF&&parseFloat(RF[1]);class _ye{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){rd(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){rd(this.isRunning),this.isRunning=!1,this._reject(e)}}class gA{terminate(){}}const _A=new Map;function yye(n){rd(n.source&&!n.url||!n.source&&n.url);let e=_A.get(n.source||n.url);return e||(n.url&&(e=vye(n.url),_A.set(n.url,e)),n.source&&(e=oW(n.source),_A.set(n.source,e))),rd(e),e}function vye(n){if(!n.startsWith("http"))return n;const e=xye(n);return oW(e)}function oW(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function xye(n){return`try {
  importScripts('${n}');
} catch (error) {
  console.error(error);
  throw error;
}`}function aW(n,e=!0,t){const i=t||new Set;if(n){if(IF(n))i.add(n);else if(IF(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(e&&typeof n=="object")for(const r in n)aW(n[r],e,i)}}return t===void 0?Array.from(i):[]}function IF(n){return n?n instanceof ArrayBuffer||typeof MessagePort<"u"&&n instanceof MessagePort||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas:!1}const yA=()=>{};class XC{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&Lp||typeof gA<"u"&&!Lp}constructor(e){const{name:t,source:i,url:r}=e;rd(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=yA,this.onError=s=>console.log(s),this.worker=Lp?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=yA,this.onError=yA,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||aW(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=yye({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new gA(i,{eval:!1})}else if(this.source)e=new gA(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class bye{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return XC.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,t=(r,s,o)=>r.done(o),i=(r,s)=>r.error(s)){const r=new Promise(s=>(this.jobQueue.push({name:e,onMessage:t,onError:i,onStart:s}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const i=new _ye(t.name,e);e.onMessage=r=>t.onMessage(i,r.type,r.payload),e.onError=r=>t.onError(i,r),t.onStart(i);try{await i.result}catch(r){console.error(`Worker exception: ${r}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Lp||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new XC({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return gye?this.maxMobileConcurrency:this.maxConcurrency}}const wye={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class kf{props;workerPools=new Map;static _workerFarm;static isSupported(){return XC.isSupported()}static getWorkerFarm(e={}){return kf._workerFarm=kf._workerFarm||new kf({}),kf._workerFarm.setProps(e),kf._workerFarm}constructor(e){this.props={...wye},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new bye({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function Sye(n,e={}){const t=e[n.id]||{},i=Lp?`${n.id}-worker.js`:`${n.id}-worker-node.js`;let r=t.workerUrl;if(!r&&n.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(Lp?r=`modules/${n.module}/dist/${i}`:r=`modules/${n.module}/src/workers/${n.id}-worker-node.ts`),!r){let s=n.version;s==="latest"&&(s=dye);const o=s?`@${s}`:"";r=`https://unpkg.com/@loaders.gl/${n.module}${o}/dist/${i}`}return rd(r),r}function Tye(n,e=mye){rd(n,"no worker provided");const t=n.version;return!(!e||!t)}function Eye(n,e){return!kf.isSupported()||!Lp&&!e?._nodeWorkers?!1:n.worker&&e?.worker}async function Aye(n,e,t,i,r){const s=n.id,o=Sye(n,t),l=kf.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i||{}));const c=await l.startJob("process-on-worker",Mye.bind(null,r));return c.postMessage("process",{input:e,options:t,context:i}),await(await c.result).result}async function Mye(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:o}=i;try{const a=await n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}}function Cye(n,e,t){if(t=t||n.byteLength,n.byteLength<t||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}function Pye(...n){return Rye(n)}function Rye(n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}async function Iye(n){const e=[];for await(const t of n)e.push(t);return Pye(...e)}function kF(){let n;if(typeof window<"u"&&window.performance)n=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();n=e[0]*1e3+e[1]/1e6}else n=Date.now();return n}class OF{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=kF(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(kF()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class BT{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:i}=e;let r=this.stats[t];return r||(e instanceof OF?r=e:r=new OF(t,i),this.stats[t]=r),r}}let kye="";const LF={};function Oye(n){for(const e in LF)if(n.startsWith(e)){const t=LF[e];n=n.replace(e,t)}return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${kye}${n}`),n}function Lye(n){return n&&typeof n=="object"&&n.isBuffer}function lW(n){if(Lye(n))return n;if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if(typeof n=="string"){const e=n;return new TextEncoder().encode(e).buffer}if(n&&typeof n=="object"&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function cW(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(e+1):""}function Nye(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(0,e):""}const Dye=n=>typeof n=="boolean",sv=n=>typeof n=="function",U0=n=>n!==null&&typeof n=="object",NF=n=>U0(n)&&n.constructor==={}.constructor,Fye=n=>!!n&&typeof n[Symbol.iterator]=="function",Uye=n=>n&&typeof n[Symbol.asyncIterator]=="function",hm=n=>typeof Response<"u"&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,fm=n=>typeof Blob<"u"&&n instanceof Blob,Bye=n=>n&&typeof n=="object"&&n.isBuffer,zye=n=>typeof ReadableStream<"u"&&n instanceof ReadableStream||U0(n)&&sv(n.tee)&&sv(n.cancel)&&sv(n.getReader),Vye=n=>U0(n)&&sv(n.read)&&sv(n.pipe)&&Dye(n.readable),uW=n=>zye(n)||Vye(n);class Hye extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const Wye=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,jye=/^([-\w.]+\/[-\w.+]+)/;function DF(n,e){return n.toLowerCase()===e.toLowerCase()}function $ye(n){const e=jye.exec(n);return e?e[1]:n}function FF(n){const e=Wye.exec(n);return e?e[1]:""}const hW=/\?.*/;function Xye(n){const e=n.match(hW);return e&&e[0]}function H2(n){return n.replace(hW,"")}function Gye(n){if(n.length<50)return n;const e=n.slice(n.length-15);return`${n.substr(0,32)}...${e}`}function zT(n){return hm(n)?n.url:fm(n)?n.name||"":typeof n=="string"?n:""}function W2(n){if(hm(n)){const e=n,t=e.headers.get("content-type")||"",i=H2(e.url);return $ye(t)||FF(i)}return fm(n)?n.type||"":typeof n=="string"?FF(n):""}function Yye(n){return hm(n)?n.headers["content-length"]||-1:fm(n)?n.size:typeof n=="string"?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}async function fW(n){if(hm(n))return n;const e={},t=Yye(n);t>=0&&(e["content-length"]=String(t));const i=zT(n),r=W2(n);r&&(e["content-type"]=r);const s=await Kye(n);s&&(e["x-first-bytes"]=s),typeof n=="string"&&(n=new TextEncoder().encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o}async function qye(n){if(!n.ok)throw await Zye(n)}async function Zye(n){const e=Gye(n.url);let t=`Failed to fetch resource (${n.status}) ${n.statusText}: ${e}`;t=t.length>100?`${t.slice(0,100)}...`:t;const i={reason:n.statusText,url:n.url,response:n};try{const r=n.headers.get("Content-Type");i.reason=!n.bodyUsed&&r?.includes("application/json")?await n.json():await n.text()}catch{}return new Hye(t,i)}async function Kye(n){if(typeof n=="string")return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=s=>i(s?.target?.result),r.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const t=n.slice(0,5);return`data:base64,${Jye(t)}`}return null}function Jye(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function Qye(n){return!eve(n)&&!tve(n)}function eve(n){return n.startsWith("http:")||n.startsWith("https:")}function tve(n){return n.startsWith("data:")}async function UF(n,e){if(typeof n=="string"){const t=Oye(n);return Qye(t)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(t,e):await fetch(t,e)}return await fW(n)}const BF=new F0({id:"loaders.gl"});class nve{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class ive{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const dW={fetch:null,mimeType:void 0,nothrow:!1,log:new ive,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:z2,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},rve={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function pW(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state||(n._state={}),n._state}function mW(){const n=pW();return n.globalOptions=n.globalOptions||{...dW},n.globalOptions}function sve(n,e,t,i){return t=t||[],t=Array.isArray(t)?t:[t],ove(n,t),lve(e,n,i)}function ove(n,e){zF(n,null,dW,rve,e);for(const t of e){const i=n&&n[t.id]||{},r=t.options&&t.options[t.id]||{},s=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};zF(i,t.id,r,s,e)}}function zF(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&U0(n[a]),c=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in t)&&!c&&!u){if(a in i)BF.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const d=ave(a,r);BF.warn(`${s} loader option '${o}${a}' not recognized. ${d}`)()}}}}function ave(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function lve(n,e,t){const r={...n.options||{}};return cve(r,t),r.log===null&&(r.log=new nve),VF(r,mW()),VF(r,e),r}function VF(n,e){for(const t in e)if(t in e){const i=e[t];NF(i)&&NF(n[t])?n[t]={...n[t],...e[t]}:n[t]=e[t]}}function cve(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}function j2(n){return n?(Array.isArray(n)&&(n=n[0]),Array.isArray(n?.extensions)):!1}function $2(n){uS(n,"null loader"),uS(j2(n),"invalid loader");let e;return Array.isArray(n)&&(e=n[1],n=n[0],n={...n,options:{...n.options,...e}}),(n?.parseTextSync||n?.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const gW=()=>{const n=pW();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function uve(n){const e=gW();n=Array.isArray(n)?n:[n];for(const t of n){const i=$2(t);e.find(r=>i===r)||e.unshift(i)}}function hve(){return gW()}const fve=/\.([^.]+)$/;async function dve(n,e=[],t,i){if(!_W(n))return null;let r=HF(n,e,{...t,nothrow:!0},i);if(r)return r;if(fm(n)&&(n=await n.slice(0,10).arrayBuffer(),r=HF(n,e,t,i)),!r&&!t?.nothrow)throw new Error(yW(n));return r}function HF(n,e=[],t,i){if(!_W(n))return null;if(e&&!Array.isArray(e))return $2(e);let r=[];e&&(r=r.concat(e)),t?.ignoreRegisteredLoaders||r.push(...hve()),mve(r);const s=pve(n,r,t,i);if(!s&&!t?.nothrow)throw new Error(yW(n));return s}function pve(n,e,t,i){const r=zT(n),s=W2(n),o=H2(r)||i?.url;let a=null,l="";return t?.mimeType&&(a=vA(e,t?.mimeType),l=`match forced by supplied MIME type ${t?.mimeType}`),a=a||gve(e,o),l=l||(a?`matched url ${o}`:""),a=a||vA(e,s),l=l||(a?`matched MIME type ${s}`:""),a=a||yve(e,n),l=l||(a?`matched initial data ${vW(n)}`:""),t?.fallbackMimeType&&(a=a||vA(e,t?.fallbackMimeType),l=l||(a?`matched fallback MIME type ${s}`:"")),l&&hye.log(1,`selectLoader selected ${a?.name}: ${l}.`),a}function _W(n){return!(n instanceof Response&&n.status===204)}function yW(n){const e=zT(n),t=W2(n);let i="No valid loader found (";i+=e?`${cW(e)}, `:"no url provided, ",i+=`MIME type: ${t?`"${t}"`:"not provided"}, `;const r=n?vW(n):"";return i+=r?` first bytes: "${r}"`:"first bytes: not available",i+=")",i}function mve(n){for(const e of n)$2(e)}function gve(n,e){const t=e&&fve.exec(e),i=t&&t[1];return i?_ve(n,i):null}function _ve(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}function vA(n,e){for(const t of n)if(t.mimeTypes?.some(i=>DF(e,i))||DF(e,`application/x.${t.id}`))return t;return null}function yve(n,e){if(!e)return null;for(const t of n)if(typeof e=="string"){if(vve(e,t))return t}else if(ArrayBuffer.isView(e)){if(WF(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&WF(e,0,t))return t;return null}function vve(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function WF(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>xve(n,e,t,r))}function xve(n,e,t,i){if(i instanceof ArrayBuffer)return Cye(i,n,i.byteLength);switch(typeof i){case"function":return i(n);case"string":const r=GC(n,e,i.length);return i===r;default:return!1}}function vW(n,e=5){return typeof n=="string"?n.slice(0,e):ArrayBuffer.isView(n)?GC(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?GC(n,0,e):""}function GC(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}const bve=256*1024;function*wve(n,e){const t=e?.chunkSize||bve;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}const Sve=256*1024;function*Tve(n,e={}){const{chunkSize:t=Sve}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}const Eve=1024*1024;async function*Ave(n,e){const t=e?.chunkSize||Eve;let i=0;for(;i<n.size;){const r=i+t,s=await n.slice(i,r).arrayBuffer();i=r,yield s}}function jF(n,e){return z2?Mve(n,e):Cve(n)}async function*Mve(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();e?._streamReadAhead&&(i=t.read());const{done:s,value:o}=await r;if(s)return;yield lW(o)}}catch{t.releaseLock()}}async function*Cve(n,e){for await(const t of n)yield lW(t)}function Pve(n,e){if(typeof n=="string")return wve(n,e);if(n instanceof ArrayBuffer)return Tve(n,e);if(fm(n))return Ave(n,e);if(uW(n))return jF(n,e);if(hm(n))return jF(n.body,e);throw new Error("makeIterator")}const xW="Cannot convert supplied data type";function Rve(n,e,t){if(e.text&&typeof n=="string")return n;if(Bye(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(n.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(xW)}async function Ive(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if(typeof n=="string"||i)return Rve(n,e);if(fm(n)&&(n=await fW(n)),hm(n)){const r=n;return await qye(r),e.binary?await r.arrayBuffer():await r.text()}if(uW(n)&&(n=Pve(n,t)),Fye(n)||Uye(n))return Iye(n);throw new Error(xW)}function bW(n,e){const t=mW(),i=n||t;return typeof i.fetch=="function"?i.fetch:U0(i.fetch)?r=>UF(r,i.fetch):e?.fetch?e?.fetch:UF}function kve(n,e,t){if(t)return t;const i={fetch:bW(e,n),...n};if(i.url){const r=H2(i.url);i.baseUrl=r,i.queryString=Xye(i.url),i.filename=cW(r),i.baseUrl=Nye(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function Ove(n,e){if(n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:void 0}async function fS(n,e,t,i){e&&!Array.isArray(e)&&!j2(e)&&(i=void 0,t=e,e=void 0),n=await n,t=t||{};const r=zT(n),o=Ove(e,i),a=await dve(n,o,t);return a?(t=sve(t,a,o,r),i=kve({url:r,_parse:fS,loaders:o},t,i||null),await Lve(a,n,t,i)):null}async function Lve(n,e,t,i){if(Tye(n),t=fye(n.options,t),hm(e)){const s=e,{ok:o,redirected:a,status:l,statusText:c,type:u,url:d}=s,m=Object.fromEntries(s.headers.entries());i.response={headers:m,ok:o,redirected:a,status:l,statusText:c,type:u,url:d}}e=await Ive(e,n,t);const r=n;if(r.parseTextSync&&typeof e=="string")return r.parseTextSync(e,t,i);if(Eye(n,t))return await Aye(n,e,t,i,fS);if(r.parseText&&typeof e=="string")return await r.parseText(e,t,i);if(r.parse)return await r.parse(e,t,i);throw rd(!r.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)}async function dS(n,e,t,i){let r,s;!Array.isArray(e)&&!j2(e)?(r=[],s=e):(r=e,s=t);const o=bW(s);let a=n;return typeof n=="string"&&(a=await o(n)),fm(n)&&(a=await o(n)),Array.isArray(r)?await fS(a,r,s):await fS(a,r,s)}const Nve="4.3.3",Dve=globalThis.loaders?.parseImageNode,YC=typeof Image<"u",qC=typeof ImageBitmap<"u",Fve=!!Dve,ZC=z2?!0:Fve;function Uve(n){switch(n){case"auto":return qC||YC||ZC;case"imagebitmap":return qC;case"image":return YC;case"data":return ZC;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}function Bve(){if(qC)return"imagebitmap";if(YC)return"image";if(ZC)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function zve(n){const e=Hve(n);if(!e)throw new Error("Not an image");return e}function Vve(n){switch(zve(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}function Hve(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&typeof n=="object"&&n.data&&n.width&&n.height?"data":null}const Wve=/^data:image\/svg\+xml/,jve=/\.svg((\?|#).*)?$/;function X2(n){return n&&(Wve.test(n)||jve.test(n))}function $ve(n,e){if(X2(e)){let i=new TextDecoder().decode(n);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return wW(n,e)}function wW(n,e){if(X2(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}async function SW(n,e,t){const i=$ve(n,t),r=self.URL||self.webkitURL,s=typeof i!="string"&&r.createObjectURL(i);try{return await Xve(s||i,e)}finally{s&&r.revokeObjectURL(s)}}async function Xve(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>{const o=s instanceof Error?s.message:"error";r(new Error(o))}}catch(s){r(s)}})}const Gve={};let $F=!0;async function Yve(n,e,t){let i;X2(t)?i=await SW(n,e,t):i=wW(n,t);const r=e&&e.imagebitmap;return await qve(i,r)}async function qve(n,e=null){if((Zve(e)||!$F)&&(e=null),e)try{return await createImageBitmap(n,e)}catch(t){console.warn(t),$F=!1}return await createImageBitmap(n)}function Zve(n){for(const e in n||Gve)return!1;return!0}function Kve(n){return!t0e(n,"ftyp",4)||(n[8]&96)===0?null:Jve(n)}function Jve(n){switch(Qve(n,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Qve(n,e,t){return String.fromCharCode(...n.slice(e,t))}function e0e(n){return[...n].map(e=>e.charCodeAt(0))}function t0e(n,e,t=0){const i=e0e(e);for(let r=0;r<i.length;++r)if(i[r]!==n[r+t])return!1;return!0}const Yc=!1,ov=!0;function TW(n){const e=B0(n);return i0e(e)||o0e(e)||r0e(e)||s0e(e)||n0e(e)}function n0e(n){const e=new Uint8Array(n instanceof DataView?n.buffer:n),t=Kve(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function i0e(n){const e=B0(n);return e.byteLength>=24&&e.getUint32(0,Yc)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Yc),height:e.getUint32(20,Yc)}:null}function r0e(n){const e=B0(n);return e.byteLength>=10&&e.getUint32(0,Yc)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,ov),height:e.getUint16(8,ov)}:null}function s0e(n){const e=B0(n);return e.byteLength>=14&&e.getUint16(0,Yc)===16973&&e.getUint32(2,ov)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,ov),height:e.getUint32(22,ov)}:null}function o0e(n){const e=B0(n);if(!(e.byteLength>=3&&e.getUint16(0,Yc)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=a0e();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Yc);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Yc),width:e.getUint16(s+7,Yc)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Yc)}return null}function a0e(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function B0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}async function l0e(n,e){const{mimeType:t}=TW(n)||{},i=globalThis.loaders?.parseImageNode;return uS(i),await i(n,t)}async function c0e(n,e,t){e=e||{};const r=(e.image||{}).type||"auto",{url:s}=t||{},o=u0e(r);let a;switch(o){case"imagebitmap":a=await Yve(n,e,s);break;case"image":a=await SW(n,e,s);break;case"data":a=await l0e(n);break;default:uS(!1)}return r==="data"&&(a=Vve(a)),a}function u0e(n){switch(n){case"auto":case"data":return Bve();default:return Uve(n),n}}const h0e=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],f0e=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],d0e={image:{type:"auto",decode:!0}},p0e={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:Nve,mimeTypes:f0e,extensions:h0e,parse:c0e,tests:[n=>!!TW(new DataView(n))],options:d0e},vi=new F0({id:"deck"});let KC={};function m0e(n){KC=n}function No(n,e,t,i){vi.level>0&&KC[n]&&KC[n].call(null,e,t,i)}function g0e(n){const e=n[0],t=n[n.length-1];return e==="{"&&t==="}"||e==="["&&t==="]"}const _0e={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:g0e,parseTextSync:JSON.parse};function y0e(){const n="9.2.2",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==n)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${n}`);return e||(vi.log(1,`deck.gl ${n}`)(),globalThis.deck={...globalThis.deck,VERSION:n,version:n,log:vi,_registerLoggers:m0e},uve([_0e,[p0e,{imagebitmap:{premultiplyAlpha:"none"}}]])),n}const v0e=y0e();function G2(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const xA={number:{type:"number",validate(n,e){return Number.isFinite(n)&&typeof e=="object"&&(e.max===void 0||n<=e.max)&&(e.min===void 0||n>=e.min)}},array:{type:"array",validate(n,e){return Array.isArray(n)||ArrayBuffer.isView(n)}}};function x0e(n){const e={};for(const[t,i]of Object.entries(n))e[t]=b0e(i);return e}function b0e(n){let e=XF(n);if(e!=="object")return{value:n,...xA[e],type:e};if(typeof n=="object")return n?n.type!==void 0?{...n,...xA[n.type],type:n.type}:n.value===void 0?{type:"object",value:n}:(e=XF(n.value),{...n,...xA[e],type:e}):{type:"object",value:null};throw new Error("props")}function XF(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}const w0e=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,S0e=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,T0e={vertex:w0e,fragment:S0e},GF=/void\s+main\s*\([^)]*\)\s*\{\n?/,YF=/}\n?[^{}]*$/,bA=[],ww="__LUMA_INJECT_DECLARATIONS__";function E0e(n){const e={vertex:{},fragment:{}};for(const t in n){let i=n[t];const r=A0e(t);typeof i=="string"&&(i={order:0,injection:i}),e[r][t]=i}return e}function A0e(n){const e=n.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function pS(n,e,t,i=!1){const r=e==="vertex";for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),bA.length=o.length;for(let l=0,c=o.length;l<c;++l)bA[l]=o[l].injection;const a=`${bA.join(`
`)}
`;switch(s){case"vs:#decl":r&&(n=n.replace(ww,a));break;case"vs:#main-start":r&&(n=n.replace(GF,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(YF,l=>a+l));break;case"fs:#decl":r||(n=n.replace(ww,a));break;case"fs:#main-start":r||(n=n.replace(GF,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(YF,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(ww,""),i&&(n=n.replace(/\}\s*$/,s=>s+T0e[e])),n}function mS(n){n.map(e=>M0e(e))}function M0e(n){if(n.instance)return;mS(n.dependencies||[]);const{propTypes:e={},deprecations:t=[],inject:i={}}=n,r={normalizedInjections:E0e(i),parsedDeprecations:C0e(t)};e&&(r.propValidators=x0e(e)),n.instance=r;let s={};e&&(s=Object.entries(e).reduce((o,[a,l])=>{const c=l?.value;return c&&(o[a]=c),o},{})),n.defaultUniforms={...n.defaultUniforms,...s}}function EW(n,e,t){n.deprecations?.forEach(i=>{i.regex?.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}function C0e(n){return n.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),n}function Y2(n){mS(n);const e={},t={};AW({modules:n,level:0,moduleMap:e,moduleDepth:t});const i=Object.keys(t).sort((r,s)=>t[s]-t[r]).map(r=>e[r]);return mS(i),i}function AW(n){const{modules:e,level:t,moduleMap:i,moduleDepth:r}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(r[s.name]===void 0||r[s.name]<t)&&(r[s.name]=t);for(const s of e)s.dependencies&&AW({modules:s.dependencies,level:t+1,moduleMap:i,moduleDepth:r})}function P0e(n){switch(n?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function R0e(n,e){if(Number(n.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return n=qF(n,I0e),n;case"fragment":return n=qF(n,k0e),n;default:throw new Error(e)}}const MW=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],I0e=[...MW,[JC("attribute"),"in $1"],[JC("varying"),"out $1"]],k0e=[...MW,[JC("varying"),"in $1"]];function qF(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}function JC(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function CW(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {
`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}
`}r.footer&&(t+=`  ${r.footer}`),t+=`}
`}return t}function PW(n){const e={vertex:{},fragment:{}};for(const t of n){let i,r;typeof t!="string"?(i=t,r=i.hook):(i={},r=t),r=r.trim();const[s,o]=r.split(":"),a=r.replace(/\(.+/,""),l=Object.assign(i,{signature:o});switch(s){case"vs":e.vertex[a]=l;break;case"fs":e.fragment[a]=l;break;default:throw new Error(s)}}return e}function O0e(n,e){return{name:L0e(n,e),language:"glsl",version:N0e(n)}}function L0e(n,e="unnamed"){const i=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(n);return i?i[1]:e}function N0e(n){let e=100;const t=n.match(/[^\s]+/g);if(t&&t.length>=2&&t[0]==="#version"){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const RW=`

${ww}
`,D0e=`precision highp float;
`;function F0e(n){const e=Y2(n.modules||[]);return{source:B0e(n.platformInfo,{...n,source:n.source,stage:"vertex",modules:e}),getUniforms:IW(e)}}function U0e(n){const{vs:e,fs:t}=n,i=Y2(n.modules||[]);return{vs:ZF(n.platformInfo,{...n,source:e,stage:"vertex",modules:i}),fs:ZF(n.platformInfo,{...n,source:t,stage:"fragment",modules:i}),getUniforms:IW(i)}}function B0e(n,e){const{source:t,stage:i,modules:r,hookFunctions:s=[],inject:o={},log:a}=e;G2(typeof t=="string","shader source must be a string");const l=t;let c="";const u=PW(s),d={},m={},y={};for(const T in o){const S=typeof o[T]=="string"?{injection:o[T],order:0}:o[T],w=/^(v|f)s:(#)?([\w-]+)$/.exec(T);if(w){const P=w[2],M=w[3];P?M==="decl"?m[T]=[S]:y[T]=[S]:d[T]=[S]}else y[T]=[S]}const x=r;for(const T of x){a&&EW(T,l,a);const S=kW(T,"wgsl");c+=S;const w=T.injections?.[i]||{};for(const P in w){const M=/^(v|f)s:#([\w-]+)$/.exec(P);if(M){const k=M[2]==="decl"?m:y;k[P]=k[P]||[],k[P].push(w[P])}else d[P]=d[P]||[],d[P].push(w[P])}}return c+=RW,c=pS(c,i,m),c+=CW(u[i],d),c+=l,c=pS(c,i,y),c}function ZF(n,e){const{source:t,stage:i,language:r="glsl",modules:s,defines:o={},hookFunctions:a=[],inject:l={},prologue:c=!0,log:u}=e;G2(typeof t=="string","shader source must be a string");const d=r==="glsl"?O0e(t).version:-1,m=n.shaderLanguageVersion,y=d===100?"#version 100":"#version 300 es",T=t.split(`
`).slice(1).join(`
`),S={};s.forEach(D=>{Object.assign(S,D.defines)}),Object.assign(S,o);let w="";switch(r){case"wgsl":break;case"glsl":w=c?`${y}

// ----- PROLOGUE -------------------------
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${P0e(n)}
${i==="fragment"?D0e:""}

// ----- APPLICATION DEFINES -------------------------

${z0e(S)}

`:`${y}
`;break}const P=PW(a),M={},I={},k={};for(const D in l){const H=typeof l[D]=="string"?{injection:l[D],order:0}:l[D],W=/^(v|f)s:(#)?([\w-]+)$/.exec(D);if(W){const z=W[2],j=W[3];z?j==="decl"?I[D]=[H]:k[D]=[H]:M[D]=[H]}else k[D]=[H]}for(const D of s){u&&EW(D,T,u);const H=kW(D,i);w+=H;const W=D.instance?.normalizedInjections[i]||{};for(const z in W){const j=/^(v|f)s:#([\w-]+)$/.exec(z);if(j){const le=j[2]==="decl"?I:k;le[z]=le[z]||[],le[z].push(W[z])}else M[z]=M[z]||[],M[z].push(W[z])}}return w+="// ----- MAIN SHADER SOURCE -------------------------",w+=RW,w=pS(w,i,I),w+=CW(P[i],M),w+=T,w=pS(w,i,k),r==="glsl"&&d!==m&&(w=R0e(w,i)),w.trim()}function IW(n){return function(t){const i={};for(const r of n){const s=r.getUniforms?.(t,i);Object.assign(i,s)}return i}}function z0e(n={}){let e="";for(const t in n){const i=n[t];(i||Number.isFinite(i))&&(e+=`#define ${t.toUpperCase()} ${n[t]}
`)}return e}function kW(n,e){let t;switch(e){case"vertex":t=n.vs||"";break;case"fragment":t=n.fs||"";break;case"wgsl":t=n.source||"";break;default:G2(!1)}if(!n.name)throw new Error("Shader module must have a name");const i=n.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let r=`// ----- MODULE ${n.name} ---------------

`;return e!=="wgsl"&&(r+=`#define MODULE_${i}
`),r+=`${t}
`,r}const V0e=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,H0e=/^\s*\#\s*endif\s*$/;function W0e(n,e){const t=n.split(`
`),i=[];let r=!0,s=null;for(const o of t){const a=o.match(V0e),l=o.match(H0e);a?(s=a[1],r=!!e?.defines?.[s]):l?r=!0:r&&i.push(o)}return i.join(`
`)}class wp{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return wp.defaultShaderAssembler=wp.defaultShaderAssembler||new wp,wp.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),i=this._hookFunctions,{source:r,getUniforms:s}=F0e({...e,source:e.source,modules:t,hookFunctions:i});return{source:e.platformInfo.shaderLanguage==="wgsl"?W0e(r):r,getUniforms:s,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),i=this._hookFunctions;return{...U0e({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:i}),modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,mS(t),t}}const j0e=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,$0e=`#version 300 es
${j0e}`;function X0e(n){const{input:e,inputChannels:t,output:i}={};if(!e)return $0e;if(!t)throw new Error("inputChannels");const r=G0e(t),s=Y0e(e,t);return`#version 300 es
in ${r} ${e};
out vec4 ${i};
void main() {
  ${i} = ${s};
}`}function G0e(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${n}`)}}function Y0e(n,e){switch(e){case 1:return`vec4(${n}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${n}, 0.0, 1.0)`;case 3:return`vec4(${n}, 1.0)`;case 4:return n;default:throw new Error(`invalid channels: ${e}`)}}class q0e{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new BT({id:e})),this.stats.get(e)}}const OW=new q0e,Qe=new F0({id:"luma.gl"}),wA={};function VT(n="id"){wA[n]=wA[n]||1;const e=wA[n]++;return`${n}-${e}`}let xi=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,t,i){if(!e)throw new Error("no device");this._device=e,this.props=Z0e(t,i);const r=this.props.id!=="undefined"?this.props.id:VT(this[Symbol.toStringTag]);this.props.id=r,this.id=r,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const i=this._device.statsManager.getStats("Resource Counts");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}};function Z0e(n,e){const t={...e};for(const i in n)n[i]!==void 0&&(t[i]=n[i]);return t}let gr=class Sw extends xi{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,t){const i={...t};(t.usage||0)&Sw.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?i.indexType="uint32":t.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data,super(e,i,Sw.defaultProps),this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,t,i){const r=ArrayBuffer.isView(e)?e.buffer:e,s=Math.min(e?e.byteLength:i,Sw.DEBUG_DATA_MAX_LENGTH);r===null?this.debugData=new ArrayBuffer(s):t===0&&i===r.byteLength?this.debugData=r.slice(0,s):this.debugData=r.slice(t,t+s)}static defaultProps={...xi.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}};function LW(n){const[e,t,i]=K2[n],r=n.includes("norm"),s=!r&&!n.startsWith("float"),o=n.startsWith("s");return{signedType:e,primitiveType:t,byteLength:i,normalized:r,integer:s,signed:o}}function K0e(n){const e=n;switch(e){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return e}}function J0e(n,e){switch(e){case 1:return n;case 2:return n+n%2;default:return n+(4-n%4)%4}}function q2(n){const e=ArrayBuffer.isView(n)?n.constructor:n;if(e===Uint8ClampedArray)return"uint8";const t=Object.values(K2).find(i=>e===i[4]);if(!t)throw new Error(e.name);return t[0]}function Z2(n){const[,,,,e]=K2[n];return e}const K2={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]};function J2(n){let e;n.endsWith("-webgl")&&(n.replace("-webgl",""),e=!0);const[t,i]=n.split("x"),r=t,s=i?parseInt(i):1,o=LW(r),a={type:r,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function Q0e(n,e,t){const i=t?K0e(n):n;switch(i){case"unorm8":return e===1?"unorm8":e===3?"unorm8x3-webgl":`${i}x${e}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(e===1||e===3)throw new Error(`size: ${e}`);return`${i}x${e}`;default:return e===1?i:`${i}x${e}`}}function exe(n,e,t){if(!e||e>4)throw new Error(`size ${e}`);const i=e,r=q2(n);return Q0e(r,i,t)}function txe(n){let e;switch(n.primitiveType){case"f32":e="float32";break;case"i32":e="sint32";break;case"u32":e="uint32";break;case"f16":return n.components<=2?"float16x2":"float16x4"}return n.components===1?e:`${e}x${n.components}`}const so="texture-compression-bc",yi="texture-compression-astc",Vc="texture-compression-etc2",nxe="texture-compression-etc1-webgl",Bb="texture-compression-pvrtc-webgl",SA="texture-compression-atc-webgl",zb="float32-renderable-webgl",TA="float16-renderable-webgl",ixe="rgb9e5ufloat-renderable-webgl",EA="snorm8-renderable-webgl",Sy="norm16-renderable-webgl",AA="snorm16-renderable-webgl",Vb="float32-filterable",KF="float16-filterable-webgl";function NW(n){const e=oxe[n];if(!e)throw new Error(`Unsupported texture format ${n}`);return e}const rxe={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:EA},rg8snorm:{render:EA},"rgb8snorm-webgl":{},rgba8snorm:{render:EA},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:Sy},rg16unorm:{render:Sy},"rgb16unorm-webgl":{f:Sy},rgba16unorm:{render:Sy},r16snorm:{f:AA},rg16snorm:{render:AA},"rgb16snorm-webgl":{f:Sy},rgba16snorm:{render:AA},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:TA,filter:"float16-filterable-webgl"},rg16float:{render:TA,filter:KF},rgba16float:{render:TA,filter:KF},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:zb,filter:Vb},rg32float:{render:!1,filter:Vb},"rgb32float-webgl":{render:zb,filter:Vb},rgba32float:{render:zb,filter:Vb},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:ixe},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:zb},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},sxe={"bc1-rgb-unorm-webgl":{f:so},"bc1-rgb-unorm-srgb-webgl":{f:so},"bc1-rgba-unorm":{f:so},"bc1-rgba-unorm-srgb":{f:so},"bc2-rgba-unorm":{f:so},"bc2-rgba-unorm-srgb":{f:so},"bc3-rgba-unorm":{f:so},"bc3-rgba-unorm-srgb":{f:so},"bc4-r-unorm":{f:so},"bc4-r-snorm":{f:so},"bc5-rg-unorm":{f:so},"bc5-rg-snorm":{f:so},"bc6h-rgb-ufloat":{f:so},"bc6h-rgb-float":{f:so},"bc7-rgba-unorm":{f:so},"bc7-rgba-unorm-srgb":{f:so},"etc2-rgb8unorm":{f:Vc},"etc2-rgb8unorm-srgb":{f:Vc},"etc2-rgb8a1unorm":{f:Vc},"etc2-rgb8a1unorm-srgb":{f:Vc},"etc2-rgba8unorm":{f:Vc},"etc2-rgba8unorm-srgb":{f:Vc},"eac-r11unorm":{f:Vc},"eac-r11snorm":{f:Vc},"eac-rg11unorm":{f:Vc},"eac-rg11snorm":{f:Vc},"astc-4x4-unorm":{f:yi},"astc-4x4-unorm-srgb":{f:yi},"astc-5x4-unorm":{f:yi},"astc-5x4-unorm-srgb":{f:yi},"astc-5x5-unorm":{f:yi},"astc-5x5-unorm-srgb":{f:yi},"astc-6x5-unorm":{f:yi},"astc-6x5-unorm-srgb":{f:yi},"astc-6x6-unorm":{f:yi},"astc-6x6-unorm-srgb":{f:yi},"astc-8x5-unorm":{f:yi},"astc-8x5-unorm-srgb":{f:yi},"astc-8x6-unorm":{f:yi},"astc-8x6-unorm-srgb":{f:yi},"astc-8x8-unorm":{f:yi},"astc-8x8-unorm-srgb":{f:yi},"astc-10x5-unorm":{f:yi},"astc-10x5-unorm-srgb":{f:yi},"astc-10x6-unorm":{f:yi},"astc-10x6-unorm-srgb":{f:yi},"astc-10x8-unorm":{f:yi},"astc-10x8-unorm-srgb":{f:yi},"astc-10x10-unorm":{f:yi},"astc-10x10-unorm-srgb":{f:yi},"astc-12x10-unorm":{f:yi},"astc-12x10-unorm-srgb":{f:yi},"astc-12x12-unorm":{f:yi},"astc-12x12-unorm-srgb":{f:yi},"pvrtc-rgb4unorm-webgl":{f:Bb},"pvrtc-rgba4unorm-webgl":{f:Bb},"pvrtc-rbg2unorm-webgl":{f:Bb},"pvrtc-rgba2unorm-webgl":{f:Bb},"etc1-rbg-unorm-webgl":{f:nxe},"atc-rgb-unorm-webgl":{f:SA},"atc-rgba-unorm-webgl":{f:SA},"atc-rgbai-unorm-webgl":{f:SA}},oxe={...rxe,...sxe},axe=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],lxe=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;class cxe{getInfo(e){return JF(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return axe.some(t=>e.startsWith(t))}getCapabilities(e){const t=NW(e),i={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},r=JF(e),s=e.startsWith("depth")||e.startsWith("stencil"),o=r?.signed,a=r?.integer,l=r?.webgl;return i.render&&=!o,i.filter&&=!s&&!o&&!a&&!l,i}}const Gg=new cxe;function JF(n){let e=uxe(n);if(Gg.isCompressed(n)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const i=hxe(n);i&&(e.blockWidth=i.blockWidth,e.blockHeight=i.blockHeight)}const t=lxe.exec(n);if(t){const[,i,r,s,o,a]=t,l=`${s}${r}`,c=LW(l),u=c.byteLength*8,d=i.length,m=[u,d>=2?u:0,d>=3?u:0,d>=4?u:0];e={format:n,attachment:e.attachment,dataType:c.signedType,components:d,channels:i,integer:c.integer,signed:c.signed,normalized:c.normalized,bitsPerChannel:m,bytesPerPixel:c.byteLength*i.length,packed:e.packed,srgb:e.srgb},a==="-webgl"&&(e.webgl=!0),o==="-srgb"&&(e.srgb=!0)}return n.endsWith("-webgl")&&(e.webgl=!0),n.endsWith("-srgb")&&(e.srgb=!0),e}function uxe(n){const e=NW(n),t=e.bytesPerPixel||1,i=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:n,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:t,bitsPerChannel:i,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function hxe(n){const t=/.*-(\d+)x(\d+)-.*/.exec(n);if(t){const[,i,r]=t;return{blockWidth:Number(i),blockHeight:Number(r)}}return null}function fxe(n){return typeof ImageData<"u"&&n instanceof ImageData||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement||typeof VideoFrame<"u"&&n instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}function dxe(n){if(typeof ImageData<"u"&&n instanceof ImageData||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height};if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)return{width:n.naturalWidth,height:n.naturalHeight};if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)return{width:n.videoWidth,height:n.videoHeight};if(typeof VideoFrame<"u"&&n instanceof VideoFrame)return{width:n.displayWidth,height:n.displayHeight};throw new Error("Unknown image type")}class pxe{}class mxe{features;disabledFeatures;constructor(e=[],t){this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class Kp{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,t)=>{},onResize:(e,t)=>{const[i,r]=e.getDevicePixelSize();Qe.log(1,`${e} resized => ${i}x${r}px`)()},onPositionChange:(e,t)=>{const[i,r]=e.getPosition();Qe.log(1,`${e} repositioned => ${i},${r}`)()},onVisibilityChange:e=>Qe.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,t)=>Qe.log(1,`${e} DPR changed ${t.oldRatio} => ${e.devicePixelRatio}`)(),debug:Qe.get("debug")||void 0,debugShaders:Qe.get("debug-shaders")||void 0,debugFramebuffers:!!Qe.get("debug-framebuffers"),debugFactories:!!Qe.get("debug-factories"),debugWebGL:!!Qe.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0};get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=OW;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...Kp.defaultProps,...e},this.id=this.props.id||VT(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return J2(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return Gg.getInfo(e)}getTextureFormatCapabilities(e){let t=this._textureCaps[e];if(!t){const i=this._getDeviceTextureFormatCapabilities(e);t=this._getDeviceSpecificTextureFormatCapabilities(i),this._textureCaps[e]=t}return t}getMipLevelCount(e,t,i=1){const r=Math.max(e,t,i);return 1+Math.floor(Math.log2(r))}isExternalImage(e){return fxe(e)}getExternalImageSize(e){return dxe(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return Gg.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,t,...i){return this.props.onError(e,t)?()=>{}:Qe.error(e.message,t,...i)}debug(){if(this.props.debug)debugger;else Qe.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',
or create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const t=Gg.getCapabilities(e),i=s=>(typeof s=="string"?this.features.has(s):s)??!0,r=i(t.create);return{format:e,create:r,render:r&&i(t.render),filter:r&&i(t.filter),blend:r&&i(t.blend),store:r&&i(t.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};if((e.usage||0)&gr.INDEX&&(e.indexType||(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array&&(t.indexType="uint16")),!t.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return t}}const gxe="set luma.log.level=1 (or higher) to trace rendering",QF="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class gS{static defaultProps={...Kp.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=OW;log=Qe;VERSION="9.2.4";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw Qe.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),Qe.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");Qe.error("This version of luma.gl has already been initialized")()}Qe.log(1,`${this.VERSION} - ${gxe}`)(),globalThis.luma=this}async createDevice(e={}){const t={...gS.defaultProps,...e},i=this.selectAdapter(t.type,t.adapters);if(!i)throw new Error(QF);return t.waitForPageLoad&&await i.pageLoaded,await i.create(t)}async attachDevice(e,t){const i=this._getTypeFromHandle(e,t.adapters),r=i&&this.selectAdapter(i,t.adapters);if(!r)throw new Error(QF);return await r?.attach?.(e,t)}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this._getAdapterMap(e);return Array.from(t).map(([,i])=>i).filter(i=>i.isSupported?.()).map(i=>i.type)}getBestAvailableAdapterType(e=[]){const t=["webgpu","webgl","null"],i=this._getAdapterMap(e);for(const r of t)if(i.get(r)?.isSupported?.())return r;return null}selectAdapter(e,t=[]){let i=e;e==="best-available"&&(i=this.getBestAvailableAdapterType(t));const r=this._getAdapterMap(t);return i&&r.get(i)||null}enforceWebGL2(e=!0,t=[]){const r=this._getAdapterMap(t).get("webgl");r||Qe.warn("enforceWebGL2: webgl adapter not found")(),r?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(gS.defaultProps,e)}_getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const i of e)t.set(i.type,i);return t}_getTypeFromHandle(e,t=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?Qe.warn("WebGL1 is not supported",e)():Qe.warn("Unknown handle type",e)(),null)}}const QC=new gS;class _xe{get pageLoaded(){return xxe()}}const yxe=um()&&typeof document<"u",vxe=()=>yxe&&document.readyState==="complete";let Hb=null;function xxe(){return Hb||(vxe()||typeof window>"u"?Hb=Promise.resolve():Hb=new Promise(n=>window.addEventListener("load",()=>n()))),Hb}function bxe(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}class Sp{static isHTMLCanvas(e){return typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=bxe();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...Sp.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,um()?e.canvas?typeof e.canvas=="string"?this.canvas=Sxe(e.canvas):this.canvas=e.canvas:this.canvas=Txe(e):this.canvas={width:e.width||1,height:e.height||1},Sp.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):Sp.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],Sp.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(t=>this._handleIntersection(t)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(t=>this._handleResize(t));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,t){this.canvas.width=e,this.canvas.height=t,this.drawingBufferWidth=e,this.drawingBufferHeight=t}getDevicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}cssToDevicePixels(e,t=!0){const i=this.cssToDeviceRatio(),[r,s]=this.getDrawingBufferSize();return Exe(e,i,r,s,t)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,t]=this.getDevicePixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[t]=this.getCSSSize();return t?e/t:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}_handleIntersection(e){const t=e.find(r=>r.target===this.canvas);if(!t)return;const i=t.isIntersecting;this.isVisible!==i&&(this.isVisible=i,this.device.props.onVisibilityChange(this))}_handleResize(e){const t=e.find(l=>l.target===this.canvas);if(!t)return;this.cssWidth=t.contentBoxSize[0].inlineSize,this.cssHeight=t.contentBoxSize[0].blockSize;const i=this.getDevicePixelSize(),r=t.devicePixelContentBoxSize?.[0].inlineSize||t.contentBoxSize[0].inlineSize*devicePixelRatio,s=t.devicePixelContentBoxSize?.[0].blockSize||t.contentBoxSize[0].blockSize*devicePixelRatio,[o,a]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(r,o)),this.devicePixelHeight=Math.max(1,Math.min(s,a)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:i})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels=="number"){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){const t=setInterval(()=>{this.destroyed?clearInterval(t):this.updatePosition()},e)}updatePosition(){const e=this.htmlCanvas?.getBoundingClientRect();if(e){const t=[e.left,e.top];if(this._position??=t,t[0]!==this._position[0]||t[1]!==this._position[1]){const r=this._position;this._position=t,this.device.props.onPositionChange?.(this,{oldPosition:r})}}}}function wxe(n){if(typeof n=="string"){const e=document.getElementById(n);if(!e)throw new Error(`${n} is not an HTML element`);return e}return n||document.body}function Sxe(n){const e=document.getElementById(n);if(!Sp.isHTMLCanvas(e))throw new Error("Object is not a canvas element");return e}function Txe(n){const{width:e,height:t}=n,i=document.createElement("canvas");i.id=VT("lumagl-auto-created-canvas"),i.width=e||1,i.height=t||1,i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(t)?`${t}px`:"100%",n?.visible||(i.style.visibility="hidden");const r=wxe(n?.container||null);return r.insertBefore(i,r.firstChild),i}function Exe(n,e,t,i,r){const s=n,o=eU(s[0],e,t);let a=tU(s[1],e,i,r),l=eU(s[0]+1,e,t);const c=l===t-1?l:l-1;l=tU(s[1]+1,e,i,r);let u;return r?(l=l===0?l:l+1,u=a,a=l):u=l===i-1?l:l-1,{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}function eU(n,e,t){return Math.min(Math.round(n*e),t-1)}function tU(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}class Jp extends xi{static defaultProps={...xi.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){t=Jp.normalizeProps(e,t),super(e,t,Jp.defaultProps)}static normalizeProps(e,t){return t}}const Axe={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class ts extends xi{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,t){if(t=ts.normalizeProps(e,t),super(e,t,ts.defaultProps),this.dimension=this.props.dimension,this.baseDimension=Axe[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(e.isExternalImage(t.data)){const i=e.getExternalImageSize(t.data);this.width=i?.width||1,this.height=i?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&Qe.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof Jp?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,t){const i={...t},{width:r,height:s}=i;return typeof r=="number"&&(i.width=Math.max(1,Math.ceil(r))),typeof s=="number"&&(i.height=Math.max(1,Math.ceil(s))),i}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){const{width:t,height:i,depth:r}=this,s={...ts.defaultCopyDataOptions,width:t,height:i,depth:r,...e},o=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!o.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return s.bytesPerRow=e.bytesPerRow||t*(o.bytesPerPixel||4),s.rowsPerImage=e.rowsPerImage||i,s}_normalizeCopyExternalImageOptions(e){const t=this.device.getExternalImageSize(e.image),i={...ts.defaultCopyExternalImageOptions,...t,...e};return i.width=Math.min(i.width,this.width-i.x),i.height=Math.min(i.height,this.height-i.y),i}static defaultProps={...xi.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:ts.TEXTURE|ts.RENDER_ATTACHMENT|ts.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}}class HT extends xi{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,HT.defaultProps)}static defaultProps={...xi.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}function Mxe(n,e,t){let i="";const r=e.split(/\r?\n/),s=n.slice().sort((o,a)=>o.lineNum-a.lineNum);switch(t?.showSourceCode||"no"){case"all":let o=0;for(let a=1;a<=r.length;a++)for(i+=DW(r[a-1],a,t);s.length>o&&s[o].lineNum===a;){const l=s[o++];i+=MA(l,r,l.lineNum,{...t,inlineSource:!1})}for(;s.length>o;){const a=s[o++];i+=MA(a,[],0,{...t,inlineSource:!1})}return i;case"issues":case"no":for(const a of n)i+=MA(a,r,a.lineNum,{inlineSource:t?.showSourceCode!=="no"});return i}}function MA(n,e,t,i){if(i?.inlineSource){const s=Cxe(e,t),o=n.linePos>0?`${" ".repeat(n.linePos+5)}^^^
`:"";return`
${s}${o}${n.type.toUpperCase()}: ${n.message}

`}const r=n.type==="error"?"red":"#8B4000";return i?.html?`<div class='luma-compiler-log-error' style="color:${r};"><b> ${n.type.toUpperCase()}: ${n.message}</b></div>`:`${n.type.toUpperCase()}: ${n.message}`}function Cxe(n,e,t){let i="";for(let r=e-2;r<=e;r++){const s=n[r-1];s!==void 0&&(i+=DW(s,e,t))}return i}function DW(n,e,t){const i=t?.html?Rxe(n):n;return`${Pxe(String(e),4)}: ${i}${t?.html?"<br/>":`
`}`}function Pxe(n,e){let t="";for(let i=n.length;i<e;++i)t+=" ";return t+n}function Rxe(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class WT extends xi{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,t){t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"},super(e,{id:Ixe(t),...t},WT.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const t=await this.getCompilationInfo();e==="warnings"&&t?.length===0||this._displayShaderLog(t,this.id)}_displayShaderLog(e,t){if(typeof document>"u"||!document?.createElement)return;const i=t,r=`${this.stage} shader "${i}"`;let s=Mxe(e,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`
<h1>Compilation error in ${r}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),a.onclick=()=>{const c=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(c)}}static defaultProps={...xi.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}}function Ixe(n){return kxe(n.source)||n.id||VT(`unnamed ${n.stage}-shader`)}function kxe(n,e="unnamed"){const i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(n);return i?i[1]:e}class jT extends xi{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,t={}){super(e,t,jT.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map(r=>r.texture.clone(e)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:i})}resize(e){let t=!e;if(e){const[i,r]=Array.isArray(e)?e:[e.width,e.height];t=t||r!==this.height||i!==this.width,this.width=i,this.height=r}t&&(Qe.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((t,i)=>{if(typeof t=="string"){const r=this.createColorTexture(t,i);return this.attachResource(r),r.view}return t instanceof ts?t.view:t});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else e instanceof ts?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:ts.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:ts.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,t){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const r=this.colorAttachments[i].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const i=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}static defaultProps={...xi.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}class Np extends xi{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,t){super(e,t,Np.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...xi.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}class pp extends xi{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){t=pp.normalizeProps(e,t),super(e,t,pp.defaultProps)}static normalizeProps(e,t){return t}static defaultProps={...xi.defaultProps,framebuffer:null,parameters:void 0,clearColor:pp.defaultClearColor,clearColors:void 0,clearDepth:pp.defaultClearDepth,clearStencil:pp.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}class _S extends xi{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,t){super(e,t,_S.defaultProps),this.shaderLayout=t.shaderLayout}static defaultProps={...xi.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}class Q2 extends xi{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,Q2.defaultProps)}static defaultProps={...xi.defaultProps,measureExecutionTime:void 0}}class eI extends xi{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,eI.defaultProps)}static defaultProps={...xi.defaultProps}}function FW(n){return Dxe[n]}function Oxe(n){const[e,t]=Nxe[n],i=e==="i32"||e==="u32",r=e!=="u32",s=Lxe[e]*t;return{primitiveType:e,components:t,byteLength:s,integer:i,signed:r}}const Lxe={f32:4,f16:2,i32:4,u32:4},Nxe={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},Dxe={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}};function UW(n,e){const t={};for(const i of n.attributes){const r=Uxe(n,e,i.name);r&&(t[i.name]=r)}return t}function Fxe(n,e,t=16){const i=UW(n,e),r=new Array(t).fill(null);for(const s of Object.values(i))r[s.location]=s;return r}function Uxe(n,e,t){const i=Bxe(n,t),r=zxe(e,t);if(!i)return null;const s=Oxe(i.type),o=txe(s),a=r?.vertexFormat||o,l=J2(a);return{attributeName:r?.attributeName||i.name,bufferName:r?.bufferName||i.name,location:i.location,shaderType:i.type,primitiveType:s.primitiveType,shaderComponents:s.components,vertexFormat:a,bufferDataType:l.type,bufferComponents:l.components,normalized:l.normalized,integer:s.integer,stepMode:r?.stepMode||i.stepMode||"vertex",byteOffset:r?.byteOffset||0,byteStride:r?.byteStride||0}}function Bxe(n,e){const t=n.attributes.find(i=>i.name===e);return t||Qe.warn(`shader layout attribute "${e}" not present in shader`),t||null}function zxe(n,e){Vxe(n);let t=Hxe(n,e);return t||(t=Wxe(n,e),t)?t:(Qe.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function Vxe(n){for(const e of n)(e.attributes&&e.format||!e.attributes&&!e.format)&&Qe.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function Hxe(n,e){for(const t of n)if(t.format&&t.name===e)return{attributeName:t.name,bufferName:e,stepMode:t.stepMode,vertexFormat:t.format,byteOffset:0,byteStride:t.byteStride||0};return null}function Wxe(n,e){for(const t of n){let i=t.byteStride;if(typeof t.byteStride!="number")for(const s of t.attributes||[]){const o=J2(s.format);i+=o.byteLength}const r=t.attributes?.find(s=>s.attribute===e);if(r)return{attributeName:r.attribute,bufferName:t.name,stepMode:t.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:i}}return null}class tI extends xi{static defaultProps={...xi.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,t){super(e,t,tI.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=Fxe(t.shaderLayout,t.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"),this)()}}class nI extends xi{static defaultProps={...xi.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,nI.defaultProps)}}class iI extends xi{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,iI.defaultProps)}static defaultProps={...xi.defaultProps,type:void 0,count:void 0}}let Wb;function BW(n){return(!Wb||Wb.byteLength<n)&&(Wb=new ArrayBuffer(n)),Wb}function jxe(n,e){const t=BW(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}function $xe(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function yS(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":$xe(n)}const Xxe=1024;class Gxe{layout={};byteLength;constructor(e,t={}){let i=0;for(const[s,o]of Object.entries(e)){const a=FW(o),{type:l,components:c}=a,u=c*(t?.[s]??1);i=J0e(i,u);const d=i;i+=u,this.layout[s]={type:l,size:u,offset:d}}i+=(4-i%4)%4;const r=i*4;this.byteLength=Math.max(r,Xxe)}getData(e){const t=BW(this.byteLength),i={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[r,s]of Object.entries(e)){const o=this.layout[r];if(!o){Qe.warn(`Supplied uniform value ${r} not present in uniform block layout`)();continue}const{type:a,size:l,offset:c}=o,u=i[a];if(l===1){if(typeof s!="number"&&typeof s!="boolean"){Qe.warn(`Supplied value for single component uniform ${r} is not a number: ${s}`)();continue}u[c]=Number(s)}else{if(!yS(s)){Qe.warn(`Supplied value for multi component / array uniform ${r} is not a numeric array: ${s}`)();continue}u.set(s,c)}}return new Uint8Array(t,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function Yxe(n,e,t=16){if(n!==e)return!1;const i=n,r=e;if(!yS(i))return!1;if(yS(r)&&i.length===r.length){for(let s=0;s<i.length;++s)if(r[s]!==i[s])return!1}return!0}function qxe(n){return yS(n)?n.slice():n}class Zxe{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find(r=>r.type==="uniform"&&r.name===e?.name);if(!t)throw new Error(e?.name);const i=t;for(const r of i.uniforms||[])this.bindingLayout[r.name]=r}}setUniforms(e){for(const[t,i]of Object.entries(e))this._setUniform(t,i),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${i}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){Yxe(this.uniforms[e],t)||(this.uniforms[e]=qxe(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}class Kxe{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[t,i]of Object.entries(e)){const r=t,s=new Gxe(i.uniformTypes??{},i.uniformSizes??{});this.uniformBufferLayouts.set(r,s);const o=new Zxe({name:t});o.setUniforms(i.defaultUniforms||{}),this.uniformBlocks.set(r,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,i]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,i){i&&this.setUniforms(i);const r=this.getUniformBufferByteLength(t),s=e.createBuffer({usage:gr.UNIFORM|gr.COPY_DST,byteLength:r}),o=this.getUniformBufferData(t);return s.write(o),s}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const i=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:gr.UNIFORM|gr.COPY_DST,byteLength:i});this.uniformBuffers.set(t,r)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const i=this.updateUniformBuffer(t);e||=i}return e&&Qe.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let i=this.uniformBuffers.get(e),r=!1;if(i&&t?.needsRedraw){r||=t.needsRedraw;const s=this.getUniformBufferData(e);i=this.uniformBuffers.get(e),i?.write(s);const o=this.uniformBlocks.get(e)?.getAllUniforms();Qe.log(4,`Writing to uniform buffer ${String(e)}`,s,o)()}return r}}class gl{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class nU{constructor(e,t,i){this.name=e,this.type=t,this.attributes=i,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Bf extends gl{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class Zf extends gl{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class eP extends gl{constructor(e,t,i){super(e,i),this.format=t}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class Qp extends gl{constructor(e,t,i,r){super(e,i),this.format=t,this.access=r}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var Af;(n=>{n[n.Uniform=0]="Uniform",n[n.Storage=1]="Storage",n[n.Texture=2]="Texture",n[n.Sampler=3]="Sampler",n[n.StorageTexture=4]="StorageTexture"})(Af||(Af={}));class jb{constructor(e,t,i,r,s,o,a){this.name=e,this.type=t,this.group=i,this.binding=r,this.attributes=s,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Jxe{constructor(e,t){this.name=e,this.type=t}}class Qxe{constructor(e,t,i,r){this.name=e,this.type=t,this.locationType=i,this.location=r,this.interpolation=null}}class iU{constructor(e,t,i,r){this.name=e,this.type=t,this.locationType=i,this.location=r}}class ebe{constructor(e,t,i,r){this.name=e,this.type=t,this.attributes=i,this.id=r}}class tbe{constructor(e,t,i){this.name=e,this.type=t,this.attributes=i}}class nbe{constructor(e,t=null,i){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=i}}class ibe{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function rbe(n){var e=(32768&n)>>15,t=(31744&n)>>10,i=1023&n;return t==0?(e?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):t==31?i?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,t-15)*(1+i/Math.pow(2,10))}const zW=new Float32Array(1),sbe=new Int32Array(zW.buffer),oo=new Uint16Array(1);function obe(n){zW[0]=n;const e=sbe[0],t=e>>31&1;let i=e>>23&255,r=8388607&e;if(i===255)return oo[0]=t<<15|31744|(r!==0?512:0),oo[0];if(i===0){if(r===0)return oo[0]=t<<15,oo[0];r|=8388608;let s=113;for(;!(8388608&r);)r<<=1,s--;return i=127-s,r&=8388607,i>0?(r=(r>>126-i)+(r>>127-i&1),oo[0]=t<<15|i<<10|r>>13,oo[0]):(oo[0]=t<<15,oo[0])}return i=i-127+15,i>=31?(oo[0]=t<<15|31744,oo[0]):i<=0?i<-10?(oo[0]=t<<15,oo[0]):(r=(8388608|r)>>1-i,oo[0]=t<<15|r>>13,oo[0]):(r>>=13,oo[0]=t<<15|i<<10|r,oo[0])}const rI=new Uint32Array(1),VW=new Float32Array(rI.buffer,0,1);function rU(n){const e=112+(n>>6&31)<<23|(63&n)<<17;return rI[0]=e,VW[0]}function abe(n,e,t,i,r,s,o,a,l){const c=i*(o>>=r)*(s>>=r)+t*o+e*a;switch(l){case"r8unorm":return[ni(n,c,"8unorm",1)[0]];case"r8snorm":return[ni(n,c,"8snorm",1)[0]];case"r8uint":return[ni(n,c,"8uint",1)[0]];case"r8sint":return[ni(n,c,"8sint",1)[0]];case"rg8unorm":{const u=ni(n,c,"8unorm",2);return[u[0],u[1]]}case"rg8snorm":{const u=ni(n,c,"8snorm",2);return[u[0],u[1]]}case"rg8uint":{const u=ni(n,c,"8uint",2);return[u[0],u[1]]}case"rg8sint":{const u=ni(n,c,"8sint",2);return[u[0],u[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const u=ni(n,c,"8unorm",4);return[u[0],u[1],u[2],u[3]]}case"rgba8snorm":{const u=ni(n,c,"8snorm",4);return[u[0],u[1],u[2],u[3]]}case"rgba8uint":{const u=ni(n,c,"8uint",4);return[u[0],u[1],u[2],u[3]]}case"rgba8sint":{const u=ni(n,c,"8sint",4);return[u[0],u[1],u[2],u[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const u=ni(n,c,"8unorm",4);return[u[2],u[1],u[0],u[3]]}case"r16uint":return[ni(n,c,"16uint",1)[0]];case"r16sint":return[ni(n,c,"16sint",1)[0]];case"r16float":return[ni(n,c,"16float",1)[0]];case"rg16uint":{const u=ni(n,c,"16uint",2);return[u[0],u[1]]}case"rg16sint":{const u=ni(n,c,"16sint",2);return[u[0],u[1]]}case"rg16float":{const u=ni(n,c,"16float",2);return[u[0],u[1]]}case"rgba16uint":{const u=ni(n,c,"16uint",4);return[u[0],u[1],u[2],u[3]]}case"rgba16sint":{const u=ni(n,c,"16sint",4);return[u[0],u[1],u[2],u[3]]}case"rgba16float":{const u=ni(n,c,"16float",4);return[u[0],u[1],u[2],u[3]]}case"r32uint":return[ni(n,c,"32uint",1)[0]];case"r32sint":return[ni(n,c,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[ni(n,c,"32float",1)[0]];case"rg32uint":{const u=ni(n,c,"32uint",2);return[u[0],u[1]]}case"rg32sint":{const u=ni(n,c,"32sint",2);return[u[0],u[1]]}case"rg32float":{const u=ni(n,c,"32float",2);return[u[0],u[1]]}case"rgba32uint":{const u=ni(n,c,"32uint",4);return[u[0],u[1],u[2],u[3]]}case"rgba32sint":{const u=ni(n,c,"32sint",4);return[u[0],u[1],u[2],u[3]]}case"rgba32float":{const u=ni(n,c,"32float",4);return[u[0],u[1],u[2],u[3]]}case"rg11b10ufloat":{const u=new Uint32Array(n.buffer,c,1)[0],d=(4192256&u)>>11,m=(4290772992&u)>>22;return[rU(2047&u),rU(d),(function(y){const x=112+(y>>5&31)<<23|(31&y)<<18;return rI[0]=x,VW[0]})(m),1]}}return null}function ni(n,e,t,i){const r=[0,0,0,0];for(let s=0;s<i;++s)switch(t){case"8unorm":r[s]=n[e]/255,e++;break;case"8snorm":r[s]=n[e]/255*2-1,e++;break;case"8uint":r[s]=n[e],e++;break;case"8sint":r[s]=n[e]-127,e++;break;case"16uint":r[s]=n[e]|n[e+1]<<8,e+=2;break;case"16sint":r[s]=(n[e]|n[e+1]<<8)-32768,e+=2;break;case"16float":r[s]=rbe(n[e]|n[e+1]<<8),e+=2;break;case"32uint":case"32sint":r[s]=n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24,e+=4;break;case"32float":r[s]=new Float32Array(n.buffer,e,1)[0],e+=4}return r}function oi(n,e,t,i,r){for(let s=0;s<i;++s)switch(t){case"8unorm":n[e]=255*r[s],e++;break;case"8snorm":n[e]=.5*(r[s]+1)*255,e++;break;case"8uint":n[e]=r[s],e++;break;case"8sint":n[e]=r[s]+127,e++;break;case"16uint":new Uint16Array(n.buffer,e,1)[0]=r[s],e+=2;break;case"16sint":new Int16Array(n.buffer,e,1)[0]=r[s],e+=2;break;case"16float":{const o=obe(r[s]);new Uint16Array(n.buffer,e,1)[0]=o,e+=2;break}case"32uint":new Uint32Array(n.buffer,e,1)[0]=r[s],e+=4;break;case"32sint":new Int32Array(n.buffer,e,1)[0]=r[s],e+=4;break;case"32float":new Float32Array(n.buffer,e,1)[0]=r[s],e+=4}return r}const CA={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class bl{constructor(){this.id=bl._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(vS.instance);for(const i of e)i instanceof Array?this.searchBlock(i,t):i.search(t);t(xS.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}bl._id=0;class vS extends bl{}vS.instance=new vS;class xS extends bl{}xS.instance=new xS;const HW=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class Yi extends bl{constructor(){super()}}class i0 extends Yi{constructor(e,t,i,r,s,o){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=i,this.body=r,this.startLine=s,this.endLine=o}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class lbe extends Yi{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class WW extends Yi{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class tP extends Yi{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class jW extends Yi{constructor(e,t,i,r){super(),this.init=e,this.condition=t,this.increment=i,this.body=r}get astNodeType(){return"for"}search(e){var t,i,r;(t=this.init)===null||t===void 0||t.search(e),(i=this.condition)===null||i===void 0||i.search(e),(r=this.increment)===null||r===void 0||r.search(e),this.searchBlock(this.body,e)}}class th extends Yi{constructor(e,t,i,r,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=r,this.value=s}get astNodeType(){return"var"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class sI extends Yi{constructor(e,t,i){super(),this.attributes=null,this.name=e,this.type=t,this.value=i}get astNodeType(){return"override"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class av extends Yi{constructor(e,t,i,r,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=r,this.value=s}get astNodeType(){return"let"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class Tw extends Yi{constructor(e,t,i,r,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=r,this.value=s}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}var Og,Uy,Ie,Se;(n=>{n.increment="++",n.decrement="--"})(Og||(Og={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for IncrementOperator");return n[t]}})(Og||(Og={}));class $W extends Yi{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(n=>{n.assign="=",n.addAssign="+=",n.subtractAssin="-=",n.multiplyAssign="*=",n.divideAssign="/=",n.moduloAssign="%=",n.andAssign="&=",n.orAssign="|=",n.xorAssign="^=",n.shiftLeftAssign="<<=",n.shiftRightAssign=">>="})(Uy||(Uy={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for AssignOperator");return t}})(Uy||(Uy={}));class XW extends Yi{constructor(e,t,i){super(),this.operator=e,this.variable=t,this.value=i}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class oI extends Yi{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return HW.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class GW extends Yi{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),(t=this.continuing)===null||t===void 0||t.search(e)}}class YW extends Yi{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}}class qW extends Yi{constructor(e,t,i,r){super(),this.condition=e,this.body=t,this.elseif=i,this.else=r}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class ZW extends Yi{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class cbe extends Yi{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class ube extends Yi{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class KW extends Yi{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class aI extends Yi{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class hbe extends Yi{constructor(){super()}get astNodeType(){return"discard"}}class JW extends Yi{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class QW extends Yi{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class Ze extends Yi{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if(t.name==="f32")return t;for(let i=1;i<e.length;++i){const r=Ze._priority.get(t.name);Ze._priority.get(e[i].name)<r&&(t=e[i])}return t.name==="x32"?Ze.i32:t}getTypeName(){return this.name}}Ze.x32=new Ze("x32"),Ze.f32=new Ze("f32"),Ze.i32=new Ze("i32"),Ze.u32=new Ze("u32"),Ze.f16=new Ze("f16"),Ze.bool=new Ze("bool"),Ze.void=new Ze("void"),Ze._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class sU extends Ze{constructor(e){super(e)}}class Ju extends Ze{constructor(e,t,i,r){super(e),this.members=t,this.startLine=i,this.endLine=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class Ae extends Ze{constructor(e,t,i){super(e),this.format=t,this.access=i}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}Ae.vec2f=new Ae("vec2",Ze.f32,null),Ae.vec3f=new Ae("vec3",Ze.f32,null),Ae.vec4f=new Ae("vec4",Ze.f32,null),Ae.vec2i=new Ae("vec2",Ze.i32,null),Ae.vec3i=new Ae("vec3",Ze.i32,null),Ae.vec4i=new Ae("vec4",Ze.i32,null),Ae.vec2u=new Ae("vec2",Ze.u32,null),Ae.vec3u=new Ae("vec3",Ze.u32,null),Ae.vec4u=new Ae("vec4",Ze.u32,null),Ae.vec2h=new Ae("vec2",Ze.f16,null),Ae.vec3h=new Ae("vec3",Ze.f16,null),Ae.vec4h=new Ae("vec4",Ze.f16,null),Ae.vec2b=new Ae("vec2",Ze.bool,null),Ae.vec3b=new Ae("vec3",Ze.bool,null),Ae.vec4b=new Ae("vec4",Ze.bool,null),Ae.mat2x2f=new Ae("mat2x2",Ze.f32,null),Ae.mat2x3f=new Ae("mat2x3",Ze.f32,null),Ae.mat2x4f=new Ae("mat2x4",Ze.f32,null),Ae.mat3x2f=new Ae("mat3x2",Ze.f32,null),Ae.mat3x3f=new Ae("mat3x3",Ze.f32,null),Ae.mat3x4f=new Ae("mat3x4",Ze.f32,null),Ae.mat4x2f=new Ae("mat4x2",Ze.f32,null),Ae.mat4x3f=new Ae("mat4x3",Ze.f32,null),Ae.mat4x4f=new Ae("mat4x4",Ze.f32,null),Ae.mat2x2h=new Ae("mat2x2",Ze.f16,null),Ae.mat2x3h=new Ae("mat2x3",Ze.f16,null),Ae.mat2x4h=new Ae("mat2x4",Ze.f16,null),Ae.mat3x2h=new Ae("mat3x2",Ze.f16,null),Ae.mat3x3h=new Ae("mat3x3",Ze.f16,null),Ae.mat3x4h=new Ae("mat3x4",Ze.f16,null),Ae.mat4x2h=new Ae("mat4x2",Ze.f16,null),Ae.mat4x3h=new Ae("mat4x3",Ze.f16,null),Ae.mat4x4h=new Ae("mat4x4",Ze.f16,null),Ae.mat2x2i=new Ae("mat2x2",Ze.i32,null),Ae.mat2x3i=new Ae("mat2x3",Ze.i32,null),Ae.mat2x4i=new Ae("mat2x4",Ze.i32,null),Ae.mat3x2i=new Ae("mat3x2",Ze.i32,null),Ae.mat3x3i=new Ae("mat3x3",Ze.i32,null),Ae.mat3x4i=new Ae("mat3x4",Ze.i32,null),Ae.mat4x2i=new Ae("mat4x2",Ze.i32,null),Ae.mat4x3i=new Ae("mat4x3",Ze.i32,null),Ae.mat4x4i=new Ae("mat4x4",Ze.i32,null),Ae.mat2x2u=new Ae("mat2x2",Ze.u32,null),Ae.mat2x3u=new Ae("mat2x3",Ze.u32,null),Ae.mat2x4u=new Ae("mat2x4",Ze.u32,null),Ae.mat3x2u=new Ae("mat3x2",Ze.u32,null),Ae.mat3x3u=new Ae("mat3x3",Ze.u32,null),Ae.mat3x4u=new Ae("mat3x4",Ze.u32,null),Ae.mat4x2u=new Ae("mat4x2",Ze.u32,null),Ae.mat4x3u=new Ae("mat4x3",Ze.u32,null),Ae.mat4x4u=new Ae("mat4x4",Ze.u32,null);class Ew extends Ze{constructor(e,t,i,r){super(e),this.storage=t,this.type=i,this.access=r}get astNodeType(){return"pointer"}}class lv extends Ze{constructor(e,t,i,r){super(e),this.attributes=t,this.format=i,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}}class By extends Ze{constructor(e,t,i){super(e),this.format=t,this.access=i}get astNodeType(){return"sampler"}}class gc extends bl{constructor(){super(),this.postfix=null}}class em extends gc{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class $c extends gc{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class lI extends gc{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return HW.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class Ha extends gc{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class ej extends gc{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const i=e.evalExpression(this.initializer,e.context);return i!==null&&this.postfix?i.getSubData(e,this.postfix,e.context):i}return null}search(e){this.initializer.search(e)}}class Jr extends gc{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return t!==void 0&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof be}get isVector(){return this.value instanceof se||this.value instanceof hn}get scalarValue(){return this.value instanceof be?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof se||this.value instanceof hn?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class tj extends gc{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class h_ extends gc{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class nj extends gc{constructor(){super()}}class Wr extends nj{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class ec extends nj{constructor(e,t,i){super(),this.operator=e,this.left=t,this.right=i}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:e.name==="f32"||t.name==="f32"?Ze.f32:e.name==="u32"||t.name==="u32"?Ze.u32:Ze.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class ij extends bl{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class Aw extends gc{constructor(){super()}get astNodeType(){return"default"}}class rj extends ij{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class sj extends ij{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class oU extends bl{constructor(e,t,i){super(),this.name=e,this.type=t,this.attributes=i}get astNodeType(){return"argument"}}class fbe extends bl{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class aU extends bl{constructor(e,t,i){super(),this.name=e,this.type=t,this.attributes=i}get astNodeType(){return"member"}}class oj extends bl{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class vl{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=vl._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,i,r){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,t,i){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}vl._id=0;class nP extends vl{constructor(){super(new gl("void",null),null)}toString(){return"void"}}nP.void=new nP;class mg extends vl{constructor(e){super(new eP("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,i,r){this.reference.setDataValue(e,t,i,r)}getSubData(e,t,i){return t?this.reference.getSubData(e,t,i):this}toString(){return`&${this.reference.toString()}`}}class be extends vl{constructor(e,t,i=null){super(t,i),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new be(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new be(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new be(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,i,r){if(i)return void console.error("SetDataValue: Scalar data does not support postfix",i);if(!(t instanceof be))return void console.error("SetDataValue: Invalid value",t);let s=t.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?s=Math.floor(s):this.typeInfo.name==="bool"&&(s=s?1:0),this.data[0]=s}getSubData(e,t,i){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return`${this.value}`}}function dbe(n,e,t){const i=e.length;return i===2?t==="f32"?new se(new Float32Array(e),n.getTypeInfo("vec2f")):t==="i32"||t==="bool"?new se(new Int32Array(e),n.getTypeInfo("vec2i")):t==="u32"?new se(new Uint32Array(e),n.getTypeInfo("vec2u")):t==="f16"?new se(new Float32Array(e),n.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${t}`),null):i===3?t==="f32"?new se(new Float32Array(e),n.getTypeInfo("vec3f")):t==="i32"||t==="bool"?new se(new Int32Array(e),n.getTypeInfo("vec3i")):t==="u32"?new se(new Uint32Array(e),n.getTypeInfo("vec3u")):t==="f16"?new se(new Float32Array(e),n.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${t}`),null):i===4?t==="f32"?new se(new Float32Array(e),n.getTypeInfo("vec4f")):t==="i32"||t==="bool"?new se(new Int32Array(e),n.getTypeInfo("vec4i")):t==="u32"?new se(new Uint32Array(e),n.getTypeInfo("vec4u")):t==="f16"?new se(new Float32Array(e),n.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${t}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class se extends vl{constructor(e,t,i=null){if(super(t,i),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const r=this.typeInfo.name;r==="vec2f"||r==="vec3f"||r==="vec4f"?this.data=new Float32Array(e):r==="vec2i"||r==="vec3i"||r==="vec4i"?this.data=new Int32Array(e):r==="vec2u"||r==="vec3u"||r==="vec4u"?this.data=new Uint32Array(e):r==="vec2h"||r==="vec3h"||r==="vec4h"?this.data=new Float32Array(e):r==="vec2b"||r==="vec3b"||r==="vec4b"?this.data=new Int32Array(e):r==="vec2"||r==="vec3"||r==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${r}`)}}clone(){if(this.data instanceof Float32Array)return new se(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new se(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new se(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,i,r){i instanceof em?console.error("TODO: Set vector postfix"):t instanceof se?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,i){if(t===null)return this;let r=e.getTypeInfo("f32");if(this.typeInfo instanceof Qp)r=this.typeInfo.format||r;else{const o=this.typeInfo.name;o==="vec2f"||o==="vec3f"||o==="vec4f"?r=e.getTypeInfo("f32"):o==="vec2i"||o==="vec3i"||o==="vec4i"?r=e.getTypeInfo("i32"):o==="vec2b"||o==="vec3b"||o==="vec4b"?r=e.getTypeInfo("bool"):o==="vec2u"||o==="vec3u"||o==="vec4u"?r=e.getTypeInfo("u32"):o==="vec2h"||o==="vec3h"||o==="vec4h"?r=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${o}`)}let s=this;for(;t!==null&&s!==null;){if(t instanceof h_){const o=t.index;let a=-1;if(o instanceof Jr){if(!(o.value instanceof be))return console.error(`GetSubData: Invalid array index ${o.value}`),null;a=o.value.value}else{const l=e.evalExpression(o,i);if(!(l instanceof be))return console.error("GetSubData: Unknown index type",o),null;a=l.value}if(a<0||a>=s.data.length)return console.error("GetSubData: Index out of range",a),null;if(s.data instanceof Float32Array){const l=new Float32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new be(l,r)}if(s.data instanceof Int32Array){const l=new Int32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new be(l,r)}if(s.data instanceof Uint32Array){const l=new Uint32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new be(l,r)}throw"GetSubData: Invalid data type"}if(!(t instanceof em))return console.error("GetSubData: Unknown postfix",t),null;{const o=t.value.toLowerCase();if(o.length===1){let l=0;if(o==="x"||o==="r")l=0;else if(o==="y"||o==="g")l=1;else if(o==="z"||o==="b")l=2;else{if(o!=="w"&&o!=="a")return console.error(`GetSubData: Unknown member ${o}`),null;l=3}if(this.data instanceof Float32Array){let c=new Float32Array(this.data.buffer,this.data.byteOffset+4*l,1);return new be(c,r,this)}if(this.data instanceof Int32Array){let c=new Int32Array(this.data.buffer,this.data.byteOffset+4*l,1);return new be(c,r,this)}if(this.data instanceof Uint32Array){let c=new Uint32Array(this.data.buffer,this.data.byteOffset+4*l,1);return new be(c,r,this)}}const a=[];for(const l of o)l==="x"||l==="r"?a.push(this.data[0]):l==="y"||l==="g"?a.push(this.data[1]):l==="z"||l==="b"?a.push(this.data[2]):l==="w"||l==="a"?a.push(this.data[3]):console.error(`GetDataValue: Unknown member ${l}`);s=dbe(e,a,r.name)}t=t.postfix}return s}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class hn extends vl{constructor(e,t,i=null){super(t,i),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new hn(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,i,r){i instanceof em?console.error("TODO: Set matrix postfix"):t instanceof hn?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,i){if(t===null)return this;const r=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof Qp)this.typeInfo.format;else if(r.endsWith("f"))e.getTypeInfo("f32");else if(r.endsWith("i"))e.getTypeInfo("i32");else if(r.endsWith("u"))e.getTypeInfo("u32");else{if(!r.endsWith("h"))return console.error(`GetDataValue: Unknown type ${r}`),null;e.getTypeInfo("f16")}if(t instanceof h_){const s=t.index;let o=-1;if(s instanceof Jr){if(!(s.value instanceof be))return console.error(`GetDataValue: Invalid array index ${s.value}`),null;o=s.value.value}else{const c=e.evalExpression(s,i);if(!(c instanceof be))return console.error("GetDataValue: Unknown index type",s),null;o=c.value}if(o<0||o>=this.data.length)return console.error("GetDataValue: Index out of range",o),null;const a=r.endsWith("h")?"h":"f";let l;if(r==="mat2x2"||r==="mat2x2f"||r==="mat2x2h"||r==="mat3x2"||r==="mat3x2f"||r==="mat3x2h"||r==="mat4x2"||r==="mat4x2f"||r==="mat4x2h")l=new se(new Float32Array(this.data.buffer,this.data.byteOffset+2*o*4,2),e.getTypeInfo(`vec2${a}`));else if(r==="mat2x3"||r==="mat2x3f"||r==="mat2x3h"||r==="mat3x3"||r==="mat3x3f"||r==="mat3x3h"||r==="mat4x3"||r==="mat4x3f"||r==="mat4x3h")l=new se(new Float32Array(this.data.buffer,this.data.byteOffset+3*o*4,3),e.getTypeInfo(`vec3${a}`));else{if(r!=="mat2x4"&&r!=="mat2x4f"&&r!=="mat2x4h"&&r!=="mat3x4"&&r!=="mat3x4f"&&r!=="mat3x4h"&&r!=="mat4x4"&&r!=="mat4x4f"&&r!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${r}`),null;l=new se(new Float32Array(this.data.buffer,this.data.byteOffset+4*o*4,4),e.getTypeInfo(`vec4${a}`))}return t.postfix?l.getSubData(e,t.postfix,i):l}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class fr extends vl{constructor(e,t,i=0,r=null){super(t,r),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=i}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new fr(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,i,r){if(t===null)return void console.log("setDataValue: NULL data.");let s=this.offset,o=this.typeInfo;for(;i;){if(i instanceof h_)if(o instanceof Zf){const a=i.index;if(a instanceof Jr){if(!(a.value instanceof be))return void console.error(`SetDataValue: Invalid index type ${a.value}`);s+=a.value.value*o.stride}else{const l=e.evalExpression(a,r);if(!(l instanceof be))return void console.error("SetDataValue: Unknown index type",a);s+=l.value*o.stride}o=o.format}else console.error(`SetDataValue: Type ${o.getTypeName()} is not an array`);else{if(!(i instanceof em))return void console.error("SetDataValue: Unknown postfix type",i);{const a=i.value;if(o instanceof Bf){let l=!1;for(const c of o.members)if(c.name===a){s+=c.offset,o=c.type,l=!0;break}if(!l)return void console.error(`SetDataValue: Member ${a} not found`)}else if(o instanceof gl){const l=o.getTypeName();let c=0;if(a==="x"||a==="r")c=0;else if(a==="y"||a==="g")c=1;else if(a==="z"||a==="b")c=2;else{if(a!=="w"&&a!=="a")return void console.error(`SetDataValue: Unknown member ${a}`);c=3}if(!(t instanceof be))return void console.error("SetDataValue: Invalid value",t);const u=t.value;return l==="vec2f"?void(new Float32Array(this.buffer,s,2)[c]=u):l==="vec3f"?void(new Float32Array(this.buffer,s,3)[c]=u):l==="vec4f"?void(new Float32Array(this.buffer,s,4)[c]=u):l==="vec2i"?void(new Int32Array(this.buffer,s,2)[c]=u):l==="vec3i"?void(new Int32Array(this.buffer,s,3)[c]=u):l==="vec4i"?void(new Int32Array(this.buffer,s,4)[c]=u):l==="vec2u"?void(new Uint32Array(this.buffer,s,2)[c]=u):l==="vec3u"?void(new Uint32Array(this.buffer,s,3)[c]=u):l==="vec4u"?void(new Uint32Array(this.buffer,s,4)[c]=u):void console.error(`SetDataValue: Type ${l} is not a struct`)}}}i=i.postfix}this.setData(e,t,o,s,r)}setData(e,t,i,r,s){const o=i.getTypeName();if(o!=="f32"&&o!=="f16")if(o!=="i32"&&o!=="atomic<i32>"&&o!=="x32")if(o!=="u32"&&o!=="atomic<u32>")if(o!=="bool"){if(o==="vec2f"||o==="vec2h"){const a=new Float32Array(this.buffer,r,2);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1]))}if(o==="vec3f"||o==="vec3h"){const a=new Float32Array(this.buffer,r,3);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2]))}if(o==="vec4f"||o==="vec4h"){const a=new Float32Array(this.buffer,r,4);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3]))}if(o==="vec2i"){const a=new Int32Array(this.buffer,r,2);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1]))}if(o==="vec3i"){const a=new Int32Array(this.buffer,r,3);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2]))}if(o==="vec4i"){const a=new Int32Array(this.buffer,r,4);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3]))}if(o==="vec2u"){const a=new Uint32Array(this.buffer,r,2);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1]))}if(o==="vec3u"){const a=new Uint32Array(this.buffer,r,3);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2]))}if(o==="vec4u"){const a=new Uint32Array(this.buffer,r,4);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3]))}if(o==="vec2b"){const a=new Uint32Array(this.buffer,r,2);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1]):(a[0]=t[0],a[1]=t[1]))}if(o==="vec3b"){const a=new Uint32Array(this.buffer,r,3);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2]):(a[0]=t[0],a[1]=t[1],a[2]=t[2]))}if(o==="vec4b"){const a=new Uint32Array(this.buffer,r,4);return void(t instanceof se?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3]))}if(o==="mat2x2f"||o==="mat2x2h"){const a=new Float32Array(this.buffer,r,4);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3]))}if(o==="mat2x3f"||o==="mat2x3h"){const a=new Float32Array(this.buffer,r,6);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5]))}if(o==="mat2x4f"||o==="mat2x4h"){const a=new Float32Array(this.buffer,r,8);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7]))}if(o==="mat3x2f"||o==="mat3x2h"){const a=new Float32Array(this.buffer,r,6);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5]))}if(o==="mat3x3f"||o==="mat3x3h"){const a=new Float32Array(this.buffer,r,9);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8]))}if(o==="mat3x4f"||o==="mat3x4h"){const a=new Float32Array(this.buffer,r,12);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8],a[9]=t.data[9],a[10]=t.data[10],a[11]=t.data[11]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11]))}if(o==="mat4x2f"||o==="mat4x2h"){const a=new Float32Array(this.buffer,r,8);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7]))}if(o==="mat4x3f"||o==="mat4x3h"){const a=new Float32Array(this.buffer,r,12);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8],a[9]=t.data[9],a[10]=t.data[10],a[11]=t.data[11]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11]))}if(o==="mat4x4f"||o==="mat4x4h"){const a=new Float32Array(this.buffer,r,16);return void(t instanceof hn?(a[0]=t.data[0],a[1]=t.data[1],a[2]=t.data[2],a[3]=t.data[3],a[4]=t.data[4],a[5]=t.data[5],a[6]=t.data[6],a[7]=t.data[7],a[8]=t.data[8],a[9]=t.data[9],a[10]=t.data[10],a[11]=t.data[11],a[12]=t.data[12],a[13]=t.data[13],a[14]=t.data[14],a[15]=t.data[15]):(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]))}if(t instanceof fr){if(i===t.typeInfo)return void new Uint8Array(this.buffer,r,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",o,t.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${o}`)}else t instanceof be&&(new Int32Array(this.buffer,r,1)[0]=t.value);else t instanceof be&&(new Uint32Array(this.buffer,r,1)[0]=t.value);else t instanceof be&&(new Int32Array(this.buffer,r,1)[0]=t.value);else t instanceof be&&(new Float32Array(this.buffer,r,1)[0]=t.value)}getSubData(e,t,i){var r,s,o;if(t===null)return this;let a=this.offset,l=this.typeInfo;for(;t;){if(t instanceof h_){const u=t.index,d=u instanceof gc?e.evalExpression(u,i):u;let m=0;if(d instanceof be?m=d.value:typeof d=="number"?m=d:console.error("GetDataValue: Invalid index type",u),l instanceof Zf)a+=m*l.stride,l=l.format;else{const y=l.getTypeName();y==="mat4x4"||y==="mat4x4f"||y==="mat4x4h"?(a+=16*m,l=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${l.getTypeName()} is not an array`)}}else{if(!(t instanceof em))return console.error("GetDataValue: Unknown postfix type",t),null;{const u=t.value;if(l instanceof Bf){let d=!1;for(const m of l.members)if(m.name===u){a+=m.offset,l=m.type,d=!0;break}if(!d)return console.error(`GetDataValue: Member ${u} not found`),null}else if(l instanceof gl){const d=l.getTypeName();if(d==="vec2f"||d==="vec3f"||d==="vec4f"||d==="vec2i"||d==="vec3i"||d==="vec4i"||d==="vec2u"||d==="vec3u"||d==="vec4u"||d==="vec2b"||d==="vec3b"||d==="vec4b"||d==="vec2h"||d==="vec3h"||d==="vec4h"||d==="vec2"||d==="vec3"||d==="vec4"){if(u.length>0&&u.length<5){let m="f";const y=[];for(let x=0;x<u.length;++x){const T=u[x].toLowerCase();let S=0;if(T==="x"||T==="r")S=0;else if(T==="y"||T==="g")S=1;else if(T==="z"||T==="b")S=2;else{if(T!=="w"&&T!=="a")return console.error(`Unknown member ${u}`),null;S=3}if(u.length===1){if(d.endsWith("f"))return this.buffer.byteLength<a+4*S+4?(console.log("Insufficient buffer data"),null):new be(new Float32Array(this.buffer,a+4*S,1),e.getTypeInfo("f32"),this);if(d.endsWith("h"))return new be(new Float32Array(this.buffer,a+4*S,1),e.getTypeInfo("f16"),this);if(d.endsWith("i"))return new be(new Int32Array(this.buffer,a+4*S,1),e.getTypeInfo("i32"),this);if(d.endsWith("b"))return new be(new Int32Array(this.buffer,a+4*S,1),e.getTypeInfo("bool"),this);if(d.endsWith("u"))return new be(new Uint32Array(this.buffer,a+4*S,1),e.getTypeInfo("i32"),this)}if(d==="vec2f")y.push(new Float32Array(this.buffer,a,2)[S]);else if(d==="vec3f"){if(a+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const w=new Float32Array(this.buffer,a,3);y.push(w[S])}else if(d==="vec4f")y.push(new Float32Array(this.buffer,a,4)[S]);else if(d==="vec2i")m="i",y.push(new Int32Array(this.buffer,a,2)[S]);else if(d==="vec3i")m="i",y.push(new Int32Array(this.buffer,a,3)[S]);else if(d==="vec4i")m="i",y.push(new Int32Array(this.buffer,a,4)[S]);else if(d==="vec2u"){m="u";const w=new Uint32Array(this.buffer,a,2);y.push(w[S])}else d==="vec3u"?(m="u",y.push(new Uint32Array(this.buffer,a,3)[S])):d==="vec4u"&&(m="u",y.push(new Uint32Array(this.buffer,a,4)[S]))}return y.length===2?l=e.getTypeInfo(`vec2${m}`):y.length===3?l=e.getTypeInfo(`vec3${m}`):y.length===4?l=e.getTypeInfo(`vec4${m}`):console.error(`GetDataValue: Invalid vector length ${y.length}`),new se(y,l,null)}return console.error(`GetDataValue: Unknown member ${u}`),null}return console.error(`GetDataValue: Type ${d} is not a struct`),null}}}t=t.postfix}const c=l.getTypeName();return c==="f32"?new be(new Float32Array(this.buffer,a,1),l,this):c==="i32"?new be(new Int32Array(this.buffer,a,1),l,this):c==="u32"?new be(new Uint32Array(this.buffer,a,1),l,this):c==="vec2f"?new se(new Float32Array(this.buffer,a,2),l,this):c==="vec3f"?new se(new Float32Array(this.buffer,a,3),l,this):c==="vec4f"?new se(new Float32Array(this.buffer,a,4),l,this):c==="vec2i"?new se(new Int32Array(this.buffer,a,2),l,this):c==="vec3i"?new se(new Int32Array(this.buffer,a,3),l,this):c==="vec4i"?new se(new Int32Array(this.buffer,a,4),l,this):c==="vec2u"?new se(new Uint32Array(this.buffer,a,2),l,this):c==="vec3u"?new se(new Uint32Array(this.buffer,a,3),l,this):c==="vec4u"?new se(new Uint32Array(this.buffer,a,4),l,this):l instanceof Qp&&l.name==="atomic"?((r=l.format)===null||r===void 0?void 0:r.name)==="u32"?new be(new Uint32Array(this.buffer,a,1)[0],l.format,this):((s=l.format)===null||s===void 0?void 0:s.name)==="i32"?new be(new Int32Array(this.buffer,a,1)[0],l.format,this):(console.error(`GetDataValue: Invalid atomic format ${(o=l.format)===null||o===void 0?void 0:o.name}`),null):new fr(this.buffer,l,a,this)}toString(){let e="";if(this.typeInfo instanceof Zf)if(this.typeInfo.format.name==="f32"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let i=1;i<t.length;++i)e+=`, ${t[i]}`}else if(this.typeInfo.format.name==="i32"){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let i=1;i<t.length;++i)e+=`, ${t[i]}`}else if(this.typeInfo.format.name==="u32"){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let i=1;i<t.length;++i)e+=`, ${t[i]}`}else if(this.typeInfo.format.name==="vec2f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let i=1;i<t.length/2;++i)e+=`, [${t[2*i]}, ${t[2*i+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let i=4;i<t.length;i+=4)e+=`, [${t[i]}, ${t[i+1]}, ${t[i+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let i=4;i<t.length;i+=4)e+=`, [${t[i]}, ${t[i+1]}, ${t[i+2]}, ${t[i+3]}]`}else e="[...]";else this.typeInfo instanceof Bf?e+="{...}":e="[...]";return e}}class Qu extends vl{constructor(e,t,i,r){super(t,null),this.data=e,this.descriptor=i,this.view=r}clone(){return new Qu(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>0?(e=i[0])!==null&&e!==void 0?e:0:i instanceof Object&&(t=i.width)!==null&&t!==void 0?t:0}get height(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>1?(e=i[1])!==null&&e!==void 0?e:0:i instanceof Object&&(t=i.height)!==null&&t!==void 0?t:0}get depthOrArrayLayers(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>2?(e=i[2])!==null&&e!==void 0?e:0:i instanceof Object&&(t=i.depthOrArrayLayers)!==null&&t!==void 0?t:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let i=0;i<t.length;++i)t[i]=Math.max(1,t[i]>>e);return t}get texelByteSize(){const e=this.format,t=CA[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=CA[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=CA[e],i=this.width;if(!e||i<=0||!t)return-1;const r=this.height,s=this.depthOrArrayLayers,o=this.dimension;return i/t.blockWidth*(o==="1d"?1:r/t.blockHeight)*t.bytesPerBlock*s}getPixel(e,t,i=0,r=0){const s=this.texelByteSize,o=this.bytesPerRow,a=this.height,l=this.data[r];return abe(new Uint8Array(l),e,t,i,r,a,o,s,this.format)}setPixel(e,t,i,r,s){const o=this.texelByteSize,a=this.bytesPerRow,l=this.height,c=this.data[r];(function(u,d,m,y,x,T,S,w,P,M){const I=y*(S>>=x)*(T>>=x)+m*S+d*w;switch(P){case"r8unorm":return void oi(u,I,"8unorm",1,M);case"r8snorm":return void oi(u,I,"8snorm",1,M);case"r8uint":return void oi(u,I,"8uint",1,M);case"r8sint":return void oi(u,I,"8sint",1,M);case"rg8unorm":return void oi(u,I,"8unorm",2,M);case"rg8snorm":return void oi(u,I,"8snorm",2,M);case"rg8uint":return void oi(u,I,"8uint",2,M);case"rg8sint":return void oi(u,I,"8sint",2,M);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void oi(u,I,"8unorm",4,M);case"rgba8snorm":return void oi(u,I,"8snorm",4,M);case"rgba8uint":return void oi(u,I,"8uint",4,M);case"rgba8sint":return void oi(u,I,"8sint",4,M);case"r16uint":return void oi(u,I,"16uint",1,M);case"r16sint":return void oi(u,I,"16sint",1,M);case"r16float":return void oi(u,I,"16float",1,M);case"rg16uint":return void oi(u,I,"16uint",2,M);case"rg16sint":return void oi(u,I,"16sint",2,M);case"rg16float":return void oi(u,I,"16float",2,M);case"rgba16uint":return void oi(u,I,"16uint",4,M);case"rgba16sint":return void oi(u,I,"16sint",4,M);case"rgba16float":return void oi(u,I,"16float",4,M);case"r32uint":return void oi(u,I,"32uint",1,M);case"r32sint":return void oi(u,I,"32sint",1,M);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void oi(u,I,"32float",1,M);case"rg32uint":return void oi(u,I,"32uint",2,M);case"rg32sint":return void oi(u,I,"32sint",2,M);case"rg32float":return void oi(u,I,"32float",2,M);case"rgba32uint":return void oi(u,I,"32uint",4,M);case"rgba32sint":return void oi(u,I,"32sint",4,M);case"rgba32float":return void oi(u,I,"32float",4,M);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(c),e,t,i,r,l,a,o,this.format,s)}}(n=>{n[n.token=0]="token",n[n.keyword=1]="keyword",n[n.reserved=2]="reserved"})(Se||(Se={}));class Te{constructor(e,t,i){this.name=e,this.type=t,this.rule=i}toString(){return this.name}}class ee{}Ie=ee,ee.none=new Te("",Se.reserved,""),ee.eof=new Te("EOF",Se.token,""),ee.reserved={asm:new Te("asm",Se.reserved,"asm"),bf16:new Te("bf16",Se.reserved,"bf16"),do:new Te("do",Se.reserved,"do"),enum:new Te("enum",Se.reserved,"enum"),f16:new Te("f16",Se.reserved,"f16"),f64:new Te("f64",Se.reserved,"f64"),handle:new Te("handle",Se.reserved,"handle"),i8:new Te("i8",Se.reserved,"i8"),i16:new Te("i16",Se.reserved,"i16"),i64:new Te("i64",Se.reserved,"i64"),mat:new Te("mat",Se.reserved,"mat"),premerge:new Te("premerge",Se.reserved,"premerge"),regardless:new Te("regardless",Se.reserved,"regardless"),typedef:new Te("typedef",Se.reserved,"typedef"),u8:new Te("u8",Se.reserved,"u8"),u16:new Te("u16",Se.reserved,"u16"),u64:new Te("u64",Se.reserved,"u64"),unless:new Te("unless",Se.reserved,"unless"),using:new Te("using",Se.reserved,"using"),vec:new Te("vec",Se.reserved,"vec"),void:new Te("void",Se.reserved,"void")},ee.keywords={array:new Te("array",Se.keyword,"array"),atomic:new Te("atomic",Se.keyword,"atomic"),bool:new Te("bool",Se.keyword,"bool"),f32:new Te("f32",Se.keyword,"f32"),i32:new Te("i32",Se.keyword,"i32"),mat2x2:new Te("mat2x2",Se.keyword,"mat2x2"),mat2x3:new Te("mat2x3",Se.keyword,"mat2x3"),mat2x4:new Te("mat2x4",Se.keyword,"mat2x4"),mat3x2:new Te("mat3x2",Se.keyword,"mat3x2"),mat3x3:new Te("mat3x3",Se.keyword,"mat3x3"),mat3x4:new Te("mat3x4",Se.keyword,"mat3x4"),mat4x2:new Te("mat4x2",Se.keyword,"mat4x2"),mat4x3:new Te("mat4x3",Se.keyword,"mat4x3"),mat4x4:new Te("mat4x4",Se.keyword,"mat4x4"),ptr:new Te("ptr",Se.keyword,"ptr"),sampler:new Te("sampler",Se.keyword,"sampler"),sampler_comparison:new Te("sampler_comparison",Se.keyword,"sampler_comparison"),struct:new Te("struct",Se.keyword,"struct"),texture_1d:new Te("texture_1d",Se.keyword,"texture_1d"),texture_2d:new Te("texture_2d",Se.keyword,"texture_2d"),texture_2d_array:new Te("texture_2d_array",Se.keyword,"texture_2d_array"),texture_3d:new Te("texture_3d",Se.keyword,"texture_3d"),texture_cube:new Te("texture_cube",Se.keyword,"texture_cube"),texture_cube_array:new Te("texture_cube_array",Se.keyword,"texture_cube_array"),texture_multisampled_2d:new Te("texture_multisampled_2d",Se.keyword,"texture_multisampled_2d"),texture_storage_1d:new Te("texture_storage_1d",Se.keyword,"texture_storage_1d"),texture_storage_2d:new Te("texture_storage_2d",Se.keyword,"texture_storage_2d"),texture_storage_2d_array:new Te("texture_storage_2d_array",Se.keyword,"texture_storage_2d_array"),texture_storage_3d:new Te("texture_storage_3d",Se.keyword,"texture_storage_3d"),texture_depth_2d:new Te("texture_depth_2d",Se.keyword,"texture_depth_2d"),texture_depth_2d_array:new Te("texture_depth_2d_array",Se.keyword,"texture_depth_2d_array"),texture_depth_cube:new Te("texture_depth_cube",Se.keyword,"texture_depth_cube"),texture_depth_cube_array:new Te("texture_depth_cube_array",Se.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new Te("texture_depth_multisampled_2d",Se.keyword,"texture_depth_multisampled_2d"),texture_external:new Te("texture_external",Se.keyword,"texture_external"),u32:new Te("u32",Se.keyword,"u32"),vec2:new Te("vec2",Se.keyword,"vec2"),vec3:new Te("vec3",Se.keyword,"vec3"),vec4:new Te("vec4",Se.keyword,"vec4"),bitcast:new Te("bitcast",Se.keyword,"bitcast"),block:new Te("block",Se.keyword,"block"),break:new Te("break",Se.keyword,"break"),case:new Te("case",Se.keyword,"case"),continue:new Te("continue",Se.keyword,"continue"),continuing:new Te("continuing",Se.keyword,"continuing"),default:new Te("default",Se.keyword,"default"),diagnostic:new Te("diagnostic",Se.keyword,"diagnostic"),discard:new Te("discard",Se.keyword,"discard"),else:new Te("else",Se.keyword,"else"),enable:new Te("enable",Se.keyword,"enable"),fallthrough:new Te("fallthrough",Se.keyword,"fallthrough"),false:new Te("false",Se.keyword,"false"),fn:new Te("fn",Se.keyword,"fn"),for:new Te("for",Se.keyword,"for"),function:new Te("function",Se.keyword,"function"),if:new Te("if",Se.keyword,"if"),let:new Te("let",Se.keyword,"let"),const:new Te("const",Se.keyword,"const"),loop:new Te("loop",Se.keyword,"loop"),while:new Te("while",Se.keyword,"while"),private:new Te("private",Se.keyword,"private"),read:new Te("read",Se.keyword,"read"),read_write:new Te("read_write",Se.keyword,"read_write"),return:new Te("return",Se.keyword,"return"),requires:new Te("requires",Se.keyword,"requires"),storage:new Te("storage",Se.keyword,"storage"),switch:new Te("switch",Se.keyword,"switch"),true:new Te("true",Se.keyword,"true"),alias:new Te("alias",Se.keyword,"alias"),type:new Te("type",Se.keyword,"type"),uniform:new Te("uniform",Se.keyword,"uniform"),var:new Te("var",Se.keyword,"var"),override:new Te("override",Se.keyword,"override"),workgroup:new Te("workgroup",Se.keyword,"workgroup"),write:new Te("write",Se.keyword,"write"),r8unorm:new Te("r8unorm",Se.keyword,"r8unorm"),r8snorm:new Te("r8snorm",Se.keyword,"r8snorm"),r8uint:new Te("r8uint",Se.keyword,"r8uint"),r8sint:new Te("r8sint",Se.keyword,"r8sint"),r16uint:new Te("r16uint",Se.keyword,"r16uint"),r16sint:new Te("r16sint",Se.keyword,"r16sint"),r16float:new Te("r16float",Se.keyword,"r16float"),rg8unorm:new Te("rg8unorm",Se.keyword,"rg8unorm"),rg8snorm:new Te("rg8snorm",Se.keyword,"rg8snorm"),rg8uint:new Te("rg8uint",Se.keyword,"rg8uint"),rg8sint:new Te("rg8sint",Se.keyword,"rg8sint"),r32uint:new Te("r32uint",Se.keyword,"r32uint"),r32sint:new Te("r32sint",Se.keyword,"r32sint"),r32float:new Te("r32float",Se.keyword,"r32float"),rg16uint:new Te("rg16uint",Se.keyword,"rg16uint"),rg16sint:new Te("rg16sint",Se.keyword,"rg16sint"),rg16float:new Te("rg16float",Se.keyword,"rg16float"),rgba8unorm:new Te("rgba8unorm",Se.keyword,"rgba8unorm"),rgba8unorm_srgb:new Te("rgba8unorm_srgb",Se.keyword,"rgba8unorm_srgb"),rgba8snorm:new Te("rgba8snorm",Se.keyword,"rgba8snorm"),rgba8uint:new Te("rgba8uint",Se.keyword,"rgba8uint"),rgba8sint:new Te("rgba8sint",Se.keyword,"rgba8sint"),bgra8unorm:new Te("bgra8unorm",Se.keyword,"bgra8unorm"),bgra8unorm_srgb:new Te("bgra8unorm_srgb",Se.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new Te("rgb10a2unorm",Se.keyword,"rgb10a2unorm"),rg11b10float:new Te("rg11b10float",Se.keyword,"rg11b10float"),rg32uint:new Te("rg32uint",Se.keyword,"rg32uint"),rg32sint:new Te("rg32sint",Se.keyword,"rg32sint"),rg32float:new Te("rg32float",Se.keyword,"rg32float"),rgba16uint:new Te("rgba16uint",Se.keyword,"rgba16uint"),rgba16sint:new Te("rgba16sint",Se.keyword,"rgba16sint"),rgba16float:new Te("rgba16float",Se.keyword,"rgba16float"),rgba32uint:new Te("rgba32uint",Se.keyword,"rgba32uint"),rgba32sint:new Te("rgba32sint",Se.keyword,"rgba32sint"),rgba32float:new Te("rgba32float",Se.keyword,"rgba32float"),static_assert:new Te("static_assert",Se.keyword,"static_assert")},ee.tokens={decimal_float_literal:new Te("decimal_float_literal",Se.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new Te("hex_float_literal",Se.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new Te("int_literal",Se.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new Te("uint_literal",Se.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new Te("name",Se.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new Te("ident",Se.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new Te("and",Se.token,"&"),and_and:new Te("and_and",Se.token,"&&"),arrow:new Te("arrow ",Se.token,"->"),attr:new Te("attr",Se.token,"@"),forward_slash:new Te("forward_slash",Se.token,"/"),bang:new Te("bang",Se.token,"!"),bracket_left:new Te("bracket_left",Se.token,"["),bracket_right:new Te("bracket_right",Se.token,"]"),brace_left:new Te("brace_left",Se.token,"{"),brace_right:new Te("brace_right",Se.token,"}"),colon:new Te("colon",Se.token,":"),comma:new Te("comma",Se.token,","),equal:new Te("equal",Se.token,"="),equal_equal:new Te("equal_equal",Se.token,"=="),not_equal:new Te("not_equal",Se.token,"!="),greater_than:new Te("greater_than",Se.token,">"),greater_than_equal:new Te("greater_than_equal",Se.token,">="),shift_right:new Te("shift_right",Se.token,">>"),less_than:new Te("less_than",Se.token,"<"),less_than_equal:new Te("less_than_equal",Se.token,"<="),shift_left:new Te("shift_left",Se.token,"<<"),modulo:new Te("modulo",Se.token,"%"),minus:new Te("minus",Se.token,"-"),minus_minus:new Te("minus_minus",Se.token,"--"),period:new Te("period",Se.token,"."),plus:new Te("plus",Se.token,"+"),plus_plus:new Te("plus_plus",Se.token,"++"),or:new Te("or",Se.token,"|"),or_or:new Te("or_or",Se.token,"||"),paren_left:new Te("paren_left",Se.token,"("),paren_right:new Te("paren_right",Se.token,")"),semicolon:new Te("semicolon",Se.token,";"),star:new Te("star",Se.token,"*"),tilde:new Te("tilde",Se.token,"~"),underscore:new Te("underscore",Se.token,"_"),xor:new Te("xor",Se.token,"^"),plus_equal:new Te("plus_equal",Se.token,"+="),minus_equal:new Te("minus_equal",Se.token,"-="),times_equal:new Te("times_equal",Se.token,"*="),division_equal:new Te("division_equal",Se.token,"/="),modulo_equal:new Te("modulo_equal",Se.token,"%="),and_equal:new Te("and_equal",Se.token,"&="),or_equal:new Te("or_equal",Se.token,"|="),xor_equal:new Te("xor_equal",Se.token,"^="),shift_right_equal:new Te("shift_right_equal",Se.token,">>="),shift_left_equal:new Te("shift_left_equal",Se.token,"<<=")},ee.simpleTokens={"@":Ie.tokens.attr,"{":Ie.tokens.brace_left,"}":Ie.tokens.brace_right,":":Ie.tokens.colon,",":Ie.tokens.comma,"(":Ie.tokens.paren_left,")":Ie.tokens.paren_right,";":Ie.tokens.semicolon},ee.literalTokens={"&":Ie.tokens.and,"&&":Ie.tokens.and_and,"->":Ie.tokens.arrow,"/":Ie.tokens.forward_slash,"!":Ie.tokens.bang,"[":Ie.tokens.bracket_left,"]":Ie.tokens.bracket_right,"=":Ie.tokens.equal,"==":Ie.tokens.equal_equal,"!=":Ie.tokens.not_equal,">":Ie.tokens.greater_than,">=":Ie.tokens.greater_than_equal,">>":Ie.tokens.shift_right,"<":Ie.tokens.less_than,"<=":Ie.tokens.less_than_equal,"<<":Ie.tokens.shift_left,"%":Ie.tokens.modulo,"-":Ie.tokens.minus,"--":Ie.tokens.minus_minus,".":Ie.tokens.period,"+":Ie.tokens.plus,"++":Ie.tokens.plus_plus,"|":Ie.tokens.or,"||":Ie.tokens.or_or,"*":Ie.tokens.star,"~":Ie.tokens.tilde,_:Ie.tokens.underscore,"^":Ie.tokens.xor,"+=":Ie.tokens.plus_equal,"-=":Ie.tokens.minus_equal,"*=":Ie.tokens.times_equal,"/=":Ie.tokens.division_equal,"%=":Ie.tokens.modulo_equal,"&=":Ie.tokens.and_equal,"|=":Ie.tokens.or_equal,"^=":Ie.tokens.xor_equal,">>=":Ie.tokens.shift_right_equal,"<<=":Ie.tokens.shift_left_equal},ee.regexTokens={decimal_float_literal:Ie.tokens.decimal_float_literal,hex_float_literal:Ie.tokens.hex_float_literal,int_literal:Ie.tokens.int_literal,uint_literal:Ie.tokens.uint_literal,ident:Ie.tokens.ident},ee.storage_class=[Ie.keywords.function,Ie.keywords.private,Ie.keywords.workgroup,Ie.keywords.uniform,Ie.keywords.storage],ee.access_mode=[Ie.keywords.read,Ie.keywords.write,Ie.keywords.read_write],ee.sampler_type=[Ie.keywords.sampler,Ie.keywords.sampler_comparison],ee.sampled_texture_type=[Ie.keywords.texture_1d,Ie.keywords.texture_2d,Ie.keywords.texture_2d_array,Ie.keywords.texture_3d,Ie.keywords.texture_cube,Ie.keywords.texture_cube_array],ee.multisampled_texture_type=[Ie.keywords.texture_multisampled_2d],ee.storage_texture_type=[Ie.keywords.texture_storage_1d,Ie.keywords.texture_storage_2d,Ie.keywords.texture_storage_2d_array,Ie.keywords.texture_storage_3d],ee.depth_texture_type=[Ie.keywords.texture_depth_2d,Ie.keywords.texture_depth_2d_array,Ie.keywords.texture_depth_cube,Ie.keywords.texture_depth_cube_array,Ie.keywords.texture_depth_multisampled_2d],ee.texture_external_type=[Ie.keywords.texture_external],ee.any_texture_type=[...Ie.sampled_texture_type,...Ie.multisampled_texture_type,...Ie.storage_texture_type,...Ie.depth_texture_type,...Ie.texture_external_type],ee.texel_format=[Ie.keywords.r8unorm,Ie.keywords.r8snorm,Ie.keywords.r8uint,Ie.keywords.r8sint,Ie.keywords.r16uint,Ie.keywords.r16sint,Ie.keywords.r16float,Ie.keywords.rg8unorm,Ie.keywords.rg8snorm,Ie.keywords.rg8uint,Ie.keywords.rg8sint,Ie.keywords.r32uint,Ie.keywords.r32sint,Ie.keywords.r32float,Ie.keywords.rg16uint,Ie.keywords.rg16sint,Ie.keywords.rg16float,Ie.keywords.rgba8unorm,Ie.keywords.rgba8unorm_srgb,Ie.keywords.rgba8snorm,Ie.keywords.rgba8uint,Ie.keywords.rgba8sint,Ie.keywords.bgra8unorm,Ie.keywords.bgra8unorm_srgb,Ie.keywords.rgb10a2unorm,Ie.keywords.rg11b10float,Ie.keywords.rg32uint,Ie.keywords.rg32sint,Ie.keywords.rg32float,Ie.keywords.rgba16uint,Ie.keywords.rgba16sint,Ie.keywords.rgba16float,Ie.keywords.rgba32uint,Ie.keywords.rgba32sint,Ie.keywords.rgba32float],ee.const_literal=[Ie.tokens.int_literal,Ie.tokens.uint_literal,Ie.tokens.decimal_float_literal,Ie.tokens.hex_float_literal,Ie.keywords.true,Ie.keywords.false],ee.literal_or_ident=[Ie.tokens.ident,Ie.tokens.int_literal,Ie.tokens.uint_literal,Ie.tokens.decimal_float_literal,Ie.tokens.hex_float_literal,Ie.tokens.name],ee.element_count_expression=[Ie.tokens.int_literal,Ie.tokens.uint_literal,Ie.tokens.ident],ee.template_types=[Ie.keywords.vec2,Ie.keywords.vec3,Ie.keywords.vec4,Ie.keywords.mat2x2,Ie.keywords.mat2x3,Ie.keywords.mat2x4,Ie.keywords.mat3x2,Ie.keywords.mat3x3,Ie.keywords.mat3x4,Ie.keywords.mat4x2,Ie.keywords.mat4x3,Ie.keywords.mat4x4,Ie.keywords.atomic,Ie.keywords.bitcast,...Ie.any_texture_type],ee.attribute_name=[Ie.tokens.ident,Ie.keywords.block,Ie.keywords.diagnostic],ee.assignment_operators=[Ie.tokens.equal,Ie.tokens.plus_equal,Ie.tokens.minus_equal,Ie.tokens.times_equal,Ie.tokens.division_equal,Ie.tokens.modulo_equal,Ie.tokens.and_equal,Ie.tokens.or_equal,Ie.tokens.xor_equal,Ie.tokens.shift_right_equal,Ie.tokens.shift_left_equal],ee.increment_operators=[Ie.tokens.plus_plus,Ie.tokens.minus_minus];class lU{constructor(e,t,i,r,s){this.type=e,this.lexeme=t,this.line=i,this.start=r,this.end=s}toString(){return this.lexeme}isTemplateType(){return ee.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==ee.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class pbe{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new lU(ee.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const t=ee.simpleTokens[e];if(t)return this._addToken(t),!0;let i=ee.none;const r=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(r){const o=ee.keywords[e];if(o)return this._addToken(o),!0}if(r||s)return this._addToken(ee.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(ee.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(ee.tokens.minus_minus),!0;const l=this._tokens.length-1;if((ee.literal_or_ident.indexOf(this._tokens[l].type)!=-1||this._tokens[l].type==ee.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let l=!1,c=this._tokens.length-1;for(let u=0;u<5&&c>=0&&ee.assignment_operators.indexOf(this._tokens[c].type)===-1;++u,--c)if(this._tokens[c].type===ee.tokens.less_than){c>0&&this._tokens[c-1].isArrayOrTemplateType()&&(l=!0);break}if(l)return this._addToken(o),!0}if(o===ee.none){let l=e,c=0;const u=2;for(let d=0;d<u;++d)if(l+=this._peekAhead(d),o=this._findType(l),o!==ee.none){c=d;break}if(o===ee.none)return i!==ee.none&&(this._current--,this._addToken(i),!0);e=l,this._current+=c+1}if(i=o,this._isAtEnd())break;e+=this._advance()}return i!==ee.none&&(this._addToken(i),!0)}_findType(e){for(const i in ee.regexTokens){const r=ee.regexTokens[i];if(this._match(e,r.rule))return r}return ee.literalTokens[e]||ee.none}_match(e,t){const i=t.exec(e);return i&&i.index==0&&i[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new lU(e,t,this._line,this._start,this._current))}}function Tt(n){return Array.isArray(n)||n?.buffer instanceof ArrayBuffer}const bS=new Float32Array(1),mbe=new Uint32Array(bS.buffer),gbe=new Uint32Array(bS.buffer),wS=new Int32Array(1),_be=new Float32Array(wS.buffer),ybe=new Uint32Array(wS.buffer),SS=new Uint32Array(1),vbe=new Float32Array(SS.buffer),xbe=new Int32Array(SS.buffer);function cU(n,e,t){if(e===t)return n;if(e==="f32"){if(t==="i32"||t==="x32")return bS[0]=n,mbe[0];if(t==="u32")return bS[0]=n,gbe[0]}else if(e==="i32"||e==="x32"){if(t==="f32")return wS[0]=n,_be[0];if(t==="u32")return wS[0]=n,ybe[0]}else if(e==="u32"){if(t==="f32")return SS[0]=n,vbe[0];if(t==="i32"||t==="x32")return SS[0]=n,xbe[0]}return console.error(`Unsupported cast from ${e} to ${t}`),n}class bbe{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class $b{constructor(e,t){this.align=e,this.size=t}}class Kc{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new ibe,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const t of e)t instanceof i0&&this._functions.set(t.name,new bbe(t));for(const t of e)if(t instanceof Ju){const i=this.getTypeInfo(t,null);i instanceof Bf&&this.structs.push(i)}for(const t of e)if(t instanceof aI)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof sI){const i=t,r=this._getAttributeNum(i.attributes,"id",0),s=i.type!=null?this.getTypeInfo(i.type,i.attributes):null;this.overrides.push(new ebe(i.name,s,i.attributes,r));continue}if(this._isUniformVar(t)){const i=t,r=this._getAttributeNum(i.attributes,"group",0),s=this._getAttributeNum(i.attributes,"binding",0),o=this.getTypeInfo(i.type,i.attributes),a=new jb(i.name,o,r,s,i.attributes,Af.Uniform,i.access);a.access||(a.access="read"),this.uniforms.push(a);continue}if(this._isStorageVar(t)){const i=t,r=this._getAttributeNum(i.attributes,"group",0),s=this._getAttributeNum(i.attributes,"binding",0),o=this.getTypeInfo(i.type,i.attributes),a=this._isStorageTexture(o),l=new jb(i.name,o,r,s,i.attributes,a?Af.StorageTexture:Af.Storage,i.access);l.access||(l.access="read"),this.storage.push(l);continue}if(this._isTextureVar(t)){const i=t,r=this._getAttributeNum(i.attributes,"group",0),s=this._getAttributeNum(i.attributes,"binding",0),o=this.getTypeInfo(i.type,i.attributes),a=this._isStorageTexture(o),l=new jb(i.name,o,r,s,i.attributes,a?Af.StorageTexture:Af.Texture,i.access);l.access||(l.access="read"),a?this.storage.push(l):this.textures.push(l);continue}if(this._isSamplerVar(t)){const i=t,r=this._getAttributeNum(i.attributes,"group",0),s=this._getAttributeNum(i.attributes,"binding",0),o=this.getTypeInfo(i.type,i.attributes),a=new jb(i.name,o,r,s,i.attributes,Af.Sampler,i.access);this.samplers.push(a);continue}}for(const t of e)if(t instanceof i0){const i=this._getAttribute(t,"vertex"),r=this._getAttribute(t,"fragment"),s=this._getAttribute(t,"compute"),o=i||r||s,a=new nbe(t.name,o?.name,t.attributes);a.attributes=t.attributes,a.startLine=t.startLine,a.endLine=t.endLine,this.functions.push(a),this._functions.get(t.name).info=a,o&&(this._functions.get(t.name).inUse=!0,a.inUse=!0,a.resources=this._findResources(t,!!o),a.inputs=this._getInputs(t.args),a.outputs=this._getOutputs(t.returnType),this.entry[o.name].push(a)),a.arguments=t.args.map(l=>new tbe(l.name,this.getTypeInfo(l.type,l.attributes),l.attributes)),a.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(i=>{var r,s,o;if(i instanceof oj){if(i.value)if(Tt(i.value))for(const a of i.value)for(const l of this.overrides)a===l.name&&((r=t.info)===null||r===void 0||r.overrides.push(l));else for(const a of this.overrides)i.value===a.name&&((s=t.info)===null||s===void 0||s.overrides.push(a))}else if(i instanceof Ha)for(const a of this.overrides)i.name===a.name&&((o=t.info)===null||o===void 0||o.overrides.push(a))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var i;for(const r of e.calls){const s=(i=this._functions.get(r.name))===null||i===void 0?void 0:i.info;s&&t.add(s)}}findResource(e,t,i){if(i){for(const r of this.entry.compute)if(r.name===i){for(const s of r.resources)if(s.group==e&&s.binding==t)return s}for(const r of this.entry.vertex)if(r.name===i){for(const s of r.resources)if(s.group==e&&s.binding==t)return s}for(const r of this.entry.fragment)if(r.name===i){for(const s of r.resources)if(s.group==e&&s.binding==t)return s}}for(const r of this.uniforms)if(r.group==e&&r.binding==t)return r;for(const r of this.storage)if(r.group==e&&r.binding==t)return r;for(const r of this.textures)if(r.group==e&&r.binding==t)return r;for(const r of this.samplers)if(r.group==e&&r.binding==t)return r;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const i=[],r=this,s=[];return e.search(o=>{if(o instanceof vS)s.push({});else if(o instanceof xS)s.pop();else if(o instanceof th){const a=o;t&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof $c){const a=o;t&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof av){const a=o;t&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof Ha){const a=o;if(s.length>0&&s[s.length-1][a.name])return;const l=r._findResource(a.name);l&&i.push(l)}else if(o instanceof lI){const a=o,l=r._functions.get(a.name);l&&(t&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=r._findResources(l.node,t)),i.push(...l.resources))}else if(o instanceof oI){const a=o,l=r._functions.get(a.name);l&&(t&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=r._findResources(l.node,t)),i.push(...l.resources))}}),[...new Map(i.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function t(i,r){i>=e.length&&(e.length=i+1),e[i]===void 0&&(e[i]=[]),r>=e[i].length&&(e[i].length=r+1)}for(const i of this.uniforms)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.storage)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.textures)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.samplers)t(i.group,i.binding),e[i.group][i.binding]=i;return e}_getOutputs(e,t=void 0){if(t===void 0&&(t=[]),e instanceof Ju)this._getStructOutputs(e,t);else{const i=this._getOutputInfo(e);i!==null&&t.push(i)}return t}_getStructOutputs(e,t){for(const i of e.members)if(i.type instanceof Ju)this._getStructOutputs(i.type,t);else{const r=this._getAttribute(i,"location")||this._getAttribute(i,"builtin");if(r!==null){const s=this.getTypeInfo(i.type,i.type.attributes),o=this._parseInt(r.value),a=new iU(i.name,s,r.name,o);t.push(a)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const i=this.getTypeInfo(e,e.attributes),r=this._parseInt(t.value);return new iU("",i,t.name,r)}return null}_getInputs(e,t=void 0){t===void 0&&(t=[]);for(const i of e)if(i.type instanceof Ju)this._getStructInputs(i.type,t);else{const r=this._getInputInfo(i);r!==null&&t.push(r)}return t}_getStructInputs(e,t){for(const i of e.members)if(i.type instanceof Ju)this._getStructInputs(i.type,t);else{const r=this._getInputInfo(i);r!==null&&t.push(r)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const i=this._getAttribute(e,"interpolation"),r=this.getTypeInfo(e.type,e.attributes),s=this._parseInt(t.value),o=new Qxe(e.name,r,t.name,s);return i!==null&&(o.interpolation=this._parseString(i.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new Jxe(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof Ew){const r=e.type?this.getTypeInfo(e.type,e.attributes):null,s=new eP(e.name,r,t);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof lv){const r=e,s=r.format?this.getTypeInfo(r.format,r.attributes):null,o=new Zf(r.name,t);return o.format=s,o.count=r.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Ju){const r=e,s=new Bf(r.name,t);s.startLine=r.startLine,s.endLine=r.endLine;for(const o of r.members){const a=this.getTypeInfo(o.type,o.attributes);s.members.push(new nU(o.name,a,o.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof By){const r=e,s=r.format instanceof Ze,o=r.format?s?this.getTypeInfo(r.format,null):new gl(r.format,null):null,a=new Qp(r.name,o,t,r.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Ae){const r=e,s=r.format?this.getTypeInfo(r.format,null):null,o=new Qp(r.name,s,t,r.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const i=new gl(e.name,t);return this._types.set(e,i),this._updateTypeInfo(i),i}_updateTypeInfo(e){var t,i,r;const s=this._getTypeSize(e);if(e.size=(t=s?.size)!==null&&t!==void 0?t:0,e instanceof Zf&&e.format){const o=this._getTypeSize(e.format);e.stride=Math.max((i=o?.size)!==null&&i!==void 0?i:0,(r=o?.align)!==null&&r!==void 0?r:0),this._updateTypeInfo(e.format)}e instanceof eP&&this._updateTypeInfo(e.format),e instanceof Bf&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let i=0,r=0,s=0,o=0;for(let a=0,l=e.members.length;a<l;++a){const c=e.members[a],u=this._getTypeSize(c);if(!u)continue;(t=this._getAlias(c.type.name))!==null&&t!==void 0||c.type;const d=u.align,m=u.size;i=this._roundUp(d,i+r),r=m,s=i,o=Math.max(o,d),c.offset=i,c.size=m,this._updateTypeInfo(c.type)}e.size=this._roundUp(o,s+r),e.align=o}_getTypeSize(e){var t,i;if(e==null)return null;const r=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof nU&&(e=e.type),e instanceof gl){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=Kc._typeInfo[e.name];if(o!==void 0){const a=((t=e.format)===null||t===void 0?void 0:t.name)==="f16"?2:1;return new $b(Math.max(s,o.align/a),Math.max(r,o.size/a))}}{const o=Kc._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new $b(Math.max(s,o.align/a),Math.max(r,o.size/a))}}if(e instanceof Zf){let o=e,a=8,l=8;const c=this._getTypeSize(o.format);return c!==null&&(l=c.size,a=c.align),l=o.count*this._getAttributeNum((i=e?.attributes)!==null&&i!==void 0?i:null,"stride",this._roundUp(a,l)),r&&(l=r),new $b(Math.max(s,a),Math.max(r,l))}if(e instanceof Bf){let o=0,a=0,l=0,c=0,u=0;for(const d of e.members){const m=this._getTypeSize(d.type);m!==null&&(o=Math.max(m.align,o),l=this._roundUp(m.align,l+c),c=m.size,u=l)}return a=this._roundUp(o,u+c),new $b(Math.max(s,o),Math.max(r,a))}return null}_isUniformVar(e){return e instanceof th&&e.storage=="uniform"}_isStorageVar(e){return e instanceof th&&e.storage=="storage"}_isTextureVar(e){return e instanceof th&&e.type!==null&&Kc._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof th&&e.type!==null&&Kc._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,t){const i=e;if(!i||!i.attributes)return null;const r=i.attributes;for(let s of r)if(s.name==t)return s;return null}_getAttributeNum(e,t,i){if(e===null)return i;for(let r of e)if(r.name==t){let s=r!==null&&r.value!==null?r.value:i;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):i}return i}_roundUp(e,t){return Math.ceil(t/e)*e}}Kc._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Kc._textureTypes=ee.any_texture_type.map(n=>n.name),Kc._samplerTypes=ee.sampler_type.map(n=>n.name);let cI=0;class uI{constructor(e,t,i){this.id=cI++,this.name=e,this.value=t,this.node=i}clone(){return new uI(this.name,this.value,this.node)}}class hI{constructor(e){this.id=cI++,this.name=e.name,this.node=e}clone(){return new hI(this.node)}}class fI{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=cI++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?(t=this.variables.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?(t=this.functions.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,i){this.variables.set(e,new uI(e,t,i??null))}setVariable(e,t,i){const r=this.getVariable(e);r!==null?r.value=t:this.createVariable(e,t,i)}getVariableValue(e){var t;const i=this.getVariable(e);return(t=i?.value)!==null&&t!==void 0?t:null}clone(){return new fI(this)}}class wbe{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class Sbe{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const i=this.exec.evalExpression(e.args[0],t);let r=!0;if(i instanceof se)return i.data.forEach(s=>{s||(r=!1)}),new be(r?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se){const r=i.data.some(s=>s);return new be(r?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const i=this.exec.evalExpression(e.args[2],t);if(!(i instanceof be))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return i.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.evalExpression(i,t);if(r instanceof fr&&r.typeInfo.size===0){const s=r.typeInfo,o=r.buffer.byteLength/s.stride;return new be(o,this.getTypeInfo("u32"))}return new be(r.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.abs(s)),i.typeInfo);const r=i;return new be(Math.abs(r.value),r.typeInfo)}Acos(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.acos(s)),i.typeInfo);const r=i;return new be(Math.acos(r.value),i.typeInfo)}Acosh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.acosh(s)),i.typeInfo);const r=i;return new be(Math.acosh(r.value),i.typeInfo)}Asin(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.asin(s)),i.typeInfo);const r=i;return new be(Math.asin(r.value),i.typeInfo)}Asinh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.asinh(s)),i.typeInfo);const r=i;return new be(Math.asinh(r.value),i.typeInfo)}Atan(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.atan(s)),i.typeInfo);const r=i;return new be(Math.atan(r.value),i.typeInfo)}Atanh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.atanh(s)),i.typeInfo);const r=i;return new be(Math.atanh(r.value),i.typeInfo)}Atan2(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se)return new se(i.data.map((a,l)=>Math.atan2(a,r.data[l])),i.typeInfo);const s=i,o=r;return new be(Math.atan2(s.value,o.value),i.typeInfo)}Ceil(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.ceil(s)),i.typeInfo);const r=i;return new be(Math.ceil(r.value),i.typeInfo)}_clamp(e,t,i){return Math.min(Math.max(e,t),i)}Clamp(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(i instanceof se&&r instanceof se&&s instanceof se)return new se(i.data.map((c,u)=>this._clamp(c,r.data[u],s.data[u])),i.typeInfo);const o=i,a=r,l=s;return new be(this._clamp(o.value,a.value,l.value),i.typeInfo)}Cos(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.cos(s)),i.typeInfo);const r=i;return new be(Math.cos(r.value),i.typeInfo)}Cosh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.cosh(s)),i.typeInfo);const r=i;return new be(Math.cos(r.value),i.typeInfo)}CountLeadingZeros(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.clz32(s)),i.typeInfo);const r=i;return new be(Math.clz32(r.value),i.typeInfo)}_countOneBits(e){let t=0;for(;e!==0;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>this._countOneBits(s)),i.typeInfo);const r=i;return new be(this._countOneBits(r.value),i.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>this._countTrailingZeros(s)),i.typeInfo);const r=i;return new be(this._countTrailingZeros(r.value),i.typeInfo)}Cross(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se){if(i.data.length!==3||r.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const s=i.data,o=r.data;return new se([s[1]*o[2]-o[1]*s[2],s[2]*o[0]-o[2]*s[0],s[0]*o[1]-o[0]*s[1]],i.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,t){const i=this.exec.evalExpression(e.args[0],t),r=180/Math.PI;return i instanceof se?new se(i.data.map(s=>s*r),i.typeInfo):new be(i.value*r,this.getTypeInfo("f32"))}Determinant(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof hn){const r=i.data,s=i.typeInfo.getTypeName(),o=s.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(s==="mat2x2"||s==="mat2x2f"||s==="mat2x2h")return new be(r[0]*r[3]-r[1]*r[2],o);if(s==="mat2x3"||s==="mat2x3f"||s==="mat2x3h")return new be(r[0]*(r[4]*r[8]-r[5]*r[7])-r[1]*(r[3]*r[8]-r[5]*r[6])+r[2]*(r[3]*r[7]-r[4]*r[6]),o);if(s==="mat2x4"||s==="mat2x4f"||s==="mat2x4h")console.error(`TODO: Determinant for ${s}`);else if(s==="mat3x2"||s==="mat3x2f"||s==="mat3x2h")console.error(`TODO: Determinant for ${s}`);else{if(s==="mat3x3"||s==="mat3x3f"||s==="mat3x3h")return new be(r[0]*(r[4]*r[8]-r[5]*r[7])-r[1]*(r[3]*r[8]-r[5]*r[6])+r[2]*(r[3]*r[7]-r[4]*r[6]),o);s==="mat3x4"||s==="mat3x4f"||s==="mat3x4h"||s==="mat4x2"||s==="mat4x2f"||s==="mat4x2h"||s==="mat4x3"||s==="mat4x3f"||s==="mat4x3h"?console.error(`TODO: Determinant for ${s}`):s!=="mat4x4"&&s!=="mat4x4f"&&s!=="mat4x4h"||console.error(`TODO: Determinant for ${s}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se){let a=0;for(let l=0;l<i.data.length;++l)a+=(i.data[l]-r.data[l])*(i.data[l]-r.data[l]);return new be(Math.sqrt(a),this.getTypeInfo("f32"))}const s=i,o=r;return new be(Math.abs(s.value-o.value),i.typeInfo)}_dot(e,t){let i=0;for(let r=0;r<e.length;++r)i+=t[r]*e[r];return i}Dot(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);return i instanceof se&&r instanceof se?new be(this._dot(i.data,r.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,t){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,t){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.exp(s)),i.typeInfo);const r=i;return new be(Math.exp(r.value),i.typeInfo)}Exp2(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.pow(2,s)),i.typeInfo);const r=i;return new be(Math.pow(2,r.value),i.typeInfo)}ExtractBits(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(r.typeInfo.name!=="u32"&&r.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const o=r.value,a=s.value;if(i instanceof se)return new se(i.data.map(c=>c>>o&(1<<a)-1),i.typeInfo);if(i.typeInfo.name!=="i32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const l=i.value;return new be(l>>o&(1<<a)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(i instanceof se&&r instanceof se&&s instanceof se){const o=this._dot(r.data,s.data);return new se(o<0?Array.from(i.data):i.data.map(a=>-a),i.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>this._firstLeadingBit(s)),i.typeInfo);const r=i;return new be(this._firstLeadingBit(r.value),i.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>this._firstTrailingBit(s)),i.typeInfo);const r=i;return new be(this._firstTrailingBit(r.value),i.typeInfo)}Floor(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.floor(s)),i.typeInfo);const r=i;return new be(Math.floor(r.value),i.typeInfo)}Fma(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(i instanceof se&&r instanceof se&&s instanceof se)return i.data.length!==r.data.length||i.data.length!==s.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new se(i.data.map((c,u)=>c*r.data[u]+s.data[u]),i.typeInfo);const o=i,a=r,l=s;return new be(o.value*a.value+l.value,o.typeInfo)}Fract(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>s-Math.floor(s)),i.typeInfo);const r=i;return new be(r.value-Math.floor(r.value),i.typeInfo)}Frexp(e,t){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t),o=this.exec.evalExpression(e.args[3],t);if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const a=s.value,l=(1<<o.value)-1<<a,c=~l;if(i instanceof se&&r instanceof se)return new se(i.data.map((m,y)=>m&c|r.data[y]<<a&l),i.typeInfo);const u=i.value,d=r.value;return new be(u&c|d<<a&l,i.typeInfo)}InverseSqrt(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>1/Math.sqrt(s)),i.typeInfo);const r=i;return new be(1/Math.sqrt(r.value),i.typeInfo)}Ldexp(e,t){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se){let s=0;return i.data.forEach(o=>{s+=o*o}),new be(Math.sqrt(s),this.getTypeInfo("f32"))}const r=i;return new be(Math.abs(r.value),i.typeInfo)}Log(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.log(s)),i.typeInfo);const r=i;return new be(Math.log(r.value),i.typeInfo)}Log2(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.log2(s)),i.typeInfo);const r=i;return new be(Math.log2(r.value),i.typeInfo)}Max(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se)return new se(i.data.map((a,l)=>Math.max(a,r.data[l])),i.typeInfo);const s=i,o=r;return new be(Math.max(s.value,o.value),i.typeInfo)}Min(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se)return new se(i.data.map((a,l)=>Math.min(a,r.data[l])),i.typeInfo);const s=i,o=r;return new be(Math.min(s.value,o.value),i.typeInfo)}Mix(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(i instanceof se&&r instanceof se&&s instanceof se)return new se(i.data.map((l,c)=>i.data[c]*(1-s.data[c])+r.data[c]*s.data[c]),i.typeInfo);const o=r,a=s;return new be(i.value*(1-a.value)+o.value*a.value,i.typeInfo)}Modf(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se)return new se(i.data.map((o,a)=>o%r.data[a]),i.typeInfo);const s=r;return new be(i.value%s.value,i.typeInfo)}Normalize(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se){const r=this.Length(e,t).value;return new se(i.data.map(s=>s/r),i.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se)return new se(i.data.map((a,l)=>Math.pow(a,r.data[l])),i.typeInfo);const s=i,o=r;return new be(Math.pow(s.value,o.value),i.typeInfo)}QuantizeToF16(e,t){const i=this.exec.evalExpression(e.args[0],t);return i instanceof se?new se(i.data.map(r=>r),i.typeInfo):new be(i.value,i.typeInfo)}Radians(e,t){const i=this.exec.evalExpression(e.args[0],t);return i instanceof se?new se(i.data.map(r=>r*Math.PI/180),i.typeInfo):new be(i.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(i instanceof se&&r instanceof se){const s=this._dot(i.data,r.data);return new se(i.data.map((o,a)=>o-2*s*r.data[a]),i.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,t){let i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(i instanceof se&&r instanceof se&&s instanceof be){const o=this._dot(r.data,i.data);return new se(i.data.map((a,l)=>{const c=1-s.value*s.value*(1-o*o);if(c<0)return 0;const u=Math.sqrt(c);return s.value*a-(s.value*o+u)*r.data[l]}),i.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,t){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.round(s)),i.typeInfo);const r=i;return new be(Math.round(r.value),i.typeInfo)}Saturate(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.min(Math.max(s,0),1)),i.typeInfo);const r=i;return new be(Math.min(Math.max(r.value,0),1),i.typeInfo)}Sign(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.sign(s)),i.typeInfo);const r=i;return new be(Math.sign(r.value),i.typeInfo)}Sin(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.sin(s)),i.typeInfo);const r=i;return new be(Math.sin(r.value),i.typeInfo)}Sinh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.sinh(s)),i.typeInfo);const r=i;return new be(Math.sinh(r.value),i.typeInfo)}_smoothstep(e,t,i){const r=Math.min(Math.max((i-e)/(t-e),0),1);return r*r*(3-2*r)}SmoothStep(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(s instanceof se&&i instanceof se&&r instanceof se)return new se(s.data.map((c,u)=>this._smoothstep(i.data[u],r.data[u],c)),s.typeInfo);const o=i,a=r,l=s;return new be(this._smoothstep(o.value,a.value,l.value),s.typeInfo)}Sqrt(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.sqrt(s)),i.typeInfo);const r=i;return new be(Math.sqrt(r.value),i.typeInfo)}Step(e,t){const i=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(r instanceof se&&i instanceof se)return new se(r.data.map((o,a)=>o<i.data[a]?0:1),r.typeInfo);const s=i;return new be(r.value<s.value?0:1,s.typeInfo)}Tan(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.tan(s)),i.typeInfo);const r=i;return new be(Math.tan(r.value),i.typeInfo)}Tanh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.tanh(s)),i.typeInfo);const r=i;return new be(Math.tanh(r.value),i.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return t==="mat2x2f"||t==="mat2x2h"?e:t==="mat2x3f"?this.getTypeInfo("mat3x2f"):t==="mat2x3h"?this.getTypeInfo("mat3x2h"):t==="mat2x4f"?this.getTypeInfo("mat4x2f"):t==="mat2x4h"?this.getTypeInfo("mat4x2h"):t==="mat3x2f"?this.getTypeInfo("mat2x3f"):t==="mat3x2h"?this.getTypeInfo("mat2x3h"):t==="mat3x3f"||t==="mat3x3h"?e:t==="mat3x4f"?this.getTypeInfo("mat4x3f"):t==="mat3x4h"?this.getTypeInfo("mat4x3h"):t==="mat4x2f"?this.getTypeInfo("mat2x4f"):t==="mat4x2h"?this.getTypeInfo("mat2x4h"):t==="mat4x3f"?this.getTypeInfo("mat3x4f"):t==="mat4x3h"?this.getTypeInfo("mat3x4h"):(t==="mat4x4f"||t==="mat4x4h"||console.error(`Invalid matrix type ${t}`),e)}Transpose(e,t){const i=this.exec.evalExpression(e.args[0],t);if(!(i instanceof hn))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const r=this._getTransposeType(i.typeInfo);if(i.typeInfo.name==="mat2x2"||i.typeInfo.name==="mat2x2f"||i.typeInfo.name==="mat2x2h"){const s=i.data;return new hn([s[0],s[2],s[1],s[3]],r)}if(i.typeInfo.name==="mat2x3"||i.typeInfo.name==="mat2x3f"||i.typeInfo.name==="mat2x3h"){const s=i.data;return new hn([s[0],s[3],s[6],s[1],s[4],s[7]],r)}if(i.typeInfo.name==="mat2x4"||i.typeInfo.name==="mat2x4f"||i.typeInfo.name==="mat2x4h"){const s=i.data;return new hn([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13]],r)}if(i.typeInfo.name==="mat3x2"||i.typeInfo.name==="mat3x2f"||i.typeInfo.name==="mat3x2h"){const s=i.data;return new hn([s[0],s[3],s[1],s[4],s[2],s[5]],r)}if(i.typeInfo.name==="mat3x3"||i.typeInfo.name==="mat3x3f"||i.typeInfo.name==="mat3x3h"){const s=i.data;return new hn([s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8]],r)}if(i.typeInfo.name==="mat3x4"||i.typeInfo.name==="mat3x4f"||i.typeInfo.name==="mat3x4h"){const s=i.data;return new hn([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14]],r)}if(i.typeInfo.name==="mat4x2"||i.typeInfo.name==="mat4x2f"||i.typeInfo.name==="mat4x2h"){const s=i.data;return new hn([s[0],s[4],s[1],s[5],s[2],s[6]],r)}if(i.typeInfo.name==="mat4x3"||i.typeInfo.name==="mat4x3f"||i.typeInfo.name==="mat4x3h"){const s=i.data;return new hn([s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]],r)}if(i.typeInfo.name==="mat4x4"||i.typeInfo.name==="mat4x4f"||i.typeInfo.name==="mat4x4h"){const s=i.data;return new hn([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]],r)}return console.error(`Invalid matrix type ${i.typeInfo.name}`),null}Trunc(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof se)return new se(i.data.map(s=>Math.trunc(s)),i.typeInfo);const r=i;return new be(Math.trunc(r.value),i.typeInfo)}Dpdx(e,t){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,t){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const i=e.args[0],r=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(i instanceof Ha){const s=i.name,o=t.getVariableValue(s);if(o instanceof Qu){if(r<0||r>=o.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const a=o.getMipLevelSize(r),l=o.dimension;return l==="1d"?new be(a[0],this.getTypeInfo("u32")):l==="3d"?new se(a,this.getTypeInfo("vec3u")):l==="2d"?new se(a.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${l} not found. Line ${e.line}`),null)}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const i=e.args[0],r=this.exec.evalExpression(e.args[1],t),s=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(r instanceof se)||r.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(i instanceof Ha){const o=i.name,a=t.getVariableValue(o);if(a instanceof Qu){const l=Math.floor(r.data[0]),c=Math.floor(r.data[1]);if(l<0||l>=a.width||c<0||c>=a.height)return console.error(`Texture ${o} out of bounds. Line ${e.line}`),null;const u=a.getPixel(l,c,0,s);return u===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new se(u,this.getTypeInfo("vec4f"))}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,t){const i=e.args[0];if(i instanceof Ha){const r=i.name,s=t.getVariableValue(r);return s instanceof Qu?new be(s.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${r} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,t){const i=e.args[0];if(i instanceof Ha){const r=i.name,s=t.getVariableValue(r);return s instanceof Qu?new be(s.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${r} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,t){const i=e.args[0];if(i instanceof Ha){const r=i.name,s=t.getVariableValue(r);return s instanceof Qu?new be(s.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${r} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const i=e.args[0],r=this.exec.evalExpression(e.args[1],t),s=e.args.length===4?this.exec.evalExpression(e.args[2],t).value:0,o=e.args.length===4?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(o.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(r instanceof se)||r.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(i instanceof Ha){const a=i.name,l=t.getVariableValue(a);if(l instanceof Qu){const c=l.getMipLevelSize(0),u=Math.floor(r.data[0]),d=Math.floor(r.data[1]);return u<0||u>=c[0]||d<0||d>=c[1]?(console.error(`Texture ${a} out of bounds. Line ${e.line}`),null):(l.setPixel(u,d,0,s,Array.from(o)),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t);return t.getVariable(r).value.getSubData(this.exec,i.postfix,t)}AtomicStore(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t);return l instanceof be&&a instanceof be&&(l.value=a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),null}AtomicAdd(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value+=a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicSub(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value-=a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicMax(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value=Math.max(l.value,a.value)),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicMin(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value=Math.min(l.value,a.value)),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicAnd(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value=l.value&a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicOr(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value=l.value|a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicXor(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value=l.value^a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicExchange(e,t){let i=e.args[0];i instanceof Wr&&(i=i.right);const r=this.exec.getVariableName(i,t),s=t.getVariable(r);let o=e.args[1];const a=this.exec.evalExpression(o,t),l=s.value.getSubData(this.exec,i.postfix,t),c=new be(l.value,l.typeInfo);return l instanceof be&&a instanceof be&&(l.value=a.value),s.value instanceof fr&&s.value.setDataValue(this.exec,l,i.postfix,t),c}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const PA={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Oo={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class lo extends wbe{constructor(e,t){var i;super(),this.ast=e??[],this.reflection=new Kc,this.reflection.updateAST(this.ast),this.context=(i=t?.clone())!==null&&i!==void 0?i:new fI,this.builtins=new Sbe(this),this.typeInfo={bool:this.getTypeInfo(Ze.bool),i32:this.getTypeInfo(Ze.i32),u32:this.getTypeInfo(Ze.u32),f32:this.getTypeInfo(Ze.f32),f16:this.getTypeInfo(Ze.f16),vec2f:this.getTypeInfo(Ae.vec2f),vec2u:this.getTypeInfo(Ae.vec2u),vec2i:this.getTypeInfo(Ae.vec2i),vec2h:this.getTypeInfo(Ae.vec2h),vec3f:this.getTypeInfo(Ae.vec3f),vec3u:this.getTypeInfo(Ae.vec3u),vec3i:this.getTypeInfo(Ae.vec3i),vec3h:this.getTypeInfo(Ae.vec3h),vec4f:this.getTypeInfo(Ae.vec4f),vec4u:this.getTypeInfo(Ae.vec4u),vec4i:this.getTypeInfo(Ae.vec4i),vec4h:this.getTypeInfo(Ae.vec4h),mat2x2f:this.getTypeInfo(Ae.mat2x2f),mat2x3f:this.getTypeInfo(Ae.mat2x3f),mat2x4f:this.getTypeInfo(Ae.mat2x4f),mat3x2f:this.getTypeInfo(Ae.mat3x2f),mat3x3f:this.getTypeInfo(Ae.mat3x3f),mat3x4f:this.getTypeInfo(Ae.mat3x4f),mat4x2f:this.getTypeInfo(Ae.mat4x2f),mat4x3f:this.getTypeInfo(Ae.mat4x3f),mat4x4f:this.getTypeInfo(Ae.mat4x4f)}}getVariableValue(e){var t,i;const r=(i=(t=this.context.getVariable(e))===null||t===void 0?void 0:t.value)!==null&&i!==void 0?i:null;if(r===null)return null;if(r instanceof be)return r.value;if(r instanceof se||r instanceof hn)return Array.from(r.data);if(r instanceof fr&&r.typeInfo instanceof Zf){if(r.typeInfo.format.name==="u32")return Array.from(new Uint32Array(r.buffer,r.offset,r.typeInfo.count));if(r.typeInfo.format.name==="i32")return Array.from(new Int32Array(r.buffer,r.offset,r.typeInfo.count));if(r.typeInfo.format.name==="f32")return Array.from(new Float32Array(r.buffer,r.offset,r.typeInfo.count))}return console.error(`Unsupported return variable type ${r.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,i,r){const s=this.context.clone();(r=r??{}).constants&&this._setOverrides(r.constants,s),this._execStatements(this.ast,s);const o=s.getFunction(e);if(!o)return void console.error(`Function ${e} not found`);if(typeof t=="number")t=[t,1,1];else{if(t.length===0)return void console.error("Invalid dispatch count");t.length===1?t=[t[0],1,1]:t.length===2?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const a=t[0],l=t[1],c=t[2],u=this.getTypeInfo("vec3u");s.setVariable("@num_workgroups",new se(t,u));const d=this.reflection.getFunctionInfo(e);d===null&&console.error(`Function ${e} not found in reflection data`);for(const m in i)for(const y in i[m]){const x=i[m][y];s.variables.forEach(T=>{var S;const w=T.node;if(w?.attributes){let P=null,M=null;for(const I of w.attributes)I.name==="binding"?P=I.value:I.name==="group"&&(M=I.value);if(y==P&&m==M){let I=!1;for(const k of d.resources)if(k.name===T.name&&k.group===parseInt(m)&&k.binding===parseInt(y)){I=!0;break}if(I)if(x.texture!==void 0&&x.descriptor!==void 0){const k=new Qu(x.texture,this.getTypeInfo(w.type),x.descriptor,(S=x.texture.view)!==null&&S!==void 0?S:null);T.value=k}else x.uniform!==void 0?T.value=new fr(x.uniform,this.getTypeInfo(w.type)):T.value=new fr(x,this.getTypeInfo(w.type))}}})}for(let m=0;m<c;++m)for(let y=0;y<l;++y)for(let x=0;x<a;++x)s.setVariable("@workgroup_id",new se([x,y,m],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(o,[x,y,m],s)}execStatement(e,t){if(e instanceof ZW)return this.evalExpression(e.value,t);if(e instanceof JW){if(e.condition){const i=this.evalExpression(e.condition,t);if(!(i instanceof be))throw new Error("Invalid break-if condition");if(!i.value)return null}return lo._breakObj}if(e instanceof QW)return lo._continueObj;if(e instanceof av)this._let(e,t);else if(e instanceof th)this._var(e,t);else if(e instanceof Tw)this._const(e,t);else if(e instanceof i0)this._function(e,t);else{if(e instanceof qW)return this._if(e,t);if(e instanceof YW)return this._switch(e,t);if(e instanceof jW)return this._for(e,t);if(e instanceof WW)return this._while(e,t);if(e instanceof GW)return this._loop(e,t);if(e instanceof tP){const i=t.clone();return i.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,i)}if(e instanceof XW)this._assign(e,t);else if(e instanceof $W)this._increment(e,t);else{if(e instanceof Ju)return null;if(e instanceof sI){const i=e.name;t.getVariable(i)===null&&t.setVariable(i,new be(0,this.getTypeInfo("u32")))}else if(e instanceof oI)this._call(e,t);else{if(e instanceof KW||e instanceof aI)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,t){return e instanceof ec?this._evalBinaryOp(e,t):e instanceof Jr?this._evalLiteral(e,t):e instanceof Ha?this._evalVariable(e,t):e instanceof lI?this._evalCall(e,t):e instanceof $c?this._evalCreate(e,t):e instanceof ej?this._evalConst(e,t):e instanceof tj?this._evalBitcast(e,t):e instanceof Wr?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var t;if(e instanceof Ze){const r=this.reflection.getTypeInfo(e);if(r!==null)return r}let i=(t=this.typeInfo[e])!==null&&t!==void 0?t:null;return i!==null||(i=this.reflection.getTypeInfoByName(e)),i}_setOverrides(e,t){for(const i in e){const r=e[i],s=this.reflection.getOverrideInfo(i);s!==null?(s.type===null&&(s.type=this.getTypeInfo("u32")),s.type.name==="u32"||s.type.name==="i32"||s.type.name==="f32"||s.type.name==="f16"?t.setVariable(i,new be(r,s.type)):s.type.name==="bool"?t.setVariable(i,new be(r?1:0,s.type)):s.type.name==="vec2"||s.type.name==="vec3"||s.type.name==="vec4"||s.type.name==="vec2f"||s.type.name==="vec3f"||s.type.name==="vec4f"||s.type.name==="vec2i"||s.type.name==="vec3i"||s.type.name==="vec4i"||s.type.name==="vec2u"||s.type.name==="vec3u"||s.type.name==="vec4u"||s.type.name==="vec2h"||s.type.name==="vec3h"||s.type.name==="vec4h"?t.setVariable(i,new se(r,s.type)):console.error(`Invalid constant type for ${i}`)):console.error(`Override ${i} does not exist in the shader.`)}}_dispatchWorkgroup(e,t,i){const r=[1,1,1];for(const u of e.node.attributes)if(u.name==="workgroup_size"){if(u.value.length>0){const d=i.getVariableValue(u.value[0]);r[0]=d instanceof be?d.value:parseInt(u.value[0])}if(u.value.length>1){const d=i.getVariableValue(u.value[1]);r[1]=d instanceof be?d.value:parseInt(u.value[1])}if(u.value.length>2){const d=i.getVariableValue(u.value[2]);r[2]=d instanceof be?d.value:parseInt(u.value[2])}}const s=this.getTypeInfo("vec3u"),o=this.getTypeInfo("u32");i.setVariable("@workgroup_size",new se(r,s));const a=r[0],l=r[1],c=r[2];for(let u=0,d=0;u<c;++u)for(let m=0;m<l;++m)for(let y=0;y<a;++y,++d){const x=[y,m,u],T=[y+t[0]*r[0],m+t[1]*r[1],u+t[2]*r[2]];i.setVariable("@local_invocation_id",new se(x,s)),i.setVariable("@global_invocation_id",new se(T,s)),i.setVariable("@local_invocation_index",new be(d,o)),this._dispatchExec(e,i)}}_dispatchExec(e,t){for(const i of e.node.args)for(const r of i.attributes)if(r.name==="builtin"){const s=`@${r.value}`,o=t.getVariable(s);o!==void 0&&t.variables.set(i.name,o)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof Wr;)e=e.right;return e instanceof Ha?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const i of e){if(i instanceof Array){const s=t.clone(),o=this._execStatements(i,s);if(o)return o;continue}const r=this.execStatement(i,t);if(r)return r}return null}_call(e,t){const i=t.clone();i.currentFunctionName=e.name;const r=t.getFunction(e.name);if(r){for(let s=0;s<r.node.args.length;++s){const o=r.node.args[s],a=this.evalExpression(e.args[s],i);i.setVariable(o.name,a,o)}this._execStatements(r.node.body,i)}else e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const i=this.getVariableName(e.variable,t),r=t.getVariable(i);r?e.operator==="++"?r.value instanceof be?r.value.value++:console.error(`Variable ${i} is not a scalar. Line ${e.line}`):e.operator==="--"?r.value instanceof be?r.value.value--:console.error(`Variable ${i} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${i} not found. Line ${e.line}`)}_getVariableData(e,t){if(e instanceof Ha){const i=this.getVariableName(e,t),r=t.getVariable(i);return r===null?(console.error(`Variable ${i} not found. Line ${e.line}`),null):r.value.getSubData(this,e.postfix,t)}if(e instanceof Wr){if(e.operator==="*"){const i=this._getVariableData(e.right,t);return i instanceof mg?i.reference.getSubData(this,e.postfix,t):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const i=this._getVariableData(e.right,t);return new mg(i)}}return null}_assign(e,t){let i=null,r="<var>",s=null;if(e.variable instanceof Wr){const l=this._getVariableData(e.variable,t),c=this.evalExpression(e.value,t),u=e.operator;if(u==="="){if(l instanceof be||l instanceof se||l instanceof hn){if(c instanceof be||c instanceof se||c instanceof hn&&l.data.length===c.data.length)return void l.data.set(c.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(l instanceof fr&&c instanceof fr&&l.buffer.byteLength-l.offset>=c.buffer.byteLength-c.offset)return void(l.buffer.byteLength%4==0?new Uint32Array(l.buffer,l.offset,l.typeInfo.size/4).set(new Uint32Array(c.buffer,c.offset,c.typeInfo.size/4)):new Uint8Array(l.buffer,l.offset,l.typeInfo.size).set(new Uint8Array(c.buffer,c.offset,c.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(u==="+=")return l instanceof be||l instanceof se||l instanceof hn?c instanceof be||c instanceof se||c instanceof hn?void l.data.set(c.data.map((d,m)=>l.data[m]+d)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(u==="-=")return(l instanceof be||l instanceof se||l instanceof hn)&&(c instanceof be||c instanceof se||c instanceof hn)?void l.data.set(c.data.map((d,m)=>l.data[m]-d)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof Wr){if(e.variable.operator==="*"){r=this.getVariableName(e.variable.right,t);const l=t.getVariable(r);if(!(l&&l.value instanceof mg))return void console.error(`Variable ${r} is not a pointer. Line ${e.line}`);i=l.value.reference;let c=e.variable.postfix;if(!c){let u=e.variable.right;for(;u instanceof Wr;){if(u.postfix){c=u.postfix;break}u=u.right}}c&&(i=i.getSubData(this,c,t))}}else{s=e.variable.postfix,r=this.getVariableName(e.variable,t);const l=t.getVariable(r);if(l===null)return void console.error(`Variable ${r} not found. Line ${e.line}`);i=l.value}if(i instanceof mg&&(i=i.reference),i===null)return void console.error(`Variable ${r} not found. Line ${e.line}`);const o=this.evalExpression(e.value,t),a=e.operator;if(a!=="="){const l=i.getSubData(this,s,t);if(l instanceof se&&o instanceof be){const c=l.data,u=o.value;if(a==="+=")for(let d=0;d<c.length;++d)c[d]+=u;else if(a==="-=")for(let d=0;d<c.length;++d)c[d]-=u;else if(a==="*=")for(let d=0;d<c.length;++d)c[d]*=u;else if(a==="/=")for(let d=0;d<c.length;++d)c[d]/=u;else if(a==="%=")for(let d=0;d<c.length;++d)c[d]%=u;else if(a==="&=")for(let d=0;d<c.length;++d)c[d]&=u;else if(a==="|=")for(let d=0;d<c.length;++d)c[d]|=u;else if(a==="^=")for(let d=0;d<c.length;++d)c[d]^=u;else if(a==="<<=")for(let d=0;d<c.length;++d)c[d]<<=u;else if(a===">>=")for(let d=0;d<c.length;++d)c[d]>>=u;else console.error(`Invalid operator ${a}. Line ${e.line}`)}else if(l instanceof se&&o instanceof se){const c=l.data,u=o.data;if(c.length!==u.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(a==="+=")for(let d=0;d<c.length;++d)c[d]+=u[d];else if(a==="-=")for(let d=0;d<c.length;++d)c[d]-=u[d];else if(a==="*=")for(let d=0;d<c.length;++d)c[d]*=u[d];else if(a==="/=")for(let d=0;d<c.length;++d)c[d]/=u[d];else if(a==="%=")for(let d=0;d<c.length;++d)c[d]%=u[d];else if(a==="&=")for(let d=0;d<c.length;++d)c[d]&=u[d];else if(a==="|=")for(let d=0;d<c.length;++d)c[d]|=u[d];else if(a==="^=")for(let d=0;d<c.length;++d)c[d]^=u[d];else if(a==="<<=")for(let d=0;d<c.length;++d)c[d]<<=u[d];else if(a===">>=")for(let d=0;d<c.length;++d)c[d]>>=u[d];else console.error(`Invalid operator ${a}. Line ${e.line}`)}else{if(!(l instanceof be&&o instanceof be))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);a==="+="?l.value+=o.value:a==="-="?l.value-=o.value:a==="*="?l.value*=o.value:a==="/="?l.value/=o.value:a==="%="?l.value%=o.value:a==="&="?l.value&=o.value:a==="|="?l.value|=o.value:a==="^="?l.value^=o.value:a==="<<="?l.value<<=o.value:a===">>="?l.value>>=o.value:console.error(`Invalid operator ${a}. Line ${e.line}`)}return void(i instanceof fr&&i.setDataValue(this,l,s,t))}if(i instanceof fr)i.setDataValue(this,o,s,t);else if(s){if(!(i instanceof se||i instanceof hn))return void console.error(`Variable ${r} is not a vector or matrix. Line ${e.line}`);if(s instanceof h_){const l=this.evalExpression(s.index,t).value;if(i instanceof se){if(!(o instanceof be))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[l]=o.value}else{if(!(i instanceof hn))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);{const c=this.evalExpression(s.index,t).value;if(c<0)return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);if(!(o instanceof se))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);{const u=i.typeInfo.getTypeName();if(u==="mat2x2"||u==="mat2x2f"||u==="mat2x2h"){if(!(c<2&&o.data.length===2))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[2*c]=o.data[0],i.data[2*c+1]=o.data[1]}else if(u==="mat2x3"||u==="mat2x3f"||u==="mat2x3h"){if(!(c<2&&o.data.length===3))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[3*c]=o.data[0],i.data[3*c+1]=o.data[1],i.data[3*c+2]=o.data[2]}else if(u==="mat2x4"||u==="mat2x4f"||u==="mat2x4h"){if(!(c<2&&o.data.length===4))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[4*c]=o.data[0],i.data[4*c+1]=o.data[1],i.data[4*c+2]=o.data[2],i.data[4*c+3]=o.data[3]}else if(u==="mat3x2"||u==="mat3x2f"||u==="mat3x2h"){if(!(c<3&&o.data.length===2))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[2*c]=o.data[0],i.data[2*c+1]=o.data[1]}else if(u==="mat3x3"||u==="mat3x3f"||u==="mat3x3h"){if(!(c<3&&o.data.length===3))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[3*c]=o.data[0],i.data[3*c+1]=o.data[1],i.data[3*c+2]=o.data[2]}else if(u==="mat3x4"||u==="mat3x4f"||u==="mat3x4h"){if(!(c<3&&o.data.length===4))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[4*c]=o.data[0],i.data[4*c+1]=o.data[1],i.data[4*c+2]=o.data[2],i.data[4*c+3]=o.data[3]}else if(u==="mat4x2"||u==="mat4x2f"||u==="mat4x2h"){if(!(c<4&&o.data.length===2))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[2*c]=o.data[0],i.data[2*c+1]=o.data[1]}else if(u==="mat4x3"||u==="mat4x3f"||u==="mat4x3h"){if(!(c<4&&o.data.length===3))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[3*c]=o.data[0],i.data[3*c+1]=o.data[1],i.data[3*c+2]=o.data[2]}else{if(u!=="mat4x4"&&u!=="mat4x4f"&&u!=="mat4x4h")return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);if(!(c<4&&o.data.length===4))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);i.data[4*c]=o.data[0],i.data[4*c+1]=o.data[1],i.data[4*c+2]=o.data[2],i.data[4*c+3]=o.data[3]}}}}}else if(s instanceof em){const l=s.value;if(!(i instanceof se))return void console.error(`Invalid assignment to ${l}. Variable ${r} is not a vector. Line ${e.line}`);if(o instanceof be){if(l.length>1)return void console.error(`Invalid assignment to ${l} for variable ${r}. Line ${e.line}`);if(l==="x")i.data[0]=o.value;else if(l==="y"){if(i.data.length<2)return void console.error(`Invalid assignment to ${l} for variable ${r}. Line ${e.line}`);i.data[1]=o.value}else if(l==="z"){if(i.data.length<3)return void console.error(`Invalid assignment to ${l} for variable ${r}. Line ${e.line}`);i.data[2]=o.value}else if(l==="w"){if(i.data.length<4)return void console.error(`Invalid assignment to ${l} for variable ${r}. Line ${e.line}`);i.data[3]=o.value}}else{if(!(o instanceof se))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);if(l.length!==o.data.length)return void console.error(`Invalid assignment to ${l} for variable ${r}. Line ${e.line}`);for(let c=0;c<l.length;++c){const u=l[c];if(u==="x"||u==="r")i.data[0]=o.data[c];else if(u==="y"||u==="g"){if(o.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${r}. Line ${e.line}`);i.data[1]=o.data[c]}else if(u==="z"||u==="b"){if(o.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${r}. Line ${e.line}`);i.data[2]=o.data[c]}else{if(u!=="w"&&u!=="a")return void console.error(`Invalid assignment to ${u} for variable ${r}. Line ${e.line}`);if(o.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${r}. Line ${e.line}`);i.data[3]=o.data[c]}}}}}else i instanceof be&&o instanceof be?i.value=o.value:i instanceof se&&o instanceof se||i instanceof hn&&o instanceof hn?i.data.set(o.data):console.error(`Invalid assignment to ${r}. Line ${e.line}`)}_function(e,t){const i=new hI(e);t.functions.set(e.name,i)}_const(e,t){let i=null;e.value!==null&&(i=this.evalExpression(e.value,t)),t.createVariable(e.name,i,e)}_let(e,t){let i=null;if(e.value!==null){if(i=this.evalExpression(e.value,t),i===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Wr||(i=i.clone())}else{const r=e.type.name;if(r==="f32"||r==="i32"||r==="u32"||r==="bool"||r==="f16"||r==="vec2"||r==="vec3"||r==="vec4"||r==="vec2f"||r==="vec3f"||r==="vec4f"||r==="vec2i"||r==="vec3i"||r==="vec4i"||r==="vec2u"||r==="vec3u"||r==="vec4u"||r==="vec2h"||r==="vec3h"||r==="vec4h"||r==="vec2b"||r==="vec3b"||r==="vec4b"||r==="mat2x2"||r==="mat2x3"||r==="mat2x4"||r==="mat3x2"||r==="mat3x3"||r==="mat3x4"||r==="mat4x2"||r==="mat4x3"||r==="mat4x4"||r==="mat2x2f"||r==="mat2x3f"||r==="mat2x4f"||r==="mat3x2f"||r==="mat3x3f"||r==="mat3x4f"||r==="mat4x2f"||r==="mat4x3f"||r==="mat4x4f"||r==="mat2x2h"||r==="mat2x3h"||r==="mat2x4h"||r==="mat3x2h"||r==="mat3x3h"||r==="mat3x4h"||r==="mat4x2h"||r==="mat4x3h"||r==="mat4x4h"||r==="array"){const s=new $c(e.type,[]);i=this._evalCreate(s,t)}}t.createVariable(e.name,i,e)}_var(e,t){let i=null;if(e.value!==null){if(i=this.evalExpression(e.value,t),i===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Wr||(i=i.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const r=e.type.name;if(r==="f32"||r==="i32"||r==="u32"||r==="bool"||r==="f16"||r==="vec2"||r==="vec3"||r==="vec4"||r==="vec2f"||r==="vec3f"||r==="vec4f"||r==="vec2i"||r==="vec3i"||r==="vec4i"||r==="vec2u"||r==="vec3u"||r==="vec4u"||r==="vec2h"||r==="vec3h"||r==="vec4h"||r==="vec2b"||r==="vec3b"||r==="vec4b"||r==="mat2x2"||r==="mat2x3"||r==="mat2x4"||r==="mat3x2"||r==="mat3x3"||r==="mat3x4"||r==="mat4x2"||r==="mat4x3"||r==="mat4x4"||r==="mat2x2f"||r==="mat2x3f"||r==="mat2x4f"||r==="mat3x2f"||r==="mat3x3f"||r==="mat3x4f"||r==="mat4x2f"||r==="mat4x3f"||r==="mat4x4f"||r==="mat2x2h"||r==="mat2x3h"||r==="mat2x4h"||r==="mat3x2h"||r==="mat3x3h"||r==="mat3x4h"||r==="mat4x2h"||r==="mat4x3h"||r==="mat4x4h"||e.type instanceof lv||e.type instanceof Ju||e.type instanceof Ae){const s=new $c(e.type,[]);i=this._evalCreate(s,t)}}t.createVariable(e.name,i,e)}_switch(e,t){t=t.clone();const i=this.evalExpression(e.condition,t);if(!(i instanceof be))return console.error(`Invalid if condition. Line ${e.line}`),null;let r=null;for(const s of e.cases)if(s instanceof rj)for(const o of s.selectors){if(o instanceof Aw){r=s;continue}const a=this.evalExpression(o,t);if(!(a instanceof be))return console.error(`Invalid case selector. Line ${e.line}`),null;if(a.value===i.value)return this._execStatements(s.body,t)}else s instanceof sj&&(r=s);return r?this._execStatements(r.body,t):null}_if(e,t){t=t.clone();const i=this.evalExpression(e.condition,t);if(!(i instanceof be))return console.error(`Invalid if condition. Line ${e.line}`),null;if(i.value)return this._execStatements(e.body,t);for(const r of e.elseif){const s=this.evalExpression(r.condition,t);if(!(s instanceof be))return console.error(`Invalid if condition. Line ${e.line}`),null;if(s.value)return this._execStatements(r.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof be?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const i=this._execStatements(e.body,t);if(i===lo._breakObj)break;if(i!==null&&i!==lo._continueObj)return i;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const i=this._execStatements(e.body,t);if(i===lo._breakObj)break;if(i===lo._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===lo._breakObj)break}else if(i!==null)return i}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const i=this._execStatements(e.body,t);if(i===lo._breakObj)break;if(i!==lo._continueObj&&i!==null)return i}return null}_evalBitcast(e,t){const i=this.evalExpression(e.value,t),r=e.type;if(i instanceof be){const s=cU(i.value,i.typeInfo.name,r.name);return new be(s,this.getTypeInfo(r))}if(i instanceof se){const s=i.typeInfo.getTypeName();let o="";if(s.endsWith("f"))o="f32";else if(s.endsWith("i"))o="i32";else if(s.endsWith("u"))o="u32";else if(s.endsWith("b"))o="bool";else{if(!s.endsWith("h"))return console.error(`Unknown vector type ${s}. Line ${e.line}`),null;o="f16"}const a=r.getTypeName();let l="";if(a.endsWith("f"))l="f32";else if(a.endsWith("i"))l="i32";else if(a.endsWith("u"))l="u32";else if(a.endsWith("b"))l="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${l}. Line ${e.line}`),null;l="f16"}const c=(function(u,d,m){if(d===m)return u;const y=new Array(u.length);for(let x=0;x<u.length;x++)y[x]=cU(u[x],d,m);return y})(Array.from(i.data),o,l);return new se(c,this.getTypeInfo(r))}return console.error(`TODO: bitcast for ${i.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var i;if(e instanceof $c){if(e.type===null)return nP.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const r=e instanceof $c?e.type.name:e.name,s=e instanceof $c?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(s===null)return console.error(`Unknown type ${r}. Line ${e.line}`),null;if(s.size===0)return null;const o=new fr(new ArrayBuffer(s.size),s,0);if(s instanceof Bf){if(e.args)for(let a=0;a<e.args.length;++a){const l=s.members[a],c=e.args[a],u=this.evalExpression(c,t);o.setData(this,u,l.type,l.offset,t)}}else if(s instanceof Zf){let a=0;if(e.args)for(let l=0;l<e.args.length;++l){const c=e.args[l],u=this.evalExpression(c,t);s.format===null&&(((i=u.typeInfo)===null||i===void 0?void 0:i.name)==="x32"?s.format=this.getTypeInfo("i32"):s.format=u.typeInfo),o.setData(this,u,s.format,a,t),a+=s.stride}}else console.error(`Unknown type "${r}". Line ${e.line}`);return e instanceof $c?o.getSubData(this,e.postfix,t):o}_evalLiteral(e,t){const i=this.getTypeInfo(e.type),r=i.name;return r==="x32"||r==="u32"||r==="f32"||r==="f16"||r==="i32"||r==="bool"?new be(e.scalarValue,i):r==="vec2"||r==="vec3"||r==="vec4"||r==="vec2f"||r==="vec3f"||r==="vec4f"||r==="vec2h"||r==="vec3h"||r==="vec4h"||r==="vec2i"||r==="vec3i"||r==="vec4i"||r==="vec2u"||r==="vec3u"||r==="vec4u"?this._callConstructorVec(e,t):r==="mat2x2"||r==="mat2x3"||r==="mat2x4"||r==="mat3x2"||r==="mat3x3"||r==="mat3x4"||r==="mat4x2"||r==="mat4x3"||r==="mat4x4"||r==="mat2x2f"||r==="mat2x3f"||r==="mat2x4f"||r==="mat3x2f"||r==="mat3x3f"||r==="mat3x4f"||r==="mat4x2f"||r==="mat4x3f"||r==="mat4x4f"||r==="mat2x2h"||r==="mat2x3h"||r==="mat2x4h"||r==="mat3x2h"||r==="mat3x3h"||r==="mat3x4h"||r==="mat4x2h"||r==="mat4x3h"||r==="mat4x4h"?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const i=t.getVariableValue(e.name);return i===null?i:i.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if(t.name==="f32")return t;for(let i=1;i<e.length;++i){const r=lo._priority.get(t.name);lo._priority.get(e[i].name)<r&&(t=e[i])}return t.name==="x32"?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const i=this.evalExpression(e.right,t);if(e.operator==="&")return new mg(i);if(e.operator==="*")return i instanceof mg?i.reference.getSubData(this,e.postfix,t):(console.error(`Invalid dereference. Line ${e.line}`),null);const r=i instanceof be?i.value:i instanceof se?Array.from(i.data):null;switch(e.operator){case"+":{if(Tt(r)){const a=r.map((l,c)=>+l);return new se(a,i.typeInfo)}const s=r,o=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new be(+s,o)}case"-":{if(Tt(r)){const a=r.map((l,c)=>-l);return new se(a,i.typeInfo)}const s=r,o=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new be(-s,o)}case"!":{if(Tt(r)){const a=r.map((l,c)=>l?0:1);return new se(a,i.typeInfo)}const s=r,o=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new be(s?0:1,o)}case"~":{if(Tt(r)){const a=r.map((l,c)=>~l);return new se(a,i.typeInfo)}const s=r,o=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new be(~s,o)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,t){const i=this.evalExpression(e.left,t),r=this.evalExpression(e.right,t),s=i instanceof be?i.value:i instanceof se||i instanceof hn?Array.from(i.data):null,o=r instanceof be?r.value:r instanceof se||r instanceof hn?Array.from(r.data):null;switch(e.operator){case"+":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y+d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m+u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u+m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a+l,c)}case"-":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y-d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m-u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u-m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a-l,c)}case"*":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(i instanceof hn&&r instanceof hn){const m=(function(S,w,P,M){if(Oo[w.name]===void 0||Oo[M.name]===void 0)return null;const I=Oo[w.name][0],k=Oo[w.name][1],D=Oo[M.name][0];if(I!==Oo[M.name][1])return null;const H=new Array(D*k);for(let W=0;W<k;W++)for(let z=0;z<D;z++){let j=0;for(let J=0;J<I;J++)j+=S[J*k+W]*P[z*I+J];H[W*D+z]=j}return H})(u,i.typeInfo,d,r.typeInfo);if(m===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const y=Oo[r.typeInfo.name][0],x=Oo[i.typeInfo.name][1],T=this.getTypeInfo(`mat${y}x${x}f`);return new hn(m,T)}if(i instanceof hn&&r instanceof se){const m=(function(y,x,T,S){if(Oo[x.name]===void 0||PA[S.name]===void 0)return null;const w=Oo[x.name][0],P=Oo[x.name][1];if(w!==T.length)return null;const M=new Array(P);for(let I=0;I<P;I++){let k=0;for(let D=0;D<w;D++)k+=y[D*P+I]*T[D];M[I]=k}return M})(u,i.typeInfo,d,r.typeInfo);return m===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new se(m,r.typeInfo)}if(i instanceof se&&r instanceof hn){const m=(function(y,x,T,S){if(PA[x.name]===void 0||Oo[S.name]===void 0)return null;const w=Oo[S.name][0],P=Oo[S.name][1];if(P!==y.length)return null;const M=[];for(let I=0;I<w;I++){let k=0;for(let D=0;D<P;D++)k+=y[D]*T[D*w+I];M[I]=k}return M})(u,i.typeInfo,d,r.typeInfo);return m===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new se(m,i.typeInfo)}{if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y*d[x]);return new se(m,i.typeInfo)}}if(Tt(s)){const u=o,d=s.map((m,y)=>m*u);return i instanceof hn?new hn(d,i.typeInfo):new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u*m);return r instanceof hn?new hn(d,r.typeInfo):new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a*l,c)}case"%":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y%d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m%u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u%m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a%l,c)}case"/":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y/d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m/u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u/m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a/l,c)}case"&":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y&d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m&u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u&m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a&l,c)}case"|":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y|d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m|u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u|m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a|l,c)}case"^":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y^d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m^u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u^m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a^l,c)}case"<<":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y<<d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m<<u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u<<m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a<<l,c)}case">>":{if(Tt(s)&&Tt(o)){const u=s,d=o;if(u.length!==d.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const m=u.map((y,x)=>y>>d[x]);return new se(m,i.typeInfo)}if(Tt(s)){const u=o,d=s.map((m,y)=>m>>u);return new se(d,i.typeInfo)}if(Tt(o)){const u=s,d=o.map((m,y)=>u>>m);return new se(d,r.typeInfo)}const a=s,l=o,c=this._maxFormatTypeInfo([i.typeInfo,r.typeInfo]);return new be(a>>l,c)}case">":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u>l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c>a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a>c?1:0);return new se(l,r.typeInfo)}return new be(s>o?1:0,this.getTypeInfo("bool"));case"<":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u<l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c<a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a<c?1:0);return new se(l,r.typeInfo)}return new be(s<o?1:0,this.getTypeInfo("bool"));case"==":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u===l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c==a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a==c?1:0);return new se(l,r.typeInfo)}return new be(s===o?1:0,this.getTypeInfo("bool"));case"!=":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u!==l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c!==a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a!==c?1:0);return new se(l,r.typeInfo)}return new be(s!==o?1:0,this.getTypeInfo("bool"));case">=":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u>=l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c>=a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a>=c?1:0);return new se(l,r.typeInfo)}return new be(s>=o?1:0,this.getTypeInfo("bool"));case"<=":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u<=l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c<=a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a<=c?1:0);return new se(l,r.typeInfo)}return new be(s<=o?1:0,this.getTypeInfo("bool"));case"&&":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u&&l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c&&a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a&&c?1:0);return new se(l,r.typeInfo)}return new be(s&&o?1:0,this.getTypeInfo("bool"));case"||":if(Tt(s)&&Tt(o)){const a=s,l=o;if(a.length!==l.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const c=a.map((u,d)=>u||l[d]?1:0);return new se(c,i.typeInfo)}if(Tt(s)){const a=o,l=s.map((c,u)=>c||a?1:0);return new se(l,i.typeInfo)}if(Tt(o)){const a=s,l=o.map((c,u)=>a||c?1:0);return new se(l,r.typeInfo)}return new be(s||o?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,t){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const i=t.clone();i.currentFunctionName=e.name;const r=t.getFunction(e.name);if(!r)return e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let s=0;s<r.node.args.length;++s){const o=r.node.args[s],a=this.evalExpression(e.args[s],i);i.createVariable(o.name,a,o)}return this._execStatements(r.node.body,i)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const i=t.getFunction(e.name);if(i){const r=t.clone();for(let s=0;s<i.node.args.length;++s){const o=i.node.args[s],a=this.evalExpression(e.args[s],r);r.setVariable(o.name,a,o)}return this._execStatements(i.node.body,r)}return null}_callConstructorValue(e,t){if(!e.args||e.args.length===0)return new be(0,this.getTypeInfo(e.type));const i=this.evalExpression(e.args[0],t);return i.typeInfo=this.getTypeInfo(e.type),i.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const i=this.getTypeInfo(e.type),r=e.type.getTypeName(),s=PA[r];if(s===void 0)return console.error(`Invalid vec constructor ${r}. Line ${e.line}`),null;const o=[];if(e instanceof Jr)if(e.isVector){const a=e.vectorValue;for(const l of a)o.push(l)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const l=this.evalExpression(a,t);if(l instanceof se){const c=l.data;for(let u=0;u<c.length;++u){let d=c[u];o.push(d)}}else if(l instanceof be){let c=l.value;o.push(c)}}if(e.type instanceof Ae&&e.type.format===null&&(e.type.format=Ae.f32),o.length===0){const a=new Array(s).fill(0);return new se(a,i).getSubData(this,e.postfix,t)}if(o.length===1)for(;o.length<s;)o.push(o[0]);return o.length<s?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new se(o.length>s?o.slice(0,s):o,i).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const i=this.getTypeInfo(e.type),r=e.type.getTypeName(),s=Oo[r];if(s===void 0)return console.error(`Invalid matrix constructor ${r}. Line ${e.line}`),null;const o=[];if(e instanceof Jr)if(e.isVector){const a=e.vectorValue;for(const l of a)o.push(l)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const l=this.evalExpression(a,t);l instanceof se?o.push(...l.data):l instanceof be?o.push(l.value):l instanceof hn&&o.push(...l.data)}if(i instanceof Qp&&i.format===null&&(i.format=this.getTypeInfo("f32")),o.length===0){const a=new Array(s[2]).fill(0);return new hn(a,i).getSubData(this,e.postfix,t)}return o.length!==s[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new hn(o,i).getSubData(this,e.postfix,t)}}lo._breakObj=new vl(new gl("BREAK",null),null),lo._continueObj=new vl(new gl("CONTINUE",null),null),lo._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Tbe{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Ebe{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new Tbe,this._exec=new lo,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const i=this._global_decl_or_directive();if(!i)break;t.push(i)}if(this._deferArrayCountEval.length>0){for(const i of this._deferArrayCountEval){const r=i.arrayType,s=i.countNode;if(s instanceof Ha){const o=s.name,a=this._context.constants.get(o);if(a)try{const l=a.constEvaluate(this._exec);r.count=l}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const i of t)i.search(r=>{r instanceof aU||r instanceof Ew?r.type=this._forwardType(r.type):r instanceof lv?r.format=this._forwardType(r.format):r instanceof th||r instanceof av||r instanceof Tw?r.type=this._forwardType(r.type):r instanceof i0?r.returnType=this._forwardType(r.returnType):r instanceof oU&&(r.type=this._forwardType(r.type))});return t}_forwardType(e){if(e instanceof sU){const t=this._getType(e.name);if(t)return t}else e instanceof Ew?e.type=this._forwardType(e.type):e instanceof lv&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const t=new pbe(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=t??this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==ee.eof}_match(e){if(e instanceof Te)return!!this._check(e)&&(this._advance(),!0);for(let t=0,i=e.length;t<i;++t){const r=e[t];if(this._check(r))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const i=t.type;let r=!1;for(const s of e){if(i===s)return!0;s===ee.tokens.name&&(r=!0)}if(r){const s=ee.tokens.name.rule.exec(t.lexeme);if(s&&s.index==0&&s[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===ee.tokens.name){const i=ee.tokens.name.rule.exec(t.lexeme);return i&&i.index==0&&i[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=(t=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&t!==void 0?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(ee.tokens.semicolon)&&!this._isAtEnd(););if(this._match(ee.keywords.alias)){const t=this._type_alias();return this._consume(ee.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(ee.keywords.diagnostic)){const t=this._diagnostic();return this._consume(ee.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(ee.keywords.requires)){const t=this._requires_directive();return this._consume(ee.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(ee.keywords.enable)){const t=this._enable_directive();return this._consume(ee.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}const e=this._attribute();if(this._check(ee.keywords.var)){const t=this._global_variable_decl();return t!=null&&(t.attributes=e),this._consume(ee.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(ee.keywords.override)){const t=this._override_variable_decl();return t!=null&&(t.attributes=e),this._consume(ee.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(ee.keywords.let)){const t=this._global_let_decl();return t!=null&&(t.attributes=e),this._consume(ee.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(ee.keywords.const)){const t=this._global_const_decl();return t!=null&&(t.attributes=e),this._consume(ee.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(ee.keywords.struct)){const t=this._struct_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(ee.keywords.fn)){const t=this._function_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(ee.keywords.fn))return null;const e=this._currentLine,t=this._consume(ee.tokens.ident,"Expected function name.").toString();this._consume(ee.tokens.paren_left,"Expected '(' for function arguments.");const i=[];if(!this._check(ee.tokens.paren_right))do{if(this._check(ee.tokens.paren_right))break;const a=this._attribute(),l=this._consume(ee.tokens.name,"Expected argument name.").toString();this._consume(ee.tokens.colon,"Expected ':' for argument type.");const c=this._attribute(),u=this._type_decl();u!=null&&(u.attributes=c,i.push(this._updateNode(new oU(l,u,a))))}while(this._match(ee.tokens.comma));this._consume(ee.tokens.paren_right,"Expected ')' after function arguments.");let r=null;if(this._match(ee.tokens.arrow)){const a=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=a)}const s=this._compound_statement(),o=this._currentLine;return this._updateNode(new i0(t,i,r,s,e,o),e)}_compound_statement(){const e=[];for(this._consume(ee.tokens.brace_left,"Expected '{' for block.");!this._check(ee.tokens.brace_right);){const t=this._statement();t!==null&&e.push(t)}return this._consume(ee.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(ee.tokens.semicolon)&&!this._isAtEnd(););if(this._check(ee.tokens.attr)&&this._attribute(),this._check(ee.keywords.if))return this._if_statement();if(this._check(ee.keywords.switch))return this._switch_statement();if(this._check(ee.keywords.loop))return this._loop_statement();if(this._check(ee.keywords.for))return this._for_statement();if(this._check(ee.keywords.while))return this._while_statement();if(this._check(ee.keywords.continuing))return this._continuing_statement();if(this._check(ee.keywords.static_assert))return this._static_assert_statement();if(this._check(ee.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(ee.keywords.return))e=this._return_statement();else if(this._check([ee.keywords.var,ee.keywords.let,ee.keywords.const]))e=this._variable_statement();else if(this._match(ee.keywords.discard))e=this._updateNode(new hbe);else if(this._match(ee.keywords.break)){const t=this._updateNode(new JW);if(this._currentLoop.length>0){const i=this._currentLoop[this._currentLoop.length-1];t.loopId=i.id}e=t,this._check(ee.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(ee.keywords.continue)){const t=this._updateNode(new QW);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const i=this._currentLoop[this._currentLoop.length-1];t.loopId=i.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(ee.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(ee.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new lbe(t),e)}_while_statement(){if(!this._match(ee.keywords.while))return null;const e=this._updateNode(new WW(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(ee.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(ee.keywords.continuing))return null;const t=this._currentLine,i=this._compound_statement();return this._updateNode(new tP(i,e),t)}_for_statement(){if(!this._match(ee.keywords.for))return null;this._consume(ee.tokens.paren_left,"Expected '('.");const e=this._updateNode(new jW(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(ee.tokens.semicolon)?null:this._for_init(),this._consume(ee.tokens.semicolon,"Expected ';'."),e.condition=this._check(ee.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(ee.tokens.semicolon,"Expected ';'."),e.increment=this._check(ee.tokens.paren_right)?null:this._for_increment(),this._consume(ee.tokens.paren_right,"Expected ')'."),this._check(ee.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(ee.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(ee.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new th(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(ee.keywords.let)){const e=this._currentLine,t=this._consume(ee.tokens.name,"Expected name for let.").toString();let i=null;if(this._match(ee.tokens.colon)){const s=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=s)}this._consume(ee.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return this._updateNode(new av(t,i,null,null,r),e)}if(this._match(ee.keywords.const)){const e=this._currentLine,t=this._consume(ee.tokens.name,"Expected name for const.").toString();let i=null;if(this._match(ee.tokens.colon)){const s=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=s)}this._consume(ee.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return i===null&&r instanceof Jr&&(i=r.type),this._updateNode(new Tw(t,i,null,null,r),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(t==null)return null;if(!this._check(ee.increment_operators))return this._current=e,null;const i=this._consume(ee.increment_operators,"Expected increment operator");return this._updateNode(new $W(i.type===ee.tokens.plus_plus?Og.increment:Og.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(ee.tokens.brace_right))return null;let i=this._match(ee.tokens.underscore);if(i||(e=this._unary_expression()),!i&&e==null)return null;const r=this._consume(ee.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return this._updateNode(new XW(Uy.parse(r.lexeme),e,s),t)}_func_call_statement(){if(!this._check(ee.tokens.ident))return null;const e=this._currentLine,t=this._current,i=this._consume(ee.tokens.ident,"Expected function name."),r=this._argument_expression_list();return r===null?(this._current=t,null):this._updateNode(new oI(i.lexeme,r),e)}_loop_statement(){if(!this._match(ee.keywords.loop))return null;this._check(ee.tokens.attr)&&this._attribute(),this._consume(ee.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new GW([],null));this._currentLoop.push(e);let t=this._statement();for(;t!==null;){if(Array.isArray(t))for(let i of t)e.body.push(i);else e.body.push(t);if(t instanceof tP){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(ee.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(ee.keywords.switch))return null;const e=this._updateNode(new YW(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(ee.tokens.attr)&&this._attribute(),this._consume(ee.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(ee.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([ee.keywords.default,ee.keywords.case]);){if(this._match(ee.keywords.case)){const i=this._case_selectors();for(const s of i)if(s instanceof Aw){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(ee.tokens.colon),this._check(ee.tokens.attr)&&this._attribute(),this._consume(ee.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(ee.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new rj(i,r)))}if(this._match(ee.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(ee.tokens.colon),this._check(ee.tokens.attr)&&this._attribute(),this._consume(ee.tokens.brace_left,"Exected '{' for switch default.");const i=this._case_body();this._consume(ee.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new sj(i)))}}return e}_case_selectors(){const e=[];for(this._match(ee.keywords.default)?e.push(this._updateNode(new Aw)):e.push(this._shift_expression());this._match(ee.tokens.comma);)this._match(ee.keywords.default)?e.push(this._updateNode(new Aw)):e.push(this._shift_expression());return e}_case_body(){if(this._match(ee.keywords.fallthrough))return this._consume(ee.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const t=this._case_body();return t.length==0?e:[...e,t[0]]}_if_statement(){if(!this._match(ee.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(ee.tokens.attr)&&this._attribute();const i=this._compound_statement();let r=[];this._match_elseif()&&(this._check(ee.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let s=null;return this._match(ee.keywords.else)&&(this._check(ee.tokens.attr)&&this._attribute(),s=this._compound_statement()),this._updateNode(new qW(t,i,r,s),e)}_match_elseif(){return this._tokens[this._current].type===ee.keywords.else&&this._tokens[this._current+1].type===ee.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),i=this._compound_statement();return e.push(this._updateNode(new fbe(t,i))),this._match_elseif()&&(this._check(ee.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(ee.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new ZW(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(ee.tokens.or_or);)e=this._updateNode(new ec(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(ee.tokens.and_and);)e=this._updateNode(new ec(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(ee.tokens.or);)e=this._updateNode(new ec(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(ee.tokens.xor);)e=this._updateNode(new ec(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(ee.tokens.and);)e=this._updateNode(new ec(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([ee.tokens.equal_equal,ee.tokens.not_equal])?this._updateNode(new ec(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([ee.tokens.less_than,ee.tokens.greater_than,ee.tokens.less_than_equal,ee.tokens.greater_than_equal]);)e=this._updateNode(new ec(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([ee.tokens.shift_left,ee.tokens.shift_right]);)e=this._updateNode(new ec(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([ee.tokens.plus,ee.tokens.minus]);)e=this._updateNode(new ec(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([ee.tokens.star,ee.tokens.forward_slash,ee.tokens.modulo]);)e=this._updateNode(new ec(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([ee.tokens.minus,ee.tokens.bang,ee.tokens.tilde,ee.tokens.star,ee.tokens.and])?this._updateNode(new Wr(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(ee.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(ee.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new h_(e)),i=this._postfix_expression();return i&&(t.postfix=i),t}if(this._match(ee.tokens.period)){const e=this._consume(ee.tokens.name,"Expected member name."),t=this._postfix_expression(),i=this._updateNode(new em(e.lexeme));return t&&(i.postfix=t),i}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(t!==null)return t;switch(e){case"void":return Ze.void;case"bool":return Ze.bool;case"i32":return Ze.i32;case"u32":return Ze.u32;case"f32":return Ze.f32;case"f16":return Ze.f16;case"vec2f":return Ae.vec2f;case"vec3f":return Ae.vec3f;case"vec4f":return Ae.vec4f;case"vec2i":return Ae.vec2i;case"vec3i":return Ae.vec3i;case"vec4i":return Ae.vec4i;case"vec2u":return Ae.vec2u;case"vec3u":return Ae.vec3u;case"vec4u":return Ae.vec4u;case"vec2h":return Ae.vec2h;case"vec3h":return Ae.vec3h;case"vec4h":return Ae.vec4h;case"mat2x2f":return Ae.mat2x2f;case"mat2x3f":return Ae.mat2x3f;case"mat2x4f":return Ae.mat2x4f;case"mat3x2f":return Ae.mat3x2f;case"mat3x3f":return Ae.mat3x3f;case"mat3x4f":return Ae.mat3x4f;case"mat4x2f":return Ae.mat4x2f;case"mat4x3f":return Ae.mat4x3f;case"mat4x4f":return Ae.mat4x4f;case"mat2x2h":return Ae.mat2x2h;case"mat2x3h":return Ae.mat2x3h;case"mat2x4h":return Ae.mat2x4h;case"mat3x2h":return Ae.mat3x2h;case"mat3x3h":return Ae.mat3x3h;case"mat3x4h":return Ae.mat3x4h;case"mat4x2h":return Ae.mat4x2h;case"mat4x3h":return Ae.mat4x3h;case"mat4x4h":return Ae.mat4x4h;case"mat2x2i":return Ae.mat2x2i;case"mat2x3i":return Ae.mat2x3i;case"mat2x4i":return Ae.mat2x4i;case"mat3x2i":return Ae.mat3x2i;case"mat3x3i":return Ae.mat3x3i;case"mat3x4i":return Ae.mat3x4i;case"mat4x2i":return Ae.mat4x2i;case"mat4x3i":return Ae.mat4x3i;case"mat4x4i":return Ae.mat4x4i;case"mat2x2u":return Ae.mat2x2u;case"mat2x3u":return Ae.mat2x3u;case"mat2x4u":return Ae.mat2x4u;case"mat3x2u":return Ae.mat3x2u;case"mat3x3u":return Ae.mat3x3u;case"mat3x4u":return Ae.mat3x4u;case"mat4x2u":return Ae.mat4x2u;case"mat4x3u":return Ae.mat4x3u;case"mat4x4u":return Ae.mat4x4u}return null}_validateTypeRange(e,t){if(t.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(t.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(ee.tokens.ident)){const i=this._previous().toString();if(this._check(ee.tokens.paren_left)){const r=this._argument_expression_list(),s=this._getType(i);return s!==null?this._updateNode(new $c(s,r)):this._updateNode(new lI(i,r))}if(this._context.constants.has(i)){const r=this._context.constants.get(i);return this._updateNode(new ej(i,r.value))}return this._updateNode(new Ha(i))}if(this._match(ee.tokens.int_literal)){const i=this._previous().toString();let r=i.endsWith("i")||i.endsWith("i")?Ze.i32:i.endsWith("u")||i.endsWith("U")?Ze.u32:Ze.x32;const s=parseInt(i);return this._validateTypeRange(s,r),this._updateNode(new Jr(new be(s,this._exec.getTypeInfo(r)),r))}if(this._match(ee.tokens.uint_literal)){const i=parseInt(this._previous().toString());return this._validateTypeRange(i,Ze.u32),this._updateNode(new Jr(new be(i,this._exec.getTypeInfo(Ze.u32)),Ze.u32))}if(this._match([ee.tokens.decimal_float_literal,ee.tokens.hex_float_literal])){let i=this._previous().toString(),r=i.endsWith("h");r&&(i=i.substring(0,i.length-1));const s=parseFloat(i);this._validateTypeRange(s,r?Ze.f16:Ze.f32);const o=r?Ze.f16:Ze.f32;return this._updateNode(new Jr(new be(s,this._exec.getTypeInfo(o)),o))}if(this._match([ee.keywords.true,ee.keywords.false])){let i=this._previous().toString()===ee.keywords.true.rule;return this._updateNode(new Jr(new be(i?1:0,this._exec.getTypeInfo(Ze.bool)),Ze.bool))}if(this._check(ee.tokens.paren_left))return this._paren_expression();if(this._match(ee.keywords.bitcast)){this._consume(ee.tokens.less_than,"Expected '<'.");const i=this._type_decl();this._consume(ee.tokens.greater_than,"Expected '>'.");const r=this._paren_expression();return this._updateNode(new tj(i,r))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new $c(e,t))}_argument_expression_list(){if(!this._match(ee.tokens.paren_left))return null;const e=[];do{if(this._check(ee.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(ee.tokens.comma));return this._consume(ee.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(ee.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(ee.tokens.paren_right),e}_paren_expression(){this._consume(ee.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(ee.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(ee.keywords.struct))return null;const e=this._currentLine,t=this._consume(ee.tokens.ident,"Expected name for struct.").toString();this._consume(ee.tokens.brace_left,"Expected '{' for struct body.");const i=[];for(;!this._check(ee.tokens.brace_right);){const o=this._attribute(),a=this._consume(ee.tokens.name,"Expected variable name.").toString();this._consume(ee.tokens.colon,"Expected ':' for struct member type.");const l=this._attribute(),c=this._type_decl();c!=null&&(c.attributes=l),this._check(ee.tokens.brace_right)?this._match(ee.tokens.comma):this._consume(ee.tokens.comma,"Expected ',' for struct member."),i.push(this._updateNode(new aU(a,c,o)))}this._consume(ee.tokens.brace_right,"Expected '}' after struct body.");const r=this._currentLine,s=this._updateNode(new Ju(t,i,e,r),e);return this._context.structs.set(t,s),s}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(ee.tokens.equal)){const t=this._const_expression();e.value=t}if(e.type!==null&&e.value instanceof Jr){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Jr&&(e.type=e.value.type.name==="x32"?Ze.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(ee.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(ee.keywords.const))return null;const t=this._consume(ee.tokens.name,"Expected variable name"),i=this._currentLine;let r=null;if(this._match(ee.tokens.colon)){const l=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=l)}let s=null;this._consume(ee.tokens.equal,"const declarations require an assignment");const o=this._short_circuit_or_expression();try{let l=[Ze.f32],c=o.constEvaluate(this._exec,l);c instanceof be&&this._validateTypeRange(c.value,l[0]),l[0]instanceof Ae&&l[0].format===null&&c.typeInfo instanceof Qp&&c.typeInfo.format!==null&&(c.typeInfo.format.name==="f16"?l[0].format=Ze.f16:c.typeInfo.format.name==="f32"?l[0].format=Ze.f32:c.typeInfo.format.name==="i32"?l[0].format=Ze.i32:c.typeInfo.format.name==="u32"?l[0].format=Ze.u32:c.typeInfo.format.name==="bool"?l[0].format=Ze.bool:console.error(`TODO: impelement template format type ${c.typeInfo.format.name}`)),s=this._updateNode(new Jr(c,l[0])),this._exec.context.setVariable(t.toString(),c)}catch{s=o}if(r!==null&&s instanceof Jr){if(s.type.name!=="x32"&&r.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${r.name}. Line:${this._currentLine}`);s.type=r,s.isScalar&&this._validateTypeRange(s.scalarValue,s.type)}else r===null&&s instanceof Jr&&(r=(e=s?.type)!==null&&e!==void 0?e:Ze.f32,r===Ze.x32&&(r=Ze.i32));const a=this._updateNode(new Tw(t.toString(),r,"","",s),i);return this._context.constants.set(a.name,a),a}_global_let_decl(){if(!this._match(ee.keywords.let))return null;const e=this._currentLine,t=this._consume(ee.tokens.name,"Expected variable name");let i=null;if(this._match(ee.tokens.colon)){const s=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=s)}let r=null;if(this._match(ee.tokens.equal)&&(r=this._const_expression()),i!==null&&r instanceof Jr){if(r.type.name!=="x32"&&i.getTypeName()!==r.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${r.type.name} to ${i.name}. Line:${this._currentLine}`);r.type=i}else i===null&&r instanceof Jr&&(i=r.type.name==="x32"?Ze.i32:r.type);return r instanceof Jr&&r.isScalar&&this._validateTypeRange(r.scalarValue,i),this._updateNode(new av(t.toString(),i,"","",r),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(ee.keywords.var))return null;const e=this._currentLine;let t="",i="";this._match(ee.tokens.less_than)&&(t=this._consume(ee.storage_class,"Expected storage_class.").toString(),this._match(ee.tokens.comma)&&(i=this._consume(ee.access_mode,"Expected access_mode.").toString()),this._consume(ee.tokens.greater_than,"Expected '>'."));const r=this._consume(ee.tokens.name,"Expected variable name");let s=null;if(this._match(ee.tokens.colon)){const o=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=o)}return this._updateNode(new th(r.toString(),s,t,i,null),e)}_override_decl(){if(!this._match(ee.keywords.override))return null;const e=this._consume(ee.tokens.name,"Expected variable name");let t=null;if(this._match(ee.tokens.colon)){const i=this._attribute();t=this._type_decl(),t!=null&&(t.attributes=i)}return this._updateNode(new sI(e.toString(),t,null))}_diagnostic(){this._consume(ee.tokens.paren_left,"Expected '('");const e=this._consume(ee.tokens.ident,"Expected severity control name.");this._consume(ee.tokens.comma,"Expected ','");let t=this._consume(ee.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(ee.tokens.period)&&(t+=`.${this._consume(ee.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(ee.tokens.paren_right,"Expected ')'"),this._updateNode(new KW(e.toString(),t))}_enable_directive(){const e=this._consume(ee.tokens.ident,"identity expected.");return this._updateNode(new cbe(e.toString()))}_requires_directive(){const e=[this._consume(ee.tokens.ident,"identity expected.").toString()];for(;this._match(ee.tokens.comma);){const t=this._consume(ee.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new ube(e))}_type_alias(){const e=this._consume(ee.tokens.ident,"identity expected.");this._consume(ee.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(t===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const i=this._updateNode(new aI(e.toString(),t));return this._context.aliases.set(i.name,i),i}_type_decl(){if(this._check([ee.tokens.ident,...ee.texel_format,ee.keywords.bool,ee.keywords.f32,ee.keywords.i32,ee.keywords.u32])){const i=this._advance().toString();if(this._context.structs.has(i))return this._context.structs.get(i);if(this._context.aliases.has(i))return this._context.aliases.get(i).type;if(!this._getType(i)){const r=this._updateNode(new sU(i));return this._forwardTypeCount++,r}return this._updateNode(new Ze(i))}let e=this._texture_sampler_types();if(e)return e;if(this._check(ee.template_types)){let i=this._advance().toString(),r=null,s=null;return this._match(ee.tokens.less_than)&&(r=this._type_decl(),s=null,this._match(ee.tokens.comma)&&(s=this._consume(ee.access_mode,"Expected access_mode for pointer").toString()),this._consume(ee.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new Ae(i,r,s))}if(this._match(ee.keywords.ptr)){let i=this._previous().toString();this._consume(ee.tokens.less_than,"Expected '<' for pointer.");const r=this._consume(ee.storage_class,"Expected storage_class for pointer");this._consume(ee.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let o=null;return this._match(ee.tokens.comma)&&(o=this._consume(ee.access_mode,"Expected access_mode for pointer").toString()),this._consume(ee.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new Ew(i,r.toString(),s,o))}const t=this._attribute();if(this._match(ee.keywords.array)){let i=null,r=-1;const s=this._previous();let o=null;if(this._match(ee.tokens.less_than)){i=this._type_decl(),this._context.aliases.has(i.name)&&(i=this._context.aliases.get(i.name).type);let l="";if(this._match(ee.tokens.comma)){o=this._shift_expression();try{l=o.constEvaluate(this._exec).toString(),o=null}catch{l="1"}}this._consume(ee.tokens.greater_than,"Expected '>' for array."),r=l?parseInt(l):0}const a=this._updateNode(new lv(s.toString(),t,i,r));return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(ee.sampler_type))return this._updateNode(new By(this._previous().toString(),null,null));if(this._match(ee.depth_texture_type))return this._updateNode(new By(this._previous().toString(),null,null));if(this._match(ee.sampled_texture_type)||this._match(ee.multisampled_texture_type)){const e=this._previous();this._consume(ee.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(ee.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new By(e.toString(),t,null))}if(this._match(ee.storage_texture_type)){const e=this._previous();this._consume(ee.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(ee.texel_format,"Invalid texel format.").toString();this._consume(ee.tokens.comma,"Expected ',' after texel format.");const i=this._consume(ee.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(ee.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new By(e.toString(),t,i))}return null}_attribute(){let e=[];for(;this._match(ee.tokens.attr);){const t=this._consume(ee.attribute_name,"Expected attribute name"),i=this._updateNode(new oj(t.toString(),null));if(this._match(ee.tokens.paren_left)){if(i.value=this._consume(ee.literal_or_ident,"Expected attribute value").toString(),this._check(ee.tokens.comma)){this._advance();do{const r=this._consume(ee.literal_or_ident,"Expected attribute value").toString();i.value instanceof Array||(i.value=[i.value]),i.value.push(r)}while(this._match(ee.tokens.comma))}this._consume(ee.tokens.paren_right,"Expected ')'")}e.push(i)}return e.length==0?null:e}}class Abe extends Kc{constructor(e){super(),e&&this.update(e)}update(e){const t=new Ebe().parse(e);this.updateAST(t)}}function Mbe(n){const e={attributes:[],bindings:[]};let t;try{t=Cbe(n)}catch(s){return Qe.error(s.message)(),e}for(const s of t.uniforms){const o=[];for(const a of s.type?.members||[])o.push({name:a.name,type:uU(a.type)});e.bindings.push({type:"uniform",name:s.name,group:s.group,location:s.binding,members:o})}for(const s of t.textures)e.bindings.push({type:"texture",name:s.name,group:s.group,location:s.binding});for(const s of t.samplers)e.bindings.push({type:"sampler",name:s.name,group:s.group,location:s.binding});const i=t.entry.vertex[0],r=i?.inputs.length||0;for(let s=0;s<r;s++){const o=i.inputs[s];if(o.locationType==="location"){const a=uU(o.type);e.attributes.push({name:o.name,location:Number(o.location),type:a})}}return e}function uU(n){return n?.format?`${n.name}<${n.format.name}>`:n.name}function Cbe(n){try{return new Abe(n)}catch(e){if(e instanceof Error)throw e;let t="WGSL parse error";throw typeof e=="object"&&e?.message&&(t+=`: ${e.message} `),typeof e=="object"&&e?.token&&(t+=e.token.line||""),new Error(t,{cause:e})}}const Pbe={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Pbe}};const _l=globalThis.mathgl.config;function Rbe(n,{precision:e=_l.precision}={}){return n=Ibe(n),`${parseFloat(n.toPrecision(e))}`}function f_(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function zf(n,e,t){return Obe(n,i=>Math.max(e,Math.min(t,i)))}function TS(n,e,t){return f_(n)?n.map((i,r)=>TS(i,e[r],t)):t*e+(1-t)*n}function r0(n,e,t){const i=_l.EPSILON;try{if(n===e)return!0;if(f_(n)&&f_(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!r0(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):typeof n=="number"&&typeof e=="number"?Math.abs(n-e)<=_l.EPSILON*Math.max(1,Math.abs(n),Math.abs(e)):!1}finally{_l.EPSILON=i}}function Ibe(n){return Math.round(n/_l.EPSILON)*_l.EPSILON}function kbe(n){return n.clone?n.clone():new Array(n.length)}function Obe(n,e,t){if(f_(n)){const i=n;t=t||kbe(i);for(let r=0;r<t.length&&r<i.length;++r){const s=typeof n=="number"?n:n[r];t[r]=e(s,r,t)}return t}return e(n)}class aj extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:f_(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(_l)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+Rbe(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!r0(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){if(i===void 0)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const s=e[r],o=typeof t=="number"?t:t[r];this[r]=s+i*(o-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(_l.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}get elements(){return this}}function Lbe(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}function Va(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${JSON.stringify(n)}`);return n}function RA(n,e,t=""){if(_l.debug&&!Lbe(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}function hU(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}class Nbe extends aj{get x(){return this[0]}set x(e){this[0]=Va(e)}get y(){return this[1]}set y(e){this[1]=Va(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return Va(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return Va(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return hU(e>=0&&e<this.ELEMENTS,"index is out of range"),Va(this[e])}setComponent(e,t){return hU(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const Mw=1e-6;let d_=typeof Float32Array<"u"?Float32Array:Array;function Dbe(){const n=new d_(2);return d_!=Float32Array&&(n[0]=0,n[1]=0),n}function fU(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function Fbe(n,e){return n[0]=-e[0],n[1]=-e[1],n}function lj(n,e,t,i){const r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function Ube(n,e,t){const i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(function(){const n=Dbe();return function(e,t,i,r,s,o){let a,l;for(t||(t=2),i||(i=0),r?l=Math.min(r*t+i,e.length):l=e.length,a=i;a<l;a+=t)n[0]=e[a],n[1]=e[a+1],s(n,n,o),e[a]=n[0],e[a+1]=n[1];return e}})();function Bbe(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}function cj(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}function zbe(n,e,t){const i=e[0],r=e[1];return n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2],n}function Vbe(){const n=new d_(3);return d_!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Hbe(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Wbe(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function jbe(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function $be(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function uj(n,e,t){const i=e[0],r=e[1],s=e[2];let o=t[3]*i+t[7]*r+t[11]*s+t[15];return o=o||1,n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/o,n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function Xbe(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function Gbe(n,e,t){const i=t[0],r=t[1],s=t[2],o=t[3],a=e[0],l=e[1],c=e[2];let u=r*c-s*l,d=s*a-i*c,m=i*l-r*a,y=r*m-s*d,x=s*u-i*m,T=i*d-r*u;const S=o*2;return u*=S,d*=S,m*=S,y*=2,x*=2,T*=2,n[0]=a+u+y,n[1]=l+d+x,n[2]=c+m+T,n}function Ybe(n,e,t,i){const r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function qbe(n,e,t,i){const r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Zbe(n,e,t,i){const r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Kbe(n,e){const t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt((t*t+i*i+r*r)*(s*s+o*o+a*a)),c=l&&jbe(n,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}const Jbe=Hbe;(function(){const n=Vbe();return function(e,t,i,r,s,o){let a,l;for(t||(t=3),i||(i=0),r?l=Math.min(r*t+i,e.length):l=e.length,a=i;a<l;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],s(n,n,o),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2];return e}})();const IA=[0,0,0];let Xb;class lu extends Nbe{static get ZERO(){return Xb||(Xb=new lu(0,0,0),Object.freeze(Xb)),Xb}constructor(e=0,t=0,i=0){super(-0,-0,-0),arguments.length===1&&f_(e)?this.copy(e):(_l.debug&&(Va(e),Va(t),Va(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return _l.debug&&(Va(e.x),Va(e.y),Va(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Va(e)}angle(e){return Kbe(this,e)}cross(e){return $be(this,this,e),this.check()}rotateX({radians:e,origin:t=IA}){return Ybe(this,this,t,e),this.check()}rotateY({radians:e,origin:t=IA}){return qbe(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=IA}){return Zbe(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return uj(this,this,e),this.check()}transformAsVector(e){return cj(this,this,e),this.check()}transformByMatrix3(e){return Xbe(this,this,e),this.check()}transformByMatrix2(e){return zbe(this,this,e),this.check()}transformByQuaternion(e){return Gbe(this,this,e),this.check()}}class Qbe extends aj{toString(){let e="[";if(_l.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=Va(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function ewe(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function twe(n,e){if(n===e){const t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function iP(n,e){const t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],m=e[10],y=e[11],x=e[12],T=e[13],S=e[14],w=e[15],P=t*a-i*o,M=t*l-r*o,I=t*c-s*o,k=i*l-r*a,D=i*c-s*a,H=r*c-s*l,W=u*T-d*x,z=u*S-m*x,j=u*w-y*x,J=d*S-m*T,le=d*w-y*T,ge=m*w-y*S;let te=P*ge-M*le+I*J+k*j-D*z+H*W;return te?(te=1/te,n[0]=(a*ge-l*le+c*J)*te,n[1]=(r*le-i*ge-s*J)*te,n[2]=(T*H-S*D+w*k)*te,n[3]=(m*D-d*H-y*k)*te,n[4]=(l*j-o*ge-c*z)*te,n[5]=(t*ge-r*j+s*z)*te,n[6]=(S*I-x*H-w*M)*te,n[7]=(u*H-m*I+y*M)*te,n[8]=(o*le-a*j+c*W)*te,n[9]=(i*j-t*le-s*W)*te,n[10]=(x*D-T*I+w*P)*te,n[11]=(d*I-u*D-y*P)*te,n[12]=(a*z-o*J-l*W)*te,n[13]=(t*J-i*z+r*W)*te,n[14]=(T*M-x*k-S*P)*te,n[15]=(u*k-d*M+m*P)*te,n):null}function nwe(n){const e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],d=n[10],m=n[11],y=n[12],x=n[13],T=n[14],S=n[15],w=e*o-t*s,P=e*a-i*s,M=t*a-i*o,I=c*x-u*y,k=c*T-d*y,D=u*T-d*x,H=e*D-t*k+i*I,W=s*D-o*k+a*I,z=c*M-u*P+d*w,j=y*M-x*P+T*w;return l*H-r*W+S*z-m*j}function Dp(n,e,t){const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],m=e[9],y=e[10],x=e[11],T=e[12],S=e[13],w=e[14],P=e[15];let M=t[0],I=t[1],k=t[2],D=t[3];return n[0]=M*i+I*a+k*d+D*T,n[1]=M*r+I*l+k*m+D*S,n[2]=M*s+I*c+k*y+D*w,n[3]=M*o+I*u+k*x+D*P,M=t[4],I=t[5],k=t[6],D=t[7],n[4]=M*i+I*a+k*d+D*T,n[5]=M*r+I*l+k*m+D*S,n[6]=M*s+I*c+k*y+D*w,n[7]=M*o+I*u+k*x+D*P,M=t[8],I=t[9],k=t[10],D=t[11],n[8]=M*i+I*a+k*d+D*T,n[9]=M*r+I*l+k*m+D*S,n[10]=M*s+I*c+k*y+D*w,n[11]=M*o+I*u+k*x+D*P,M=t[12],I=t[13],k=t[14],D=t[15],n[12]=M*i+I*a+k*d+D*T,n[13]=M*r+I*l+k*m+D*S,n[14]=M*s+I*c+k*y+D*w,n[15]=M*o+I*u+k*x+D*P,n}function ES(n,e,t){const i=t[0],r=t[1],s=t[2];let o,a,l,c,u,d,m,y,x,T,S,w;return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],d=e[5],m=e[6],y=e[7],x=e[8],T=e[9],S=e[10],w=e[11],n[0]=o,n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=d,n[6]=m,n[7]=y,n[8]=x,n[9]=T,n[10]=S,n[11]=w,n[12]=o*i+u*r+x*s+e[12],n[13]=a*i+d*r+T*s+e[13],n[14]=l*i+m*r+S*s+e[14],n[15]=c*i+y*r+w*s+e[15]),n}function dI(n,e,t){const i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function iwe(n,e,t,i){let r=i[0],s=i[1],o=i[2],a=Math.sqrt(r*r+s*s+o*o),l,c,u,d,m,y,x,T,S,w,P,M,I,k,D,H,W,z,j,J,le,ge,te,de;return a<Mw?null:(a=1/a,r*=a,s*=a,o*=a,c=Math.sin(t),l=Math.cos(t),u=1-l,d=e[0],m=e[1],y=e[2],x=e[3],T=e[4],S=e[5],w=e[6],P=e[7],M=e[8],I=e[9],k=e[10],D=e[11],H=r*r*u+l,W=s*r*u+o*c,z=o*r*u-s*c,j=r*s*u-o*c,J=s*s*u+l,le=o*s*u+r*c,ge=r*o*u+s*c,te=s*o*u-r*c,de=o*o*u+l,n[0]=d*H+T*W+M*z,n[1]=m*H+S*W+I*z,n[2]=y*H+w*W+k*z,n[3]=x*H+P*W+D*z,n[4]=d*j+T*J+M*le,n[5]=m*j+S*J+I*le,n[6]=y*j+w*J+k*le,n[7]=x*j+P*J+D*le,n[8]=d*ge+T*te+M*de,n[9]=m*ge+S*te+I*de,n[10]=y*ge+w*te+k*de,n[11]=x*ge+P*te+D*de,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function hj(n,e,t){const i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],d=e[10],m=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+d*i,n[7]=l*r+m*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=d*r-a*i,n[11]=m*r-l*i,n}function rwe(n,e,t){const i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],d=e[10],m=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-d*i,n[3]=l*r-m*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+d*r,n[11]=l*i+m*r,n}function fj(n,e,t){const i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],d=e[6],m=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+d*i,n[3]=l*r+m*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=d*r-a*i,n[7]=m*r-l*i,n}function swe(n,e){const t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,d=i*a,m=r*o,y=r*a,x=r*l,T=s*o,S=s*a,w=s*l;return n[0]=1-d-x,n[1]=u+w,n[2]=m-S,n[3]=0,n[4]=u-w,n[5]=1-c-x,n[6]=y+T,n[7]=0,n[8]=m+S,n[9]=y-T,n[10]=1-c-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function owe(n,e,t,i,r,s,o){const a=1/(t-e),l=1/(r-i),c=1/(s-o);return n[0]=s*2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s*2*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0,n}function awe(n,e,t,i,r){const s=1/Math.tan(e/2);if(n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,r!=null&&r!==1/0){const o=1/(i-r);n[10]=(r+i)*o,n[14]=2*r*i*o}else n[10]=-1,n[14]=-2*i;return n}const lwe=awe;function cwe(n,e,t,i,r,s,o){const a=1/(e-t),l=1/(i-r),c=1/(s-o);return n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1,n}const uwe=cwe;function hwe(n,e,t,i){let r,s,o,a,l,c,u,d,m,y;const x=e[0],T=e[1],S=e[2],w=i[0],P=i[1],M=i[2],I=t[0],k=t[1],D=t[2];return Math.abs(x-I)<Mw&&Math.abs(T-k)<Mw&&Math.abs(S-D)<Mw?ewe(n):(d=x-I,m=T-k,y=S-D,r=1/Math.sqrt(d*d+m*m+y*y),d*=r,m*=r,y*=r,s=P*y-M*m,o=M*d-w*y,a=w*m-P*d,r=Math.sqrt(s*s+o*o+a*a),r?(r=1/r,s*=r,o*=r,a*=r):(s=0,o=0,a=0),l=m*a-y*o,c=y*s-d*a,u=d*o-m*s,r=Math.sqrt(l*l+c*c+u*u),r?(r=1/r,l*=r,c*=r,u*=r):(l=0,c=0,u=0),n[0]=s,n[1]=l,n[2]=d,n[3]=0,n[4]=o,n[5]=c,n[6]=m,n[7]=0,n[8]=a,n[9]=u,n[10]=y,n[11]=0,n[12]=-(s*x+o*T+a*S),n[13]=-(l*x+c*T+u*S),n[14]=-(d*x+m*T+y*S),n[15]=1,n)}function fwe(){const n=new d_(4);return d_!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function dwe(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function z0(n,e,t){const i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}(function(){const n=fwe();return function(e,t,i,r,s,o){let a,l;for(t||(t=4),i||(i=0),r?l=Math.min(r*t+i,e.length):l=e.length,a=i;a<l;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],n[3]=e[a+3],s(n,n,o),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2],e[a+3]=n[3];return e}})();var rP;(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3"})(rP||(rP={}));const pwe=45*Math.PI/180,mwe=1,kA=.1,OA=500,gwe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class cu extends Qbe{static get IDENTITY(){return ywe()}static get ZERO(){return _we()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return rP}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,d,m,y,x,T,S){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=d,this[11]=m,this[12]=y,this[13]=x,this[14]=T,this[15]=S,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,d,m,y,x,T,S){return this[0]=e,this[1]=s,this[2]=c,this[3]=y,this[4]=t,this[5]=o,this[6]=u,this[7]=x,this[8]=i,this[9]=a,this[10]=d,this[11]=T,this[12]=r,this[13]=l,this[14]=m,this[15]=S,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(gwe)}fromObject(e){return this.check()}fromQuaternion(e){return swe(this,e),this.check()}frustum(e){const{left:t,right:i,bottom:r,top:s,near:o=kA,far:a=OA}=e;return a===1/0?vwe(this,t,i,r,s,o):owe(this,t,i,r,s,o,a),this.check()}lookAt(e){const{eye:t,center:i=[0,0,0],up:r=[0,1,0]}=e;return hwe(this,t,i,r),this.check()}ortho(e){const{left:t,right:i,bottom:r,top:s,near:o=kA,far:a=OA}=e;return uwe(this,t,i,r,s,o,a),this.check()}orthographic(e){const{fovy:t=pwe,aspect:i=mwe,focalDistance:r=1,near:s=kA,far:o=OA}=e;dU(t);const a=t/2,l=r*Math.tan(a),c=l*i;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return dU(t),lwe(this,t,i,r,s),this.check()}determinant(){return nwe(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const i=this.getScale(t),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const i=this.getScale(t),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return twe(this,this),this.check()}invert(){return iP(this,this),this.check()}multiplyLeft(e){return Dp(this,e,this),this.check()}multiplyRight(e){return Dp(this,this,e),this.check()}rotateX(e){return hj(this,this,e),this.check()}rotateY(e){return rwe(this,this,e),this.check()}rotateZ(e){return fj(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return iwe(this,this,e,t),this.check()}scale(e){return dI(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return ES(this,this,e),this.check()}transform(e,t){return e.length===4?(t=z0(t||[-0,-0,-0,-0],e,this),RA(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;let r;switch(i){case 2:r=Ube(t||[-0,-0],e,this);break;case 3:r=uj(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return RA(r,e.length),r}transformAsVector(e,t){let i;switch(e.length){case 2:i=Bbe(t||[-0,-0],e,this);break;case 3:i=cj(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return RA(i,e.length),i}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}}let Gb,Yb;function _we(){return Gb||(Gb=new cu([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Gb)),Gb}function ywe(){return Yb||(Yb=new cu,Object.freeze(Yb)),Yb}function dU(n){if(n>Math.PI*2)throw Error("expected radians")}function vwe(n,e,t,i,r,s){const o=2*s/(t-e),a=2*s/(r-i),l=(t+e)/(t-e),c=(r+i)/(r-i),u=-1,d=-1,m=-2*s;return n[0]=o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=l,n[9]=c,n[10]=u,n[11]=d,n[12]=0,n[13]=0,n[14]=m,n[15]=0,n}function dj(n,e=[],t=0){const i=Math.fround(n),r=n-i;return e[t]=i,e[t+1]=r,e}function xwe(n){return n-Math.fround(n)}function bwe(n){const e=new Float32Array(32);for(let t=0;t<4;++t)for(let i=0;i<4;++i){const r=t*4+i;dj(n[i*4+t],e,r*2)}return e}const wwe=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,Swe={name:"fp32",vs:wwe},Twe=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,Ewe={ONE:1},Awe={name:"fp64arithmetic",vs:Twe,defaultUniforms:Ewe,uniformTypes:{ONE:"f32"},fp64ify:dj,fp64LowPart:xwe,fp64ifyMatrix4:bwe},Mwe=[0,1,1,1],Cwe=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,Pwe=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,pU={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:Mwe},vs:Cwe,fs:Pwe,getUniforms:Rwe};function Rwe(n={},e){const t={};if(n.highlightedObjectColor!==void 0)if(n.highlightedObjectColor===null)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const i=n.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=i}if(n.highlightColor){const i=Array.from(n.highlightColor,r=>r/255);Number.isFinite(i[3])||(i[3]=1),t.highlightColor=i}return n.isActive!==void 0&&(t.isActive=!!n.isActive,t.isAttribute=!!n.isAttribute),n.useFloatColors!==void 0&&(t.useFloatColors=!!n.useFloatColors),t}const mU=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,Iwe={name:"layer",vs:mU,fs:mU,getUniforms:n=>({opacity:Math.pow(n.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},kwe=`

struct ColorUniforms {
  opacity: f32,
};

var<private> color: ColorUniforms = ColorUniforms(1.0);
// TODO (kaapp) avoiding binding index collisions to handle layer opacity 
// requires some thought.
// @group(0) @binding(0) var<uniform> color: ColorUniforms;

@must_use
fn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {
    return vec4(fragColor.rgb * fragColor.a, fragColor.a); 
};
`,Owe={name:"color",dependencies:[],source:kwe,getUniforms:n=>({}),uniformTypes:{opacity:"f32"}},Lwe=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,pj="#define SMOOTH_EDGE_RADIUS 0.5",Nwe=`${pj}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,Dwe=`${pj}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,mj={name:"geometry",source:Lwe,vs:Nwe,fs:Dwe},Fwe=25;var $r;(function(n){n[n.Start=1]="Start",n[n.Move=2]="Move",n[n.End=4]="End",n[n.Cancel=8]="Cancel"})($r||($r={}));var Qr;(function(n){n[n.None=0]="None",n[n.Left=1]="Left",n[n.Right=2]="Right",n[n.Up=4]="Up",n[n.Down=8]="Down",n[n.Horizontal=3]="Horizontal",n[n.Vertical=12]="Vertical",n[n.All=15]="All"})(Qr||(Qr={}));var Tn;(function(n){n[n.Possible=1]="Possible",n[n.Began=2]="Began",n[n.Changed=4]="Changed",n[n.Ended=8]="Ended",n[n.Recognized=8]="Recognized",n[n.Cancelled=16]="Cancelled",n[n.Failed=32]="Failed"})(Tn||(Tn={}));const Uwe="compute",Bwe="auto",sP="manipulation",Cw="none",oP="pan-x",aP="pan-y";function zwe(n){if(n.includes(Cw))return Cw;const e=n.includes(oP),t=n.includes(aP);return e&&t?Cw:e||t?e?oP:aP:n.includes(sP)?sP:Bwe}class Vwe{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){e===Uwe&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return zwe(e.join(" "))}}function AS(n){return n.trim().split(/\s+/g)}function LA(n,e,t){if(n)for(const i of AS(e))n.addEventListener(i,t,!1)}function NA(n,e,t){if(n)for(const i of AS(e))n.removeEventListener(i,t,!1)}function gU(n){return(n.ownerDocument||n).defaultView}function Hwe(n,e){let t=n;for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function gj(n){const e=n.length;if(e===1)return{x:Math.round(n[0].clientX),y:Math.round(n[0].clientY)};let t=0,i=0,r=0;for(;r<e;)t+=n[r].clientX,i+=n[r].clientY,r++;return{x:Math.round(t/e),y:Math.round(i/e)}}function _U(n){const e=[];let t=0;for(;t<n.pointers.length;)e[t]={clientX:Math.round(n.pointers[t].clientX),clientY:Math.round(n.pointers[t].clientY)},t++;return{timeStamp:Date.now(),pointers:e,center:gj(e),deltaX:n.deltaX,deltaY:n.deltaY}}function _j(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}function yU(n,e){const t=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.sqrt(t*t+i*i)}function Wwe(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.atan2(i,t)*180/Math.PI}function vU(n,e){const t=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.atan2(i,t)*180/Math.PI}function yj(n,e){return n===e?Qr.None:Math.abs(n)>=Math.abs(e)?n<0?Qr.Left:Qr.Right:e<0?Qr.Up:Qr.Down}function jwe(n,e){const t=e.center;let i=n.offsetDelta,r=n.prevDelta;const s=n.prevInput;return(e.eventType===$r.Start||s?.eventType===$r.End)&&(r=n.prevDelta={x:s?.deltaX||0,y:s?.deltaY||0},i=n.offsetDelta={x:t.x,y:t.y}),{deltaX:r.x+(t.x-i.x),deltaY:r.y+(t.y-i.y)}}function vj(n,e,t){return{x:e/n||0,y:t/n||0}}function $we(n,e){return yU(e[0],e[1])/yU(n[0],n[1])}function Xwe(n,e){return vU(e[1],e[0])-vU(n[1],n[0])}function Gwe(n,e){const t=n.lastInterval||e,i=e.timeStamp-t.timeStamp;let r,s,o,a;if(e.eventType!==$r.Cancel&&(i>Fwe||t.velocity===void 0)){const l=e.deltaX-t.deltaX,c=e.deltaY-t.deltaY,u=vj(i,l,c);s=u.x,o=u.y,r=Math.abs(u.x)>Math.abs(u.y)?u.x:u.y,a=yj(l,c),n.lastInterval=e}else r=t.velocity,s=t.velocityX,o=t.velocityY,a=t.direction;e.velocity=r,e.velocityX=s,e.velocityY=o,e.direction=a}function Ywe(n,e){const{session:t}=n,{pointers:i}=e,{length:r}=i;t.firstInput||(t.firstInput=_U(e)),r>1&&!t.firstMultiple?t.firstMultiple=_U(e):r===1&&(t.firstMultiple=!1);const{firstInput:s,firstMultiple:o}=t,a=o?o.center:s.center,l=e.center=gj(i);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=Wwe(a,l),e.distance=_j(a,l);const{deltaX:c,deltaY:u}=jwe(t,e);e.deltaX=c,e.deltaY=u,e.offsetDirection=yj(e.deltaX,e.deltaY);const d=vj(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,e.scale=o?$we(o.pointers,i):1,e.rotation=o?Xwe(o.pointers,i):0,e.maxPointers=t.prevInput?e.pointers.length>t.prevInput.maxPointers?e.pointers.length:t.prevInput.maxPointers:e.pointers.length;let m=n.element;return Hwe(e.srcEvent.target,m)&&(m=e.srcEvent.target),e.target=m,Gwe(t,e),e}function qwe(n,e,t){const i=t.pointers.length,r=t.changedPointers.length,s=e&$r.Start&&i-r===0,o=e&($r.End|$r.Cancel)&&i-r===0;t.isFirst=!!s,t.isFinal=!!o,s&&(n.session={}),t.eventType=e;const a=Ywe(n,t);n.emit("hammer.input",a),n.recognize(a),n.session.prevInput=a}let Zwe=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=t=>{this.manager.options.enable&&this.handler(t)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){qwe(this.manager,e,t)}init(){LA(this.element,this.evEl,this.domHandler),LA(this.target,this.evTarget,this.domHandler),LA(gU(this.element),this.evWin,this.domHandler)}destroy(){NA(this.element,this.evEl,this.domHandler),NA(this.target,this.evTarget,this.domHandler),NA(gU(this.element),this.evWin,this.domHandler)}};const Kwe={pointerdown:$r.Start,pointermove:$r.Move,pointerup:$r.End,pointercancel:$r.Cancel,pointerout:$r.Cancel},Jwe="pointerdown",Qwe="pointermove pointerup pointercancel";class eSe extends Zwe{constructor(e){super(e),this.evEl=Jwe,this.evWin=Qwe,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let i=!1;const r=Kwe[e.type],s=e.pointerType,o=s==="touch";let a=t.findIndex(l=>l.pointerId===e.pointerId);r&$r.Start&&(e.buttons||o)?a<0&&(t.push(e),a=t.length-1):r&($r.End|$r.Cancel)&&(i=!0),!(a<0)&&(t[a]=e,this.callback(r,{pointers:t,changedPointers:[e],eventType:r,pointerType:s,srcEvent:e}),i&&t.splice(a,1))}}const tSe=["","webkit","Moz","MS","ms","o"];function nSe(n,e){const t=e[0].toUpperCase()+e.slice(1);for(const i of tSe){const r=i?i+t:e;if(r in n)return r}}const iSe=1,xU=2,bU={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class rSe{constructor(e,t){this.options={...bU,...t,cssProps:{...bU.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new eSe(this),this.touchAction=new Vwe(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?xU:iSe}recognize(e){const{session:t}=this;if(t.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let i;const{recognizers:r}=this;let{curRecognizer:s}=t;(!s||s&&s.state&Tn.Recognized)&&(s=t.curRecognizer=null);let o=0;for(;o<r.length;)i=r[o],t.stopped!==xU&&(!s||i===s||i.canRecognizeWith(s))?i.recognize(e):i.reset(),!s&&i.state&(Tn.Began|Tn.Changed|Tn.Ended)&&(s=t.curRecognizer=i),o++}get(e){const{recognizers:t}=this;for(let i=0;i<t.length;i++)if(t[i].options.event===e)return t[i];return null}add(e){if(Array.isArray(e)){for(const i of e)this.add(i);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const i of e)this.remove(i);return this}const t=typeof e=="string"?this.get(e):e;if(t){const{recognizers:i}=this,r=i.indexOf(t);r!==-1&&(i.splice(r,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:i}=this;for(const r of AS(e))i[r]=i[r]||[],i[r].push(t)}off(e,t){if(!e)return;const{handlers:i}=this;for(const r of AS(e))t?i[r]&&i[r].splice(i[r].indexOf(t),1):delete i[r]}emit(e,t){const i=this.handlers[e]&&this.handlers[e].slice();if(!i||!i.length)return;const r=t;r.type=e,r.preventDefault=function(){t.srcEvent.preventDefault()};let s=0;for(;s<i.length;)i[s](r),s++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[i,r]of Object.entries(this.options.cssProps)){const s=nSe(t.style,i);e?(this.oldCssProps[s]=t.style[s],t.style[s]=r):t.style[s]=this.oldCssProps[s]||""}e||(this.oldCssProps={})}}}let sSe=1;function oSe(){return sSe++}function wU(n){return n&Tn.Cancelled?"cancel":n&Tn.Ended?"end":n&Tn.Changed?"move":n&Tn.Began?"start":""}class xj{constructor(e){this.options=e,this.id=oSe(),this.state=Tn.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const r of e)this.recognizeWith(r);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:i}=this;return i[t.id]||(i[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const i of e)this.dropRecognizeWith(i);return this}let t;return typeof e=="string"?t=this.manager.get(e):t=e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const r of e)this.requireFailure(r);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:i}=this;return i.indexOf(t)===-1&&(i.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const i of e)this.dropRequireFailure(i);return this}let t;if(typeof e=="string"?t=this.manager.get(e):t=e,t){const i=this.requireFail.indexOf(t);i>-1&&this.requireFail.splice(i,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:t}=this;t<Tn.Ended&&this.manager.emit(this.options.event+wU(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=Tn.Ended&&this.manager.emit(this.options.event+wU(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Tn.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Tn.Failed|Tn.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable){this.reset(),this.state=Tn.Failed;return}this.state&(Tn.Recognized|Tn.Cancelled|Tn.Failed)&&(this.state=Tn.Possible),this.state=this.process(t),this.state&(Tn.Began|Tn.Changed|Tn.Ended|Tn.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class bj extends xj{attrTest(e){const t=this.options.pointers;return t===0||e.pointers.length===t}process(e){const{state:t}=this,{eventType:i}=e,r=t&(Tn.Began|Tn.Changed),s=this.attrTest(e);return r&&(i&$r.Cancel||!s)?t|Tn.Cancelled:r||s?i&$r.End?t|Tn.Ended:t&Tn.Began?t|Tn.Changed:Tn.Began:Tn.Failed}}class SU extends xj{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[sP]}process(e){const{options:t}=this,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,s=e.deltaTime<t.time;if(this.reset(),e.eventType&$r.Start&&this.count===0)return this.failTimeout();if(r&&s&&i){if(e.eventType!==$r.End)return this.failTimeout();const o=this.pTime?e.timeStamp-this.pTime<t.interval:!0,a=!this.pCenter||_j(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!a||!o?this.count=1:this.count+=1,this._input=e,this.count%t.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Tn.Recognized,this.tryEmit(this._input)},t.interval),Tn.Began):Tn.Recognized}return Tn.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Tn.Failed},this.options.interval),Tn.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Tn.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const aSe=["","start","move","end","cancel","up","down","left","right"];class TU extends bj{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Qr.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&Qr.Horizontal&&t.push(aP),e&Qr.Vertical&&t.push(oP),t}getEventNames(){return aSe.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let i=!0,{distance:r}=e,{direction:s}=e;const o=e.deltaX,a=e.deltaY;return s&t.direction||(t.direction&Qr.Horizontal?(s=o===0?Qr.None:o<0?Qr.Left:Qr.Right,i=o!==this.pX,r=Math.abs(e.deltaX)):(s=a===0?Qr.None:a<0?Qr.Up:Qr.Down,i=a!==this.pY,r=Math.abs(e.deltaY))),e.direction=s,i&&r>t.threshold&&!!(s&t.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Tn.Began)||!(this.state&Tn.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=Qr[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const lSe=["","start","move","end","cancel","in","out"];class cSe extends bj{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[Cw]}getEventNames(){return lSe.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Tn.Began))}emit(e){if(e.scale!==1){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}}class $T{constructor(e,t,i){this.element=e,this.callback=t,this.options=i}}const uSe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",hSe=uSe.indexOf("firefox")!==-1,EU=4.000244140625,fSe=40,dSe=.25;class pSe extends $T{constructor(e,t,i){super(e,t,{enable:!0,...i}),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;globalThis.WheelEvent&&(hSe&&r.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(s/=globalThis.devicePixelRatio),r.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(s*=fSe)),s!==0&&s%EU===0&&(s=Math.floor(s/EU)),r.shiftKey&&s&&(s=s*dSe),this.callback({type:"wheel",center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){e==="wheel"&&(this.options.enable=t)}}const AU=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class mSe extends $T{constructor(e,t,i){super(e,t,{enable:!0,...i}),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,AU.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){AU.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const MU=["keydown","keyup"];class gSe extends $T{constructor(e,t,i){super(e,t,{enable:!0,tabIndex:0,...i}),this.handleEvent=r=>{const s=r.target||r.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:"keydown",srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:"keyup",srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",MU.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){MU.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e==="keydown"&&(this.enableDownEvent=t),e==="keyup"&&(this.enableUpEvent=t)}}class _Se extends $T{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e==="contextmenu"&&(this.options.enable=t)}}const CU=1,lP=2,PU=4,ySe={pointerdown:CU,pointermove:lP,pointerup:PU,mousedown:CU,mousemove:lP,mouseup:PU},vSe=0,xSe=1,bSe=2,wSe=1,SSe=2,TSe=4;function ESe(n){const e=ySe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i}=n.srcEvent;let r=!1,s=!1,o=!1;return e===lP?(r=!!(t&wSe),s=!!(t&TSe),o=!!(t&SSe)):(r=i===vSe,s=i===xSe,o=i===bSe),{leftButton:r,middleButton:s,rightButton:o}}function ASe(n,e){const t=n.center;if(!t)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1,o={x:(t.x-i.left-e.clientLeft)/r,y:(t.y-i.top-e.clientTop)/s};return{center:t,offsetCenter:o}}const MSe={srcElement:"root",priority:0};class CSe{constructor(e,t){this.handleEvent=i=>{if(this.isEmpty())return;const r=this._normalizeEvent(i);let s=i.srcEvent.target;for(;s&&s!==r.rootElement;){if(this._emit(r,s),r.handled)return;s=s.parentNode}this._emit(r,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this,l={...MSe,...i};let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:t,srcElement:l.srcElement,priority:l.priority};r&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let d=c.length-1;for(;d>=0&&!(c[d].priority>=u.priority);)d--;c.splice(d+1,0,u)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:d}=i[l];if(u({...e,type:c,stopPropagation:s,stopImmediatePropagation:o}),d&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...ESe(e),...ASe(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function PSe(n){if("recognizer"in n)return n;let e;const t=Array.isArray(n)?[...n]:[n];if(typeof t[0]=="function"){const i=t.shift(),r=t.shift()||{};e=new i(r)}else e=t.shift();return{recognizer:e,recognizeWith:typeof t[0]=="string"?[t[0]]:t[0],requireFailure:typeof t[1]=="string"?[t[1]]:t[1]}}class RSe{constructor(e=null,t={}){if(this._onBasicInput=i=>{this.manager.emit(i.srcEvent.type,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,!!e){this.manager=new rSe(e,this.options);for(const i of this.options.recognizers){const{recognizer:r,recognizeWith:s,requireFailure:o}=PSe(i);this.manager.add(r),s&&r.recognizeWith(s),o&&r.requireFailure(o)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new pSe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new mSe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new gSe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new _Se(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);r&&(r.set({enable:t}),i.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if(typeof e!="string"){i=t;for(const[c,u]of Object.entries(e))this._addEventHandler(c,u,i,r,s);return}const{manager:o,events:a}=this;if(!o)return;let l=a.get(e);if(!l){const c=this._getRecognizerName(e)||e;l=new CSe(this,c),a.set(e,l),o&&o.on(e,l.handleEvent)}l.add(e,t,i,r,s),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if(typeof e!="string"){for(const[s,o]of Object.entries(e))this._removeEventHandler(s,o);return}const{events:i}=this,r=i.get(e);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:s}=r;let o=!1;for(const a of i.values())if(a.recognizerName===s&&!a.isEmpty()){o=!0;break}o||this._toggleRecognizer(s,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(t=>t.getEventNames().includes(e))?.options.event}}const ii={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ii,"IDENTITY",{get:()=>(vi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const dl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},tm={common:0,meters:1,pixels:2},cP={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},RU={multipan:[TU,{threshold:10,direction:Qr.Vertical,pointers:2}],pinch:[cSe,{},null,["multipan"]],pan:[TU,{threshold:1},["pinch"],["multipan"]],dblclick:[SU,{event:"dblclick",taps:2}],click:[SU,{event:"click"},null,["dblclick"]]};function ISe(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function V0(n){let e={},t;return i=>{for(const r in i)if(!ISe(i[r],e[r])){t=n(i),e=i;break}return t}}const IU=[0,0,0,0],kSe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],wj=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],OSe=[0,0,0],Sj=[0,0,0],LSe=V0(FSe);function Tj(n,e,t=Sj){t.length<3&&(t=[t[0],t[1],0]);let i=t,r,s=!0;switch(e===ii.LNGLAT_OFFSETS||e===ii.METER_OFFSETS?r=t:r=n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case dl.WEB_MERCATOR:(e===ii.LNGLAT||e===ii.CARTESIAN)&&(r=[0,0,0],s=!1);break;case dl.WEB_MERCATOR_AUTO_OFFSET:e===ii.LNGLAT?i=r:e===ii.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case dl.IDENTITY:i=n.position.map(Math.fround),i[2]=i[2]||0;break;case dl.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function NSe(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=IU,l=IU,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:m}=Tj(n,e,t);return m&&(l=n.projectPosition(u||d),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=z0([],l,o),s=i||s,o=Dp([],r,s),o=Dp([],o,kSe)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:d,geospatialOrigin:u}}function DSe({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=ii.DEFAULT,coordinateOrigin:r=Sj,autoWrapLongitude:s=!1}){i===ii.DEFAULT&&(i=n.isGeospatial?ii.LNGLAT:ii.CARTESIAN);const o=LSe({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.wrapLongitude=s,o.modelMatrix=t||wj,o}function FSe({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=NSe(n,t,i),u=n.getDistanceScales(),d=[n.width*e,n.height*e],m=z0([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,y={coordinateSystem:t,projectionMode:n.projectionMode,coordinateOrigin:l,commonOrigin:o.slice(0,3),center:r,pseudoMeters:!!n._pseudoMeters,viewportSize:d,devicePixelRatio:e,focalDistance:m,commonUnitsPerMeter:u.unitsPerMeter,commonUnitsPerWorldUnit:u.unitsPerMeter,commonUnitsPerWorldUnit2:OSe,scale:n.scale,wrapLongitude:!1,viewProjectionMatrix:s,modelMatrix:wj,cameraPosition:a};if(c){const x=n.getDistanceScales(c);switch(t){case ii.METER_OFFSETS:y.commonUnitsPerWorldUnit=x.unitsPerMeter,y.commonUnitsPerWorldUnit2=x.unitsPerMeter2;break;case ii.LNGLAT:case ii.LNGLAT_OFFSETS:n._pseudoMeters||(y.commonUnitsPerMeter=x.unitsPerMeter),y.commonUnitsPerWorldUnit=x.unitsPerDegree,y.commonUnitsPerWorldUnit2=x.unitsPerDegree2;break;case ii.CARTESIAN:y.commonUnitsPerWorldUnit=[1,1,x.unitsPerMeter[2]],y.commonUnitsPerWorldUnit2=[0,0,x.unitsPerMeter2[2]];break}}return y}const USe=Object.keys(ii).map(n=>`const COORDINATE_SYSTEM_${n}: i32 = ${ii[n]};`).join(""),BSe=Object.keys(dl).map(n=>`const PROJECTION_MODE_${n}: i32 = ${dl[n]};`).join(""),zSe=Object.keys(tm).map(n=>`const UNIT_${n.toUpperCase()}: i32 = ${tm[n]};`).join(""),VSe=`${USe}
${BSe}
${zSe}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,HSe=`${VSe}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,WSe=Object.keys(ii).map(n=>`const int COORDINATE_SYSTEM_${n} = ${ii[n]};`).join(""),jSe=Object.keys(dl).map(n=>`const int PROJECTION_MODE_${n} = ${dl[n]};`).join(""),$Se=Object.keys(tm).map(n=>`const int UNIT_${n.toUpperCase()} = ${tm[n]};`).join(""),XSe=`${WSe}
${jSe}
${$Se}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,GSe={};function YSe(n=GSe){return"viewport"in n?DSe(n):{}}const pI={name:"project",dependencies:[Swe,mj],source:HSe,vs:XSe,getUniforms:YSe,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},qSe=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,ZSe=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Ej={name:"project32",dependencies:[pI],source:qSe,vs:ZSe};function KSe(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Yg(n,e){const t=z0([],e,n);return dwe(t,t,1/t[3]),t}function kU(n,e){const t=n%e;return t<0?e+t:t}function uP(n,e,t){return n<e?e:n>t?t:n}function JSe(n){return Math.log(n)*Math.LOG2E}const mI=Math.log2||JSe;function xh(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const lc=Math.PI,Aj=lc/4,yl=lc/180,hP=180/lc,p_=512,MS=4003e4,qb=85.051129,QSe=1.5;function eTe(n){return mI(n)}function CS(n){const[e,t]=n;xh(Number.isFinite(e)),xh(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const i=e*yl,r=t*yl,s=p_*(i+lc)/(2*lc),o=p_*(lc+Math.log(Math.tan(Aj+r*.5)))/(2*lc);return[s,o]}function m_(n){const[e,t]=n,i=e/p_*(2*lc)-lc,r=2*(Math.atan(Math.exp(t/p_*(2*lc)-lc))-Aj);return[i*hP,r*hP]}function tTe(n){const{latitude:e}=n;xh(Number.isFinite(e));const t=Math.cos(e*yl);return eTe(MS*t)-9}function DA(n){const e=Math.cos(n*yl);return p_/MS/e}function fP(n){const{latitude:e,longitude:t,highPrecision:i=!1}=n;xh(Number.isFinite(e)&&Number.isFinite(t));const r=p_,s=Math.cos(e*yl),o=r/360,a=o/s,l=r/MS/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(i){const u=yl*Math.tan(e*yl)/s,d=o*u/2,m=r/MS*u,y=m/a*l;c.unitsPerDegree2=[0,d,m],c.unitsPerMeter2=[y,0,y]}return c}function Mj(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=fP({longitude:t,latitude:i,highPrecision:!0}),u=CS(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const d=m_(u),m=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[d[0],d[1],m]:d}function nTe(n){const{height:e,pitch:t,bearing:i,altitude:r,scale:s,center:o}=n,a=KSe();ES(a,a,[0,0,-r]),hj(a,a,-t*yl),fj(a,a,i*yl);const l=s/e;return dI(a,a,[l,l,l]),o&&ES(a,a,Wbe([],o)),a}function iTe(n){const{width:e,height:t,altitude:i,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=n;let{fovy:u=PS(QSe)}=n;i!==void 0&&(u=PS(i));const d=u*yl,m=r*yl,y=Cj(u);let x=y;o&&(x+=o[2]*a/Math.cos(m)/t);const T=d*(.5+(s?s[1]:0)/t),S=Math.sin(T)*x/Math.sin(uP(Math.PI/2-m-T,.01,Math.PI-.01)),w=Math.sin(m)*S+x,P=x*10,M=Math.min(w*c,P);return{fov:d,aspect:e/t,focalDistance:y,near:l,far:M}}function PS(n){return 2*Math.atan(.5/n)*hP}function Cj(n){return .5/Math.tan(.5*n*yl)}function Pj(n,e){const[t,i,r=0]=n;return xh(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Yg(e,[t,i,r,1])}function gI(n,e,t=0){const[i,r,s]=n;if(xh(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Yg(e,[i,r,s,1]);const o=Yg(e,[i,r,0,1]),a=Yg(e,[i,r,1,1]),l=o[2],c=a[2],u=l===c?0:((t||0)-l)/(c-l);return lj([],o,a,u)}function rTe(n){const{width:e,height:t,bounds:i,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=n,[[a,l],[c,u]]=i,d=sTe(n.padding),m=CS([a,uP(u,-qb,qb)]),y=CS([c,uP(l,-qb,qb)]),x=[Math.max(Math.abs(y[0]-m[0]),r),Math.max(Math.abs(y[1]-m[1]),r)],T=[e-d.left-d.right-Math.abs(o[0])*2,t-d.top-d.bottom-Math.abs(o[1])*2];xh(T[0]>0&&T[1]>0);const S=T[0]/x[0],w=T[1]/x[1],P=(d.right-d.left)/2/S,M=(d.top-d.bottom)/2/w,I=[(y[0]+m[0])/2+P,(y[1]+m[1])/2+M],k=m_(I),D=Math.min(s,mI(Math.abs(Math.min(S,w))));return xh(Number.isFinite(D)),{longitude:k[0],latitude:k[1],zoom:D}}function sTe(n=0){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:(xh(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}const OU=Math.PI/180;function oTe(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;const u=n.fovy?.5*n.fovy*OU:Math.atan(.5/n.altitude),d=(90-n.pitch)*OU;return u>d-.01?(l=LU(n,0,e),c=LU(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}function LU(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Yg(i,[e,0,1,1]),s=Yg(i,[e,n.height,1,1]),a=(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2]),l=lj([],r,s,a),c=m_(l);return c.push(t),c}const NU=512;function aTe(n){const{width:e,height:t,pitch:i=0}=n;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=n;(r<-180||r>180)&&(r=kU(r+180,360)-180),(a<-180||a>180)&&(a=kU(a+180,360)-180);const l=mI(t/NU);if(o<=l)o=l,s=0;else{const c=t/2/Math.pow(2,o),u=m_([0,c])[1];if(s<u)s=u;else{const d=m_([0,NU-c])[1];s>d&&(s=d)}}return{width:e,height:t,longitude:r,latitude:s,zoom:o,pitch:i,bearing:a}}const Rj=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,lTe=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,cTe=`
${Rj}
${lTe}
`,uTe=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,hTe=`
${Rj}
${uTe}
`,fTe=V0(_Te),dTe=V0(yTe),pTe=[0,0,0,1],mTe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function gTe(n,e){const[t,i,r]=n,s=gI([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}function _Te({viewport:n,center:e}){return new cu(n.viewProjectionMatrix).invert().transform(e)}function yTe({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>gTe(o,i));for(const o of e){const a=o.clone().translate(new lu(n.center).negate()),l=s.map(u=>a.transform(u)),c=new cu().ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}function vTe(n){const{shadowEnabled:e=!0,project:t}=n;if(!e||!t||!n.shadowMatrices||!n.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};const i=pI.getUniforms(t),r=fTe({viewport:t.viewport,center:i.center}),s=[],o=dTe({shadowMatrices:n.shadowMatrices,viewport:t.viewport}).slice();for(let l=0;l<n.shadowMatrices.length;l++){const c=o[l],u=c.clone().translate(new lu(t.viewport.center).negate());i.coordinateSystem===ii.LNGLAT&&i.projectionMode===dl.WEB_MERCATOR?(o[l]=u,s[l]=r):(o[l]=c.clone().multiplyRight(mTe),s[l]=u.transform(r))}const a={drawShadowMap:!!n.drawToShadowMap,useShadowMap:n.shadowMaps?n.shadowMaps.length>0:!1,color:n.shadowColor||pTe,lightId:n.shadowLightId||0,lightCount:n.shadowMatrices.length,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};for(let l=0;l<o.length;l++)a[`viewProjectionMatrix${l}`]=o[l],a[`projectCenter${l}`]=s[l];for(let l=0;l<2;l++)a[`shadow_uShadowMap${l}`]=n.shadowMaps&&n.shadowMaps[l]||n.dummyShadowMap;return a}const DU={name:"shadow",dependencies:[pI],vs:cTe,fs:hTe,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:vTe,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},Ij={...pU,defaultUniforms:{...pU.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},xTe=[mj],bTe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],wTe=[];function STe(n){const e=wp.getDefaultShaderAssembler();for(const i of xTe)e.addDefaultModule(i);e._hookFunctions.length=0;const t=n==="glsl"?bTe:wTe;for(const i of t)e.addShaderHook(i);return e}const TTe=[255,255,255],ETe=1;let ATe=0;class MTe{constructor(e={}){this.type="ambient";const{color:t=TTe}=e,{intensity:i=ETe}=e;this.id=e.id||`ambient-${ATe++}`,this.color=t,this.intensity=i}}const CTe=[255,255,255],PTe=1,RTe=[0,0,-1];let ITe=0;class FU{constructor(e={}){this.type="directional";const{color:t=CTe}=e,{intensity:i=PTe}=e,{direction:r=RTe}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${ITe++}`,this.color=t,this.intensity=i,this.type="directional",this.direction=new lu(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class kTe{constructor(e,t={id:"pass"}){const{id:i}=t;this.id=i,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class _I extends kTe{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,i]=this.device.canvasContext.getDrawingBufferSize(),r=e.clearCanvas??!0,s=e.clearColor??(r?[0,0,0,0]:!1),o=r?1:!1,a=r?0:!1,l=e.colorMask??15,c={viewport:[0,0,t,i]};e.colorMask&&(c.colorMask=l),e.scissorRect&&(c.scissorRect=e.scissorRect);const u=this.device.beginRenderPass({framebuffer:e.target,parameters:c,clearColor:s,clearDepth:o,clearStencil:a});try{return this._drawLayers(u,e)}finally{u.end(),this.device.submit()}}_drawLayers(e,t){const{target:i,shaderModuleProps:r,viewports:s,views:o,onViewportActive:a,clearStack:l=!0}=t;t.pass=t.pass||"unknown",l&&(this._lastRenderIndex=-1);const c=[];for(const u of s){const d=o&&o[u.id];a?.(u);const m=this._getDrawLayerParams(u,t),y=u.subViewports||[u];for(const x of y){const T=this._drawLayersInViewport(e,{target:i,shaderModuleProps:r,viewport:x,view:d,pass:t.pass,layers:t.layers},m);c.push(T)}}return c}_getDrawLayerParams(e,{layers:t,pass:i,isPicking:r=!1,layerFilter:s,cullRect:o,effects:a,shaderModuleProps:l},c=!1){const u=[],d=kj(this._lastRenderIndex+1),m={layer:t[0],viewport:e,isPicking:r,renderPass:i,cullRect:o},y={};for(let x=0;x<t.length;x++){const T=t[x],S=this._shouldDrawLayer(T,m,s,y),w={shouldDrawLayer:S};S&&!c&&(w.shouldDrawLayer=!0,w.layerRenderIndex=d(T,S),w.shaderModuleProps=this._getShaderModuleProps(T,a,i,l),w.layerParameters={...T.context.deck?.props.parameters,...this.getLayerParameters(T,x,e)}),u[x]=w}return u}_drawLayersInViewport(e,{layers:t,shaderModuleProps:i,pass:r,target:s,viewport:o,view:a},l){const c=OTe(this.device,{shaderModuleProps:i,target:s,viewport:o});if(a){const{clear:d,clearColor:m,clearDepth:y,clearStencil:x}=a.props;if(d){let T=[0,0,0,0],S=1,w=0;Array.isArray(m)?T=[...m.slice(0,3),m[3]||255].map(M=>M/255):m===!1&&(T=!1),y!==void 0&&(S=y),x!==void 0&&(w=x),this.device.beginRenderPass({framebuffer:s,parameters:{viewport:c,scissorRect:c},clearColor:T,clearDepth:S,clearStencil:w}).end()}}const u={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let d=0;d<t.length;d++){const m=t[d],y=l[d],{shouldDrawLayer:x}=y;if(x&&m.props.pickable&&u.pickableCount++,m.isComposite&&u.compositeCount++,m.isDrawable&&y.shouldDrawLayer){const{layerRenderIndex:T,shaderModuleProps:S,layerParameters:w}=y;u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,T),S.project&&(S.project.viewport=o),m.context.renderPass=e;try{m._drawLayer({renderPass:e,shaderModuleProps:S,uniforms:{layerIndex:T},parameters:w})}catch(P){m.raiseError(P,`drawing ${m} to ${r}`)}}}return u}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,i){return null}getLayerParameters(e,t,i){return e.props.parameters}_shouldDrawLayer(e,t,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(t))return!1;t.layer=o,o=o.parent}if(i){const a=t.layer.id;if(a in r||(r[a]=i(t)),!r[a])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,i,r){const s=this.device.canvasContext.cssToDeviceRatio(),o=e.internalState?.propsInTransition||e.props,a={layer:o,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:o.modelMatrix,coordinateSystem:o.coordinateSystem,coordinateOrigin:o.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const l of t)UU(a,l.getShaderModuleProps?.(e,a));return UU(a,this.getShaderModuleProps(e,t,a),r)}}function kj(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||kj(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}function OTe(n,{shaderModuleProps:e,target:t,viewport:i}){const r=e?.project?.devicePixelRatio??n.canvasContext.cssToDeviceRatio(),[,s]=n.canvasContext.getDrawingBufferSize(),o=t?t.height:s,a=i;return[a.x*r,o-(a.y+a.height)*r,a.width*r,a.height*r]}function UU(n,...e){for(const t of e)if(t)for(const i in t)n[i]?Object.assign(n[i],t[i]):n[i]=t[i];return n}class LTe extends _I{constructor(e,t){super(e,t);const i=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),r=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[i],depthStencilAttachment:r})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,i=this.device.canvasContext.cssToDeviceRatio(),r=e.viewports[0],s=r.width*i,o=r.height*i,a=[1,1,1,1];(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render({...e,clearColor:a,target:t,pass:"shadow"})}getLayerParameters(e,t,i){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,t,i){return{shadow:{project:i.project,drawToShadowMap:!0}}}}const NTe={color:[255,255,255],intensity:1},BU=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],DTe=[0,0,0,200/255];class Oj{constructor(e={}){this.id="lighting-effect",this.shadowColor=DTe,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:i}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),i._addDefaultShaderModule(DU),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:i,onViewportActive:r,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:t,viewports:i,onViewportActive:r,views:s,shaderModuleProps:{shadow:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,t){const i=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(o=>o.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},r={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(o=>o.getProjectedLight({layer:e})),pointLights:this.pointLights.map(o=>o.getProjectedLight({layer:e}))},s=e.props.material;return{shadow:i,lighting:r,phongMaterial:s,gouraudMaterial:s}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(DU))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const i=new cu().lookAt({eye:new lu(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new LTe(e);this.shadowPasses[t]=i}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&t.length===0&&i.length===0&&(this.ambientLight=new MTe(NTe),this.directionalLights.push(new FU(BU[0]),new FU(BU[1])))}}class FTe{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let d=1/0;l&&(d=l*i+s);const m=this._allocate(c,u,a,d);return e&&o?m.set(e):a||m.fill(0,0,4),this._release(e),m}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,i),t.length>this.opts.poolSize&&t.shift()}}const s0=new FTe;function zy(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function UTe(n){return[n[12],n[13],n[14]]}function BTe(n){return{left:gg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:gg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:gg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:gg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:gg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:gg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}const zU=new lu;function gg(n,e,t,i){zU.set(n,e,t);const r=zU.len();return{distance:i/r,normal:new lu(-n/r,-e/r,-t/r)}}function zTe(n){return n-Math.fround(n)}let Ty;function FA(n,e){const{size:t=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:n.length,s=(r-i)/t;Ty=s0.allocate(Ty,s,{type:Float32Array,size:t*2});let o=i,a=0;for(;o<r;){for(let l=0;l<t;l++){const c=n[o++];Ty[a+l]=c,Ty[a+l+t]=zTe(c)}a+=t*2}return Ty.subarray(0,s*t*2)}function VTe(n){let e=null,t=!1;for(const i of n)i&&(e?(t||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],t=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const HTe=Math.PI/180,WTe=zy(),VU=[0,0,0],jTe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function $Te({width:n,height:e,orthographic:t,fovyRadians:i,focalDistance:r,padding:s,near:o,far:a}){const l=n/e,c=t?new cu().orthographic({fovy:i,aspect:l,focalDistance:r,near:o,far:a}):new cu().perspective({fovy:i,aspect:l,near:o,far:a});if(s){const{left:u=0,right:d=0,top:m=0,bottom:y=0}=s,x=zf((u+n-d)/2,0,n)-n/2,T=zf((m+e-y)/2,0,e)-e/2;c[8]-=x*2/n,c[9]+=T*2/e}return c}class H0{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||jTe,this.focalDistance=e.focalDistance||1,this.position=e.position||VU,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?dl.WEB_MERCATOR:dl.WEB_MERCATOR_AUTO_OFFSET:dl.IDENTITY}equals(e){return e instanceof H0?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&r0(e.projectionMatrix,this.projectionMatrix)&&r0(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:t=!0}={}){const i=this.projectPosition(e),r=Pj(i,this.pixelProjectionMatrix),[s,o]=r,a=t?o:this.height-o;return e.length===2?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,a=t?s:this.height-s,l=i&&i*this.distanceScales.unitsPerMeter[2],c=gI([r,a,o],this.pixelUnprojectionMatrix,l),[u,d,m]=this.unprojectPosition(c);return Number.isFinite(o)?[u,d,m]:Number.isFinite(i)?[u,d,i]:[u,d]}projectPosition(e){const[t,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[t,i,r]}unprojectPosition(e){const[t,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[t,i,r]}projectFlat(e){if(this.isGeospatial){const t=CS(e);return t[1]=zf(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?m_(e):e}getBounds(e={}){const t={targetZ:e.z||0},i=this.unproject([0,0],t),r=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(i[0],r[0],s[0],o[0]),Math.min(i[1],r[1],s[1],o[1]),Math.max(i[0],r[0],s[0],o[0]),Math.max(i[1],r[1],s[1],o[1])]}getDistanceScales(e){return e&&this.isGeospatial?fP({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&t<this.y+this.height&&this.y<t+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,BTe(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=tTe({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||fP({latitude:i,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:o}=e;let a=VU;if(s&&(a=o?new cu(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([t,i,0]);this.center=new lu(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:t=WTe,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=new cu().multiplyRight(t).translate(new lu(this.center).negate()),this.projectionMatrix=i||$Te({width:this.width,height:this.height,orthographic:r,fovyRadians:s||o*HTe,focalDistance:u,padding:c,near:a,far:l});const d=zy();Dp(d,d,this.projectionMatrix),Dp(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=iP([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=UTe(this.viewMatrixInverse);const m=zy(),y=zy();dI(m,m,[this.width/2,-this.height/2,1]),ES(m,m,[1,-1,0]),Dp(y,m,this.viewProjectionMatrix),this.pixelProjectionMatrix=y,this.pixelUnprojectionMatrix=iP(zy(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||vi.warn("Pixel project matrix not invertible")()}}H0.displayName="Viewport";class g_ extends H0{constructor(e={}){const{latitude:t=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:d=!1,projectionMatrix:m,repeat:y=!1,worldOffset:x=0,position:T,padding:S,legacyMeterSizes:w=!1}=e;let{width:P,height:M,altitude:I=1.5}=e;const k=Math.pow(2,r);P=P||1,M=M||1;let D,H=null;if(m)I=m[5]/2,D=PS(I);else{e.fovy?(D=e.fovy,I=Cj(D)):D=PS(I);let z;if(S){const{top:j=0,bottom:J=0}=S;z=[0,zf((j+M-J)/2,0,M)-M/2]}H=iTe({width:P,height:M,scale:k,center:T&&[0,0,T[2]*DA(t)],offset:z,pitch:s,fovy:D,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(c)&&(H.near=c),Number.isFinite(u)&&(H.far=u)}let W=nTe({height:M,pitch:s,bearing:o,scale:k,altitude:I});x&&(W=new cu().translate([512*x,0,0]).multiplyLeft(W)),super({...e,width:P,height:M,viewMatrix:W,longitude:i,latitude:t,zoom:r,...H,fovy:D,focalDistance:I}),this.latitude=t,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=o,this.altitude=I,this.fovy=D,this.orthographic=d,this._subViewports=y?[]:null,this._pseudoMeters=w,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=t;r<=i;r++){const s=r?new g_({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,i]=this.projectFlat(e),r=(e[2]||0)*DA(e[1]);return[t,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,i]=this.unprojectFlat(e),r=(e[2]||0)/DA(i);return[t,i,r]}addMetersToLngLat(e,t){return Mj(e,t)}panByPosition(e,t){const i=gI(t,this.pixelUnprojectionMatrix),r=this.projectFlat(e),s=fU([],r,Fbe([],i)),o=fU([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const t=oTe(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=rTe({width:i,height:r,bounds:e,...t});return new g_({width:i,height:r,longitude:s,latitude:o,zoom:a})}}g_.displayName="WebMercatorViewport";const HU=[0,0,0];function UA(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof g_){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function XTe(n){const{viewport:e,modelMatrix:t,coordinateOrigin:i}=n;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return r===ii.DEFAULT&&(r=e.isGeospatial?ii.LNGLAT:ii.CARTESIAN),s===void 0&&(s=r),o===void 0&&(o=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:t,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function Lj(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=z0([],[o,a,l,1],t)),i){case ii.LNGLAT:return UA([o,a,l],e,s);case ii.LNGLAT_OFFSETS:return UA([o+r[0],a+r[1],l+(r[2]||0)],e,s);case ii.METER_OFFSETS:return UA(Mj(r,[o,a,l]),e,s);case ii.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}function GTe(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=XTe(e),{autoOffset:l=!0}=e,{geospatialOrigin:c=HU,shaderCoordinateOrigin:u=HU,offsetMode:d=!1}=l?Tj(t,i,r):{},m=Lj(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:d});if(d){const y=t.projectPosition(c||u);Jbe(m,m,y)}return m}let YTe=1,qTe=1;class Nj{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=YTe++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return t===void 0?!1:this.time>=t.delay+t.duration*t.repeat}getTime(e){if(e===void 0)return this.time;const t=this.channels.get(e);return t===void 0?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=qTe++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}function ZTe(n){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}function KTe(n){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}let JTe=0;class yI{static defaultAnimationLoopProps={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:QC.stats.get(`animation-loop-${JTe++}`),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...yI.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error("No device provided");this.stats=e.stats||new BT({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=ZTe(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(KTe(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");const t=e?.canvas,i=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:t,useDevicePixels:i,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1];let i=1;const r=this.device?.getDefaultCanvasContext().canvas;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const BA={};function W0(n="id"){BA[n]=BA[n]||1;const e=BA[n]++;return`${n}-${e}`}class WU{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||W0("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&gr.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function QTe(n,e){if(e instanceof WU)return e;const t=eEe(n,e),{attributes:i,bufferLayout:r}=tEe(n,e);return new WU({topology:e.topology||"triangle-list",bufferLayout:r,vertexCount:e.vertexCount,indices:t,attributes:i})}function eEe(n,e){if(!e.indices)return;const t=e.indices.value;return n.createBuffer({usage:gr.INDEX,data:t})}function tEe(n,e){const t=[],i={};for(const[s,o]of Object.entries(e.attributes)){let a=s;switch(s){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}if(o){i[a]=n.createBuffer({data:o.value,id:`${s}-buffer`});const{value:l,size:c,normalized:u}=o;t.push({name:a,format:exe(l,c,u)})}}const r=e._calculateVertexCount(e.attributes,e.indices);return{attributes:i,bufferLayout:t,vertexCount:r}}class vI{static defaultProps={...Np.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new vI(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const t={...Np.defaultProps,...e},i=this._renderPipelineCache,r=this._hashRenderPipeline(t);let s=i[r]?.pipeline;return s?(i[r].useCount++,this.debug&&Qe.warn(`${this}: ${i[r].pipeline} reused, count=${i[r].useCount}, (id=${e.id})`)()):(s=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:W0("unnamed-cached")}),s.hash=r,i[r]={pipeline:s,useCount:1},this.debug&&Qe.warn(`${this}: ${s} created, count=${i[r].useCount}`)()),s}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);const t={..._S.defaultProps,...e},i=this._computePipelineCache,r=this._hashComputePipeline(t);let s=i[r]?.pipeline;return s?(i[r].useCount++,this.debug&&Qe.warn(`${this}: ${i[r].pipeline} reused, count=${i[r].useCount}, (id=${e.id})`)()):(s=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0}),s.hash=r,i[r]={pipeline:s,useCount:1},this.debug&&Qe.warn(`${this}: ${s} created, count=${i[r].useCount}`)()),s}release(e){if(!this.cachingEnabled){e.destroy();return}const t=this._getCache(e),i=e.hash;t[i].useCount--,t[i].useCount===0?(this._destroyPipeline(e),this.debug&&Qe.warn(`${this}: ${e} released and destroyed`)()):t[i].useCount<0?(Qe.error(`${this}: ${e} released, useCount < 0, resetting`)(),t[i].useCount=0):this.debug&&Qe.warn(`${this}: ${e} released, count=${t[i].useCount}`)()}_destroyPipeline(e){const t=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete t[e.hash],e.destroy(),!0}}_getCache(e){let t;if(e instanceof _S&&(t=this._computePipelineCache),e instanceof Np&&(t=this._renderPipelineCache),!t)throw new Error(`${this}`);if(!t[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return t}_hashComputePipeline(e){const{type:t}=this.device,i=this._getHash(e.shader.source);return`${t}/C/${i}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,i=e.fs?this._getHash(e.fs.source):0,r="-",s=this._getHash(JSON.stringify(e.bufferLayout)),{type:o}=this.device;switch(o){case"webgl":return`${o}/R/${t}/${i}V${r}BL${s}`;case"webgpu":default:const a=this._getHash(JSON.stringify(e.parameters));return`${o}/R/${t}/${i}V${r}T${e.topology}P${a}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class xI{static defaultProps={...WT.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new xI(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const t=this._hashShader(e);let i=this._cache[t];if(i)i.useCount++,this.debug&&Qe.warn(`${this}: Reusing shader ${i.shader.id} count=${i.useCount}`)();else{const r=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=i={shader:r,useCount:1},this.debug&&Qe.warn(`${this}: Created new shader ${r.id}`)()}return i.shader}release(e){if(!this.cachingEnabled){e.destroy();return}const t=this._hashShader(e),i=this._cache[t];if(i)if(i.useCount--,i.useCount===0)this.destroyPolicy==="unused"&&(delete this._cache[t],i.shader.destroy(),this.debug&&Qe.warn(`${this}: Releasing shader ${e.id}, destroyed`)());else{if(i.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&Qe.warn(`${this}: Releasing shader ${e.id} count=${i.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}}function nEe(n,e){const t={},i="Values";if(n.attributes.length===0&&!n.varyings?.length)return{"No attributes or varyings":{[i]:"N/A"}};for(const r of n.attributes)if(r){const s=`${r.location} ${r.name}: ${r.type}`;t[`in ${s}`]={[i]:r.stepMode||"vertex"}}for(const r of n.varyings||[]){const s=`${r.location} ${r.name}`;t[`out ${s}`]={[i]:JSON.stringify(r)}}return t}let vs=null,zA=null;function iEe(n,{id:e,minimap:t,opaque:i,top:r="0",left:s="0",rgbaScale:o=1}){vs||(vs=document.createElement("canvas"),vs.id=e,vs.title=e,vs.style.zIndex="100",vs.style.position="absolute",vs.style.top=r,vs.style.left=s,vs.style.border="blue 5px solid",vs.style.transform="scaleY(-1)",document.body.appendChild(vs),zA=vs.getContext("2d")),(vs.width!==n.width||vs.height!==n.height)&&(vs.width=n.width/2,vs.height=n.height/2,vs.style.width="400px",vs.style.height="400px");const a=n.device.readPixelsToArrayWebGL(n),l=zA?.createImageData(n.width,n.height);if(l){for(let u=0;u<a.length;u+=4)l.data[0+u+0]=a[u+0]*o,l.data[0+u+1]=a[u+1]*o,l.data[0+u+2]=a[u+2]*o,l.data[0+u+3]=i?255:a[u+3]*o;zA?.putImageData(l,0,0)}}function dP(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!dP(n[i],e[i],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const i=Object.keys(n),r=Object.keys(e);if(i.length!==r.length)return!1;for(const s of i)if(!e.hasOwnProperty(s)||!dP(n[s],e[s],t-1))return!1;return!0}return!1}class VA{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(t=>t.attribute):[e.name]}mergeBufferLayouts(e,t){const i=[...e];for(const r of t){const s=i.findIndex(o=>o.name===r.name);s<0?i.push(r):i[s]=r}return i}getBufferIndex(e){const t=this.bufferLayouts.findIndex(i=>i.name===e);return t===-1&&Qe.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}function rEe(n,e){const t=Object.fromEntries(n.attributes.map(r=>[r.name,r.location])),i=e.slice();return i.sort((r,s)=>{const o=r.attributes?r.attributes.map(u=>u.attribute):[r.name],a=s.attributes?s.attributes.map(u=>u.attribute):[s.name],l=Math.min(...o.map(u=>t[u])),c=Math.min(...a.map(u=>t[u]));return l-c}),i}function sEe(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function oEe(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":!1}function aEe(n){return sEe(n)||oEe(n)}function lEe(n){return aEe(n)||typeof n=="number"||typeof n=="boolean"}function cEe(n){const e={bindings:{},uniforms:{}};return Object.keys(n).forEach(t=>{const i=n[t];lEe(i)?e.uniforms[t]=i:e.bindings[t]=i}),e}class uEe{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,t){Object.assign(this.options,t);const i=Y2(Object.values(e).filter(r=>r.dependencies));for(const r of i)e[r.name]=r;Qe.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,s]of Object.entries(e))this._addModule(s),s.name&&r!==s.name&&!this.options.disableWarnings&&Qe.warn(`Module name: ${r} vs ${s.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const i=t,r=e[i]||{},s=this.modules[i];if(!s){this.options.disableWarnings||Qe.warn(`Module ${t} not found`)();continue}const o=this.moduleUniforms[i],a=this.moduleBindings[i],l=s.getUniforms?.(r,o)||r,{uniforms:c,bindings:u}=cEe(l);this.moduleUniforms[i]={...o,...c},this.moduleBindings[i]={...a,...u}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,i]of Object.entries(this.moduleUniforms))for(const[r,s]of Object.entries(i))e[`${t}.${r}`]={type:this.modules[t].uniformTypes?.[r],value:String(s)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let hEe="";async function fEe(n,e){const t=new Image;return t.crossOrigin="anonymous",t.src=n.startsWith("http")?n:hEe+n,await t.decode(),e?await createImageBitmap(t,e):await createImageBitmap(t)}const dEe=["+X","-X","+Y","-Y","+Z","-Z"],pEe=["+X","-X","+Y","-Y","+Z","-Z"];class cv{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,t){this.device=e;const i=W0("async-texture");this.props={...cv.defaultProps,id:i,...t},this.id=this.props.id,t={...t},typeof t?.data=="string"&&t.dimension==="2d"&&(t.data=fEe(t.data)),t.mipmaps&&(t.mipLevels="auto"),this.ready=new Promise((r,s)=>{this.resolveReady=()=>{this.isReady=!0,r()},this.rejectReady=s}),this.initAsync(t)}async initAsync(e){const t=e.data,i=await Dj(t).then(void 0,this.rejectReady);if(this.destroyed)return;const r=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(i);if(!r)throw new Error("Texture size could not be determined");const s={...r,...e,data:void 0,mipLevels:1},o=this.device.getMipLevelCount(s.width,s.height);if(s.mipLevels=this.props.mipLevels==="auto"?o:Math.min(o,this.props.mipLevels),this.texture=this.device.createTexture(s),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,i);break;case"2d":this._setTexture2DData(i);break;case"3d":this._setTexture3DData(this.texture,i);break;case"2d-array":this._setTextureArrayData(this.texture,i);break;case"cube":this._setTextureCubeData(this.texture,i);break;case"cube-array":this._setTextureCubeArrayData(this.texture,i);break}this.props.mipmaps&&this.generateMipmaps(),Qe.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof Jp?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const i=Object.values(e)[0];return{width:i.width,height:i.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,t){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,t=0){if(!this.texture)throw new Error("Texture not initialized");const i=this._normalizeTextureData(e);i.length>1&&this.props.mipmaps!==!1&&Qe.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let r=0;r<i.length;r++){const s=i[r];this.device.isExternalImage(s)?this.texture.copyExternalImage({image:s,depth:t,mipLevel:r,flipY:!0}):this.texture.copyImageData({data:s.data,mipLevel:r})}}_setTexture3DData(e,t){if(this.texture?.props.dimension!=="3d")throw new Error(this.id);for(let i=0;i<t.length;i++)this._setTexture2DData(t[i],i)}_setTextureCubeData(e,t){if(this.texture?.props.dimension!=="cube")throw new Error(this.id);for(const[i,r]of Object.entries(t)){const s=pEe.indexOf(i);this._setTexture2DData(r,s)}}_setTextureArrayData(e,t){if(this.texture?.props.dimension!=="2d-array")throw new Error(this.id);for(let i=0;i<t.length;i++)this._setTexture2DData(t[i],i)}_setTextureCubeArrayData(e,t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,t,i,r=0){Array.isArray(t)&&t.length>1&&this.props.mipmaps!==!1&&Qe.warn(`${this.id} has mipmap and multiple LODs.`)();const s=dEe.indexOf(i);this._setTexture2DData(t,s)}_normalizeTextureData(e){const t=this.texture;let i;return ArrayBuffer.isView(e)?i=[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?i=e:i=[e],i}static defaultProps={...ts.defaultProps,data:null,mipmaps:!1}}async function Dj(n){if(n=await n,Array.isArray(n))return await Promise.all(n.map(Dj));if(n&&typeof n=="object"&&n.constructor===Object){const e=n,t=await Promise.all(Object.values(e)),i=Object.keys(e),r={};for(let s=0;s<i.length;s++)r[i[s]]=t[s];return r}return n}const np=2,mEe=1e4;class __{static defaultProps={...Np.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:wp.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,t){this.props={...__.defaultProps,...t},t=this.props,this.id=t.id||W0("model"),this.device=e,Object.assign(this.userData,t.userData);const i=Object.fromEntries(this.props.modules?.map(l=>[l.name,l])||[]),r=t.shaderInputs||new uEe(i,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(r);const s=_Ee(e),o=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:l,getUniforms:c}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:s,...this.props,modules:o});this.source=l,this._getModuleUniforms=c,this.props.shaderLayout||=Mbe(this.source)}else{const{vs:l,fs:c,getUniforms:u}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:s,...this.props,modules:o});this.vs=l,this.fs=c,this._getModuleUniforms=u}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||vI.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||xI.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return Qe.info(np,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let i;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const r=this._getBindings();this.pipeline.setBindings(r,{disableWarnings:this.props.disableWarnings});const{indexBuffer:s}=this.vertexArray,o=s?s.byteLength/(s.indexType==="uint32"?4:2):void 0;i=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:o,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),i?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",i}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&QTe(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const i=new VA(this.bufferLayout);this.bufferLayout=i.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new VA(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){dP(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new Kxe(this.shaderInputs.modules);for(const[t,i]of Object.entries(this.shaderInputs.modules))if(gEe(i)){const r=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=r}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const i=t?.disableWarnings??this.props.disableWarnings;e.indices&&Qe.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=rEe(this.pipeline.shaderLayout,this.bufferLayout);const r=new VA(this.bufferLayout);for(const[s,o]of Object.entries(e)){const a=r.getBufferLayout(s);if(!a){i||Qe.warn(`Model(${this.id}): Missing layout for buffer "${s}".`)();continue}const l=r.getAttributeNamesForBuffer(a);let c=!1;for(const u of l){const d=this._attributeInfos[u];if(d){const m=this.device.type==="webgpu"?r.getBufferIndex(d.bufferName):d.location;this.vertexArray.setBuffer(m,o),c=!0}}!c&&!i&&Qe.warn(`Model(${this.id}): Ignoring buffer "${o.id}" for unknown attribute "${s}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[i,r]of Object.entries(e)){const s=this._attributeInfos[i];s?this.vertexArray.setConstantWebGL(s.location,r):(t?.disableWarnings??this.props.disableWarnings)||Qe.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${i}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof cv&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,i]of Object.entries(this.bindings))i instanceof cv?i.isReady&&(e[t]=i.texture):e[t]=i;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof HT?e=Math.max(e,t.texture.updateTimestamp):t instanceof gr||t instanceof ts?e=Math.max(e,t.updateTimestamp):t instanceof cv?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof Jp||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[i]of Object.entries(t))!this.pipeline.shaderLayout.attributes.find(r=>r.name===i)&&i!=="positions"&&delete t[i];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(Qe.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const i=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let r=null;this.source?r=i:this.fs&&(r=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:i,fs:r}),this._attributeInfos=UW(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=Qe.level>3?0:mEe;Qe.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,Qe.group(np,`>>> DRAWING MODEL ${this.id}`,{collapsed:Qe.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=nEe(this.pipeline.shaderLayout,this.id);Qe.table(np,e)();const t=this.shaderInputs.getDebugTable();Qe.table(np,t)();const i=this._getAttributeDebugTable();Qe.table(np,this._attributeInfos)(),Qe.table(np,i)(),Qe.groupEnd(np)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const i=e.props.framebuffer;i&&iEe(i,{id:i.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,i]of Object.entries(this._attributeInfos)){const r=this.vertexArray.attributes[i.location];e[i.location]={name:t,type:i.shaderType,values:r?this._getBufferOrConstantValues(r,i.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,i=t.indexType==="uint32"?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:i.toString()}}return e}_getBufferOrConstantValues(e,t){const i=Z2(t);return(e instanceof gr?new i(e.debugData):e).toString()}}function gEe(n){return!!(n.uniformTypes&&!yEe(n.uniformTypes))}function _Ee(n){return{type:n.type,shaderLanguage:n.info.shadingLanguage,shaderLanguageVersion:n.info.shadingLanguageVersion,gpu:n.info.gpu,features:n.features}}function yEe(n){for(const e in n)return!1;return!0}class y_{device;model;transformFeedback;static defaultProps={...__.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,t=y_.defaultProps){if(!y_.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new __(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||X0e(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof gr)return t.readAsync();const{buffer:i,byteOffset:r=0,byteLength:s=i.byteLength}=t;return i.readAsync(r,s)}}class Fj{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:t={},indices:i=null,vertexCount:r=null}=e;this.id=e.id||W0("geometry"),this.topology=e.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(const[s,o]of Object.entries(t)){const a=ArrayBuffer.isView(o)?{value:o}:o;if(!ArrayBuffer.isView(a.value))throw new Error(`${this._print(s)}: must be typed array or object with value as typed array`);if((s==="POSITION"||s==="positions")&&!a.size&&(a.size=3),s==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=a}else this.attributes[s]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=r||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r of Object.values(e)){const{value:s,size:o,constant:a}=r;!a&&s&&o!==void 0&&o>=1&&(i=Math.min(i,s.length/o))}return i}}const vEe={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class Uj extends _I{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:d,effects:m,pass:y="picking",pickZ:x,shaderModuleProps:T}){this.pickZ=x;const S=this._resetColorEncoder(x),w=[a,l,c,u],P=super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,cullRect:d,effects:m?.filter(I=>I.useInPicking),pass:y,isPicking:!0,shaderModuleProps:T,clearColor:[0,0,0,0],colorMask:15,scissorRect:w});return this._colorEncoderState=null,{decodePickingColor:S&&bEe.bind(null,S),stats:P}}shouldDrawLayer(e){const{pickable:t,operation:i}=e.props;return t&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getShaderModuleProps(e,t,i){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,i){const r={...e.props.parameters},{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?r.blend=!1:s&&o.includes("draw")&&(Object.assign(r,vEe),r.blend=!0,r.blendColor=xEe(this._colorEncoderState,e,i)),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function xEe(n,e,t){const{byLayer:i,byAlpha:r}=n;let s,o=i.get(e);return o?(o.viewports.push(t),s=o.a):(s=i.size+1,s<=255?(o={a:s,layer:e,viewports:[t]},i.set(e,o),r[s]=o):(vi.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function bEe(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}const bg={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},RS=Symbol.for("component"),Fp=Symbol.for("propTypes"),HA=Symbol.for("deprecatedProps"),qg=Symbol.for("asyncPropDefaults"),nm=Symbol.for("asyncPropOriginal"),Vf=Symbol.for("asyncPropResolved");function Bj(n,e=()=>!0){return Array.isArray(n)?zj(n,e,[]):e(n)?[n]:[]}function zj(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?zj(r,e,t):e(r)&&t.push(r)}return t}function wEe({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}class SEe{constructor(e,t,i){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=i,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=dS(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class TEe{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new SEe(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{};let a=o[t];const l=a&&a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),i&&(a?(a.onChange=r,a.resourceId=i.id):a={onChange:r,resourceId:i.id},o[t]=a,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const EEe="layerManager.setLayers",AEe="layerManager.activateViewport";class MEe{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{No(AEe,this,a),a&&(this.context.viewport=a)};const{deck:i,stats:r,viewport:s,timeline:o}=t||{};this.layers=[],this.resourceManager=new TEe({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:i,shaderAssembler:STe(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[Iwe],renderPass:void 0,stats:r||new BT({id:"deck.gl"}),viewport:s||new H0({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new Nj,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(i=>t.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){No(EEe,this,t,e),this._lastRenderedLayers=e;const i=Bj(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(i=>i.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,i=t.findIndex(r=>r.name===e.name);i>=0&&(t.splice(i,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,i){i.raiseError(t,`${e} of ${i}`)}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?vi.warn(`Multiple old layers with same id ${o.id}`)():i[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=`Uniform transition in ${o}`;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];s===null&&vi.warn(`Multiple new layers with same id ${r.id}`)(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=bg.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=bg.MATCHED,t!==e&&(e.lifecycle=bg.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=bg.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=bg.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}function pl(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!pl(n[i],e[i],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const i=Object.keys(n),r=Object.keys(e);if(i.length!==r.length)return!1;for(const s of i)if(!e.hasOwnProperty(s)||!pl(n[s],e[s],t-1))return!1;return!0}return!1}class CEe{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t=typeof e=="string"?this.getView(e):e,i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Bj(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!pl(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):vi.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){const i=t.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>this.getView(e.id)?.makeViewport({viewState:s,width:this.width,height:this.height})})}_updateController(e,t,i,r){const s=e.controller;if(s&&i){const o={...t,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==s.type)&&(r=this._createController(e,o)),r&&r.setProps(o),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=t[s.id];const c=!!s.controller;c&&!l&&(i=!0),(i||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const r in t){const s=t[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length?!0:e.some((i,r)=>!e[r].equals(t[r]))}}const PEe=/([0-9]+\.?[0-9]*)(%|px)/;function wf(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=PEe.exec(n);if(e&&e.length>=3){const t=e[2]==="%",i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error(`Could not parse position string ${n}`)}}function Sf(n,e){return n.relative?Math.round(n.position*e):n.position}class v_{constructor(e){const{id:t,x:i=0,y:r=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=wf(i),this._y=wf(r),this._width=wf(s),this._height=wf(o),this._padding=a&&{left:wf(a.left||0),right:wf(a.right||0),top:wf(a.top||0),bottom:wf(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&pl(this.props,e.props,2)}clone(e){const t=this.constructor;return new t({...this.props,...e})}makeViewport({width:e,height:t,viewState:i}){i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});if(!r.height||!r.width)return null;const s=this.getViewportType(i);return new s({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const i in this.props.viewState)i!=="id"&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){const i={x:Sf(this._x,e),y:Sf(this._y,t),width:Sf(this._width,e),height:Sf(this._height,t)};return this._padding&&(i.padding={left:Sf(this._padding.left,e),top:Sf(this._padding.top,t),right:Sf(this._padding.right,e),bottom:Sf(this._padding.bottom,t)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class XT{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const jU=()=>{},pP={BREAK:1,SNAP_TO_END:2,IGNORE:3},REe=n=>n,IEe=pP.BREAK;class kEe{constructor(e){this._onTransitionUpdate=t=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:o,duration:a,easing:l}}=t,c=l(i/a),u=r.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new XT(e.timeline),this.onViewStateChange=e.onViewStateChange||jU,this.onStateChange=e.onStateChange||jU}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;r={...i,...s===pP.SNAP_TO_END?o:this.propsInTransition||i}}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||t==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===pP.IGNORE||this._isUpdateDueToCurrentTransition(t):this._isTransitionEnabled(t)?t.transitionInterpolator.arePropsEqual(e,t):!0}_triggerTransition(e,t){const i=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(i),s=t.transitionInterpolator,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(o===0)return;const a=s.initializeProps(e,r);this.propsInTransition={};const l={duration:o,easing:t.transitionEasing||REe,interpolator:s,interruption:t.transitionInterruption||IEe,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}function uo(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class OEe{constructor(e){const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i||t,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare)if(!(i in e)||!(i in t)||!r0(e[i],t[i]))return!1;return!0}initializeProps(e,t){const i={},r={};for(const s of this._propsToExtract)(s in e||s in t)&&(i[s]=e[s],r[s]=t[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const i=e[t];uo(Number.isFinite(i)||Array.isArray(i),`${t} is required for transition`)})}}const LEe=["longitude","latitude","zoom","bearing","pitch"],NEe=["longitude","latitude","zoom"];class Vj extends OEe{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:LEe,required:NEe},super(i.transitionProps),this.opts=i}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=TS(e[s]||0,t[s]||0,i);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...t,...r});Object.assign(r,s.panByPosition(t.aroundPosition,TS(e.around,t.around,i)))}return r}}const Yu={transitionDuration:0},DEe=300,Zb=n=>1-(1-n)*(1-n),_g={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},ip={};class FEe{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new kEe({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return t?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return t?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return t?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:i}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:t===!0?DEe:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(_g.WHEEL,u&&i),this.toggleEvents(_g.PAN,u),this.toggleEvents(_g.PINCH,u&&(a||l)),this.toggleEvents(_g.MULTI_PAN,u&&l),this.toggleEvents(_g.DOUBLE_CLICK,u&&o),this.toggleEvents(_g.KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t=null,i={}){const r={...e.getViewportProps(),...t},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,Yu,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,Yu,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2],s=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Zb},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Yu,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2],s=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Zb},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&o!==0&&(o=1/o);const a=r?{...this._getTransitionProps({around:t}),transitionDuration:250}:Yu,l=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(l,a,{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,Yu,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Yu,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Zb},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return ip._startPinchRotation=e.rotation,ip._lastPinchEvent=e,this.updateViewport(i,Yu,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:ip._startPinchRotation-i})}return this.updateViewport(t,Yu,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),ip._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:i}=ip;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:Zb},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return ip._startPinchRotation=null,ip._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:t}=this;return!t||!t.transitionInterpolator?Yu:e?{...t,transitionInterpolator:new Vj({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t}}class UEe{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}const $U=5,BEe=1.2;class zEe extends UEe{constructor(e){const{width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:d=20,minZoom:m=0,maxPitch:y=60,minPitch:x=0,startPanLngLat:T,startZoomLngLat:S,startRotatePos:w,startBearing:P,startPitch:M,startZoom:I,normalize:k=!0}=e;uo(Number.isFinite(s)),uo(Number.isFinite(r)),uo(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:d,minZoom:m,maxPitch:y,minPitch:x,normalize:k,position:u},{startPanLngLat:T,startZoomLngLat:S,startRotatePos:w,startBearing:P,startPitch:M,startZoom:I}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this.getState().startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState();if(!r||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,r,o,s):a={bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=r+Math.log2(i);l=zf(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=zf(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=zf(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,aTe(e)),e}_zoomFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,i,r){const s=e[0]-t[0],o=e[1]-t[1],a=e[1],l=t[1],{width:c,height:u}=this.getViewportProps(),d=s/c;let m=0;o>0?Math.abs(u-l)>$U&&(m=o/(l-u)*BEe):o<0&&l>$U&&(m=1-a/l),m=zf(m,-1,1);const{minPitch:y,maxPitch:x}=this.getViewportProps(),T=r+180*d;let S=i;return m>0?S=i+m*(x-i):m<0&&(S=i-m*(y-i)),{pitch:S,bearing:T}}}class VEe extends FEe{constructor(){super(...arguments),this.ControllerState=zEe,this.transition={transitionDuration:300,transitionInterpolator:new Vj({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Hj extends v_{constructor(e={}){super(e)}getViewportType(){return g_}get ControllerType(){return VEe}}Hj.displayName="MapView";const HEe=new Oj;function WEe(n,e){const t=n.order??1/0,i=e.order??1/0;return t-i}class jEe{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(i=>i.id===e.id)){const i=t.findIndex(r=>WEe(r,e)>0);i<0?t.push(e):t.splice(i,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(pl(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const i=[];for(const r of e){const s=t[r.id];let o=r;s&&s!==r?s.setProps?(s.setProps(r.props),o=s):s.cleanup(this._context):s||r.setup(this._context),i.push(o),delete t[r.id]}for(const r in t)t[r].cleanup(this._context);this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof Oj)||this._resolvedEffects.push(HEe),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class $Ee extends _I{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const XEe="deckRenderer.renderLayers";class GEe{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new $Ee(e),this.pickLayersPass=new Uj(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target;this.lastPostProcessEffect&&(i.clearColor=[0,0,0,0],i.clearCanvas=!0);const s=t.render({...i,target:r});i.effects&&(this.lastPostProcessEffect&&(i.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(i.effects,i)),this.renderCount++,No(XEe,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const i of e)t.preRenderStats[i.id]=i.preRender(t),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize(),[i,r]=t;e.length===0&&[0,1].map(s=>{const o=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:i,height:r});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${s}`,colorAttachments:[o]}))});for(const s of e)s.resize(t)}_postRender(e,t){const{renderBuffers:i}=this,r={...t,inputBuffer:i[0],swapBuffer:i[1]};for(const s of e)if(s.postRender){r.target=s.id===this.lastPostProcessEffect?t.target:void 0;const o=s.postRender(r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const YEe={pickedColor:null,pickedObjectIndex:-1};function XU({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=r*r,d=-1,m=0;for(let y=0;y<c;y++){const x=y+a-i,T=x*x;if(T>u)m+=4*l;else for(let S=0;S<l;S++){if(n[m+3]-1>=0){const P=S+o-t,M=P*P+T;M<=u&&(u=M,d=m)}m+=4}}if(d>=0){const y=n.slice(d,d+4),x=e(y);if(x){const T=Math.floor(d/4/l),S=d/4-T*l;return{...x,pickedColor:y,pickedX:o+S,pickedY:a+T}}vi.error("Picked non-existent layer. Is picking buffer corrupt?")()}return YEe}function GU({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n){for(let i=0;i<n.length;i+=4)if(n[i+3]-1>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e(s);a?t.set(o,{...a,color:s}):vi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}function mP({pickInfo:n,viewports:e,pixelRatio:t,x:i,y:r,z:s}){let o=e[0];e.length>1&&(o=qEe(n?.pickedViewports||e,{x:i,y:r}));let a;if(o){const l=[i-o.x,r-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function YU(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(i==="hover"){const d=t.index,m=t.layerId,y=o?o.props.id:null;if(y!==m||a!==d){if(y!==m){const x=r.find(T=>T.props.id===m);x&&l.unshift(x)}t.layerId=y,t.index=a,t.info=null}}const c=mP(n),u=new Map;return u.set(null,c),l.forEach(d=>{let m={...c};d===o&&(m.color=s,m.index=a,m.picked=!0),m=gP({layer:d,info:m,mode:i});const y=m.layer;d===o&&i==="hover"&&(t.info=m),u.set(y.id,m),i==="hover"&&y.updateAutoHighlight(m)}),u}function gP({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}function qEe(n,e){for(let t=n.length-1;t>=0;t--){const i=n[t];if(i.containsPixel(e))return i}return n[0]}class ZEe{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new Uj(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(m=>m.id===o):null,c=a&&r.find(m=>m.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]);return{...s,...{x:e,y:t,viewport:c,coordinate:u,layer:l}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const t=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=t}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const t=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return t.length?t:null}async _pickClosestObjectAsync({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:d}){const m=this.device.canvasContext.cssToDeviceRatio(),y=this._getPickable(e);if(!y||i.length===0)return{result:[],emptyInfo:mP({viewports:i,x:r,y:s,pixelRatio:m})};this._resizeBuffer();const x=this.device.canvasContext.cssToDevicePixels([r,s],!0),T=[x.x+Math.floor(x.width/2),x.y+Math.floor(x.height/2)],S=Math.round(o*m),{width:w,height:P}=this.pickingFBO,M=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:S,deviceWidth:w,deviceHeight:P}),I={x:r-o,y:s-o,width:o*2+1,height:o*2+1};let k;const D=[],H=new Set;for(let W=0;W<a;W++){let z;if(M){const J=this._drawAndSample({layers:y,views:t,viewports:i,onViewportActive:u,deviceRect:M,cullRect:I,effects:d,pass:`picking:${l}`});z=XU({...J,deviceX:T[0],deviceY:T[1],deviceRadius:S,deviceRect:M})}else z={pickedColor:null,pickedObjectIndex:-1};let j;if(z.pickedLayer&&c&&this.depthFBO){const{pickedColors:J}=this._drawAndSample({layers:[z.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:z.pickedX,y:z.pickedY,width:1,height:1},cullRect:I,effects:d,pass:`picking:${l}:z`},!0);J[3]&&(j=J[0])}z.pickedLayer&&W+1<a&&(H.add(z.pickedLayer),z.pickedLayer.disablePickingIndex(z.pickedObjectIndex)),k=YU({pickInfo:z,lastPickedInfo:this.lastPickedInfo,mode:l,layers:y,viewports:i,x:r,y:s,z:j,pixelRatio:m});for(const J of k.values())J.layer&&D.push(J);if(!z.pickedColor)break}for(const W of H)W.restorePickingColors();return{result:D,emptyInfo:k.get(null)}}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:d}){const m=this.device.canvasContext.cssToDeviceRatio(),y=this._getPickable(e);if(!y||i.length===0)return{result:[],emptyInfo:mP({viewports:i,x:r,y:s,pixelRatio:m})};this._resizeBuffer();const x=this.device.canvasContext.cssToDevicePixels([r,s],!0),T=[x.x+Math.floor(x.width/2),x.y+Math.floor(x.height/2)],S=Math.round(o*m),{width:w,height:P}=this.pickingFBO,M=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:S,deviceWidth:w,deviceHeight:P}),I={x:r-o,y:s-o,width:o*2+1,height:o*2+1};let k;const D=[],H=new Set;for(let W=0;W<a;W++){let z;if(M){const J=this._drawAndSample({layers:y,views:t,viewports:i,onViewportActive:u,deviceRect:M,cullRect:I,effects:d,pass:`picking:${l}`});z=XU({...J,deviceX:T[0],deviceY:T[1],deviceRadius:S,deviceRect:M})}else z={pickedColor:null,pickedObjectIndex:-1};let j;if(z.pickedLayer&&c&&this.depthFBO){const{pickedColors:J}=this._drawAndSample({layers:[z.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:z.pickedX,y:z.pickedY,width:1,height:1},cullRect:I,effects:d,pass:`picking:${l}:z`},!0);J[3]&&(j=J[0])}z.pickedLayer&&W+1<a&&(H.add(z.pickedLayer),z.pickedLayer.disablePickingIndex(z.pickedObjectIndex)),k=YU({pickInfo:z,lastPickedInfo:this.lastPickedInfo,mode:l,layers:y,viewports:i,x:r,y:s,z:j,pixelRatio:m});for(const J of k.values())J.layer&&D.push(J);if(!z.pickedColor)break}for(const W of H)W.restorePickingColors();return{result:D,emptyInfo:k.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:d}){const m=this._getPickable(e);if(!m||i.length===0)return[];this._resizeBuffer();const y=this.device.canvasContext.cssToDeviceRatio(),x=this.device.canvasContext.cssToDevicePixels([r,s],!0),T=x.x,S=x.y+x.height,w=this.device.canvasContext.cssToDevicePixels([r+o,s+a],!0),P=w.x+w.width,M=w.y,I={x:T,y:M,width:P-T,height:S-M},k=this._drawAndSample({layers:m,views:t,viewports:i,onViewportActive:u,deviceRect:I,cullRect:{x:r,y:s,width:o,height:a},effects:d,pass:`picking:${l}`}),D=GU(k),H=new Map,W=[],z=Number.isFinite(c);for(let j=0;j<D.length&&!(z&&W.length>=c);j++){const J=D[j];let le={color:J.pickedColor,layer:null,index:J.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:y};le=gP({layer:J.pickedLayer,info:le,mode:l});const ge=le.layer.id;H.has(ge)||H.set(ge,new Set);const te=H.get(ge),de=le.object??le.index;te.has(de)||(te.add(de),W.push(le))}return W}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:d}){const m=this._getPickable(e);if(!m||i.length===0)return[];this._resizeBuffer();const y=this.device.canvasContext.cssToDeviceRatio(),x=this.device.canvasContext.cssToDevicePixels([r,s],!0),T=x.x,S=x.y+x.height,w=this.device.canvasContext.cssToDevicePixels([r+o,s+a],!0),P=w.x+w.width,M=w.y,I={x:T,y:M,width:P-T,height:S-M},k=this._drawAndSample({layers:m,views:t,viewports:i,onViewportActive:u,deviceRect:I,cullRect:{x:r,y:s,width:o,height:a},effects:d,pass:`picking:${l}`}),D=GU(k),H=new Map,W=[],z=Number.isFinite(c);for(let j=0;j<D.length&&!(z&&W.length>=c);j++){const J=D[j];let le={color:J.pickedColor,layer:null,index:J.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:y};le=gP({layer:J.pickedLayer,info:le,mode:l});const ge=le.layer.id;H.has(ge)||H.set(ge,new Set);const te=H.get(ge),de=le.object??le.index;te.has(de)||(te.add(de),W.push(le))}return W}async _drawAndSampleAsync({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,d={layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{},isPicking:!0};for(const P of a)P.useInPicking&&(d.preRenderStats[P.id]=P.preRender(d));const{decodePickingColor:m}=this.pickLayersPass.render(d),{x:y,y:x,width:T,height:S}=s,w=new(c?Float32Array:Uint8Array)(T*S*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:y,sourceY:x,sourceWidth:T,sourceHeight:S,target:w}),{pickedColors:w,decodePickingColor:m}}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,d={layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{},isPicking:!0};for(const P of a)P.useInPicking&&(d.preRenderStats[P.id]=P.preRender(d));const{decodePickingColor:m}=this.pickLayersPass.render(d),{x:y,y:x,width:T,height:S}=s,w=new(c?Float32Array:Uint8Array)(T*S*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:y,sourceY:x,sourceWidth:T,sourceHeight:S,target:w}),{pickedColors:w,decodePickingColor:m}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const KEe={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},JEe="top-left",qU="__root";class QEe{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,t?.classList.add("deck-widget-container"),this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!pl(e.widgets,this.widgets,1)){const t=e.widgets.filter(Boolean);this._setWidgets(t)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:t}){const i=e.reduce((r,s)=>(r[s.id]=s,r),{});for(const r of this.getWidgets()){const{viewId:s}=r;if(s){const o=i[s];o&&(r.onViewportChange&&r.onViewportChange(o),r.onRedraw?.({viewports:[o],layers:t}))}else{if(r.onViewportChange)for(const o of e)r.onViewportChange(o);r.onRedraw?.({viewports:e,layers:t})}}this.lastViewports=i,this._updateContainers()}onHover(e,t){for(const i of this.getWidgets()){const{viewId:r}=i;(!r||r===e.viewport?.id)&&i.onHover?.(e,t)}}onEvent(e,t){const i=cP[t.type];if(i)for(const r of this.getWidgets()){const{viewId:s}=r;(!s||s===e.viewport?.id)&&r[i]?.(e,t)}}_setWidgets(e){const t={};for(const i of this.resolvedWidgets)t[i.id]=i;this.resolvedWidgets.length=0;for(const i of this.defaultWidgets)t[i.id]=null,this.resolvedWidgets.push(i);for(let i of e){const r=t[i.id];r?r.viewId!==i.viewId||r.placement!==i.placement?(this._removeWidget(r),this._addWidget(i)):i!==r&&(r.setProps(i.props),i=r):this._addWidget(i),t[i.id]=null,this.resolvedWidgets.push(i)}for(const i in t){const r=t[i];r&&this._removeWidget(r)}this.widgets=e}_addWidget(e){const{viewId:t=null,placement:i=JEe}=e;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:t}),e.rootElement&&this._getContainer(t,i).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,t){const i=e||qU;let r=this.containers[i];r||(r=document.createElement("div"),r.style.pointerEvents="none",r.style.position="absolute",r.style.overflow="hidden",this.parentElement?.append(r),this.containers[i]=r);let s=r.querySelector(`.${t}`);return s||(s=globalThis.document.createElement("div"),s.className=t,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,KEe[t]),r.append(s)),s}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const i in this.containers){const r=this.lastViewports[i]||null,s=i===qU||r,o=this.containers[i];s?(o.style.display="block",o.style.left=`${r?r.x:0}px`,o.style.top=`${r?r.y:0}px`,o.style.width=`${r?r.width:e}px`,o.style.height=`${r?r.height:t}px`):o.style.display="none"}}}function ZU(n,e){e&&Object.entries(e).map(([t,i])=>{t.startsWith("--")?n.style.setProperty(t,i):n.style[t]=i})}function e1e(n,e){e&&Object.keys(e).map(t=>{t.startsWith("--")?n.style.removeProperty(t):n.style[t]=""})}class bI{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const t=this.props,i=this.rootElement;i&&t.className!==e.className&&(t.className&&i.classList.remove(t.className),e.className&&i.classList.add(e.className)),i&&!pl(t.style,e.style,1)&&(e1e(i,t.style),ZU(i,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],t=document.createElement("div");return e.filter(i=>typeof i=="string"&&i.length>0).forEach(i=>t.classList.add(i)),ZU(t,this.props.style),t}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,t){}onClick(e,t){}onDrag(e,t){}onDragStart(e,t){}onDragEnd(e,t){}}bI.defaultProps={id:"widget",style:{},className:""};const t1e={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Wj extends bI{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,t1e),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,i=t&&t.props.getTooltip;if(!i)return;const r=i(e);this.lastViewport=e.viewport,this.setTooltip(r,e.x,e.y)}setTooltip(e,t,i){const r=this.rootElement;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform=`translate(${t}px, ${i}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}}Wj.defaultProps={...bI.defaultProps};var Lg;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",n[n.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.CULL_FACE=2884]="CULL_FACE",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.BLEND=3042]="BLEND",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.DITHER=3024]="DITHER",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DOUBLE=5130]="DOUBLE",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",n[n.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",n[n.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.READ_BUFFER=3074]="READ_BUFFER",n[n.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",n[n.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",n[n.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",n[n.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",n[n.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",n[n.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",n[n.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",n[n.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",n[n.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",n[n.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",n[n.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",n[n.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",n[n.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",n[n.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",n[n.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",n[n.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",n[n.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",n[n.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",n[n.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",n[n.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",n[n.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",n[n.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",n[n.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",n[n.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",n[n.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",n[n.RED=6403]="RED",n[n.RGB8=32849]="RGB8",n[n.RGBA8=32856]="RGBA8",n[n.RGB10_A2=32857]="RGB10_A2",n[n.TEXTURE_3D=32879]="TEXTURE_3D",n[n.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",n[n.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",n[n.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",n[n.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",n[n.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",n[n.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",n[n.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",n[n.SRGB=35904]="SRGB",n[n.SRGB8=35905]="SRGB8",n[n.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",n[n.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",n[n.RGBA32F=34836]="RGBA32F",n[n.RGB32F=34837]="RGB32F",n[n.RGBA16F=34842]="RGBA16F",n[n.RGB16F=34843]="RGB16F",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",n[n.R11F_G11F_B10F=35898]="R11F_G11F_B10F",n[n.RGB9_E5=35901]="RGB9_E5",n[n.RGBA32UI=36208]="RGBA32UI",n[n.RGB32UI=36209]="RGB32UI",n[n.RGBA16UI=36214]="RGBA16UI",n[n.RGB16UI=36215]="RGB16UI",n[n.RGBA8UI=36220]="RGBA8UI",n[n.RGB8UI=36221]="RGB8UI",n[n.RGBA32I=36226]="RGBA32I",n[n.RGB32I=36227]="RGB32I",n[n.RGBA16I=36232]="RGBA16I",n[n.RGB16I=36233]="RGB16I",n[n.RGBA8I=36238]="RGBA8I",n[n.RGB8I=36239]="RGB8I",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.R8=33321]="R8",n[n.RG8=33323]="RG8",n[n.R16F=33325]="R16F",n[n.R32F=33326]="R32F",n[n.RG16F=33327]="RG16F",n[n.RG32F=33328]="RG32F",n[n.R8I=33329]="R8I",n[n.R8UI=33330]="R8UI",n[n.R16I=33331]="R16I",n[n.R16UI=33332]="R16UI",n[n.R32I=33333]="R32I",n[n.R32UI=33334]="R32UI",n[n.RG8I=33335]="RG8I",n[n.RG8UI=33336]="RG8UI",n[n.RG16I=33337]="RG16I",n[n.RG16UI=33338]="RG16UI",n[n.RG32I=33339]="RG32I",n[n.RG32UI=33340]="RG32UI",n[n.R8_SNORM=36756]="R8_SNORM",n[n.RG8_SNORM=36757]="RG8_SNORM",n[n.RGB8_SNORM=36758]="RGB8_SNORM",n[n.RGBA8_SNORM=36759]="RGBA8_SNORM",n[n.RGB10_A2UI=36975]="RGB10_A2UI",n[n.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",n[n.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.HALF_FLOAT=5131]="HALF_FLOAT",n[n.RG=33319]="RG",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",n[n.CURRENT_QUERY=34917]="CURRENT_QUERY",n[n.QUERY_RESULT=34918]="QUERY_RESULT",n[n.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",n[n.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",n[n.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",n[n.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",n[n.DRAW_BUFFER0=34853]="DRAW_BUFFER0",n[n.DRAW_BUFFER1=34854]="DRAW_BUFFER1",n[n.DRAW_BUFFER2=34855]="DRAW_BUFFER2",n[n.DRAW_BUFFER3=34856]="DRAW_BUFFER3",n[n.DRAW_BUFFER4=34857]="DRAW_BUFFER4",n[n.DRAW_BUFFER5=34858]="DRAW_BUFFER5",n[n.DRAW_BUFFER6=34859]="DRAW_BUFFER6",n[n.DRAW_BUFFER7=34860]="DRAW_BUFFER7",n[n.DRAW_BUFFER8=34861]="DRAW_BUFFER8",n[n.DRAW_BUFFER9=34862]="DRAW_BUFFER9",n[n.DRAW_BUFFER10=34863]="DRAW_BUFFER10",n[n.DRAW_BUFFER11=34864]="DRAW_BUFFER11",n[n.DRAW_BUFFER12=34865]="DRAW_BUFFER12",n[n.DRAW_BUFFER13=34866]="DRAW_BUFFER13",n[n.DRAW_BUFFER14=34867]="DRAW_BUFFER14",n[n.DRAW_BUFFER15=34868]="DRAW_BUFFER15",n[n.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",n[n.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",n[n.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",n[n.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",n[n.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",n[n.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",n[n.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",n[n.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",n[n.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",n[n.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",n[n.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",n[n.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",n[n.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",n[n.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",n[n.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",n[n.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",n[n.SAMPLER_3D=35679]="SAMPLER_3D",n[n.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",n[n.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",n[n.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",n[n.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",n[n.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",n[n.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",n[n.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",n[n.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",n[n.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",n[n.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",n[n.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",n[n.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",n[n.MAX_SAMPLES=36183]="MAX_SAMPLES",n[n.SAMPLER_BINDING=35097]="SAMPLER_BINDING",n[n.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",n[n.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",n[n.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",n[n.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",n[n.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",n[n.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",n[n.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",n[n.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",n[n.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",n[n.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",n[n.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",n[n.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",n[n.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",n[n.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",n[n.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",n[n.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",n[n.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",n[n.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",n[n.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",n[n.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",n[n.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",n[n.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",n[n.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",n[n.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",n[n.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",n[n.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",n[n.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",n[n.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",n[n.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",n[n.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",n[n.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",n[n.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",n[n.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",n[n.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",n[n.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",n[n.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",n[n.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",n[n.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",n[n.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",n[n.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",n[n.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n[n.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",n[n.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",n[n.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",n[n.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",n[n.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",n[n.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",n[n.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",n[n.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",n[n.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",n[n.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",n[n.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",n[n.UNIFORM_TYPE=35383]="UNIFORM_TYPE",n[n.UNIFORM_SIZE=35384]="UNIFORM_SIZE",n[n.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",n[n.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",n[n.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",n[n.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",n[n.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",n[n.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",n[n.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",n[n.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",n[n.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",n[n.OBJECT_TYPE=37138]="OBJECT_TYPE",n[n.SYNC_CONDITION=37139]="SYNC_CONDITION",n[n.SYNC_STATUS=37140]="SYNC_STATUS",n[n.SYNC_FLAGS=37141]="SYNC_FLAGS",n[n.SYNC_FENCE=37142]="SYNC_FENCE",n[n.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",n[n.UNSIGNALED=37144]="UNSIGNALED",n[n.SIGNALED=37145]="SIGNALED",n[n.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",n[n.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",n[n.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",n[n.WAIT_FAILED=37149]="WAIT_FAILED",n[n.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",n[n.COLOR=6144]="COLOR",n[n.DEPTH=6145]="DEPTH",n[n.STENCIL=6146]="STENCIL",n[n.MIN=32775]="MIN",n[n.MAX=32776]="MAX",n[n.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",n[n.STREAM_READ=35041]="STREAM_READ",n[n.STREAM_COPY=35042]="STREAM_COPY",n[n.STATIC_READ=35045]="STATIC_READ",n[n.STATIC_COPY=35046]="STATIC_COPY",n[n.DYNAMIC_READ=35049]="DYNAMIC_READ",n[n.DYNAMIC_COPY=35050]="DYNAMIC_COPY",n[n.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",n[n.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",n[n.INVALID_INDEX=4294967295]="INVALID_INDEX",n[n.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",n[n.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",n[n.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",n[n.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",n[n.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",n[n.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",n[n.R16_EXT=33322]="R16_EXT",n[n.RG16_EXT=33324]="RG16_EXT",n[n.RGB16_EXT=32852]="RGB16_EXT",n[n.RGBA16_EXT=32859]="RGBA16_EXT",n[n.R16_SNORM_EXT=36760]="R16_SNORM_EXT",n[n.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",n[n.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",n[n.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",n[n.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",n[n.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",n[n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",n[n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",n[n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",n[n.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",n[n.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",n[n.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",n[n.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",n[n.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",n[n.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",n[n.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",n[n.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",n[n.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",n[n.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",n[n.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",n[n.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",n[n.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",n[n.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",n[n.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",n[n.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",n[n.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",n[n.LINE_WEBGL=6913]="LINE_WEBGL",n[n.FILL_WEBGL=6914]="FILL_WEBGL",n[n.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",n[n.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",n[n.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",n[n.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",n[n.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",n[n.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",n[n.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",n[n.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",n[n.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",n[n.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",n[n.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",n[n.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",n[n.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",n[n.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",n[n.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",n[n.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",n[n.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",n[n.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",n[n.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",n[n.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",n[n.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",n[n.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",n[n.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",n[n.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Lg||(Lg={}));const n1e={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},i1e=n=>({drawBuffersWEBGL(e){return n.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),r1e=n=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return n.createVertexArray()},deleteVertexArrayOES(e){return n.deleteVertexArray(e)},isVertexArrayOES(e){return n.isVertexArray(e)},bindVertexArrayOES(e){return n.bindVertexArray(e)}}),s1e=n=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return n.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return n.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return n.vertexAttribDivisor(...e)}});function o1e(n=!0){const e=HTMLCanvasElement.prototype;if(!n&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(t,i){if(t==="webgl"||t==="experimental-webgl"){const r=this.originalGetContext("webgl2",i);return r instanceof HTMLElement&&a1e(r),r}return this.originalGetContext(t,i)}}function a1e(n){n.getExtension("EXT_color_buffer_float");const e={...n1e,WEBGL_disjoint_timer_query:n.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:i1e(n),OES_vertex_array_object:r1e(n),ANGLE_instanced_arrays:s1e(n)},t=n.getExtension;n.getExtension=function(r){const s=t.call(n,r);return s||(r in e?e[r]:null)};const i=n.getSupportedExtensions;n.getSupportedExtensions=function(){return(i.apply(n)||[])?.concat(Object.keys(e))}}async function jj(n,e){const t=document.getElementsByTagName("head")[0];if(!t)throw new Error("loadScript");const i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",n),new Promise((r,s)=>{i.onload=r,i.onerror=o=>s(new Error(`Unable to load script '${n}': ${o}`)),t.appendChild(i)})}const l1e=1;let Ua=null,KU=!1;const wI={debugSpectorJS:Qe.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function c1e(n){if(!globalThis.SPECTOR)try{await jj(n.debugSpectorJSUrl||wI.debugSpectorJSUrl)}catch(e){Qe.warn(String(e))}}function u1e(n){if(n={...wI,...n},!n.debugSpectorJS)return null;if(!Ua&&globalThis.SPECTOR&&!globalThis.luma?.spector){Qe.probe(l1e,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Ua=new e,globalThis.luma&&(globalThis.luma.spector=Ua)}if(!Ua)return null;if(KU||(KU=!0,Ua.spyCanvases(),Ua?.onCaptureStarted.add(e=>Qe.info("Spector capture started:",e)()),Ua?.onCapture.add(e=>{Qe.info("Spector capture complete:",e)(),Ua?.getResultUI(),Ua?.resultView.display(),Ua?.resultView.addCapture(e)})),n.gl){const e=n.gl,t=e.device;Ua?.startCapture(n.gl,500),e.device=t,new Promise(i=>setTimeout(i,2e3)).then(i=>{Qe.info("Spector capture stopped after 2 seconds")(),Ua?.stopCapture()})}return Ua}const h1e="https://unpkg.com/webgl-debug@2.0.1/index.js";function $j(n){return n.luma=n.luma||{},n.luma}async function f1e(){um()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await jj(h1e))}function d1e(n,e={}){return e.debugWebGL||e.traceWebGL?m1e(n,e):p1e(n)}function p1e(n){const e=$j(n);return e.realContext?e.realContext:n}function m1e(n,e){if(!globalThis.WebGLDebugUtils)return Qe.warn("webgl-debug not loaded")(),n;const t=$j(n);if(t.debugContext)return t.debugContext;globalThis.WebGLDebugUtils.init({...Lg,...n});const i=globalThis.WebGLDebugUtils.makeDebugContext(n,g1e.bind(null,e),_1e.bind(null,e));for(const o in Lg)!(o in i)&&typeof Lg[o]=="number"&&(i[o]=Lg[o]);class r{}Object.setPrototypeOf(i,Object.getPrototypeOf(n)),Object.setPrototypeOf(r,i);const s=Object.create(r);return t.realContext=n,t.debugContext=s,s.debug=!0,s}function JU(n,e){e=Array.from(e).map(i=>i===void 0?"undefined":i);let t=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,e);return t=`${t.slice(0,100)}${t.length>100?"...":""}`,`gl.${n}(${t})`}function g1e(n,e,t,i){i=Array.from(i).map(a=>a===void 0?"undefined":a);const r=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,i),o=`${r} in gl.${t}(${s})`;Qe.error(o)();debugger}function _1e(n,e,t){let i="";Qe.level>=1&&(i=JU(e,t),n.traceWebGL&&Qe.log(1,i)());for(const r of t)if(r===void 0){i=i||JU(e,t);debugger}}const Kb=1;class y1e extends _xe{type="webgl";constructor(){super(),Kp.defaultProps={...Kp.defaultProps,...wI}}enforceWebGL2(e){o1e(e)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext&&Qe.warn("WebGL1 is not supported",e)(),!1)}async attach(e,t={}){const{WebGLDevice:i}=await $C(async()=>{const{WebGLDevice:s}=await Promise.resolve().then(()=>pB);return{WebGLDevice:s}},void 0);if(e instanceof i)return e;if(e?.device instanceof i)return e.device;if(!v1e(e))throw new Error("Invalid WebGL2RenderingContext");const r=t.createCanvasContext===!0?{}:t.createCanvasContext;return new i({...t,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...r}})}async create(e={}){const{WebGLDevice:t}=await $C(async()=>{const{WebGLDevice:i}=await Promise.resolve().then(()=>pB);return{WebGLDevice:i}},void 0);Qe.groupCollapsed(Kb,"WebGLDevice created")();try{const i=[];(e.debugWebGL||e.debug)&&i.push(f1e()),e.debugSpectorJS&&i.push(c1e(e));const r=await Promise.allSettled(i);for(const a of r)a.status==="rejected"&&Qe.error(`Failed to initialize debug libraries ${a.reason}`)();const s=new t(e),o=`${s._reused?"Reusing":"Created"} device with WebGL2 ${s.props.debug?"debug ":""}context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return Qe.probe(Kb,o)(),Qe.table(Kb,s.info)(),s}finally{Qe.groupEnd(Kb)()}}}function v1e(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext?!0:!!(n&&Number.isFinite(n._version))}const WA=new y1e,SI={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Vr=(n,e,t)=>e?n.enable(t):n.disable(t),QU=(n,e,t)=>n.hint(t,e),Ba=(n,e,t)=>n.pixelStorei(t,e),eB=(n,e,t)=>{const i=t===36006?36009:36008;return n.bindFramebuffer(i,e)},Ey=(n,e,t)=>{const r={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[t];n.bindBuffer(r,e)};function jA(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}const x1e={3042:Vr,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:Vr,2885:(n,e)=>n.cullFace(e),2929:Vr,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:Vr,35723:QU,35725:(n,e)=>n.useProgram(e),36007:(n,e)=>n.bindRenderbuffer(36161,e),36389:(n,e)=>n.bindTransformFeedback?.(36386,e),34229:(n,e)=>n.bindVertexArray(e),36006:eB,36010:eB,34964:Ey,36662:Ey,36663:Ey,35053:Ey,35055:Ey,2886:(n,e)=>n.frontFace(e),33170:QU,2849:(n,e)=>n.lineWidth(e),32823:Vr,32824:"polygonOffset",10752:"polygonOffset",35977:Vr,32926:Vr,32928:Vr,32938:"sampleCoverage",32939:"sampleCoverage",3089:Vr,3088:(n,e)=>n.scissor(...e),2960:Vr,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),34383:Vr,10754:Vr,12288:Vr,12289:Vr,12290:Vr,12291:Vr,12292:Vr,12293:Vr,12294:Vr,12295:Vr,3333:Ba,3317:Ba,37440:Ba,37441:Ba,37443:Ba,3330:Ba,3332:Ba,3331:Ba,3314:Ba,32878:Ba,3316:Ba,3315:Ba,32877:Ba,framebuffer:(n,e)=>{const t=e&&"handle"in e?e.handle:e;return n.bindFramebuffer(36160,t)},blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{const t=typeof e=="number"?[e,e]:e;n.blendEquationSeparate(...t)},blendFunc:(n,e)=>{const t=e?.length===2?[...e,...e]:e;n.blendFuncSeparate(...t)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(e[0],e[1]||!1),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=jA(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=jA(e)&&e.length===3?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=jA(e)&&e.length===3?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function ur(n,e,t){return e[n]!==void 0?e[n]:t[n]}const b1e={blendEquation:(n,e,t)=>n.blendEquationSeparate(ur(32777,e,t),ur(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(ur(32969,e,t),ur(32968,e,t),ur(32971,e,t),ur(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(ur(32824,e,t),ur(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(ur(32938,e,t),ur(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,ur(2962,e,t),ur(2967,e,t),ur(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,ur(34816,e,t),ur(36003,e,t),ur(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,ur(2964,e,t),ur(2965,e,t),ur(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,ur(34817,e,t),ur(34818,e,t),ur(34819,e,t))},tB={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),useProgram:(n,e)=>n({35725:e}),bindRenderbuffer:(n,e,t)=>n({36007:t}),bindTransformFeedback:(n,e,t)=>n({36389:t}),bindVertexArray:(n,e)=>n({34229:e}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},bindBuffer:(n,e,t)=>{const i={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return i?n({[i]:t}):{valueChanged:!0}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[e===1028?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[e===1028?2962:34816]:t,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[e===1028?2964:34817]:t,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Hc=(n,e)=>n.isEnabled(e),nB={3042:Hc,2884:Hc,2929:Hc,3024:Hc,32823:Hc,32926:Hc,32928:Hc,3089:Hc,2960:Hc,35977:Hc},w1e=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function F_(n,e){if(T1e(e))return;const t={};for(const r in e){const s=Number(r),o=x1e[r];o&&(typeof o=="string"?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t){const s=b1e[r];s(n,e,i)}}function Xj(n,e=SI){if(typeof e=="number"){const r=e,s=nB[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=nB[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}function S1e(n){F_(n,SI)}function T1e(n){for(const e in n)return!1;return!0}function E1e(n,e){if(n===e)return!0;if(iB(n)&&iB(e)&&n.length===e.length){for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}return!1}function iB(n){return Array.isArray(n)||ArrayBuffer.isView(n)}class Up{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];F_(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t?.copyState?Xj(e):Object.assign({},SI),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,M1e(e);for(const i in tB){const r=tB[i];A1e(e,i,r)}rB(e,"getParameter"),rB(e,"isEnabled")}_updateCache(e){let t=!1,i;const r=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){const o=e[s],a=this.cache[s];E1e(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function rB(n,e){const t=n[e].bind(n);n[e]=function(r){if(r===void 0||w1e.has(r))return t(r);const s=Up.get(n);return r in s.cache||(s.cache[r]=t(r)),s.enable?s.cache[r]:t(r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function A1e(n,e,t){if(!n[e])return;const i=n[e].bind(n);n[e]=function(...s){const o=Up.get(n),{valueChanged:a,oldValue:l}=t(o._updateCache,...s);return a&&i(...s),l},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}function M1e(n){const e=n.useProgram.bind(n);n.useProgram=function(i){const r=Up.get(n);r.program!==i&&(e(i),r.program=i)}}function C1e(n,e,t){let i="";const r={preserveDrawingBuffer:!0,...t};let s=null;if(s||=n.getContext("webgl2",r),r.failIfMajorPerformanceCaveat&&(i||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!s&&!t.failIfMajorPerformanceCaveat&&(r.failIfMajorPerformanceCaveat=!1,s=n.getContext("webgl2",r),s.luma||={},s.luma.softwareRenderer=!0),s||(s=n.getContext("webgl",{}),s&&(s=null,i||="Your browser only supports WebGL1")),!s)throw i||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${i}`);const{onContextLost:o,onContextRestored:a}=e;return n.addEventListener("webglcontextlost",l=>o(l),!1),n.addEventListener("webglcontextrestored",l=>a(l),!1),s.luma||={},s}function x_(n,e,t){return t[e]===void 0&&(t[e]=n.getExtension(e)||null),t[e]}function P1e(n,e){const t=n.getParameter(7936),i=n.getParameter(7937);x_(n,"WEBGL_debug_renderer_info",e);const r=e.WEBGL_debug_renderer_info,s=n.getParameter(r?r.UNMASKED_VENDOR_WEBGL:7936),o=n.getParameter(r?r.UNMASKED_RENDERER_WEBGL:7937),a=s||t,l=o||i,c=n.getParameter(7938),u=Gj(a,l),d=R1e(a,l),m=I1e(a,l);return{type:"webgl",gpu:u,gpuType:m,gpuBackend:d,vendor:a,renderer:l,version:c,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Gj(n,e){return/NVIDIA/i.exec(n)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(n)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(n)||/Apple/i.exec(e)?"apple":/AMD/i.exec(n)||/AMD/i.exec(e)||/ATI/i.exec(n)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e)?"software":"unknown"}function R1e(n,e){return/Metal/i.exec(n)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(n)||/ANGLE/i.exec(e)?"opengl":"unknown"}function I1e(n,e){if(/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e))return"cpu";switch(Gj(n,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function Yj(n){switch(n){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(n))}const Vy="WEBGL_compressed_texture_s3tc",Hy="WEBGL_compressed_texture_s3tc_srgb",Ng="EXT_texture_compression_rgtc",Dg="EXT_texture_compression_bptc",k1e="WEBGL_compressed_texture_etc",O1e="WEBGL_compressed_texture_astc",L1e="WEBGL_compressed_texture_etc1",N1e="WEBGL_compressed_texture_pvrtc",D1e="WEBGL_compressed_texture_atc",sB="EXT_texture_norm16",oB="EXT_render_snorm",F1e="EXT_color_buffer_float",TI={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[oB],"norm16-renderable-webgl":[sB],"snorm16-renderable-webgl":[sB,oB],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Vy,Hy,Ng,Dg],"texture-compression-bc5-webgl":[Ng],"texture-compression-bc7-webgl":[Dg],"texture-compression-etc2":[k1e],"texture-compression-astc":[O1e],"texture-compression-etc1-webgl":[L1e],"texture-compression-pvrtc-webgl":[N1e],"texture-compression-atc-webgl":[D1e]};function U1e(n){return n in TI}function B1e(n,e,t){return(TI[e]||[]).every(r=>x_(n,r,t))}const EI={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:F1e,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Vy},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Hy},"bc1-rgba-unorm":{gl:33777,x:Vy},"bc1-rgba-unorm-srgb":{gl:35916,x:Hy},"bc2-rgba-unorm":{gl:33778,x:Vy},"bc2-rgba-unorm-srgb":{gl:35918,x:Hy},"bc3-rgba-unorm":{gl:33779,x:Vy},"bc3-rgba-unorm-srgb":{gl:35919,x:Hy},"bc4-r-unorm":{gl:36283,x:Ng},"bc4-r-snorm":{gl:36284,x:Ng},"bc5-rg-unorm":{gl:36285,x:Ng},"bc5-rg-snorm":{gl:36286,x:Ng},"bc6h-rgb-ufloat":{gl:36495,x:Dg},"bc6h-rgb-float":{gl:36494,x:Dg},"bc7-rgba-unorm":{gl:36492,x:Dg},"bc7-rgba-unorm-srgb":{gl:36493,x:Dg},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function z1e(n,e,t){let i=e.create;const r=EI[e.format];return r?.gl===void 0&&(i=!1),r?.x&&(i=i&&!!x_(n,r.x,t)),{format:e.format,create:i&&e.create,render:i&&e.render,filter:i&&e.filter,blend:i&&e.blend,store:i&&e.store}}function qj(n){const e=EI[n],t=W1e(n),i=Gg.getInfo(n);return i.compressed&&(e.dataFormat=t),{internalFormat:t,format:e?.dataFormat||H1e(i.channels,i.integer,i.normalized,t),type:i.dataType?Yj(i.dataType):e?.types?.[0]||5121,compressed:i.compressed||!1}}function V1e(n){switch(Gg.getInfo(n).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${n}`)}}function H1e(n,e,t,i){if(i===6408||i===6407)return i;switch(n){case"r":return e&&!t?36244:6403;case"rg":return e&&!t?33320:33319;case"rgb":return e&&!t?36248:6407;case"rgba":return e&&!t?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function W1e(n){const t=EI[n]?.gl;if(t===void 0)throw new Error(`Unsupported texture format ${n}`);return t}const aB={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class j1e extends mxe{gl;extensions;testedFeatures=new Set;constructor(e,t,i){super([],i),this.gl=e,this.extensions=t,x_(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),U1e(e)&&B1e(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(t=>t!=="polygon-mode-webgl");for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(aB),...Object.keys(TI)]}getWebGLFeature(e){const t=aB[e];return typeof t=="string"?!!x_(this.gl,t,this.extensions):!!t}}class $1e extends pxe{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class uv extends jT{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const i=t.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const i=this.colorAttachments[t];if(i){const r=36064+t;this._attachTextureView(r,i)}}if(this.depthStencilAttachment){const t=V1e(this.depthStencilAttachment.props.format);this._attachTextureView(t,this.depthStencilAttachment)}if(this.device.props.debug){const t=this.gl.checkFramebufferStatus(36160);if(t!==36053)throw new Error(`Framebuffer ${G1e(t)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:i}=this.device,{texture:r}=t,s=t.props.baseMipLevel,o=t.props.baseArrayLayer;switch(i.bindTexture(r.glTarget,r.handle),r.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,e,r.handle,s,o);break;case 34067:const a=X1e(o);i.framebufferTexture2D(36160,e,a,r.handle,s);break;case 3553:i.framebufferTexture2D(36160,e,3553,r.handle,s);break;default:throw new Error("Illegal texture type")}i.bindTexture(r.glTarget,null)}}function X1e(n){return n<34069?n+34069:n}function G1e(n){switch(n){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${n}`}}class Y1e extends Sp{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new uv(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}const $A={};function q1e(n="id"){$A[n]=$A[n]||1;const e=$A[n]++;return`${n}-${e}`}class hv extends gr{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,t={}){super(e,t),this.device=e,this.gl=this.device.gl;const i=typeof t=="object"?t.handle:void 0;this.handle=i||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=Z1e(this.props.usage),this.glUsage=K1e(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,t=0,i=e.byteLength+t){const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.glUsage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(e,t,i),this.trackAllocatedMemory(i)}_initWithByteLength(e){let t=e;e===0&&(t=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,t,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,t=0){const i=ArrayBuffer.isView(e)?e:new Uint8Array(e),r=36663;this.gl.bindBuffer(r,this.handle),this.gl.bufferSubData(r,t,i),this.gl.bindBuffer(r,null),this._setDebugData(e,t,e.byteLength)}async mapAndWriteAsync(e,t=0,i=this.byteLength-t){const r=new ArrayBuffer(i);await e(r,"copied"),this.write(r,t)}async readAsync(e=0,t){return this.readSyncWebGL(e,t)}async mapAndReadAsync(e,t=0,i){const r=await this.readAsync(t,i);return await e(r.buffer,"copied")}readSyncWebGL(e=0,t){t=t??this.byteLength-e;const i=new Uint8Array(t),r=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,i,r,t),this.gl.bindBuffer(36662,null),this._setDebugData(i,e,t),i}}function Z1e(n){return n&gr.INDEX?34963:n&gr.VERTEX?34962:n&gr.UNIFORM?35345:34962}function K1e(n){return n&gr.INDEX||n&gr.VERTEX?35044:n&gr.UNIFORM?35048:35044}function J1e(n){const e=n.split(/\r?\n/),t=[];for(const i of e){if(i.length<=1)continue;const r=i.split(":");if(r.length===2){const[d,m]=r;t.push({message:m.trim(),type:lB(d),lineNum:0,linePos:0});continue}const[s,o,a,...l]=r;let c=parseInt(a,10);isNaN(c)&&(c=0);let u=parseInt(o,10);isNaN(u)&&(u=0),t.push({message:l.join(":").trim(),type:lB(s),lineNum:c,linePos:u})}return t}function lB(n){const e=["warning","error","info"],t=n.toLowerCase();return e.includes(t)?t:"info"}class Q1e extends WT{device;handle;constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?J1e(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}Qe.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Qe.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async r=>await new Promise(s=>setTimeout(s,r));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function eAe(n,e,t,i){if(rAe(e))return i(n);const r=n;r.pushState();try{return tAe(n,e),F_(r.gl,t),i(n)}finally{r.popState()}}function tAe(n,e){const t=n,{gl:i}=t;if(e.cullMode)switch(e.cullMode){case"none":i.disable(2884);break;case"front":i.enable(2884),i.cullFace(1028);break;case"back":i.enable(2884),i.cullFace(1029);break}if(e.frontFace&&i.frontFace(Bp("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&n.features.has("depth-clip-control")&&i.enable(34383),e.depthBias!==void 0&&(i.enable(32823),i.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&n.features.has("provoking-vertex-webgl")){const s=t.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=Bp("provokingVertex",e.provokingVertex,{first:36429,last:36430});s?.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&n.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=t.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=Bp("polygonMode",e.polygonMode,{fill:6914,line:6913});s?.polygonModeWEBGL(1028,o),s?.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&i.enable(10754)}if(n.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&i.enable(12288),e.clipDistance1&&i.enable(12289),e.clipDistance2&&i.enable(12290),e.clipDistance3&&i.enable(12291),e.clipDistance4&&i.enable(12292),e.clipDistance5&&i.enable(12293),e.clipDistance6&&i.enable(12294),e.clipDistance7&&i.enable(12295)),e.depthWriteEnabled!==void 0&&i.depthMask(iAe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?i.enable(2929):i.disable(2929),i.depthFunc(_P("depthCompare",e.depthCompare))),e.stencilWriteMask){const r=e.stencilWriteMask;i.stencilMaskSeparate(1028,r),i.stencilMaskSeparate(1029,r)}if(e.stencilReadMask&&Qe.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const r=e.stencilReadMask||4294967295,s=_P("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?i.enable(2960):i.disable(2960),i.stencilFuncSeparate(1028,s,0,r),i.stencilFuncSeparate(1029,s,0,r)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const r=XA("stencilPassOperation",e.stencilPassOperation),s=XA("stencilFailOperation",e.stencilFailOperation),o=XA("stencilDepthFailOperation",e.stencilDepthFailOperation);i.stencilOpSeparate(1028,s,o,r),i.stencilOpSeparate(1029,s,o,r)}switch(e.blend){case!0:i.enable(3042);break;case!1:i.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const r=cB("blendColorOperation",e.blendColorOperation||"add"),s=cB("blendAlphaOperation",e.blendAlphaOperation||"add");i.blendEquationSeparate(r,s);const o=Jb("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=Jb("blendColorDstFactor",e.blendColorDstFactor||"zero"),l=Jb("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),c=Jb("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");i.blendFuncSeparate(o,a,l,c)}}function _P(n,e){return Bp(n,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function XA(n,e){return Bp(n,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function cB(n,e){return Bp(n,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Jb(n,e,t="color"){return Bp(n,e,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:t==="color"?32769:32771,"one-minus-constant":t==="color"?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function nAe(n,e){return`Illegal parameter ${e} for ${n}`}function Bp(n,e,t){if(!(e in t))throw new Error(nAe(n,e));return t[e]}function iAe(n,e){return e}function rAe(n){let e=!0;for(const t in n){e=!1;break}return e}function Zj(n){const e={};return n.addressModeU&&(e[10242]=GA(n.addressModeU)),n.addressModeV&&(e[10243]=GA(n.addressModeV)),n.addressModeW&&(e[32882]=GA(n.addressModeW)),n.magFilter&&(e[10240]=yP(n.magFilter)),(n.minFilter||n.mipmapFilter)&&(e[10241]=sAe(n.minFilter||"linear",n.mipmapFilter)),n.lodMinClamp!==void 0&&(e[33082]=n.lodMinClamp),n.lodMaxClamp!==void 0&&(e[33083]=n.lodMaxClamp),n.type==="comparison-sampler"&&(e[34892]=34894),n.compare&&(e[34893]=_P("compare",n.compare)),n.maxAnisotropy&&(e[34046]=n.maxAnisotropy),e}function GA(n){switch(n){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function yP(n){switch(n){case"nearest":return 9728;case"linear":return 9729}}function sAe(n,e="none"){if(!e)return yP(n);switch(e){case"none":return yP(n);case"nearest":switch(n){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(n){case"nearest":return 9986;case"linear":return 9987}}}class oAe extends Jp{device;handle;parameters;constructor(e,t){super(e,t),this.device=e,this.parameters=Zj(t),this.handle=t.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,i]of Object.entries(e)){const r=Number(t);switch(r){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,r,i);break;default:this.device.gl.samplerParameteri(this.handle,r,i);break}}}}function o0(n,e,t){if(aAe(e))return t(n);const{nocatch:i=!0}=e,r=Up.get(n);r.push(),F_(n,e);let s;if(i)s=t(n),r.pop();else try{s=t(n)}finally{r.pop()}return s}function aAe(n){for(const e in n)return!1;return!0}class Fg extends HT{device;gl;handle;texture;constructor(e,t){super(e,{...ts.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}class fv extends ts{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,t){super(e,t),this.device=e,this.gl=this.device.gl;const i=qj(this.props.format);this.glTarget=lAe(this.props.dimension),this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:r,width:s,height:o,depth:a,mipLevels:l,glTarget:c,glInternalFormat:u}=this;switch(r){case"2d":case"cube":this.gl.texStorage2D(c,l,u,s,o);break;case"2d-array":case"3d":this.gl.texStorage3D(c,l,u,s,o,a);break;default:throw new Error(r)}this.gl.bindTexture(this.glTarget,null),this._initializeData(t.data),this.setSampler(this.props.sampler),this.view=new Fg(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new Fg(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);const t=Zj(this.sampler.props);this._setSamplerParameters(t)}copyImageData(e){const t=this._normalizeCopyImageDataOptions(e),i=t.data,{width:r,height:s,depth:o}=this,{mipLevel:a=0,byteOffset:l=0,x:c=0,y:u=0,z:d=0}=t,{glFormat:m,glType:y,compressed:x}=this,T=uB(this.glTarget,this.dimension,d);let S;if(!this.compressed){const{bytesPerPixel:P}=this.device.getTextureFormatInfo(this.format);if(P){if(t.bytesPerRow%P!==0)throw new Error(`bytesPerRow (${t.bytesPerRow}) must be a multiple of bytesPerPixel (${P}) for ${this.format}`);S=t.bytesPerRow/P}}const w=this.compressed?{}:{...S!==void 0?{3314:S}:{},32878:t.rowsPerImage};this.gl.bindTexture(T,this.handle),o0(this.gl,w,()=>{switch(this.dimension){case"2d":case"cube":x?this.gl.compressedTexSubImage2D(T,a,c,u,r,s,m,i,l):this.gl.texSubImage2D(T,a,c,u,r,s,m,y,i,l);break;case"2d-array":case"3d":x?this.gl.compressedTexSubImage3D(T,a,c,u,d,r,s,o,m,i,l):this.gl.texSubImage3D(T,a,c,u,d,r,s,o,m,y,i,l);break;default:}}),this.gl.bindTexture(T,null)}copyExternalImage(e){const t=this._normalizeCopyExternalImageOptions(e);if(t.sourceX||t.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:i,glType:r}=this,{image:s,depth:o,mipLevel:a,x:l,y:c,z:u,width:d,height:m}=t,y=uB(this.glTarget,this.dimension,o),x=t.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),o0(this.gl,x,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(y,a,l,c,d,m,i,r,s);break;case"2d-array":case"3d":this.gl.texSubImage3D(y,a,l,c,u,d,m,o,i,r,s);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:t.width,height:t.height}}generateMipmapsWebGL(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(Qe.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(i){Qe.warn(`Error generating mipmap for ${this}: ${i.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){Qe.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,i]of Object.entries(e)){const r=Number(t),s=i;switch(r){case 33082:case 33083:this.gl.texParameterf(this.glTarget,r,s);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,r,s);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,r,s);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,r,s);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,r,s);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){const{gl:t}=this;return e!==void 0&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}_unbind(e){const{gl:t}=this;return e!==void 0&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}function lAe(n){switch(n){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(n)}function uB(n,e,t){return e==="cube"?34069+t:n}function cAe(n){return dAe[n]}function AI(n){return fAe[n]}function uAe(n){return!!Kj[n]}function hAe(n){return Kj[n]}const fAe={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},Kj={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},dAe={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126};function pAe(n,e){const t={attributes:[],bindings:[]};t.attributes=mAe(n,e);const i=yAe(n,e);for(const a of i){const l=a.uniforms.map(c=>({name:c.name,format:c.format,byteOffset:c.byteOffset,byteStride:c.byteStride,arrayLength:c.arrayLength}));t.bindings.push({type:"uniform",name:a.name,group:0,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:l})}const r=_Ae(n,e);let s=0;for(const a of r)if(uAe(a.type)){const{viewDimension:l,sampleType:c}=hAe(a.type);t.bindings.push({type:"texture",name:a.name,group:0,location:s,viewDimension:l,sampleType:c}),a.textureUnit=s,s+=1}r.length&&(t.uniforms=r);const o=gAe(n,e);return o?.length&&(t.varyings=o),t}function mAe(n,e){const t=[],i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r);if(!s)throw new Error("activeInfo");const{name:o,type:a}=s,l=n.getAttribLocation(e,o);if(l>=0){const c=AI(a),u=/instance/i.test(o)?"instance":"vertex";t.push({name:o,location:l,stepMode:u,type:c})}}return t.sort((r,s)=>r.location-s.location),t}function gAe(n,e){const t=[],i=n.getProgramParameter(e,35971);for(let r=0;r<i;r++){const s=n.getTransformFeedbackVarying(e,r);if(!s)throw new Error("activeInfo");const{name:o,type:a,size:l}=s,c=AI(a),{type:u,components:d}=FW(c);t.push({location:r,name:o,type:u,size:l*d})}return t.sort((r,s)=>r.location-s.location),t}function _Ae(n,e){const t=[],i=n.getProgramParameter(e,35718);for(let r=0;r<i;r++){const s=n.getActiveUniform(e,r);if(!s)throw new Error("activeInfo");const{name:o,size:a,type:l}=s,{name:c,isArray:u}=vAe(o);let d=n.getUniformLocation(e,c);const m={location:d,name:c,size:a,type:l,isArray:u};if(t.push(m),m.size>1)for(let y=0;y<m.size;y++){const x=`${c}[${y}]`;d=n.getUniformLocation(e,x);const T={...m,name:x,location:d};t.push(T)}}return t}function yAe(n,e){const t=(s,o)=>n.getActiveUniformBlockParameter(e,s,o),i=[],r=n.getProgramParameter(e,35382);for(let s=0;s<r;s++){const o={name:n.getActiveUniformBlockName(e,s)||"",location:t(s,35391),byteLength:t(s,35392),vertex:t(s,35396),fragment:t(s,35398),uniformCount:t(s,35394),uniforms:[]},a=t(s,35395)||[],l=n.getActiveUniforms(e,a,35383),c=n.getActiveUniforms(e,a,35384),u=n.getActiveUniforms(e,a,35387),d=n.getActiveUniforms(e,a,35388);for(let m=0;m<o.uniformCount;++m){const y=n.getActiveUniform(e,a[m]);if(!y)throw new Error("activeInfo");const x=AI(l[m]);o.uniforms.push({name:y.name,format:x,type:l[m],arrayLength:c[m],byteOffset:u[m],byteStride:d[m]})}i.push(o)}return i.sort((s,o)=>s.location-o.location),i}function vAe(n){if(n[n.length-1]!=="]")return{name:n,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(n);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]?1:0,isArray:!!t[2]}}function xAe(n,e,t,i){const r=n;let s=i;s===!0&&(s=1),s===!1&&(s=0);const o=typeof s=="number"?[s]:s;switch(t){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof i!="number")throw new Error("samplers must be set to integers");return n.uniform1i(e,i);case 5126:return n.uniform1fv(e,o);case 35664:return n.uniform2fv(e,o);case 35665:return n.uniform3fv(e,o);case 35666:return n.uniform4fv(e,o);case 5124:return n.uniform1iv(e,o);case 35667:return n.uniform2iv(e,o);case 35668:return n.uniform3iv(e,o);case 35669:return n.uniform4iv(e,o);case 35670:return n.uniform1iv(e,o);case 35671:return n.uniform2iv(e,o);case 35672:return n.uniform3iv(e,o);case 35673:return n.uniform4iv(e,o);case 5125:return r.uniform1uiv(e,o,1);case 36294:return r.uniform2uiv(e,o,2);case 36295:return r.uniform3uiv(e,o,3);case 36296:return r.uniform4uiv(e,o,4);case 35674:return n.uniformMatrix2fv(e,!1,o);case 35675:return n.uniformMatrix3fv(e,!1,o);case 35676:return n.uniformMatrix4fv(e,!1,o);case 35685:return r.uniformMatrix2x3fv(e,!1,o);case 35686:return r.uniformMatrix2x4fv(e,!1,o);case 35687:return r.uniformMatrix3x2fv(e,!1,o);case 35688:return r.uniformMatrix3x4fv(e,!1,o);case 35689:return r.uniformMatrix4x2fv(e,!1,o);case 35690:return r.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function bAe(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(n)}}function wAe(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(n)}}const hB=4;class SAe extends Np{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=t.vs,this.fs=t.fs;const{varyings:i,bufferMode:r=35981}=t;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,r)),this._linkShaders(),Qe.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=pAe(this.device.gl,this.handle),Qe.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=t.shaderLayout?TAe(this.introspectedLayout,t.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,t){for(const[i,r]of Object.entries(e)){const s=this.shaderLayout.bindings.find(o=>o.name===i)||this.shaderLayout.bindings.find(o=>o.name===`${i}Uniforms`);if(!s){const o=this.shaderLayout.bindings.map(a=>`"${a.name}"`).join(", ");t?.disableWarnings||Qe.warn(`No binding "${i}" in render pipeline "${this.id}", expected one of ${o}`,r)();continue}switch(r||Qe.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),s.type){case"uniform":if(!(r instanceof hv)&&!(r.buffer instanceof hv))throw new Error("buffer value");break;case"texture":if(!(r instanceof Fg||r instanceof fv||r instanceof uv))throw new Error(`${this} Bad texture binding for ${i}`);break;case"sampler":Qe.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(s.type)}this.bindings[i]=r}}draw(e){const{renderPass:t,parameters:i=this.props.parameters,topology:r=this.props.topology,vertexArray:s,vertexCount:o,instanceCount:a,isInstanced:l=!1,firstVertex:c=0,transformFeedback:u}=e,d=bAe(r),m=!!s.indexBuffer,y=s.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return Qe.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return Qe.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),s.bindBeforeRender(t),u&&u.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const x=t;return eAe(this.device,i,x.glParameters,()=>{m&&l?this.device.gl.drawElementsInstanced(d,o||0,y,c,a||0):m?this.device.gl.drawElements(d,o||0,y,c):l?this.device.gl.drawArraysInstanced(d,c,o||0,a||0):this.device.gl.drawArrays(d,c,o||0),u&&u.end()}),s.unbindAfterRender(t),!0}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Qe.time(hB,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),Qe.timeEnd(hB,`linkProgram for ${this.id}`)(),Qe.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}Qe.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Qe.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){switch(e){case"success":return;default:const t=e==="link-error"?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${t} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader();break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${t} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader();break}const i=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${t} during ${e}: ${i}`),this)(),this.device.debug()}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")}async _waitForLinkComplete(){const e=async r=>await new Promise(s=>setTimeout(s,r));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)!this.bindings[t.name]&&!this.bindings[t.name.replace(/Uniforms$/,"")]&&(Qe.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,i=0;for(const r of this.shaderLayout.bindings){const s=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!s)throw new Error(`No value for binding ${r.name} in ${this.id}`);switch(r.type){case"uniform":const{name:o}=r,a=e.getUniformBlockIndex(this.handle,o);if(a===4294967295)throw new Error(`Invalid uniform block name ${o}`);e.uniformBlockBinding(this.handle,i,a),s instanceof hv?e.bindBufferBase(35345,i,s.handle):e.bindBufferRange(35345,i,s.buffer.handle,s.offset||0,s.size||s.buffer.byteLength-s.offset),i+=1;break;case"texture":if(!(s instanceof Fg||s instanceof fv||s instanceof uv))throw new Error("texture");let l;if(s instanceof Fg)l=s.texture;else if(s instanceof fv)l=s;else if(s instanceof uv&&s.colorAttachments[0]instanceof Fg)Qe.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),l=s.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+t),e.bindTexture(l.glTarget,l.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${r.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:i,type:r,textureUnit:s}=e,o=this.uniforms[t]??s;o!==void 0&&xAe(this.device.gl,i,r,o)}}}function TAe(n,e){const t={...n,attributes:n.attributes.map(i=>({...i}))};for(const i of e?.attributes||[]){const r=t.attributes.find(s=>s.name===i.name);r?(r.type=i.type||r.type,r.stepMode=i.stepMode||r.stepMode):Qe.warn(`shader layout attribute ${i.name} not present in shader`)}return t}class EAe extends eI{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(const t of e)switch(t.name){case"copy-buffer-to-buffer":AAe(this.device,t.options);break;case"copy-buffer-to-texture":MAe(this.device,t.options);break;case"copy-texture-to-buffer":CAe(this.device,t.options);break;case"copy-texture-to-texture":PAe(this.device,t.options);break;default:throw new Error(t.name)}}}function AAe(n,e){const t=e.sourceBuffer,i=e.destinationBuffer;n.gl.bindBuffer(36662,t.handle),n.gl.bindBuffer(36663,i.handle),n.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),n.gl.bindBuffer(36662,null),n.gl.bindBuffer(36663,null)}function MAe(n,e){throw new Error("Not implemented")}function CAe(n,e){const{sourceTexture:t,mipLevel:i=0,aspect:r="all",width:s=e.sourceTexture.width,height:o=e.sourceTexture.height,depthOrArrayLayers:a=0,origin:l=[0,0],destinationBuffer:c,byteOffset:u=0,bytesPerRow:d,rowsPerImage:m}=e;if(r!=="all")throw new Error("aspect not supported in WebGL");if(i!==0||a!==0||d||m)throw new Error("not implemented");const{framebuffer:y,destroyFramebuffer:x}=Jj(t);let T;try{const S=c,w=s||y.width,P=o||y.height,M=qj(y.colorAttachments[0].texture.props.format),I=M.format,k=M.type;n.gl.bindBuffer(35051,S.handle),T=n.gl.bindFramebuffer(36160,y.handle),n.gl.readPixels(l[0],l[1],w,P,I,k,u)}finally{n.gl.bindBuffer(35051,null),T!==void 0&&n.gl.bindFramebuffer(36160,T),x&&y.destroy()}}function PAe(n,e){const{sourceTexture:t,destinationMipLevel:i=0,origin:r=[0,0],destinationOrigin:s=[0,0],destinationTexture:o}=e;let{width:a=e.destinationTexture.width,height:l=e.destinationTexture.height}=e;const{framebuffer:c,destroyFramebuffer:u}=Jj(t),[d,m]=r,[y,x,T]=s,S=n.gl.bindFramebuffer(36160,c.handle);let w,P;if(o instanceof fv)w=o,a=Number.isFinite(a)?a:w.width,l=Number.isFinite(l)?l:w.height,w._bind(0),P=w.glTarget;else throw new Error("invalid destination");switch(P){case 3553:case 34067:n.gl.copyTexSubImage2D(P,i,y,x,d,m,a,l);break;case 35866:case 32879:n.gl.copyTexSubImage3D(P,i,y,x,T,d,m,a,l);break}w&&w._unbind(),n.gl.bindFramebuffer(36160,S),u&&c.destroy()}function Jj(n){if(n instanceof ts){const{width:e,height:t,id:i}=n;return{framebuffer:n.device.createFramebuffer({id:`framebuffer-for-${i}`,width:e,height:t,colorAttachments:[n]}),destroyFramebuffer:!0}}return{framebuffer:n,destroyFramebuffer:!1}}const RAe=[1,2,4,8];class IAe extends pp{device;handle=null;glParameters={};constructor(e,t){super(e,t),this.device=e;let i;if(!t?.parameters?.viewport)if(t?.framebuffer){const{width:s,height:o}=t.framebuffer;i=[0,0,s,o]}else{const[s,o]=e.getDefaultCanvasContext().getDrawingBufferSize();i=[0,0,s,o]}this.device.pushState(),this.setParameters({viewport:i,...this.props.parameters});const r=this.props.framebuffer;if(this.props.framebuffer&&r?.handle){const s=this.props.framebuffer.colorAttachments.map((o,a)=>36064+a);this.device.gl.drawBuffers(s)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=e.stencilReference),"colorMask"in e&&(t.colorMask=RAe.map(i=>!!(i&e.colorMask))),this.glParameters=t,F_(this.device.gl,t)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach((i,r)=>{i&&this.clearColorBuffer(r,i)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(t|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(t|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(t|=1024,e.clearStencil=this.props.clearStencil),t!==0&&o0(this.device.gl,e,()=>{this.device.gl.clear(t)})}clearColorBuffer(e=0,t=[0,0,0,0]){o0(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class fB extends Q2{device;handle=null;commandBuffer;constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new EAe(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new IAe(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,i){}}function kAe(n){const{target:e,source:t,start:i=0,count:r=1}=n,s=t.length,o=r*s;let a=0;for(let l=i;a<s;a++)e[l++]=t[a];for(;a<o;)a<o-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+o-a),a=o);return n.target}class MI extends tI{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return J_e()==="Chrome"}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&t.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const i=t;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),c?this.device.gl.vertexAttribIPointer(e,r,s,o,a):this.device.gl.vertexAttribPointer(e,r,s,l,o,a),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,u||0),this.attributes[e]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const i=Yj(t.bufferDataType);return{size:t.bufferComponents,type:i,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:t.stepMode==="instance"?1:0}}_enable(e,t=!0){const r=MI.isConstantAttributeZeroSupported(this.device)||e!==0;(t||r)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const i=OAe(t),r=i.byteLength*e,s=i.length*e;if(this.buffer&&r!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${r} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),o||=!LAe(i,this.bufferValue),o){const a=jxe(t.constructor,s);kAe({target:a,source:i,start:0,count:s}),this.buffer.write(a),this.bufferValue=t}return this.buffer}}function OAe(n){return Array.isArray(n)?new Float32Array(n):n}function LAe(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}class NAe extends nI{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(wAe(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])})}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteLength:s,byteOffset:o}=this._getBufferRange(t);if(i<0){this.unusedBuffers[e]=r,Qe.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[i]={buffer:r,byteLength:s,byteOffset:o},this.bindOnUse||this._bindBuffer(i,r,o,s)}getBuffer(e){if(dB(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let t;return this._bound?t=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),t}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof hv)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:i=0,byteLength:r=e.buffer.byteLength}=e;return{buffer:t,byteOffset:i,byteLength:r}}_getVaryingIndex(e){if(dB(e))return Number(e);for(const t of this.layout.varyings||[])if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:i,byteOffset:r}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,r,i)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;!s||r===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,i,r)}}function dB(n){return typeof n=="number"?Number.isInteger(n):/^\d+$/.test(n)}class DAe extends iI{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");const i=this.device.gl.createQuery();if(!i)throw new Error("WebGL query not supported");this.handle=i,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}}function Qj(n){switch(n){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function FAe(n){switch(n){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function UAe(n){return BAe[n]}const BAe={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"};function zAe(n,e){const{sourceX:t=0,sourceY:i=0,sourceAttachment:r=0}=e||{};let{target:s=null,sourceWidth:o,sourceHeight:a,sourceDepth:l,sourceFormat:c,sourceType:u}=e||{};const{framebuffer:d,deleteFramebuffer:m}=e9(n),{gl:y,handle:x}=d;o||=d.width,a||=d.height;const T=d.colorAttachments[r]?.texture;if(!T)throw new Error(`Invalid framebuffer attachment ${r}`);l=T?.depth||1,c||=T?.glFormat||6408,u||=T?.glType||5121,s=WAe(s,u,c,o,a);const S=q2(s);u=u||cAe(S);const w=y.bindFramebuffer(36160,x);return y.readBuffer(36064+r),y.readPixels(t,i,o,a,c,u,s),y.readBuffer(36064),y.bindFramebuffer(36160,w||null),m&&d.destroy(),s}function VAe(n,e){const{target:t,sourceX:i=0,sourceY:r=0,sourceFormat:s=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:d}=e9(n);a=a||u.width,l=l||u.height;const m=u;c=c||5121;let y=t;if(!y){const T=Qj(s),S=FAe(c),w=o+a*l*T*S;y=m.device.createBuffer({byteLength:w})}const x=n.device.createCommandEncoder();return x.copyTextureToBuffer({sourceTexture:n,width:a,height:l,origin:[i,r],destinationBuffer:y,byteOffset:o}),x.destroy(),d&&u.destroy(),y}function e9(n){return n instanceof jT?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:HAe(n),deleteFramebuffer:!0}}function HAe(n,e){const{device:t,width:i,height:r,id:s}=n;return t.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:i,height:r,colorAttachments:[n]})}function WAe(n,e,t,i,r,s){if(n)return n;e||=5121;const o=UAe(e),a=Z2(o),l=Qj(t);return new a(i*r*l)}class vP extends Kp{type="webgl";handle;features;limits;info;canvasContext;preferredColorFormat="rgba8unorm";preferredDepthFormat="depth24plus";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){switch(e){case"unorm8x4-bgra":return!1;default:return!0}}constructor(e){super({...e,id:e.id||q1e("webgl-device")});const t=Kp._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let i=t.canvas?.gl?.device;if(i)throw new Error(`WebGL context already attached to device ${i.id}`);this.canvasContext=new Y1e(this,t),this.lost=new Promise(u=>{this._resolveContextLost=u});const r={...e.webgl};t.alphaMode==="premultiplied"&&(r.premultipliedAlpha=!0),e.powerPreference!==void 0&&(r.powerPreference=e.powerPreference);const o=this.props._handle||C1e(this.canvasContext.canvas,{onContextLost:u=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:u=>console.log("WebGL context restored")},r);if(!o)throw new Error("WebGL context creation failed");if(i=o.device,i){if(e._reuseDevices)return Qe.log(1,`Not creating a new Device, instead returning a reference to Device ${i.id} already attached to WebGL context`,i)(),i._reused=!0,i;throw new Error(`WebGL context already attached to device ${i.id}`)}this.handle=o,this.gl=o,this.spectorJS=u1e({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=P1e(this.gl,this._extensions),this.limits=new $1e(this.gl),this.features=new j1e(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new Up(this.gl,{log:(...u)=>Qe.log(1,...u)()}).trackState(this.gl,{copyState:!1});const l=e.debugWebGL||e.debug,c=e.debugWebGL;l&&(this.gl=d1e(this.gl,{debugWebGL:l,traceWebGL:c}),Qe.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(Qe.level=Math.max(Qe.level,1))),this.commandEncoder=new fB(this,{id:`${this}-command-encoder`})}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new hv(this,t)}createTexture(e){return new fv(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new oAe(this,e)}createShader(e){return new Q1e(this,e)}createFramebuffer(e){return new uv(this,e)}createVertexArray(e){return new MI(this,e)}createTransformFeedback(e){return new NAe(this,e)}createQuerySet(e){return new DAe(this,e)}createRenderPipeline(e){return new SAe(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(e={}){return new fB(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,t){return zAe(e,t)}readPixelsToBufferWebGL(e,t){return VAe(e,t)}setParametersWebGL(e){F_(this.gl,e)}getParametersWebGL(e){return Xj(this.gl,e)}withParametersWebGL(e,t){return o0(this.gl,e,t)}resetWebGL(){Qe.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),S1e(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return z1e(this.gl,e,this._extensions)}loseDevice(){let e=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(e=!0,i.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){Up.get(this.gl).push()}popState(){Up.get(this.gl).pop()}getGLKey(e,t){const i=Number(e);for(const r in this.gl)if(this.gl[r]===i)return`GL.${r}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce((i,[r,s])=>(i[`${r}:${this.getGLKey(r,t)}`]=`${s}:${this.getGLKey(s,t)}`,i),{})}setConstantAttributeWebGL(e,t){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const r=this._constants[e];switch(r&&GAe(r,t)&&Qe.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:jAe(this,e,t);break;case Int32Array:$Ae(this,e,t);break;case Uint32Array:XAe(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return x_(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,t,i){e.luma=t;const r={props:i.spector,id:i.spector.id};e.__SPECTOR_Metadata=r}}function jAe(n,e,t){switch(t.length){case 1:n.gl.vertexAttrib1fv(e,t);break;case 2:n.gl.vertexAttrib2fv(e,t);break;case 3:n.gl.vertexAttrib3fv(e,t);break;case 4:n.gl.vertexAttrib4fv(e,t);break}}function $Ae(n,e,t){n.gl.vertexAttribI4iv(e,t)}function XAe(n,e,t){n.gl.vertexAttribI4uiv(e,t)}function GAe(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}const pB=Object.freeze(Object.defineProperty({__proto__:null,WebGLDevice:vP},Symbol.toStringTag,{value:"Module"}));function Tf(){}const YAe=({isDragging:n})=>n?"grabbing":"grab",t9={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Tf,onWebGLInitialized:Tf,onResize:Tf,onViewStateChange:Tf,onInteractionStateChange:Tf,onBeforeRender:Tf,onAfterRender:Tf,onLoad:Tf,onError:n=>vi.error(n.message,n.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:YAe,getTooltip:null,debug:!1,drawPickingColors:!1};class CI{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new BT({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=i=>{const{_pickRequest:r}=this;if(i.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(i.leftButton||i.rightButton)return;{const s=i.offsetCenter;if(!s)return;r.x=s.x,r.y=s.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=i},this._onEvent=i=>{const r=cP[i.type],s=i.offsetCenter;if(!r||!s||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:o,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:l}=a,c=l&&(l[r]||l.props[r]),u=this.props[r];let d=!1;c&&(d=c.call(l,a,i)),d||(u?.(a,i),this.widgetManager.onEvent(a,i))},this._onPointerDown=i=>{if(this.device?.type==="webgpu")return;const r=i.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...t9,...e},e=this.props,e.viewState&&e.initialViewState&&vi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&vi.error("WebGL1 context not supported.")(),t=WA.attach(e.gl,this.props.deviceProps)),t||(t=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&s0.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&vi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&vi.removed("onLayerClick","onClick")(),e.initialViewState&&!pl(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);if(Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),vi.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(t),e.useDevicePixels!==void 0&&this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){this.device.canvasContext.props.useDevicePixels=e.useDevicePixels;const i=this.device.canvasContext.canvas,r={target:i,contentBoxSize:[{inlineSize:i.clientWidth,blockSize:i.clientHeight}],devicePixelContentBoxSize:[{inlineSize:i.clientWidth,blockSize:i.clientHeight}],borderBoxSize:[{inlineSize:i.clientWidth,blockSize:i.clientHeight}]};this.device.canvasContext._handleResize([r])}this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return this.viewManager!==null}getViews(){return uo(this.viewManager),this.viewManager.views}getViewports(e){return uo(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,t,i){uo(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return typeof t=="string"&&(t=document.getElementById(t),uo(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",e.width&&typeof e.width=="number"&&(t.width=e.width),e.height&&typeof e.height=="number"&&(t.height=e.height),(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:i}=e;if(t||t===0){const r=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=r}if(i||i===0){const r=Number.isFinite(i)?`${i}px`:i;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=r}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,i=e.clientHeight??e.height;(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,this.viewManager?.setProps({width:t,height:i}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:i}))}_createAnimationLoop(e,t){const{gl:i,onError:r}=t;return new yI({device:e,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,onInitialize:s=>this._setDevice(s.device),onRender:this._onRenderFrame.bind(this),onError:r})}_createDevice(e){const t=this.props.deviceProps?.createCanvasContext,i=typeof t=="object"?t:void 0,r={adapters:[],...e.deviceProps};r.adapters.includes(WA)||r.adapters.push(WA);const s={alphaMode:this.props.deviceProps?.type==="webgpu"?"premultiplied":void 0};return QC.createDevice({_reuseDevices:!0,type:"webgl",...r,createCanvasContext:{...s,...i,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new Hj({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer?.onHover(o,e.event)||s;s||(this.props.onHover?.(r,e.event),this.widgetManager.onHover(r,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const t=new Nj;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new RSe(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(RU).map(r=>{const[s,o,a,l]=RU[r],c=this.props.eventRecognizerOptions?.[r],u={...o,...c,event:r};return{recognizer:new s(u),recognizeWith:a,requestFailure:l}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in cP)this.eventManager.on(r,this._onEvent);this.viewManager=new CEe({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new MEe(this.device,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new jEe({deck:this,device:this.device}),this.deckRenderer=new GEe(this.device),this.deckPicker=new ZEe(this.device),this.widgetManager=new QEe({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new Wj),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{device:i,gl:r}=this.layerManager.context;this.props.onBeforeRender({device:i,gl:r});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};this.deckRenderer?.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:i,gl:r})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),vi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=QC.stats.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}CI.defaultProps=t9;CI.VERSION=v0e;function qAe(n){switch(n){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Z2(n)}}const ZAe=q2;function Qb(n,e,t){const i=t==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:n,format:e.size>1?`${i}x${e.size}`:e.type,byteOffset:e.offset||0}}function Tp(n){return n.stride||n.size*n.bytesPerElement}function KAe(n,e){return n.type===e.type&&n.size===e.size&&Tp(n)===Tp(e)&&(n.offset||0)===(e.offset||0)}function xP(n,e){e.offset&&vi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=Tp(n),i=e.vertexOffset!==void 0?e.vertexOffset:n.vertexOffset||0,r=e.elementOffset||0,s=i*t+r*n.bytesPerElement+(n.offset||0);return{...e,offset:s,stride:t}}function JAe(n,e){const t=xP(n,e);return{high:t,low:{...t,offset:t.offset+n.size*4}}}class QAe{constructor(e,t,i){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,s=r==="float64";let{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a="float32":!r&&t.isIndexed?a="uint32":a=r||"float32";let l=qAe(r||a);this.doublePrecision=s,s&&t.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...t,defaultType:l,defaultValue:o,logicalType:r,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Tp(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),s0.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const i={};if(this.state.constant){const r=this.value;if(t){const s=xP(this.getAccessor(),t),o=s.offset/r.BYTES_PER_ELEMENT,a=s.size||this.size;i[e]=r.subarray(o,o+a)}else i[e]=r}else i[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?i[`${e}64Low`]=i[e]:i[`${e}64Low`]=new Float32Array(this.size)),i}_getBufferLayout(e=this.id,t=null){const i=this.getAccessor(),r=[],s={name:this.id,byteStride:Tp(i),attributes:r};if(this.doublePrecision){const o=JAe(i,t||{});r.push(Qb(e,{...i,...o.high},this.device.type),Qb(`${e}64Low`,{...i,...o.low},this.device.type))}else if(t){const o=xP(i,t);r.push(Qb(e,{...i,...o},this.device.type))}else r.push(Qb(e,i,this.device.type));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:i,size:r}=this,s=i*r;if(t&&s&&t.length>=s){const o=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<r;c++){const u=t[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof gr?i={buffer:e}:i=e;const r={...this.settings,...i};if(ArrayBuffer.isView(i.value)){if(!i.type)if(this.doublePrecision&&i.value instanceof Float64Array)r.type="float32";else{const o=ZAe(i.value);r.type=r.normalized?o.replace("int","norm"):o}r.bytesPerElement=i.value.BYTES_PER_ELEMENT,r.stride=Tp(r)}if(t.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!t.constant||!this._areValuesEqual(s,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(i.buffer){const s=i.buffer;t.externalBuffer=s,t.constant=!1,this.value=i.value||null}else if(i.value){this._checkExternalBuffer(i);let s=i.value;t.externalBuffer=null,t.constant=!1,this.value=s;let{buffer:o}=this;const a=Tp(r),l=(r.vertexOffset||0)*a;if(this.doublePrecision&&s instanceof Float64Array&&(s=FA(s,r)),this.settings.isIndexed){const u=this.settings.defaultType;s.constructor!==u&&(s=new u(s))}const c=s.byteLength+l+a*2;(!o||o.byteLength<c)&&(o=this._createBuffer(c)),o.write(s,l)}return this.setAccessor(r),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?FA(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),i*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:i}=this,r=i.allocatedValue,s=s0.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<s.byteLength+o)&&(a=this._createBuffer(s.byteLength+o),t&&r&&a.write(r instanceof Float64Array?FA(r,this):r,o)),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&vi.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(t=>(t+128)/255*2-1);case"snorm16":return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(t=>t/255);case"unorm16":return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e){let o=s;for(;--o>=0;)t[i+o]=r[o];return t}switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:t,type:i}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(t?gr.INDEX:gr.VERTEX)|gr.COPY_DST,indexType:t?i:void 0,byteLength:e}),this._buffer}}const mB=[],gB=[];function n9(n,e=0,t=1/0){let i=mB;const r={index:-1,data:n,target:[]};return n?typeof n[Symbol.iterator]=="function"?i=n:n.length>0&&(gB.length=n.length,i=gB):i=mB,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function i9(n){return n&&n[Symbol.asyncIterator]}function eMe(n,e){const{size:t,stride:i,offset:r,startIndices:s,nested:o}=e,a=n.BYTES_PER_ELEMENT,l=i?i/a:t,c=r?r/a:0,u=Math.floor((n.length-c)/l);return(d,{index:m,target:y})=>{if(!s){const w=m*l+c;for(let P=0;P<t;P++)y[P]=n[w+P];return y}const x=s[m],T=s[m+1]||u;let S;if(o){S=new Array(T-x);for(let w=x;w<T;w++){const P=w*l+c;y=new Array(t);for(let M=0;M<t;M++)y[M]=n[P+M];S[w-x]=y}}else if(l===t)S=n.subarray(x*t+c,T*t+c);else{S=new n.constructor((T-x)*t);let w=0;for(let P=x;P<T;P++){const M=P*l+c;for(let I=0;I<t;I++)S[w++]=n[M+I]}}return S}}const tMe=[],Pw=[[0,1/0]];function nMe(n,e){if(n===Pw||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}const iMe={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function r9(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return{...iMe[t],...e,...n,type:t}}class s9 extends QAe{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Pw}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t;(t=this.state).layoutChanged||(t.layoutChanged=!KAe(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition,r=Array.isArray(t)?e[t.find(s=>e[s])]:e[t];return r9(r,i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=nMe(this.state.updateRanges,[i,r])}else this.state.updateRanges=Pw}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=tMe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,t.updateRanges!==Pw),!0):!1}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const d=Number.isFinite(c)?this.getVertexOffset(c):0,m=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:m})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e,t){const i=this.device.type==="webgpu";if(i||t===void 0||typeof t=="function"){if(i&&typeof t!="function"){const o=this._normalizeValue(t,[],0);this._areValuesEqual(o,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const r=this.settings.transform&&e?this.settings.transform.call(e,t):t;return this.setData({constant:!0,value:r})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;uo(ArrayBuffer.isView(o.value),`invalid ${r.accessor}`);const a=!!o.size&&o.size!==this.size;return i.binaryAccessor=eMe(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const i in e)Object.assign(t,super.getValue(i,e[i]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,i=super._getBufferLayout(),{stepMode:r}=this.settings;if(r==="dynamic"?i.stepMode=e?e.isInstanced?"instance":"vertex":"instance":i.stepMode=r??"vertex",!t)return i;for(const s in t){const o=super._getBufferLayout(s,t[s]);i.attributes.push(...o.attributes)}return i}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:a,state:l,value:c,size:u,startIndices:d}=e,{accessor:m,transform:y}=a;let x=l.binaryAccessor||(typeof m=="function"?m:s[m]);typeof x!="function"&&typeof m=="string"&&(x=()=>s[m]),uo(typeof x=="function",`accessor "${m}" is not a function`);let T=e.getVertexOffset(i);const{iterable:S,objectInfo:w}=n9(t,i,r);for(const P of S){w.index++;let M=x(P,w);if(y&&(M=y.call(this,M)),d){const I=(w.index<d.length-1?d[w.index+1]:o)-d[w.index];if(M&&Array.isArray(M[0])){let k=T;for(const D of M)e._normalizeValue(D,c,k),k+=u}else M&&M.length>u?c.set(M,T):(e._normalizeValue(M,w.target,0),wEe({target:c,source:w.target,start:T,count:I}));T+=I*u}else e._normalizeValue(M,c,T),T+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function YA(n){const{source:e,target:t,start:i=0,size:r,getData:s}=n,o=n.end||t.length,a=e.length,l=o-i;if(a>l){t.set(e.subarray(0,l),i);return}if(t.set(e,i),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let d=0;d<r;d++)t[i+c]=u[d]||0,c++}}function rMe({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!r||!s)return YA({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,d)=>i(u+a,d)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const d=r[u]*t,m=s[u]*t;YA({source:n.subarray(o,d),target:e,start:a,end:m,size:t,getData:l}),o=d,a=m}return a<e.length&&YA({source:[],target:e,start:a,size:t,getData:l}),e}function sMe(n){const{device:e,settings:t,value:i}=n,r=new s9(e,t);return r.setData({value:i instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:t.normalized}),r}function o9(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${n}"`)}}function a9(n){switch(n){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function l9(n){n.push(n.shift())}function oMe(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=n.settings;if(l)for(const c of Object.values(l))a=Math.max(a,c.vertexOffset??0);return(i.noAlloc?r.length:(e+a)*s)*o}function c9({device:n,source:e,target:t}){return(!t||t.byteLength<e.byteLength)&&(t?.destroy(),t=n.createBuffer({byteLength:e.byteLength,usage:e.usage})),t}function u9({device:n,buffer:e,attribute:t,fromLength:i,toLength:r,fromStartIndices:s,getData:o=a=>a}){const a=t.doublePrecision&&t.value instanceof Float64Array?2:1,l=t.size*a,c=t.byteOffset,u=t.settings.bytesPerElement<4?c/t.settings.bytesPerElement*4:c,d=t.startIndices,m=s&&d,y=t.isConstant;if(!m&&e&&i>=r)return e;const x=t.value instanceof Float64Array?Float32Array:t.value.constructor,T=y?t.value:new x(t.getBuffer().readSyncWebGL(c,r*x.BYTES_PER_ELEMENT).buffer);if(t.settings.normalized&&!y){const M=o;o=(I,k)=>t.normalizeConstant(M(I,k))}const S=y?(M,I)=>o(T,I):(M,I)=>o(T.subarray(M+c,M+c+l),I),w=e?new Float32Array(e.readSyncWebGL(u,i*4).buffer):new Float32Array(0),P=new Float32Array(r);return rMe({source:w,target:P,sourceStartIndices:s,targetStartIndices:d,size:l,getData:S}),(!e||e.byteLength<P.byteLength+u)&&(e?.destroy(),e=n.createBuffer({byteLength:P.byteLength+u,usage:35050})),e.write(P,u),e}class h9{constructor({device:e,attribute:t,timeline:i}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new XT(i),this.attribute=t,this.attributeInTransition=sMe(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,i=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=oMe(this.attribute,t),this.transition.start({...e,duration:i})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class aMe extends h9{constructor({device:e,attribute:t,timeline:i}){super({device:e,attribute:t,timeline:i}),this.type="interpolation",this.transform=hMe(e,t)}start(e,t){const i=this.currentLength,r=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:o}=this;l9(s),s[0]=u9({device:this.device,buffer:s[0],attribute:o,fromLength:i,toLength:this.currentLength,fromStartIndices:r,getData:e.enter}),s[1]=c9({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,l=a.model;let c=Math.floor(this.currentLength/o.size);f9(o)&&(c/=2),l.setVertexCount(c),o.isConstant?(l.setAttributes({aFrom:s[0]}),l.setConstantAttributes({aTo:o.value})):l.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:i}=this.transition;let r=i/e;t&&(r=t(r));const{model:s}=this.transform,o={time:r};s.shaderInputs.setProps({interpolation:o}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const lMe=`uniform interpolationUniforms {
  float time;
} interpolation;
`,_B={name:"interpolation",vs:lMe,uniformTypes:{time:"f32"}},cMe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,uMe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function f9(n){return n.doublePrecision&&n.value instanceof Float64Array}function hMe(n,e){const t=e.size,i=o9(t),r=a9(t),s=e.getBufferLayout();return f9(e)?new y_(n,{vs:uMe,bufferLayout:[{name:"aFrom",byteStride:8*t,attributes:[{attribute:"aFrom",format:r,byteOffset:0},{attribute:"aFrom64Low",format:r,byteOffset:4*t}]},{name:"aTo",byteStride:8*t,attributes:[{attribute:"aTo",format:r,byteOffset:0},{attribute:"aTo64Low",format:r,byteOffset:4*t}]}],modules:[Awe,_B],defines:{ATTRIBUTE_TYPE:i,ATTRIBUTE_SIZE:t},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new y_(n,{vs:cMe,bufferLayout:[{name:"aFrom",format:r},{name:"aTo",format:s.attributes[0].format}],modules:[_B],defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"],disableWarnings:!0})}class fMe extends h9{constructor({device:e,attribute:t,timeline:i}){super({device:e,attribute:t,timeline:i}),this.type="spring",this.texture=yMe(e),this.framebuffer=vMe(e,this.texture),this.transform=_Me(e,t)}start(e,t){const i=this.currentLength,r=this.currentStartIndices;super.start(e,t);const{buffers:s,attribute:o}=this;for(let l=0;l<2;l++)s[l]=u9({device:this.device,buffer:s[l],attribute:o,fromLength:i,toLength:this.currentLength,fromStartIndices:r,getData:e.enter});s[2]=c9({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this,s=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const o={stiffness:s.stiffness,damping:s.damping};t.model.shaderInputs.setProps({spring:o}),t.run({framebuffer:i,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),l9(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(i)[0]>0||r.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const dMe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,pMe={name:"spring",vs:dMe,uniformTypes:{damping:"f32",stiffness:"f32"}},mMe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,gMe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function _Me(n,e){const t=o9(e.size),i=a9(e.size);return new y_(n,{vs:mMe,fs:gMe,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[pMe],defines:{ATTRIBUTE_TYPE:t},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function yMe(n){return n.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}function vMe(n,e){return n.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const xMe={interpolation:aMe,spring:fMe};class bMe{constructor(e,{id:t,timeline:i}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);o&&this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){r&&this._removeTransition(e);const o=xMe[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,device:this.device}):(vi.error(`unsupported transition type '${i.type}'`)(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const yB="attributeManager.invalidate",wMe="attributeManager.updateStart",SMe="attributeManager.updateEnd",TMe="attribute.updateStart",EMe="attribute.allocate",AMe="attribute.updateEnd";class MMe{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.mergeBoundsMemoized=V0(VTe),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new bMe(e,{id:`${t}-transitions`,timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)this.attributes[t]!==void 0&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const i=this._invalidateTrigger(e,t);No(yB,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);No(yB,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}){let l=!1;No(wMe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],d=u.settings.accessor;u.startIndices=i,u.numInstances=t,s[c]&&vi.removed(`props.${c}`,`data.attributes.${c}`)(),u.setExternalBuffer(o[c])||u.setBinaryValue(typeof d=="string"?o[d]:void 0,e.startIndices)||typeof d=="string"&&!o[d]&&u.setConstantValue(a,s[d])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&No(SMe,this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(i=>this.attributes[i]?.getBounds());return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const i in e){const r=e[i],s={...r,id:i,size:r.isIndexed&&1||r.size||1,...t};this.attributes[i]=new s9(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;if(No(TMe,t),t.constant){t.setConstantValue(e.context,t.value);return}t.allocate(i)&&No(EMe,t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,No(AMe,t,i))}}class CMe extends XT{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=TS(t,i,o)}}const vB=1e-5;function xB(n,e,t,i,r){const s=e-n,a=(t-e)*r,l=-s*i;return a+l+s+e}function PMe(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=xB(n[o],e[o],t[o],i,r);return s}return xB(n,e,t,i,r)}function bB(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}class RMe extends XT{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=PMe(s,o,t,i,r);const l=bB(a,t),c=bB(a,o);l<vB&&c<vB&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}const IMe={interpolation:CMe,spring:RMe};class kMe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(r=r9(r),!r)return;const o=IMe[r.type];if(!o){vi.error(`unsupported transition type '${r.type}'`)();return}const a=new o(this.timeline);a.start({...r,fromValue:t,toValue:i}),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function OMe(n){const e=n[Fp];for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error(`Invalid prop ${t}: ${n[t]}`)}}function LMe(n,e){const t=d9({newProps:n,oldProps:e,propTypes:n[Fp],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=DMe(n,e);let r=!1;return i||(r=FMe(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:UMe(n,e),transitionsChanged:NMe(n,e)}}function NMe(n,e){if(!n.transitions)return!1;const t={},i=n[Fp];let r=!1;for(const s in n.transitions){const o=i[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&bP(n[s],e[s],o)&&(t[s]=!0,r=!0)}return r?t:!1}function d9({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}){if(e===n)return!1;if(typeof n!="object"||n===null)return`${r} changed shallowly`;if(typeof e!="object"||e===null)return`${r} changed shallowly`;for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return`${r}.${s} added`;const o=bP(n[s],e[s],i[s]);if(o)return`${r}.${s} ${o}`}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return`${r}.${s} dropped`;if(!Object.hasOwnProperty.call(n,s)){const o=bP(n[s],e[s],i[s]);if(o)return`${r}.${s} ${o}`}}return!1}function bP(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":!i&&e!==n?"changed shallowly":null}function DMe(n,e){if(e===null)return"oldProps is null, initial diff";let t=!1;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}function FMe(n,e){if(e===null)return{all:!0};if("all"in n.updateTriggers&&wB(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)r!=="all"&&wB(n,e,r)&&(t[r]=!0,i=!0);return i?t:!1}function UMe(n,e){if(e===null)return!0;const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(!t||!i||i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function wB(n,e,t){let i=n.updateTriggers[t];i=i??{};let r=e.updateTriggers[t];return r=r??{},d9({oldProps:r,newProps:i,triggerName:t})}const BMe="count(): argument not an object",zMe="count(): argument not a container";function VMe(n){if(!WMe(n))throw new Error(BMe);if(typeof n.count=="function")return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(HMe(n))return Object.keys(n).length;throw new Error(zMe)}function HMe(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function WMe(n){return n!==null&&typeof n=="object"}function SB(n,e){if(!e)return n;const t={...n,...e};if("defines"in e&&(t.defines={...n.defines,...e.defines}),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=t.modules.findIndex(r=>r.name==="project32");i>=0&&t.modules.splice(i,1)}if("inject"in e)if(!n.inject)t.inject=e.inject;else{const i={...n.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}return t}const jMe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},wP={};function $Me(n,e,t,i){if(t instanceof ts)return t;t.constructor&&t.constructor.name!=="Object"&&(t={data:t});let r=null;t.compressed&&(r={minFilter:"linear",mipmapFilter:t.data.length>1?"nearest":"linear"});const{width:s,height:o}=t.data,a=e.createTexture({...t,sampler:{...jMe,...r,...i},mipLevels:e.getMipLevelCount(s,o)});return a.generateMipmapsWebGL(),wP[a.id]=n,a}function XMe(n,e){!e||!(e instanceof ts)||wP[e.id]===n&&(e.delete(),delete wP[e.id])}const GMe={boolean:{validate(n,e){return!0},equal(n,e,t){return!!n==!!e}},number:{validate(n,e){return Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)}},color:{validate(n,e){return e.optional&&!n||SP(n)&&(n.length===3||n.length===4)},equal(n,e,t){return pl(n,e,1)}},accessor:{validate(n,e){const t=IS(n);return t==="function"||t===IS(e.value)},equal(n,e,t){return typeof e=="function"?!0:pl(n,e,1)}},array:{validate(n,e){return e.optional&&!n||SP(n)},equal(n,e,t){const{compare:i}=t,r=Number.isInteger(i)?i:i?1:0;return i?pl(n,e,r):n===e}},object:{equal(n,e,t){if(t.ignore)return!0;const{compare:i}=t,r=Number.isInteger(i)?i:i?1:0;return i?pl(n,e,r):n===e}},function:{validate(n,e){return e.optional&&!n||typeof n=="function"},equal(n,e,t){return!t.compare&&t.ignore!==!1||n===e}},data:{transform:(n,e,t)=>{if(!n)return n;const{dataTransform:i}=t.props;return i?i(n):typeof n.shape=="string"&&n.shape.endsWith("-table")&&Array.isArray(n.data)?n.data:n}},image:{transform:(n,e,t)=>{const i=t.context;return!i||!i.device?null:$Me(t.id,i.device,n,{...e.parameters,...t.props.textureParameters})},release:(n,e,t)=>{XMe(t.id,n)}}};function YMe(n){const e={},t={},i={};for(const[r,s]of Object.entries(n)){const o=s?.deprecatedFor;if(o)i[r]=Array.isArray(o)?o:[o];else{const a=qMe(r,s);e[r]=a,t[r]=a.value}}return{propTypes:e,defaultProps:t,deprecatedProps:i}}function qMe(n,e){switch(IS(e)){case"object":return Ay(n,e);case"array":return Ay(n,{type:"array",value:e,compare:!1});case"boolean":return Ay(n,{type:"boolean",value:e});case"number":return Ay(n,{type:"number",value:e});case"function":return Ay(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function Ay(n,e){return"type"in e?{name:n,...GMe[e.type],...e}:"value"in e?{name:n,type:IS(e.value),...e}:{name:n,type:"object",value:e}}function SP(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function IS(n){return SP(n)?"array":n===null?"null":typeof n}function ZMe(n,e){let t;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(t=o.extensions)}const i=TP(n.constructor,t),r=Object.create(i);r[RS]=n,r[nm]={},r[Vf]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)r[a]=o[a]}return Object.freeze(r),r}const KMe="_mergedDefaultProps";function TP(n,e){if(!(n instanceof GT.constructor))return{};let t=KMe;if(e)for(const r of e){const s=r.constructor;s&&(t+=`:${s.extensionName||s.name}`)}const i=p9(n,t);return i||(n[t]=JMe(n,e||[]))}function JMe(n,e){if(!n.prototype)return null;const i=Object.getPrototypeOf(n),r=TP(i),s=p9(n,"defaultProps")||{},o=YMe(s),a=Object.assign(Object.create(null),r,o.defaultProps),l=Object.assign(Object.create(null),r?.[Fp],o.propTypes),c=Object.assign(Object.create(null),r?.[HA],o.deprecatedProps);for(const u of e){const d=TP(u.constructor);d&&(Object.assign(a,d),Object.assign(l,d[Fp]),Object.assign(c,d[HA]))}return QMe(a,n),tCe(a,l),eCe(a,c),a[Fp]=l,a[HA]=c,e.length===0&&!PI(n,"_propTypes")&&(n._propTypes=l),a}function QMe(n,e){const t=iCe(e);Object.defineProperties(n,{id:{writable:!0,value:t}})}function eCe(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r=`${this.id}: ${t}`;for(const s of e[t])PI(this,s)||(this[s]=i);vi.deprecated(r,e[t].join("/"))()}})}function tCe(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=nCe(o))}n[qg]=t,n[nm]={},Object.defineProperties(n,i)}function nCe(n){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||i9(e)?this[nm][n]=e:this[Vf][n]=e},get(){if(this[Vf]){if(n in this[Vf])return this[Vf][n]||this[qg][n];if(n in this[nm]){const e=this[RS]&&this[RS].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[qg][n]}}return this[qg][n]}}}function PI(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function p9(n,e){return PI(n,e)&&n[e]}function iCe(n){const e=n.componentName;return e||vi.warn(`${n.name}.componentName not specified`)(),e||n.name}let rCe=0;class GT{constructor(...e){this.props=ZMe(this,e),this.id=this.props.id,this.count=rCe++}clone(e){const{props:t}=this,i={};for(const r in t[qg])r in t[Vf]?i[r]=t[Vf][r]:r in t[nm]&&(i[r]=t[nm][r]);return new this.constructor({...t,...i,...e})}}GT.componentName="Component";GT.defaultProps={};const sCe=Object.freeze({});class oCe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||sCe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[RS]||this.component;const t=e[Vf]||{},i=e[nm]||e,r=e[qg]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if(typeof t=="string"&&(t=this._fetch(e,t)),t instanceof Promise){this._watchPromise(e,t);return}if(i9(t)){this._resolveAsyncIterable(e,t);return}this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t===i.resolvedValue||t===i.lastValue?!1:(i.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&t!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{this.component&&(s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,t){if(e!=="data"){this._setPropValue(e,t);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let s=[],o=0;for await(const a of t){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,r)}this._onResolve(e,s)}_postProcessValue(e,t){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.props[Fp];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class aCe extends oCe{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const i=this.layer,r=i?.props.fetch;return r?r(t,{propName:e,layer:i}):super._fetch(e,t)}_onResolve(e,t){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(t,{propName:e,layer:i})}}_onError(e,t){const i=this.layer;i&&i.raiseError(t,`loading ${e} of ${this.layer}`)}}const lCe="layer.changeFlag",cCe="layer.initialize",uCe="layer.update",hCe="layer.finalize",fCe="layer.matched",TB=2**24-1,dCe=Object.freeze([]),pCe=V0(({oldViewport:n,viewport:e})=>n.equals(e));let Ql=new Uint8ClampedArray(0);const mCe={data:{type:"data",value:dCe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r={...r,fetch:{...r?.fetch,signal:s}});let a=o.contains(n);return!a&&!r&&(o.add({resourceId:n,data:dS(n,i),persistent:!1}),a=!0),a?o.subscribe({resourceId:n,onChange:l=>t.internalState?.reloadAsyncProp(e,l),consumerId:t.id,requestId:e}):dS(n,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ii.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,-n*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class j0 extends GT{constructor(){super(...arguments),this.internalState=null,this.lifecycle=bg.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){uo(this.internalState);const t=this.internalState.viewport||this.context.viewport,i=Lj(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,o]=Pj(i,t.pixelProjectionMatrix);return e.length===2?[r,s]:[r,s,o]}unproject(e){return uo(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){uo(this.internalState);const i=this.internalState.viewport||this.context.viewport;return GTe(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ii.DEFAULT||e===ii.LNGLAT||e===ii.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){uo(e instanceof Uint8Array);const[t,i,r]=e;return t+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:VMe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=SB(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=SB(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&t)if(Array.isArray(i))for(const r of i)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:r}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=t.attributes,c=a||l;c&&(o&&c.constant&&(c.constant=!1,t.invalidate(c.id)),!c.value&&!o&&(c.constant=!0,c.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo({info:e,mode:t,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,t){t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!pCe({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&(e==="all"?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const i in e)e[i].layoutChanged()&&(t=!0);for(const i of this.getModels())this._setModelAttributes(i,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:i,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),i=Object.create(this.props);for(const r in t)Object.defineProperty(i,r,{value:t[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const i=Math.floor(Ql.length/4);if(this.internalState.usesPickingColorCache=!0,i<t){t>TB&&vi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ql=s0.allocate(Ql,t,{size:4,copy:!0,maxCount:Math.max(t,TB)});const r=Math.floor(Ql.length/4),s=[0,0,0];for(let o=i;o<r;o++)this.encodePickingColor(o,s),Ql[o*4+0]=s[0],Ql[o*4+1]=s[1],Ql[o*4+2]=s[2],Ql[o*4+3]=0}e.value=Ql.subarray(0,t*4)}_setModelAttributes(e,t,i=!1){if(!Object.keys(t).length)return;if(i){const a=this.getAttributeManager();e.setBufferLayout(a.getBufferLayouts(e)),t=a.getAttributes()}const r=e.userData?.excludeAttributes||{},s={},o={};for(const a in t){if(r[a])continue;const l=t[a].getValue();for(const c in l){const u=l[c];u instanceof gr?t[a].settings.isIndexed?e.setIndexBuffer(u):s[c]=u:u&&(o[c]=u)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s&&t.attributes&&t.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let c=0;c<t.length;c++){const u=s.getVertexOffset(c);a[u]===l[0]&&a[u+1]===l[1]&&a[u+2]===l[2]&&this._disablePickingIndex(c)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;if(!r)return;const s=r.getVertexOffset(e),o=r.getVertexOffset(e+1);r.buffer.write(new Uint8Array(o-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,i=e||t;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==Ql.buffer&&(i.value=Ql.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){uo(!this.internalState),uo(Number.isFinite(this.props.coordinateSystem)),No(cCe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new aCe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(vi.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new kMe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){No(fCe,this,this===e);const{state:t,internalState:i}=e;this!==e&&(this.internalState=i,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(No(uCe,this,e),!e)return;const t=this.props,i=this.context,r=this.internalState,s=i.viewport,o=this._updateUniformTransition();r.propsInTransition=o,i.viewport=r.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(i.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);this.setNeedsRedraw(),this._updateAttributes();const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{i.viewport=s,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){No(hCe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;try{t&&this.setShaderModuleProps(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];o.device instanceof vP&&o.device.setParametersWebGL({polygonOffset:l});for(const c of this.getModels())c.device.type==="webgpu"?c.setParameters({...c.parameters,...r}):c.setParameters(r);if(o.device instanceof vP)o.device.withParametersWebGL(r,()=>{const c={renderPass:e,shaderModuleProps:t,uniforms:i,parameters:r,context:o};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)});else{const c={renderPass:e,shaderModuleProps:t,uniforms:i,parameters:r,context:o};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)}}finally{this.props=s}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let s=!1;switch(r){case"dataChanged":const o=e[r],a=t[r];o&&Array.isArray(a)&&(t.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:t[r]||(t[r]=e[r],s=!0)}s&&No(lCe,this,r,e)}const i=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=i,t.somethingChanged=i||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const i=LMe(e,t);if(i.updateTriggersChanged)for(const r in i.updateTriggersChanged)i.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(i.transitionsChanged)for(const r in i.transitionsChanged)this.internalState.uniformTransitions.add(r,t[r],e[r],e.transitions?.[r]);return this.setChangeFlags(i)}validateProps(){OMe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(t.highlightColor=i(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new MMe(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:i,oldProps:r}=e,s=this.state.model;s?.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=i;if(t||r.autoHighlight!==o||r.highlightedObjectIndex!==a||r.highlightColor!==l){const c={};Array.isArray(l)&&(c.highlightColor=l),(t||r.autoHighlight!==o||a!==r.highlightedObjectIndex)&&(c.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:c})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(t=t||r,t)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}j0.defaultProps=mCe;j0.layerName="Layer";const gCe=typeof window<"u"?G.useLayoutEffect:G.useEffect;function kS(n,e){for(;n;){if(n===e)return!0;n=Object.getPrototypeOf(n)}return!1}const _Ce={position:"absolute",zIndex:-1};function m9(n,e){if(typeof n=="function")return n(e);if(Array.isArray(n))return n.map(t=>m9(t,e));if(YT(n)){if(yCe(n))return e.style=_Ce,G.cloneElement(n,e);if(vCe(n))return G.cloneElement(n,e)}return n}function YT(n){return n&&typeof n=="object"&&"type"in n||!1}function yCe(n){return n.props?.mapStyle}function vCe(n){const e=n.type;return e&&e.deckGLViewProps}function EP(n){if(typeof n=="function")return G.createElement(v_,{},n);if(Array.isArray(n))return n.map(EP);if(YT(n)){if(n.type===G.Fragment)return EP(n.props.children);if(kS(n.type,v_))return n}return n}function xCe({children:n,layers:e=[],views:t=null}){const i=[],r=[],s={};return G.Children.forEach(EP(n),o=>{if(YT(o)){const a=o.type;if(kS(a,j0)){const l=bCe(a,o.props);r.push(l)}else i.push(o);if(kS(a,v_)&&a!==v_&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&i.push(o)}),Object.keys(s).length>0&&(Array.isArray(t)?t.forEach(o=>{s[o.id]=o}):t&&(s[t.id]=t),t=Object.values(s)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:t}}function bCe(n,e){const t={},i=n.defaultProps||{};for(const r in e)i[r]!==e[r]&&(t[r]=e[r]);return new n(t)}const wCe=G.createContext();function SCe({children:n,deck:e,ContextProvider:t=wCe.Provider}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},s=i.views[0].id;for(const o of n){let a=s,l=o;YT(o)&&kS(o.type,v_)&&(a=o.props.id||s,l=o.props.children);const c=i.getViewport(a),u=i.getViewState(a);if(c){u.padding=c.padding;const{x:d,y:m,width:y,height:x}=c;l=m9(l,{x:d,y:m,width:y,height:x,viewport:c,viewState:u}),r[a]||(r[a]={viewport:c,children:[]}),r[a].children.push(l)}}return Object.keys(r).map(o=>{const{viewport:a,children:l}=r[o],{x:c,y:u,width:d,height:m}=a,y={position:"absolute",left:c,top:u,width:d,height:m},x=`view-${o}`,T=G.createElement("div",{key:x,id:x,style:y},...l),S={deck:e,viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:P=>{P.viewId=o,e._onViewStateChange(P)},widgets:[]},w=`view-${o}-context`;return G.createElement(t,{key:w,value:S},T)})}const TCe={mixBlendMode:null};function ECe({width:n,height:e,style:t}){const i={position:"absolute",zIndex:0,left:0,top:0,width:n,height:e},r={left:0,top:0};if(t)for(const s in t)s in TCe?r[s]=t[s]:i[s]=t[s];return{containerStyle:i,canvasStyle:r}}function ACe(n){return{get deck(){return n.deck},pickObject:e=>n.deck.pickObject(e),pickMultipleObjects:e=>n.deck.pickMultipleObjects(e),pickObjects:e=>n.deck.pickObjects(e)}}function g9(n){n.redrawReason&&(n.deck._drawLayers(n.redrawReason),n.redrawReason=null)}function MCe(n,e,t){const i=new e({...t,_customRender:t.deviceProps?.adapters?.[0]?.type==="webgpu"?void 0:r=>{n.redrawReason=r;const s=i.getViewports();n.lastRenderedViewports!==s?n.forceUpdate():g9(n)}});return i}function CCe(n,e){const[t,i]=G.useState(0),s=G.useRef({control:null,version:t,forceUpdate:()=>i(k=>k+1)}).current,o=G.useRef(null),a=G.useRef(null),l=G.useMemo(()=>xCe(n),[n.layers,n.views,n.children]);let c=!0;const u=k=>c&&n.viewState?(s.viewStateUpdateRequested=k,null):(s.viewStateUpdateRequested=null,n.onViewStateChange?.(k)),d=k=>{c?s.interactionStateUpdateRequested=k:(s.interactionStateUpdateRequested=null,n.onInteractionStateChange?.(k))},m=G.useMemo(()=>{const k={widgets:[],...n,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:d};return delete k._customRender,s.deck&&s.deck.setProps(k),k},[n]);G.useEffect(()=>{const k=n.Deck||CI;return s.deck=MCe(s,k,{...m,parent:o.current,canvas:a.current}),()=>s.deck?.finalize()},[]),gCe(()=>{g9(s);const{viewStateUpdateRequested:k,interactionStateUpdateRequested:D}=s;k&&u(k),D&&d(D),s.deck?.isInitialized&&s.deck.redraw("Initial render")}),G.useImperativeHandle(e,()=>ACe(s),[]);const y=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:x,width:T="100%",height:S="100%",id:w,style:P}=n,{containerStyle:M,canvasStyle:I}=G.useMemo(()=>ECe({width:T,height:S,style:P}),[T,S,P]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===y||s.version!==t){s.lastRenderedViewports=y,s.version=t;const k=SCe({children:l.children,deck:s.deck,ContextProvider:x}),D=G.createElement("canvas",{key:"canvas",id:w||"deckgl-overlay",ref:a,style:I});s.control=G.createElement("div",{id:`${w||"deckgl"}-wrapper`,ref:o,style:M},[D,k])}return c=!1,s.control}const PCe=G.forwardRef(CCe),EB=`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeBasis;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,RCe={name:"icon",vs:EB,fs:EB,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeBasis:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},ICe=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float iconConstraint = icon.sizeBasis == 0.0 ? iconSize.x : iconSize.y;
float instanceScale = iconConstraint == 0.0 ? 0.0 : sizePixels / iconConstraint;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,kCe=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,OCe=1024,LCe=4,AB=()=>{},MB={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},NCe={x:0,y:0,width:0,height:0};function DCe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function FCe(n,e,t,i){const r=Math.min(t/e.width,i/e.height),s=Math.floor(e.width*r),o=Math.floor(e.height*r);return r===1?{image:e,width:s,height:o}:(n.canvas.height=o,n.canvas.width=s,n.clearRect(0,0,s,o),n.drawImage(e,0,0,e.width,e.height,0,0,s,o),{image:n.canvas,width:s,height:o})}function a0(n){return n&&(n.id||n.url)}function UCe(n,e,t,i){const{width:r,height:s,device:o}=n,a=o.createTexture({format:"rgba8unorm",width:e,height:t,sampler:i,mipLevels:o.getMipLevelCount(e,t)}),l=o.createCommandEncoder();return l.copyTextureToTexture({sourceTexture:n,destinationTexture:a,width:r,height:s}),l.finish(),a.generateMipmapsWebGL(),n.destroy(),a}function CB(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i],o=a0(r);n[o]={...r,x:s,y:t}}}function BCe({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<n.length;l++){const c=n[l],u=a0(c);if(!t[u]){const{height:d,width:m}=c;i+m+e>o&&(CB(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:c,xOffset:i}),i=i+m+e,s=Math.max(s,d)}}return a.length>0&&CB(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:DCe(s+r+e)}}function zCe(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=n9(n);for(const o of r){s.index++;const a=e(o,s),l=a0(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[l]&&(!t[l]||a.url!==t[l].url)&&(i[l]={...a,source:o,sourceIndex:s.index})}return i}class VCe{constructor(e,{onUpdate:t=AB,onError:i=AB}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=LCe,this._canvasWidth=OCe,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=t,this.onError=i}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?a0(e):e;return this._mapping[t]||NCe}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,textureParameters:s}){e&&(this._loadOptions=e),t!==void 0&&(this._autoPacking=t),r&&(this._mapping=r),i&&(this._texture?.delete(),this._texture=null,this._externalTexture=i),s&&(this._samplerParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,t){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(zCe(e,t,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=BCe({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",data:null,width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||MB,mipLevels:this.device.getMipLevelCount(this._canvasWidth,this._canvasHeight)})),this._texture.height!==this._canvasHeight&&(this._texture=UCe(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||MB)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i),this._texture?.generateMipmapsWebGL()}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,dS(i.url,this._loadOptions).then(r=>{const s=a0(i),o=this._mapping[s],{x:a,y:l,width:c,height:u}=o,{image:d,width:m,height:y}=FCe(t,r,c,u);this._texture?.copyExternalImage({image:d,x:a+(c-m)/2,y:l+(u-y)/2,width:m,height:y}),o.width=m,o.height=y,this._texture?.generateMipmapsWebGL(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const _9=[0,0,0,255],HCe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeBasis:"height",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:_9},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class RI extends j0{getShaders(){return super.getShaders({vs:ICe,fs:kCe,modules:[Ej,Ij,RCe]})}initializeState(){this.state={iconManager:new VCe(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:_9},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c,textureParameters:u}=t,{iconManager:d}=this.state;if(typeof o=="string")return;const m=o||this.internalState.isAsyncPropLoading("iconAtlas");d.setProps({loadOptions:t.loadOptions,autoPacking:!m,iconAtlas:o,iconMapping:m?a:null,textureParameters:u}),m?i.iconMapping!==t.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&d.packIcons(l,c),r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),s.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeBasis:i,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:o,billboard:a,alphaCutoff:l}=this.props,{iconManager:c}=this.state,u=c.getTexture();if(u){const d=this.state.model,m={iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:tm[o],sizeScale:t,sizeBasis:i==="height"?1:0,sizeMinPixels:r,sizeMaxPixels:s,billboard:a,alphaCutoff:l};d.shaderInputs.setProps({icon:m}),d.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new __(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Fj({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){const t=this.getCurrentLayer()?.props.onIconError;t?t(e):vi.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:i,anchorX:r=t/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[t,i,r,s]}}RI.defaultProps=HCe;RI.layerName="IconLayer";const PB=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,WCe={name:"scatterplot",vs:PB,fs:PB,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},jCe=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,$Ce=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,XCe=`// Main shaders

struct ScatterplotUniforms {
  radiusScale: f32,
  radiusMinPixels: f32,
  radiusMaxPixels: f32,
  lineWidthScale: f32,
  lineWidthMinPixels: f32,
  lineWidthMaxPixels: f32,
  stroked: f32,
  filled: i32,
  antialiasing: i32,
  billboard: i32,
  radiusUnits: i32,
  lineWidthUnits: i32,
};

struct ConstantAttributeUniforms {
 instancePositions: vec3<f32>,
 instancePositions64Low: vec3<f32>,
 instanceRadius: f32,
 instanceLineWidths: f32,
 instanceFillColors: vec4<f32>,
 instanceLineColors: vec4<f32>,
 instancePickingColors: vec3<f32>,

 instancePositionsConstant: i32,
 instancePositions64LowConstant: i32,
 instanceRadiusConstant: i32,
 instanceLineWidthsConstant: i32,
 instanceFillColorsConstant: i32,
 instanceLineColorsConstant: i32,
 instancePickingColorsConstant: i32
};

@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;

struct ConstantAttributes {
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instanceRadius: f32,
  instanceLineWidths: f32,
  instanceFillColors: vec4<f32>,
  instanceLineColors: vec4<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  0.0,
  0.0,
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceRadius: f32,
  @location(4) instanceLineWidths: f32,
  @location(5) instanceFillColors: vec4<f32>,
  @location(6) instanceLineColors: vec4<f32>,
  @location(7) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vFillColor: vec4<f32>,
  @location(1) vLineColor: vec4<f32>,
  @location(2) unitPosition: vec2<f32>,
  @location(3) innerUnitRadius: f32,
  @location(4) outerRadiusPixels: f32,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;

  // Draw an inline geometry constant array clip space triangle to verify that rendering works.
  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));
  // if (attributes.instanceIndex == 0) {
  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);
  //   return varyings;
  // }

  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  varyings.outerRadiusPixels = clamp(
    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),
    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
  );

  // Multiply out line width and clamp to limits
  let lineWidthPixels = clamp(
    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),
    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
  // Expand geometry to accommodate edge smoothing
  let edgePadding = select(
    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,
    1.0,
    scatterplot.antialiasing != 0
  );

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = edgePadding * attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;

  if (scatterplot.billboard != 0) {
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;
    // DECKGL_FILTER_SIZE(offset, geometry);
    let clipPixels = project_pixel_size_to_clipspace(offset.xy);
    varyings.position.x = clipPixels.x;
    varyings.position.y = clipPixels.y;
  } else {
    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);
    // DECKGL_FILTER_SIZE(offset, geometry);
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
  }

  // Apply opacity to instance color, or return instance picking color
  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);
  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition;

  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;
  let inCircle = select(
    smoothedge(distToCenter, varyings.outerRadiusPixels),
    step(distToCenter, varyings.outerRadiusPixels),
    scatterplot.antialiasing != 0
  );

  if (inCircle == 0.0) {
    discard;
  }

  var fragColor: vec4<f32>;

  if (scatterplot.stroked != 0) {
    let isLine = select(
      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      scatterplot.antialiasing != 0
    );

    if (scatterplot.filled != 0) {
      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);
    }
  } else if (scatterplot.filled == 0) {
    discard;
  } else {
    fragColor = varyings.vFillColor;
  }

  fragColor.a *= inCircle;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
  // return vec4<f32>(0, 0, 1, 1);
}
`,RB=[0,0,0,255],GCe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:n=>n.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:RB},getLineColor:{type:"accessor",value:RB},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class II extends j0{getShaders(){return super.getShaders({vs:jCe,fs:$Ce,source:XCe,modules:[Ej,Owe,Ij,WCe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:t,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:m,lineWidthMaxPixels:y}=this.props,x={stroked:o,filled:a,billboard:l,antialiasing:c,radiusUnits:tm[t],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:tm[u],lineWidthScale:d,lineWidthMinPixels:m,lineWidthMaxPixels:y},T=this.state.model;T.shaderInputs.setProps({scatterplot:x}),this.context.device.type==="webgpu"&&(T.instanceCount=this.props.data.length),T.draw(this.context.renderPass)}_getModel(){const e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,t=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new __(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Fj({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),isInstanced:!0,parameters:e})}}II.defaultProps=GCe;II.layerName="ScatterplotLayer";const YCe=G.createContext(null);function qCe(n){const e=n.clone();return e.pixelsToGLUnits=n.pixelsToGLUnits,e}function IB(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function kB(n,e){const t=e.viewState||e;let i=!1;if("longitude"in t&&"latitude"in t){const r=n.center;n.center=new r.constructor(t.longitude,t.latitude),i=i||r!==n.center}if("zoom"in t){const r=n.zoom;n.zoom=t.zoom,i=i||r!==n.zoom}if("bearing"in t){const r=n.bearing;n.bearing=t.bearing,i=i||r!==n.bearing}if("pitch"in t){const r=n.pitch;n.pitch=t.pitch,i=i||r!==n.pitch}return t.padding&&!n.isPaddingEqual(t.padding)&&(i=!0,n.padding=t.padding),i}const ZCe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function OB(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const e={};for(const i of n.layers)e[i.id]=i;const t=n.layers.map(i=>{const r=e[i.ref];let s=null;if("interactive"in i&&(s={...i},delete s.interactive),r){s=s||{...i},delete s.ref;for(const o of ZCe)o in r&&(s[o]=r[o])}return s||i});return{...n,layers:t}}function KCe(n,e){const t=Array.isArray(n)?n[0]:n?n.x:0,i=Array.isArray(n)?n[1]:n?n.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return t===r&&i===s}function Of(n,e){if(n===e)return!0;if(!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Of(n[t],e[t]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(const r of t)if(!e.hasOwnProperty(r)||!Of(n[r],e[r]))return!1;return!0}return!1}var LB={};const NB={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},qA={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},DB={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},JCe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],QCe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class b_{constructor(e,t,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const s=this.props[DB[r.type]];s&&s(r)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const s=this.props[NB[r.type]];if(s){if(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"){const o=this._hoveredFeatures||this._map.queryRenderedFeatures(r.point,{layers:this.props.interactiveLayerIds});r.features=o}s(r),delete r.features}},this._onCameraEvent=r=>{if(!this._internalUpdate){const s=this.props[qA[r.type]];s&&s(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=t,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const i=this._updateSettings(e,t);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(i||r||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const i=b_.savedMaps.pop();if(!i)return null;const r=i.map,s=r.getContainer();for(t.className=s.className;s.childNodes.length>0;)t.appendChild(s.childNodes[0]);r._container=t,i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:o}=e;return o&&(o.bounds?r.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):i._updateViewState(o,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),i}_initialize(e){const{props:t}=this,i={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||ePe()||null,container:e,style:OB(t.mapStyle)},r=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),t.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,t.gl)}const s=new this._MapClass(i);r.padding&&s.setPadding(r.padding),t.cursor&&(s.getCanvas().style.cursor=t.cursor),this._createShadowTransform(s);const o=s._render;s._render=c=>{this._inRender=!0,o.call(s,c),this._inRender=!1};const a=s._renderTaskQueue.run;s._renderTaskQueue.run=c=>{a.call(s._renderTaskQueue,c),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const l=s.fire;s.fire=this._fireEvent.bind(this,l),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const c in NB)s.on(c,this._onPointerEvent);for(const c in qA)s.on(c,this._onCameraEvent);for(const c in DB)s.on(c,this._onEvent);this._map=s}recycle(){b_.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=qCe(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const i=this._map;if(t.width!==i.transform.width||t.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:s,pitch:o,bearing:a}=r,l=i.isMoving();l&&(r.cameraElevationReference="sea");const c=kB(r,{...IB(i.transform),...e});if(l&&(r.cameraElevationReference="ground"),c&&t){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=s!==r.zoom),u.rotate||(u.rotate=a!==r.bearing),u.pitch||(u.pitch=o!==r.pitch)}return l||kB(i.transform,e),c}_updateSettings(e,t){const i=this._map;let r=!1;for(const s of JCe)s in e&&!Of(e[s],t[s])&&(r=!0,i[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return r}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==t.mapStyle){const i={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(i.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(OB(e.mapStyle),i),!0}return!1}_updateStyleComponents(e,t){const i=this._map;let r=!1;return i.style.loaded()&&("light"in e&&!Of(e.light,t.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&!Of(e.fog,t.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&!Of(e.terrain,t.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,t){const i=this._map;let r=!1;for(const s of QCe){const o=e[s];Of(o,t[s])||(r=!0,o?i[s].enable(o):i[s].disable())}return r}_updateHover(e){var t;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const s=e.type,o=((t=this._hoveredFeatures)===null||t===void 0?void 0:t.length)>0;let a;if(s==="mousemove")try{a=this._map.queryRenderedFeatures(e.point,{layers:i.interactiveLayerIds})}catch{a=[]}else a=[];const l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,t,i){const r=this._map,s=r.transform,o=typeof t=="string"?t:t.type;return o==="move"&&this._updateViewState(this.props,!1),o in qA&&(typeof t=="object"&&(t.viewState=IB(s)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,t,i),r.transform=s,r):(e.call(r,t,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const t=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=t}}}b_.savedMaps=[];function ePe(){let n=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);n=e&&e[1]}try{n=n||LB.MapboxAccessToken}catch{}try{n=n||LB.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const tPe=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function nPe(n,e){if(!n)return null;const t=n.map,i={getMap:()=>t,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:r=>n.transform.locationPoint(e.LngLat.convert(r)),unproject:r=>n.transform.pointLocation(e.Point.convert(r)),queryTerrainElevation:(r,s)=>{const o=t.transform;t.transform=n.transform;const a=t.queryTerrainElevation(r,s);return t.transform=o,a}};for(const r of iPe(t))!(r in i)&&!tPe.includes(r)&&(i[r]=t[r].bind(t));return i}function iPe(n){const e=new Set;let t=n;for(;t;){for(const i of Object.getOwnPropertyNames(t))i[0]!=="_"&&typeof n[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);t=Object.getPrototypeOf(t)}return Array.from(e)}const rPe=typeof document<"u"?G.useLayoutEffect:G.useEffect,sPe=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function oPe(n,e){for(const t of sPe)t in e&&(n[t]=e[t]);e.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(e.RTLTextPlugin,t=>{t&&console.error(t)},!1)}const qT=G.createContext(null),aPe={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},kI=G.forwardRef((n,e)=>{const t=G.useContext(YCe),[i,r]=G.useState(null),s=G.useRef(),{current:o}=G.useRef({mapLib:null,map:null});G.useEffect(()=>{const l=n.mapLib;let c=!0,u;return Promise.resolve(l||$C(()=>import("./mapbox-gl-ClTZL0lg.js").then(d=>d.m),[])).then(d=>{if(c){if(d.Map||(d=d.default),!d||!d.Map)throw new Error("Invalid mapLib");if(d.supported(n))oPe(d,n),n.reuseMaps&&(u=b_.reuse(n,s.current)),u||(u=new b_(d.Map,n,s.current)),o.map=nPe(u,d),o.mapLib=d,r(u),t?.onMapMount(o.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(d=>{n.onError({type:"error",target:null,originalEvent:null,error:d})}),()=>{c=!1,u&&(t?.onMapUnmount(n.id),n.reuseMaps?u.recycle():u.destroy())}},[]),rPe(()=>{i&&i.setProps(n)}),G.useImperativeHandle(e,()=>o.map,[i]);const a=G.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]);return G.createElement("div",{id:n.id,ref:s,style:a},i&&G.createElement(qT.Provider,{value:o},n.children))});kI.displayName="Map";kI.defaultProps=aPe;const lPe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function dm(n,e){if(!n||!e)return;const t=n.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!lPe.test(i)?t[i]=`${r}px`:t[i]=r}}const cPe={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function y9(n){const{map:e,mapLib:t}=G.useContext(qT),i=G.useRef({props:n});i.current.props=n;const r=G.useMemo(()=>{let s=!1;G.Children.forEach(n.children,l=>{l&&(s=!0)});const o={...n,element:s?document.createElement("div"):null},a=new t.Marker(o).setLngLat([n.longitude,n.latitude]);return a.getElement().addEventListener("click",l=>{var c,u;(u=(c=i.current.props).onClick)===null||u===void 0||u.call(c,{type:"click",target:a,originalEvent:l})}),a.on("dragstart",l=>{var c,u;const d=l;d.lngLat=r.getLngLat(),(u=(c=i.current.props).onDragStart)===null||u===void 0||u.call(c,d)}),a.on("drag",l=>{var c,u;const d=l;d.lngLat=r.getLngLat(),(u=(c=i.current.props).onDrag)===null||u===void 0||u.call(c,d)}),a.on("dragend",l=>{var c,u;const d=l;d.lngLat=r.getLngLat(),(u=(c=i.current.props).onDragEnd)===null||u===void 0||u.call(c,d)}),a},[]);return G.useEffect(()=>(r.addTo(e.getMap()),()=>{r.remove()}),[]),G.useEffect(()=>{dm(r.getElement(),n.style)},[n.style]),(r.getLngLat().lng!==n.longitude||r.getLngLat().lat!==n.latitude)&&r.setLngLat([n.longitude,n.latitude]),n.offset&&!KCe(r.getOffset(),n.offset)&&r.setOffset(n.offset),r.isDraggable()!==n.draggable&&r.setDraggable(n.draggable),r.getRotation()!==n.rotation&&r.setRotation(n.rotation),r.getRotationAlignment()!==n.rotationAlignment&&r.setRotationAlignment(n.rotationAlignment),r.getPitchAlignment()!==n.pitchAlignment&&r.setPitchAlignment(n.pitchAlignment),r.getPopup()!==n.popup&&r.setPopup(n.popup),MP.createPortal(n.children,r.getElement())}y9.defaultProps=cPe;G.memo(y9);function FB(n){return new Set(n?n.trim().split(/\s+/):[])}function uPe(n){const{map:e,mapLib:t}=G.useContext(qT),i=G.useMemo(()=>document.createElement("div"),[]),r=G.useRef({props:n});r.current.props=n;const s=G.useMemo(()=>{const o={...n},a=new t.Popup(o).setLngLat([n.longitude,n.latitude]);return a.once("open",l=>{var c,u;(u=(c=r.current.props).onOpen)===null||u===void 0||u.call(c,l)}),a},[]);if(G.useEffect(()=>{const o=a=>{var l,c;(c=(l=r.current.props).onClose)===null||c===void 0||c.call(l,a)};return s.on("close",o),s.setDOMContent(i).addTo(e.getMap()),()=>{s.off("close",o),s.isOpen()&&s.remove()}},[]),G.useEffect(()=>{dm(s.getElement(),n.style)},[n.style]),s.isOpen()&&((s.getLngLat().lng!==n.longitude||s.getLngLat().lat!==n.latitude)&&s.setLngLat([n.longitude,n.latitude]),n.offset&&!Of(s.options.offset,n.offset)&&s.setOffset(n.offset),(s.options.anchor!==n.anchor||s.options.maxWidth!==n.maxWidth)&&(s.options.anchor=n.anchor,s.setMaxWidth(n.maxWidth)),s.options.className!==n.className)){const o=FB(s.options.className),a=FB(n.className);for(const l of o)a.has(l)||s.removeClassName(l);for(const l of a)o.has(l)||s.addClassName(l);s.options.className=n.className}return MP.createPortal(n.children,i)}G.memo(uPe);function $0(n,e,t,i){const r=G.useContext(qT),s=G.useMemo(()=>n(r),[]);return G.useEffect(()=>{const o=e,a=null,l=typeof e=="function"?e:null,{map:c}=r;return c.hasControl(s)||(c.addControl(s,o?.position),a&&a(r)),()=>{l&&l(r),c.hasControl(s)&&c.removeControl(s)}},[]),s}function hPe(n){const e=$0(({mapLib:t})=>new t.AttributionControl(n),{position:n.position});return G.useEffect(()=>{dm(e._container,n.style)},[n.style]),null}G.memo(hPe);function fPe(n){const e=$0(({mapLib:t})=>new t.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return G.useEffect(()=>{dm(e._controlContainer,n.style)},[n.style]),null}G.memo(fPe);const v9=G.forwardRef((n,e)=>{const t=G.useRef({props:n}),i=$0(({mapLib:r})=>{const s=new r.GeolocateControl(n),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,c;(c=(l=t.current.props).onGeolocate)===null||c===void 0||c.call(l,a)}),s.on("error",a=>{var l,c;(c=(l=t.current.props).onError)===null||c===void 0||c.call(l,a)}),s.on("outofmaxbounds",a=>{var l,c;(c=(l=t.current.props).onOutOfMaxBounds)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,c;(c=(l=t.current.props).onTrackUserLocationStart)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationend",a=>{var l,c;(c=(l=t.current.props).onTrackUserLocationEnd)===null||c===void 0||c.call(l,a)}),s},{position:n.position});return t.current.props=n,G.useImperativeHandle(e,()=>({trigger:()=>i.trigger()}),[]),G.useEffect(()=>{dm(i._container,n.style)},[n.style]),null});v9.displayName="GeolocateControl";G.memo(v9);function dPe(n){const e=$0(({mapLib:t})=>new t.NavigationControl(n),{position:n.position});return G.useEffect(()=>{dm(e._container,n.style)},[n.style]),null}G.memo(dPe);const pPe={unit:"metric",maxWidth:100};function x9(n){const e=$0(({mapLib:t})=>new t.ScaleControl(n),{position:n.position});return(e.options.unit!==n.unit||e.options.maxWidth!==n.maxWidth)&&(e.options.maxWidth=n.maxWidth,e.setUnit(n.unit)),G.useEffect(()=>{dm(e._container,n.style)},[n.style]),null}x9.defaultProps=pPe;G.memo(x9);const mPe="pk.eyJ1IjoiYW5hc2VjcmV0IiwiYSI6ImNtY2RsamlsaTBsbjYyd3NhN2NsY2NmeDQifQ.Bl0ovAjYvKjTu-XCcndscQ",gPe="mapbox://styles/mapbox/satellite-v9",_Pe="an4s3crwt",yPe="Mentaybolita1";function vPe(){const{iata:n}=kP(),[e,t]=G.useState(null),[i,r]=G.useState([]),[s,o]=G.useState(null),a=G.useRef();if(G.useEffect(()=>{fetch(`https://hexdb.io/api/v1/airport/iata/${n}`).then(u=>u.json()).then(u=>t(u)).catch(console.error)},[n]),G.useEffect(()=>{if(!e)return;const u=setInterval(()=>{const d=btoa(`${_Pe}:${yPe}`);fetch("https://opensky-network.org/api/states/all",{headers:{Authorization:`Basic ${d}`}}).then(m=>m.json()).then(m=>{r(m.states?.filter(y=>y[5]&&y[6])||[])}).catch(console.error)},4e3);return()=>clearInterval(u)},[e]),G.useEffect(()=>{const u=d=>{a.current&&!a.current.contains(d.target)&&o(null)};return document.addEventListener("click",u),()=>document.removeEventListener("click",u)},[]),!e)return U.jsx("div",{className:"text-white p-8",children:"Cargando..."});const l=new II({id:"shadows",data:i,getPosition:u=>[u[5],u[6],0],getRadius:u=>{const d=u[7]||0;return 800+Math.min(d/5,2500)},getFillColor:u=>{const d=u[7]||0,m=150-Math.min(d/20,120);return[0,0,0,Math.max(m,30)]},stroked:!1,pickable:!1}),c=new RI({id:"planes",data:i,getPosition:u=>[u[5],u[6],u[7]*2],getIcon:u=>({url:`/directions/d${Math.round((u[10]||0)/45)*45}.png`,width:200,height:200,anchorY:200}),getSize:50,sizeUnits:"pixels",getColor:[255,255,255],pickable:!0,billboard:!1,onClick:({object:u,x:d,y:m})=>o({object:u,x:d,y:m})});return U.jsxs("div",{className:"relative h-screen",ref:a,children:[U.jsx(PCe,{initialViewState:{longitude:e.longitude,latitude:e.latitude,zoom:10,pitch:60,bearing:0,minZoom:5,maxZoom:15,maxPitch:80},controller:!0,layers:[l,c],children:U.jsx(kI,{mapStyle:gPe,mapboxAccessToken:mPe,terrain:{source:"mapbox-dem",exaggeration:1.5}})}),s&&U.jsx("div",{className:"absolute z-50",style:{left:s.x+10,top:s.y+10},children:U.jsx(Ez,{icao:s.object[0],callsign:s.object[1],altitude:s.object[7]||0,speed:s.object[9]||0,onClose:()=>o(null)})}),U.jsxs("div",{className:"absolute top-6 left-6 bg-black/70 text-white p-3 rounded font-mono",children:[U.jsx("h1",{className:"text-lg",children:n}),U.jsxs("p",{className:"text-xs text-gray-300",children:[e.latitude.toFixed(4),", ",e.longitude.toFixed(4)]})]})]})}const xPe=()=>{const{isAuthenticated:n}=Sh(),e=im();if(!n)return U.jsx(KA,{to:"/login",replace:!0});const t=e.pathname.split("/")[2]||"airlines",i=[{name:"Airlines",path:"airlines"},{name:"Airports",path:"airports"},{name:"Flights",path:"flights"}];return U.jsxs("div",{className:"p-8 max-w-7xl mx-auto transition-all duration-500",children:[U.jsx("div",{className:"flex justify-center mb-10",children:U.jsx("div",{className:"flex bg-white/60 dark:bg-neutral-900/70 backdrop-blur-2xl border border-gray-200 dark:border-neutral-800 rounded-2xl shadow-[0_0_40px_-15px_rgba(0,0,0,0.1)] p-1 transition-all duration-300",children:i.map(r=>U.jsxs(LS,{to:`/data/${r.path}`,className:`
                relative px-6 py-2.5 text-sm font-medium rounded-xl transition-all duration-300
                ${t===r.path?"bg-black text-white shadow-md scale-[1.03]":"text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-100/80 dark:hover:bg-white/10"}
              `,children:[r.name,t===r.path&&U.jsx("div",{className:"absolute -bottom-[2px] left-0 right-0 mx-auto w-8 h-[2px] bg-gradient-to-r from-gray-700 to-gray-400 rounded-full"})]},r.path))})}),U.jsx("div",{className:"bg-white/60 dark:bg-neutral-900/70 backdrop-blur-2xl rounded-3xl shadow-[0_0_40px_-15px_rgba(0,0,0,0.1)] p-8 transition-all duration-500 border border-gray-100 dark:border-neutral-800",children:U.jsx(qB,{})})]})};function bPe(){return U.jsx(bf,{children:U.jsxs(G7,{children:[U.jsx(Hr,{path:"/access-denied",element:U.jsx(Z_e,{})}),U.jsx(Hr,{path:"/login",element:U.jsx(Moe,{})}),U.jsx(Hr,{path:"/register",element:U.jsx(Coe,{})}),U.jsx(Hr,{path:"/create-admin",element:U.jsx(Ioe,{})}),U.jsx(Hr,{path:"*",element:U.jsx(_se,{})}),U.jsxs(Hr,{path:"/",element:U.jsx(UN,{children:U.jsx(gse,{})}),children:[U.jsx(Hr,{index:!0,element:U.jsx(Gre,{})}),U.jsxs(Hr,{path:"data",element:U.jsx(xPe,{}),children:[U.jsx(Hr,{path:"flights",element:U.jsx(tfe,{})}),U.jsx(Hr,{path:"airlines",element:U.jsx(Y_e,{})}),U.jsx(Hr,{path:"airports",element:U.jsx(q_e,{})})]}),U.jsx(Hr,{path:"airport/:iata",element:U.jsx(bf,{children:U.jsx(vPe,{})})}),U.jsx(Hr,{path:"flights",element:U.jsx(bf,{children:U.jsx(Ak,{})})}),U.jsx(Hr,{path:"flight-info/:icao",element:U.jsx(bf,{children:U.jsx(tK,{})})}),U.jsx(Hr,{path:"map",element:U.jsx(bf,{children:U.jsx(Ak,{})})}),U.jsx(Hr,{path:"scanner",element:U.jsx(bf,{children:U.jsx(bse,{})})}),U.jsx(Hr,{path:"profile",element:U.jsx(bf,{children:U.jsx(Poe,{})})}),U.jsx(Hr,{path:"logout",element:U.jsx(Roe,{})}),U.jsx(Hr,{path:"admin/dashboard",element:U.jsx(UN,{adminOnly:!0,children:U.jsx(bf,{children:U.jsx(efe,{})})})})]})]})})}const wPe=hoe({reducer:{auth:Aoe}}),SPe=async()=>{try{const n=await is.get("/api/server-time"),e=new Date(n.data.server_time),t=Math.abs(e-new Date);t>3e4&&(console.warn("Clock skew detected:",t+"ms"),alert("Warning: Your device clock is out of sync. Some features may not work properly."))}catch(n){console.error("Time sync failed:",n)}},TPe=document.getElementById("root"),EPe=e7.createRoot(TPe);SPe().finally(()=>{EPe.render(U.jsx(ic.StrictMode,{children:U.jsx(e$,{children:U.jsx(Fse,{store:wPe,children:U.jsx(JZ,{children:U.jsx(bPe,{})})})})}))});export{AP as g};
